/*! For license information please see main.79f0b9ec.js.LICENSE.txt */
(()=>{var t={43:(t,e,n)=>{"use strict";t.exports=n(202)},153:(t,e,n)=>{"use strict";var i=n(43),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,n){var i,r={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(u=e.ref),e)a.call(e,i)&&!l.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps)void 0===r[i]&&(r[i]=e[i]);return{$$typeof:s,type:t,key:c,ref:u,props:r,_owner:o.current}}e.jsx=c,e.jsxs=c},202:(t,e)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||p}function y(){}function w(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},v.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=v.prototype;var b=w.prototype=new y;b.constructor=w,g(b,v.prototype),b.isPureReactComponent=!0;var _=Array.isArray,E=Object.prototype.hasOwnProperty,A={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function k(t,e,i){var s,r={},a=null,o=null;if(null!=e)for(s in void 0!==e.ref&&(o=e.ref),void 0!==e.key&&(a=""+e.key),e)E.call(e,s)&&!S.hasOwnProperty(s)&&(r[s]=e[s]);var l=arguments.length-2;if(1===l)r.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}if(t&&t.defaultProps)for(s in l=t.defaultProps)void 0===r[s]&&(r[s]=l[s]);return{$$typeof:n,type:t,key:a,ref:o,props:r,_owner:A.current}}function C(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var T=/\/+/g;function x(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function I(t,e,s,r,a){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var l=!1;if(null===t)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case i:l=!0}}if(l)return a=a(l=t),t=""===r?"."+x(l,0):r,_(a)?(s="",null!=t&&(s=t.replace(T,"$&/")+"/"),I(a,e,s,"",(function(t){return t}))):null!=a&&(C(a)&&(a=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(a,s+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(T,"$&/")+"/")+t)),e.push(a)),1;if(l=0,r=""===r?".":r+":",_(t))for(var c=0;c<t.length;c++){var u=r+x(o=t[c],c);l+=I(o,e,s,u,a)}else if(u=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof u)for(t=u.call(t),c=0;!(o=t.next()).done;)l+=I(o=o.value,e,s,u=r+x(o,c++),a);else if("object"===o)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function R(t,e,n){if(null==t)return t;var i=[],s=0;return I(t,i,"","",(function(t){return e.call(n,t,s++)})),i}function M(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var P={current:null},N={transition:null},D={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:N,ReactCurrentOwner:A};function L(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:R,forEach:function(t,e,n){R(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return R(t,(function(){e++})),e},toArray:function(t){return R(t,(function(t){return t}))||[]},only:function(t){if(!C(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=v,e.Fragment=s,e.Profiler=a,e.PureComponent=w,e.StrictMode=r,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,e.act=L,e.cloneElement=function(t,e,i){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=g({},t.props),r=t.key,a=t.ref,o=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,o=A.current),void 0!==e.key&&(r=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)E.call(e,c)&&!S.hasOwnProperty(c)&&(s[c]=void 0===e[c]&&void 0!==l?l[c]:e[c])}var c=arguments.length-2;if(1===c)s.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:n,type:t.type,key:r,ref:a,props:s,_owner:o}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:t},t.Consumer=t},e.createElement=k,e.createFactory=function(t){var e=k.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:c,render:t}},e.isValidElement=C,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:M}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=N.transition;N.transition={};try{t()}finally{N.transition=e}},e.unstable_act=L,e.useCallback=function(t,e){return P.current.useCallback(t,e)},e.useContext=function(t){return P.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return P.current.useDeferredValue(t)},e.useEffect=function(t,e){return P.current.useEffect(t,e)},e.useId=function(){return P.current.useId()},e.useImperativeHandle=function(t,e,n){return P.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return P.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return P.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return P.current.useMemo(t,e)},e.useReducer=function(t,e,n){return P.current.useReducer(t,e,n)},e.useRef=function(t){return P.current.useRef(t)},e.useState=function(t){return P.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return P.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return P.current.useTransition()},e.version="18.3.1"},234:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var i=n-1>>>1,s=t[i];if(!(0<r(s,e)))break t;t[i]=e,t[n]=s,n=i}}function i(t){return 0===t.length?null:t[0]}function s(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,s=t.length,a=s>>>1;i<a;){var o=2*(i+1)-1,l=t[o],c=o+1,u=t[c];if(0>r(l,n))c<s&&0>r(u,l)?(t[i]=u,t[c]=n,i=c):(t[i]=l,t[o]=n,i=o);else{if(!(c<s&&0>r(u,n)))break t;t[i]=u,t[c]=n,i=c}}}return e}function r(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function b(t){for(var e=i(u);null!==e;){if(null===e.callback)s(u);else{if(!(e.startTime<=t))break;s(u),e.sortIndex=e.expirationTime,n(c,e)}e=i(u)}}function _(t){if(m=!1,b(t),!g)if(null!==i(c))g=!0,N(E);else{var e=i(u);null!==e&&D(_,e.startTime-t)}}function E(t,n){g=!1,m&&(m=!1,y(C),C=-1),p=!0;var r=f;try{for(b(n),d=i(c);null!==d&&(!(d.expirationTime>n)||t&&!I());){var a=d.callback;if("function"===typeof a){d.callback=null,f=d.priorityLevel;var o=a(d.expirationTime<=n);n=e.unstable_now(),"function"===typeof o?d.callback=o:d===i(c)&&s(c),b(n)}else s(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&D(_,h.startTime-n),l=!1}return l}finally{d=null,f=r,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var A,S=!1,k=null,C=-1,T=5,x=-1;function I(){return!(e.unstable_now()-x<T)}function R(){if(null!==k){var t=e.unstable_now();x=t;var n=!0;try{n=k(!0,t)}finally{n?A():(S=!1,k=null)}}else S=!1}if("function"===typeof w)A=function(){w(R)};else if("undefined"!==typeof MessageChannel){var M=new MessageChannel,P=M.port2;M.port1.onmessage=R,A=function(){P.postMessage(null)}}else A=function(){v(R,0)};function N(t){k=t,S||(S=!0,A())}function D(t,n){C=v((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,N(E))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return i(c)},e.unstable_next=function(t){switch(f){case 1:case 2:case 3:var e=3;break;default:e=f}var n=f;f=e;try{return t()}finally{f=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=f;f=t;try{return e()}finally{f=n}},e.unstable_scheduleCallback=function(t,s,r){var a=e.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?a+r:a:r=a,t){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return t={id:h++,callback:s,priorityLevel:t,startTime:r,expirationTime:o=r+o,sortIndex:-1},r>a?(t.sortIndex=r,n(u,t),null===i(c)&&t===i(u)&&(m?(y(C),C=-1):m=!0,D(_,r-a))):(t.sortIndex=o,n(c,t),g||p||(g=!0,N(E))),t},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(t){var e=f;return function(){var n=f;f=e;try{return t.apply(this,arguments)}finally{f=n}}}},391:(t,e,n)=>{"use strict";var i=n(950);e.createRoot=i.createRoot,e.hydrateRoot=i.hydrateRoot},450:function(t,e,n){var i,s,r;s=[],void 0===(r="function"===typeof(i=function(){"use strict";function e(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function i(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){l(i.response,e,n)},i.onerror=function(){console.error("could not download file")},i.send()}function s(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function r(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(i){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(t,e,n){var o=a.URL||a.webkitURL,l=document.createElement("a");e=e||t.name||"download",l.download=e,l.rel="noopener","string"==typeof t?(l.href=t,l.origin===location.origin?r(l):s(l.href)?i(t,e,n):r(l,l.target="_blank")):(l.href=o.createObjectURL(t),setTimeout((function(){o.revokeObjectURL(l.href)}),4e4),setTimeout((function(){r(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,a){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,a),n);else if(s(t))i(t,n,a);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout((function(){r(o)}))}}:function(t,e,n,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof t)return i(t,e,n);var r="application/octet-stream"===t.type,l=/constructor/i.test(a.HTMLElement)||a.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||r&&l||o)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=c?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=t:location=t,s=null},u.readAsDataURL(t)}else{var h=a.URL||a.webkitURL,d=h.createObjectURL(t);s?s.location=d:location.href=d,s=null,setTimeout((function(){h.revokeObjectURL(d)}),4e4)}});a.saveAs=l.saveAs=l,t.exports=l})?i.apply(e,s):i)||(t.exports=r)},579:(t,e,n)=>{"use strict";t.exports=n(153)},730:(t,e,n)=>{"use strict";var i=n(43),s=n(853);function r(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(o[t]=e,t=0;t<e.length;t++)a.add(e[t])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(t,e,n,i,s,r,a){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=r,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){m[t]=new g(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];m[e]=new g(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){m[t]=new g(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){m[t]=new g(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){m[t]=new g(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){m[t]=new g(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){m[t]=new g(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){m[t]=new g(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){m[t]=new g(t,5,!1,t.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(t){return t[1].toUpperCase()}function w(t,e,n,i){var s=m.hasOwnProperty(e)?m[e]:null;(null!==s?0!==s.type:i||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,i){if(null===e||"undefined"===typeof e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,s,i)&&(n=null),i||null===s?function(t){return!!h.call(p,t)||!h.call(f,t)&&(d.test(t)?p[t]=!0:(f[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=null===n?3!==s.type&&"":n:(e=s.attributeName,i=s.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(v,y);m[e]=new g(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(v,y);m[e]=new g(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(v,y);m[e]=new g(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){m[t]=new g(t,1,!1,t.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){m[t]=new g(t,1,!1,t.toLowerCase(),null,!0,!0)}));var b=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),E=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),T=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var N=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function L(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=D&&t[D]||t["@@iterator"])?t:null}var O,F=Object.assign;function U(t){if(void 0===O)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);O=e&&e[1]||""}return"\n"+O+t}var B=!1;function V(t,e){if(!t||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var s=c.stack.split("\n"),r=i.stack.split("\n"),a=s.length-1,o=r.length-1;1<=a&&0<=o&&s[a]!==r[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==r[o]){if(1!==a||1!==o)do{if(a--,0>--o||s[a]!==r[o]){var l="\n"+s[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=a&&0<=o);break}}}finally{B=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?U(t):""}function j(t){switch(t.tag){case 5:return U(t.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return t=V(t.type,!1);case 11:return t=V(t.type.render,!1);case 1:return t=V(t.type,!0);default:return""}}function W(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case A:return"Fragment";case E:return"Portal";case k:return"Profiler";case S:return"StrictMode";case I:return"Suspense";case R:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case T:return(t.displayName||"Context")+".Consumer";case C:return(t._context.displayName||"Context")+".Provider";case x:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case M:return null!==(e=t.displayName||null)?e:W(t.type)||"Memo";case P:e=t._payload,t=t._init;try{return W(t(e))}catch(n){}}return null}function z(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(e);case 8:return e===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function H(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function q(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function G(t){t._valueTracker||(t._valueTracker=function(t){var e=q(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var s=n.get,r=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(t){i=""+t,r.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function K(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=q(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function X(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Q(t,e){var n=e.checked;return F({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function Y(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=H(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function J(t,e){null!=(e=e.checked)&&w(t,"checked",e,!1)}function $(t,e){J(t,e);var n=H(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,H(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Z(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&X(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,i){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&i&&(t[n].defaultSelected=!0)}else{for(n=""+H(n),e=null,s=0;s<t.length;s++){if(t[s].value===n)return t[s].selected=!0,void(i&&(t[s].defaultSelected=!0));null!==e||t[s].disabled||(e=t[s])}null!==e&&(e.selected=!0)}}function it(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(r(91));return F({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function st(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(r(92));if(et(n)){if(1<n.length)throw Error(r(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:H(n)}}function rt(t,e){var n=H(e.value),i=H(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function at(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function ot(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?ot(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ct,ut,ht=(ut=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ct=ct||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ct.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,i){MSApp.execUnsafeLocalFunction((function(){return ut(t,e)}))}:ut);function dt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var ft={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pt=["Webkit","ms","Moz","O"];function gt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||ft.hasOwnProperty(t)&&ft[t]?(""+e).trim():e+"px"}function mt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),s=gt(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,s):t[n]=s}}Object.keys(ft).forEach((function(t){pt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ft[e]=ft[t]}))}));var vt=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yt(t,e){if(e){if(vt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(r(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(r(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(r(62))}}function wt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bt=null;function _t(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var Et=null,At=null,St=null;function kt(t){if(t=ws(t)){if("function"!==typeof Et)throw Error(r(280));var e=t.stateNode;e&&(e=_s(e),Et(t.stateNode,t.type,e))}}function Ct(t){At?St?St.push(t):St=[t]:At=t}function Tt(){if(At){var t=At,e=St;if(St=At=null,kt(t),e)for(t=0;t<e.length;t++)kt(e[t])}}function xt(t,e){return t(e)}function It(){}var Rt=!1;function Mt(t,e,n){if(Rt)return t(e,n);Rt=!0;try{return xt(t,e,n)}finally{Rt=!1,(null!==At||null!==St)&&(It(),Tt())}}function Pt(t,e){var n=t.stateNode;if(null===n)return null;var i=_s(n);if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(r(231,e,typeof n));return n}var Nt=!1;if(u)try{var Dt={};Object.defineProperty(Dt,"passive",{get:function(){Nt=!0}}),window.addEventListener("test",Dt,Dt),window.removeEventListener("test",Dt,Dt)}catch(ut){Nt=!1}function Lt(t,e,n,i,s,r,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Ot=!1,Ft=null,Ut=!1,Bt=null,Vt={onError:function(t){Ot=!0,Ft=t}};function jt(t,e,n,i,s,r,a,o,l){Ot=!1,Ft=null,Lt.apply(Vt,arguments)}function Wt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function zt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Ht(t){if(Wt(t)!==t)throw Error(r(188))}function qt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Wt(t)))throw Error(r(188));return e!==t?null:t}for(var n=t,i=e;;){var s=n.return;if(null===s)break;var a=s.alternate;if(null===a){if(null!==(i=s.return)){n=i;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===n)return Ht(s),t;if(a===i)return Ht(s),e;a=a.sibling}throw Error(r(188))}if(n.return!==i.return)n=s,i=a;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,i=a;break}if(l===i){o=!0,i=s,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,i=s;break}if(l===i){o=!0,i=a,n=s;break}l=l.sibling}if(!o)throw Error(r(189))}}if(n.alternate!==i)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?t:e}(t))?Gt(t):null}function Gt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Gt(t);if(null!==e)return e;t=t.sibling}return null}var Kt=s.unstable_scheduleCallback,Xt=s.unstable_cancelCallback,Qt=s.unstable_shouldYield,Yt=s.unstable_requestPaint,Jt=s.unstable_now,$t=s.unstable_getCurrentPriorityLevel,Zt=s.unstable_ImmediatePriority,te=s.unstable_UserBlockingPriority,ee=s.unstable_NormalPriority,ne=s.unstable_LowPriority,ie=s.unstable_IdlePriority,se=null,re=null;var ae=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(oe(t)/le|0)|0},oe=Math.log,le=Math.LN2;var ce=64,ue=4194304;function he(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var n=t.pendingLanes;if(0===n)return 0;var i=0,s=t.suspendedLanes,r=t.pingedLanes,a=268435455&n;if(0!==a){var o=a&~s;0!==o?i=he(o):0!==(r&=a)&&(i=he(r))}else 0!==(a=n&~s)?i=he(a):0!==r&&(i=he(r));if(0===i)return 0;if(0!==e&&e!==i&&0===(e&s)&&((s=i&-i)>=(r=e&-e)||16===s&&0!==(4194240&r)))return e;if(0!==(4&i)&&(i|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=i;0<e;)s=1<<(n=31-ae(e)),i|=t[n],e&=~s;return i}function fe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function pe(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function ge(){var t=ce;return 0===(4194240&(ce<<=1))&&(ce=64),t}function me(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ve(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-ae(e)]=n}function ye(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-ae(n),s=1<<i;s&e|t[i]&e&&(t[i]|=e),n&=~s}}var we=0;function be(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var _e,Ee,Ae,Se,ke,Ce=!1,Te=[],xe=null,Ie=null,Re=null,Me=new Map,Pe=new Map,Ne=[],De="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Le(t,e){switch(t){case"focusin":case"focusout":xe=null;break;case"dragenter":case"dragleave":Ie=null;break;case"mouseover":case"mouseout":Re=null;break;case"pointerover":case"pointerout":Me.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pe.delete(e.pointerId)}}function Oe(t,e,n,i,s,r){return null===t||t.nativeEvent!==r?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},null!==e&&(null!==(e=ws(e))&&Ee(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==s&&-1===e.indexOf(s)&&e.push(s),t)}function Fe(t){var e=ys(t.target);if(null!==e){var n=Wt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=zt(n)))return t.blockedOn=e,void ke(t.priority,(function(){Ae(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Ue(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Qe(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=ws(n))&&Ee(e),t.blockedOn=n,!1;var i=new(n=t.nativeEvent).constructor(n.type,n);bt=i,n.target.dispatchEvent(i),bt=null,e.shift()}return!0}function Be(t,e,n){Ue(t)&&n.delete(e)}function Ve(){Ce=!1,null!==xe&&Ue(xe)&&(xe=null),null!==Ie&&Ue(Ie)&&(Ie=null),null!==Re&&Ue(Re)&&(Re=null),Me.forEach(Be),Pe.forEach(Be)}function je(t,e){t.blockedOn===e&&(t.blockedOn=null,Ce||(Ce=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Ve)))}function We(t){function e(e){return je(e,t)}if(0<Te.length){je(Te[0],t);for(var n=1;n<Te.length;n++){var i=Te[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==xe&&je(xe,t),null!==Ie&&je(Ie,t),null!==Re&&je(Re,t),Me.forEach(e),Pe.forEach(e),n=0;n<Ne.length;n++)(i=Ne[n]).blockedOn===t&&(i.blockedOn=null);for(;0<Ne.length&&null===(n=Ne[0]).blockedOn;)Fe(n),null===n.blockedOn&&Ne.shift()}var ze=b.ReactCurrentBatchConfig,He=!0;function qe(t,e,n,i){var s=we,r=ze.transition;ze.transition=null;try{we=1,Ke(t,e,n,i)}finally{we=s,ze.transition=r}}function Ge(t,e,n,i){var s=we,r=ze.transition;ze.transition=null;try{we=4,Ke(t,e,n,i)}finally{we=s,ze.transition=r}}function Ke(t,e,n,i){if(He){var s=Qe(t,e,n,i);if(null===s)Hi(t,e,i,Xe,n),Le(t,i);else if(function(t,e,n,i,s){switch(e){case"focusin":return xe=Oe(xe,t,e,n,i,s),!0;case"dragenter":return Ie=Oe(Ie,t,e,n,i,s),!0;case"mouseover":return Re=Oe(Re,t,e,n,i,s),!0;case"pointerover":var r=s.pointerId;return Me.set(r,Oe(Me.get(r)||null,t,e,n,i,s)),!0;case"gotpointercapture":return r=s.pointerId,Pe.set(r,Oe(Pe.get(r)||null,t,e,n,i,s)),!0}return!1}(s,t,e,n,i))i.stopPropagation();else if(Le(t,i),4&e&&-1<De.indexOf(t)){for(;null!==s;){var r=ws(s);if(null!==r&&_e(r),null===(r=Qe(t,e,n,i))&&Hi(t,e,i,Xe,n),r===s)break;s=r}null!==s&&i.stopPropagation()}else Hi(t,e,i,null,n)}}var Xe=null;function Qe(t,e,n,i){if(Xe=null,null!==(t=ys(t=_t(i))))if(null===(e=Wt(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=zt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Xe=t,null}function Ye(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($t()){case Zt:return 1;case te:return 4;case ee:case ne:return 16;case ie:return 536870912;default:return 16}default:return 16}}var Je=null,$e=null,Ze=null;function tn(){if(Ze)return Ze;var t,e,n=$e,i=n.length,s="value"in Je?Je.value:Je.textContent,r=s.length;for(t=0;t<i&&n[t]===s[t];t++);var a=i-t;for(e=1;e<=a&&n[i-e]===s[r-e];e++);return Ze=s.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function sn(){return!1}function rn(t){function e(e,n,i,s,r){for(var a in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=r,this.currentTarget=null,t)t.hasOwnProperty(a)&&(e=t[a],this[a]=e?e(s):s[a]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?nn:sn,this.isPropagationStopped=sn,this}return F(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=rn(cn),hn=F({},cn,{view:0,detail:0}),dn=rn(hn),fn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ln&&(ln&&"mousemove"===t.type?(an=t.screenX-ln.screenX,on=t.screenY-ln.screenY):on=an=0,ln=t),an)},movementY:function(t){return"movementY"in t?t.movementY:on}}),pn=rn(fn),gn=rn(F({},fn,{dataTransfer:0})),mn=rn(F({},hn,{relatedTarget:0})),vn=rn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},cn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),wn=rn(yn),bn=rn(F({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},An={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=An[t])&&!!e[t]}function kn(){return Sn}var Cn=F({},hn,{key:function(t){if(t.key){var e=_n[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?En[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Tn=rn(Cn),xn=rn(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=rn(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),Rn=rn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Mn=F({},fn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=rn(Mn),Nn=[9,13,27,32],Dn=u&&"CompositionEvent"in window,Ln=null;u&&"documentMode"in document&&(Ln=document.documentMode);var On=u&&"TextEvent"in window&&!Ln,Fn=u&&(!Dn||Ln&&8<Ln&&11>=Ln),Un=String.fromCharCode(32),Bn=!1;function Vn(t,e){switch(t){case"keyup":return-1!==Nn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Wn=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!zn[t.type]:"textarea"===e}function qn(t,e,n,i){Ct(i),0<(e=Gi(e,"onChange")).length&&(n=new un("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Gn=null,Kn=null;function Xn(t){Ui(t,0)}function Qn(t){if(K(bs(t)))return t}function Yn(t,e){if("change"===t)return e}var Jn=!1;if(u){var $n;if(u){var Zn="oninput"in document;if(!Zn){var ti=document.createElement("div");ti.setAttribute("oninput","return;"),Zn="function"===typeof ti.oninput}$n=Zn}else $n=!1;Jn=$n&&(!document.documentMode||9<document.documentMode)}function ei(){Gn&&(Gn.detachEvent("onpropertychange",ni),Kn=Gn=null)}function ni(t){if("value"===t.propertyName&&Qn(Kn)){var e=[];qn(e,Kn,t,_t(t)),Mt(Xn,e)}}function ii(t,e,n){"focusin"===t?(ei(),Kn=n,(Gn=e).attachEvent("onpropertychange",ni)):"focusout"===t&&ei()}function si(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Qn(Kn)}function ri(t,e){if("click"===t)return Qn(e)}function ai(t,e){if("input"===t||"change"===t)return Qn(e)}var oi="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function li(t,e){if(oi(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var s=n[i];if(!h.call(e,s)||!oi(t[s],e[s]))return!1}return!0}function ci(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ui(t,e){var n,i=ci(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=ci(i)}}function hi(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?hi(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function di(){for(var t=window,e=X();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(i){n=!1}if(!n)break;e=X((t=e.contentWindow).document)}return e}function fi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function pi(t){var e=di(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&fi(n))if(e=i.start,void 0===(t=i.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var s=n.textContent.length,r=Math.min(i.start,s);i=void 0===i.end?r:Math.min(i.end,s),!t.extend&&r>i&&(s=i,i=r,r=s),s=ui(n,r);var a=ui(n,i);s&&a&&(1!==t.rangeCount||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&((e=e.createRange()).setStart(s.node,s.offset),t.removeAllRanges(),r>i?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var gi=u&&"documentMode"in document&&11>=document.documentMode,mi=null,vi=null,yi=null,wi=!1;function bi(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wi||null==mi||mi!==X(i)||("selectionStart"in(i=mi)&&fi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=Gi(vi,"onSelect")).length&&(e=new un("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=mi)))}function _i(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ei={animationend:_i("Animation","AnimationEnd"),animationiteration:_i("Animation","AnimationIteration"),animationstart:_i("Animation","AnimationStart"),transitionend:_i("Transition","TransitionEnd")},Ai={},Si={};function ki(t){if(Ai[t])return Ai[t];if(!Ei[t])return t;var e,n=Ei[t];for(e in n)if(n.hasOwnProperty(e)&&e in Si)return Ai[t]=n[e];return t}u&&(Si=document.createElement("div").style,"AnimationEvent"in window||(delete Ei.animationend.animation,delete Ei.animationiteration.animation,delete Ei.animationstart.animation),"TransitionEvent"in window||delete Ei.transitionend.transition);var Ci=ki("animationend"),Ti=ki("animationiteration"),xi=ki("animationstart"),Ii=ki("transitionend"),Ri=new Map,Mi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pi(t,e){Ri.set(t,e),l(e,[t])}for(var Ni=0;Ni<Mi.length;Ni++){var Di=Mi[Ni];Pi(Di.toLowerCase(),"on"+(Di[0].toUpperCase()+Di.slice(1)))}Pi(Ci,"onAnimationEnd"),Pi(Ti,"onAnimationIteration"),Pi(xi,"onAnimationStart"),Pi("dblclick","onDoubleClick"),Pi("focusin","onFocus"),Pi("focusout","onBlur"),Pi(Ii,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Li="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Oi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Li));function Fi(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,i,s,a,o,l,c){if(jt.apply(this,arguments),Ot){if(!Ot)throw Error(r(198));var u=Ft;Ot=!1,Ft=null,Ut||(Ut=!0,Bt=u)}}(i,e,void 0,t),t.currentTarget=null}function Ui(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var i=t[n],s=i.event;i=i.listeners;t:{var r=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==r&&s.isPropagationStopped())break t;Fi(s,o,c),r=l}else for(a=0;a<i.length;a++){if(l=(o=i[a]).instance,c=o.currentTarget,o=o.listener,l!==r&&s.isPropagationStopped())break t;Fi(s,o,c),r=l}}}if(Ut)throw t=Bt,Ut=!1,Bt=null,t}function Bi(t,e){var n=e[gs];void 0===n&&(n=e[gs]=new Set);var i=t+"__bubble";n.has(i)||(zi(e,t,2,!1),n.add(i))}function Vi(t,e,n){var i=0;e&&(i|=4),zi(n,t,i,e)}var ji="_reactListening"+Math.random().toString(36).slice(2);function Wi(t){if(!t[ji]){t[ji]=!0,a.forEach((function(e){"selectionchange"!==e&&(Oi.has(e)||Vi(e,!1,t),Vi(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[ji]||(e[ji]=!0,Vi("selectionchange",!1,e))}}function zi(t,e,n,i){switch(Ye(e)){case 1:var s=qe;break;case 4:s=Ge;break;default:s=Ke}n=s.bind(null,e,n,t),s=void 0,!Nt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(s=!0),i?void 0!==s?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):void 0!==s?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Hi(t,e,n,i,s){var r=i;if(0===(1&e)&&0===(2&e)&&null!==i)t:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var o=i.stateNode.containerInfo;if(o===s||8===o.nodeType&&o.parentNode===s)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;a=a.return}for(;null!==o;){if(null===(a=ys(o)))return;if(5===(l=a.tag)||6===l){i=r=a;continue t}o=o.parentNode}}i=i.return}Mt((function(){var i=r,s=_t(n),a=[];t:{var o=Ri.get(t);if(void 0!==o){var l=un,c=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":l=Tn;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case Ci:case Ti:case xi:l=vn;break;case Ii:l=Rn;break;case"scroll":l=dn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=xn}var u=0!==(4&e),h=!u&&"scroll"===t,d=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=i;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==d&&(null!=(g=Pt(p,d))&&u.push(qi(p,g,f)))),h)break;p=p.return}0<u.length&&(o=new l(o,c,null,n,s),a.push({event:o,listeners:u}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(o="mouseover"===t||"pointerover"===t)||n===bt||!(c=n.relatedTarget||n.fromElement)||!ys(c)&&!c[ps])&&(l||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?ys(c):null)&&(c!==(h=Wt(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=pn,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(u=xn,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?o:bs(l),f=null==c?o:bs(c),(o=new u(g,p+"leave",l,n,s)).target=h,o.relatedTarget=f,g=null,ys(s)===i&&((u=new u(d,p+"enter",c,n,s)).target=f,u.relatedTarget=h,g=u),h=g,l&&c)t:{for(d=c,p=0,f=u=l;f;f=Ki(f))p++;for(f=0,g=d;g;g=Ki(g))f++;for(;0<p-f;)u=Ki(u),p--;for(;0<f-p;)d=Ki(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break t;u=Ki(u),d=Ki(d)}u=null}else u=null;null!==l&&Xi(a,o,l,u,!1),null!==c&&null!==h&&Xi(a,h,c,u,!0)}if("select"===(l=(o=i?bs(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var m=Yn;else if(Hn(o))if(Jn)m=ai;else{m=si;var v=ii}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=ri);switch(m&&(m=m(t,i))?qn(a,m,n,s):(v&&v(t,o,i),"focusout"===t&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&tt(o,"number",o.value)),v=i?bs(i):window,t){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(mi=v,vi=i,yi=null);break;case"focusout":yi=vi=mi=null;break;case"mousedown":wi=!0;break;case"contextmenu":case"mouseup":case"dragend":wi=!1,bi(a,n,s);break;case"selectionchange":if(gi)break;case"keydown":case"keyup":bi(a,n,s)}var y;if(Dn)t:{switch(t){case"compositionstart":var w="onCompositionStart";break t;case"compositionend":w="onCompositionEnd";break t;case"compositionupdate":w="onCompositionUpdate";break t}w=void 0}else Wn?Vn(t,n)&&(w="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(w="onCompositionStart");w&&(Fn&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Wn&&(y=tn()):($e="value"in(Je=s)?Je.value:Je.textContent,Wn=!0)),0<(v=Gi(i,w)).length&&(w=new bn(w,t,null,n,s),a.push({event:w,listeners:v}),y?w.data=y:null!==(y=jn(n))&&(w.data=y))),(y=On?function(t,e){switch(t){case"compositionend":return jn(e);case"keypress":return 32!==e.which?null:(Bn=!0,Un);case"textInput":return(t=e.data)===Un&&Bn?null:t;default:return null}}(t,n):function(t,e){if(Wn)return"compositionend"===t||!Dn&&Vn(t,e)?(t=tn(),Ze=$e=Je=null,Wn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Fn&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(i=Gi(i,"onBeforeInput")).length&&(s=new bn("onBeforeInput","beforeinput",null,n,s),a.push({event:s,listeners:i}),s.data=y))}Ui(a,e)}))}function qi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Gi(t,e){for(var n=e+"Capture",i=[];null!==t;){var s=t,r=s.stateNode;5===s.tag&&null!==r&&(s=r,null!=(r=Pt(t,n))&&i.unshift(qi(t,r,s)),null!=(r=Pt(t,e))&&i.push(qi(t,r,s))),t=t.return}return i}function Ki(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Xi(t,e,n,i,s){for(var r=e._reactName,a=[];null!==n&&n!==i;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==c&&(o=c,s?null!=(l=Pt(n,r))&&a.unshift(qi(n,l,o)):s||null!=(l=Pt(n,r))&&a.push(qi(n,l,o))),n=n.return}0!==a.length&&t.push({event:e,listeners:a})}var Qi=/\r\n?/g,Yi=/\u0000|\uFFFD/g;function Ji(t){return("string"===typeof t?t:""+t).replace(Qi,"\n").replace(Yi,"")}function $i(t,e,n){if(e=Ji(e),Ji(t)!==e&&n)throw Error(r(425))}function Zi(){}var ts=null,es=null;function ns(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var is="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,rs="function"===typeof Promise?Promise:void 0,as="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof rs?function(t){return rs.resolve(null).then(t).catch(os)}:is;function os(t){setTimeout((function(){throw t}))}function ls(t,e){var n=e,i=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===i)return t.removeChild(s),void We(e);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=s}while(n);We(e)}function cs(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function us(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var hs=Math.random().toString(36).slice(2),ds="__reactFiber$"+hs,fs="__reactProps$"+hs,ps="__reactContainer$"+hs,gs="__reactEvents$"+hs,ms="__reactListeners$"+hs,vs="__reactHandles$"+hs;function ys(t){var e=t[ds];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ps]||n[ds]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=us(t);null!==t;){if(n=t[ds])return n;t=us(t)}return e}n=(t=n).parentNode}return null}function ws(t){return!(t=t[ds]||t[ps])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function bs(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(r(33))}function _s(t){return t[fs]||null}var Es=[],As=-1;function Ss(t){return{current:t}}function ks(t){0>As||(t.current=Es[As],Es[As]=null,As--)}function Cs(t,e){As++,Es[As]=t.current,t.current=e}var Ts={},xs=Ss(Ts),Is=Ss(!1),Rs=Ts;function Ms(t,e){var n=t.type.contextTypes;if(!n)return Ts;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var s,r={};for(s in n)r[s]=e[s];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Ps(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Ns(){ks(Is),ks(xs)}function Ds(t,e,n){if(xs.current!==Ts)throw Error(r(168));Cs(xs,e),Cs(Is,n)}function Ls(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var s in i=i.getChildContext())if(!(s in e))throw Error(r(108,z(t)||"Unknown",s));return F({},n,i)}function Os(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ts,Rs=xs.current,Cs(xs,t),Cs(Is,Is.current),!0}function Fs(t,e,n){var i=t.stateNode;if(!i)throw Error(r(169));n?(t=Ls(t,e,Rs),i.__reactInternalMemoizedMergedChildContext=t,ks(Is),ks(xs),Cs(xs,t)):ks(Is),Cs(Is,n)}var Us=null,Bs=!1,Vs=!1;function js(t){null===Us?Us=[t]:Us.push(t)}function Ws(){if(!Vs&&null!==Us){Vs=!0;var t=0,e=we;try{var n=Us;for(we=1;t<n.length;t++){var i=n[t];do{i=i(!0)}while(null!==i)}Us=null,Bs=!1}catch(s){throw null!==Us&&(Us=Us.slice(t+1)),Kt(Zt,Ws),s}finally{we=e,Vs=!1}}return null}var zs=[],Hs=0,qs=null,Gs=0,Ks=[],Xs=0,Qs=null,Ys=1,Js="";function $s(t,e){zs[Hs++]=Gs,zs[Hs++]=qs,qs=t,Gs=e}function Zs(t,e,n){Ks[Xs++]=Ys,Ks[Xs++]=Js,Ks[Xs++]=Qs,Qs=t;var i=Ys;t=Js;var s=32-ae(i)-1;i&=~(1<<s),n+=1;var r=32-ae(e)+s;if(30<r){var a=s-s%5;r=(i&(1<<a)-1).toString(32),i>>=a,s-=a,Ys=1<<32-ae(e)+s|n<<s|i,Js=r+t}else Ys=1<<r|n<<s|i,Js=t}function tr(t){null!==t.return&&($s(t,1),Zs(t,1,0))}function er(t){for(;t===qs;)qs=zs[--Hs],zs[Hs]=null,Gs=zs[--Hs],zs[Hs]=null;for(;t===Qs;)Qs=Ks[--Xs],Ks[Xs]=null,Js=Ks[--Xs],Ks[Xs]=null,Ys=Ks[--Xs],Ks[Xs]=null}var nr=null,ir=null,sr=!1,rr=null;function ar(t,e){var n=Mc(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function or(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,nr=t,ir=cs(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,nr=t,ir=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==Qs?{id:Ys,overflow:Js}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Mc(18,null,null,0)).stateNode=e,n.return=t,t.child=n,nr=t,ir=null,!0);default:return!1}}function lr(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function cr(t){if(sr){var e=ir;if(e){var n=e;if(!or(t,e)){if(lr(t))throw Error(r(418));e=cs(n.nextSibling);var i=nr;e&&or(t,e)?ar(i,n):(t.flags=-4097&t.flags|2,sr=!1,nr=t)}}else{if(lr(t))throw Error(r(418));t.flags=-4097&t.flags|2,sr=!1,nr=t}}}function ur(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;nr=t}function hr(t){if(t!==nr)return!1;if(!sr)return ur(t),sr=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!ns(t.type,t.memoizedProps)),e&&(e=ir)){if(lr(t))throw dr(),Error(r(418));for(;e;)ar(t,e),e=cs(e.nextSibling)}if(ur(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(r(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){ir=cs(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}ir=null}}else ir=nr?cs(t.stateNode.nextSibling):null;return!0}function dr(){for(var t=ir;t;)t=cs(t.nextSibling)}function fr(){ir=nr=null,sr=!1}function pr(t){null===rr?rr=[t]:rr.push(t)}var gr=b.ReactCurrentBatchConfig;function mr(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var i=n.stateNode}if(!i)throw Error(r(147,t));var s=i,a=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===a?e.ref:(e=function(t){var e=s.refs;null===t?delete e[a]:e[a]=t},e._stringRef=a,e)}if("string"!==typeof t)throw Error(r(284));if(!n._owner)throw Error(r(290,t))}return t}function vr(t,e){throw t=Object.prototype.toString.call(e),Error(r(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function yr(t){return(0,t._init)(t._payload)}function wr(t){function e(e,n){if(t){var i=e.deletions;null===i?(e.deletions=[n],e.flags|=16):i.push(n)}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function s(t,e){return(t=Nc(t,e)).index=0,t.sibling=null,t}function a(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags|=2,n):i:(e.flags|=2,n):(e.flags|=1048576,n)}function o(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=Fc(n,t.mode,i)).return=t,e):((e=s(e,n)).return=t,e)}function c(t,e,n,i){var r=n.type;return r===A?h(t,e,n.props.children,i,n.key):null!==e&&(e.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===P&&yr(r)===e.type)?((i=s(e,n.props)).ref=mr(t,e,n),i.return=t,i):((i=Dc(n.type,n.key,n.props,null,t.mode,i)).ref=mr(t,e,n),i.return=t,i)}function u(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Uc(n,t.mode,i)).return=t,e):((e=s(e,n.children||[])).return=t,e)}function h(t,e,n,i,r){return null===e||7!==e.tag?((e=Lc(n,t.mode,i,r)).return=t,e):((e=s(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Fc(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case _:return(n=Dc(e.type,e.key,e.props,null,t.mode,n)).ref=mr(t,null,e),n.return=t,n;case E:return(e=Uc(e,t.mode,n)).return=t,e;case P:return d(t,(0,e._init)(e._payload),n)}if(et(e)||L(e))return(e=Lc(e,t.mode,n,null)).return=t,e;vr(t,e)}return null}function f(t,e,n,i){var s=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==s?null:l(t,e,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===s?c(t,e,n,i):null;case E:return n.key===s?u(t,e,n,i):null;case P:return f(t,e,(s=n._init)(n._payload),i)}if(et(n)||L(n))return null!==s?null:h(t,e,n,i,null);vr(t,n)}return null}function p(t,e,n,i,s){if("string"===typeof i&&""!==i||"number"===typeof i)return l(e,t=t.get(n)||null,""+i,s);if("object"===typeof i&&null!==i){switch(i.$$typeof){case _:return c(e,t=t.get(null===i.key?n:i.key)||null,i,s);case E:return u(e,t=t.get(null===i.key?n:i.key)||null,i,s);case P:return p(t,e,n,(0,i._init)(i._payload),s)}if(et(i)||L(i))return h(e,t=t.get(n)||null,i,s,null);vr(e,i)}return null}function g(s,r,o,l){for(var c=null,u=null,h=r,g=r=0,m=null;null!==h&&g<o.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var v=f(s,h,o[g],l);if(null===v){null===h&&(h=m);break}t&&h&&null===v.alternate&&e(s,h),r=a(v,r,g),null===u?c=v:u.sibling=v,u=v,h=m}if(g===o.length)return n(s,h),sr&&$s(s,g),c;if(null===h){for(;g<o.length;g++)null!==(h=d(s,o[g],l))&&(r=a(h,r,g),null===u?c=h:u.sibling=h,u=h);return sr&&$s(s,g),c}for(h=i(s,h);g<o.length;g++)null!==(m=p(h,s,g,o[g],l))&&(t&&null!==m.alternate&&h.delete(null===m.key?g:m.key),r=a(m,r,g),null===u?c=m:u.sibling=m,u=m);return t&&h.forEach((function(t){return e(s,t)})),sr&&$s(s,g),c}function m(s,o,l,c){var u=L(l);if("function"!==typeof u)throw Error(r(150));if(null==(l=u.call(l)))throw Error(r(151));for(var h=u=null,g=o,m=o=0,v=null,y=l.next();null!==g&&!y.done;m++,y=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var w=f(s,g,y.value,c);if(null===w){null===g&&(g=v);break}t&&g&&null===w.alternate&&e(s,g),o=a(w,o,m),null===h?u=w:h.sibling=w,h=w,g=v}if(y.done)return n(s,g),sr&&$s(s,m),u;if(null===g){for(;!y.done;m++,y=l.next())null!==(y=d(s,y.value,c))&&(o=a(y,o,m),null===h?u=y:h.sibling=y,h=y);return sr&&$s(s,m),u}for(g=i(s,g);!y.done;m++,y=l.next())null!==(y=p(g,s,m,y.value,c))&&(t&&null!==y.alternate&&g.delete(null===y.key?m:y.key),o=a(y,o,m),null===h?u=y:h.sibling=y,h=y);return t&&g.forEach((function(t){return e(s,t)})),sr&&$s(s,m),u}return function t(i,r,a,l){if("object"===typeof a&&null!==a&&a.type===A&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case _:t:{for(var c=a.key,u=r;null!==u;){if(u.key===c){if((c=a.type)===A){if(7===u.tag){n(i,u.sibling),(r=s(u,a.props.children)).return=i,i=r;break t}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&yr(c)===u.type){n(i,u.sibling),(r=s(u,a.props)).ref=mr(i,u,a),r.return=i,i=r;break t}n(i,u);break}e(i,u),u=u.sibling}a.type===A?((r=Lc(a.props.children,i.mode,l,a.key)).return=i,i=r):((l=Dc(a.type,a.key,a.props,null,i.mode,l)).ref=mr(i,r,a),l.return=i,i=l)}return o(i);case E:t:{for(u=a.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===a.containerInfo&&r.stateNode.implementation===a.implementation){n(i,r.sibling),(r=s(r,a.children||[])).return=i,i=r;break t}n(i,r);break}e(i,r),r=r.sibling}(r=Uc(a,i.mode,l)).return=i,i=r}return o(i);case P:return t(i,r,(u=a._init)(a._payload),l)}if(et(a))return g(i,r,a,l);if(L(a))return m(i,r,a,l);vr(i,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==r&&6===r.tag?(n(i,r.sibling),(r=s(r,a)).return=i,i=r):(n(i,r),(r=Fc(a,i.mode,l)).return=i,i=r),o(i)):n(i,r)}}var br=wr(!0),_r=wr(!1),Er=Ss(null),Ar=null,Sr=null,kr=null;function Cr(){kr=Sr=Ar=null}function Tr(t){var e=Er.current;ks(Er),t._currentValue=e}function xr(t,e,n){for(;null!==t;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==i&&(i.childLanes|=e)):null!==i&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Ir(t,e){Ar=t,kr=Sr=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(wo=!0),t.firstContext=null)}function Rr(t){var e=t._currentValue;if(kr!==t)if(t={context:t,memoizedValue:e,next:null},null===Sr){if(null===Ar)throw Error(r(308));Sr=t,Ar.dependencies={lanes:0,firstContext:t}}else Sr=Sr.next=t;return e}var Mr=null;function Pr(t){null===Mr?Mr=[t]:Mr.push(t)}function Nr(t,e,n,i){var s=e.interleaved;return null===s?(n.next=n,Pr(e)):(n.next=s.next,s.next=n),e.interleaved=n,Dr(t,i)}function Dr(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var Lr=!1;function Or(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fr(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ur(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Br(t,e,n){var i=t.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&xl)){var s=i.pending;return null===s?e.next=e:(e.next=s.next,s.next=e),i.pending=e,Dr(t,n)}return null===(s=i.interleaved)?(e.next=e,Pr(i)):(e.next=s.next,s.next=e),i.interleaved=e,Dr(t,n)}function Vr(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ye(t,n)}}function jr(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var s=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===r?s=r=a:r=r.next=a,n=n.next}while(null!==n);null===r?s=r=e:r=r.next=e}else s=r=e;return n={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,effects:i.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Wr(t,e,n,i){var s=t.updateQueue;Lr=!1;var r=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(null!==o){s.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?r=c:a.next=c,a=l;var u=t.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==r){var h=s.baseState;for(a=0,u=c=l=null,o=r;;){var d=o.lane,f=o.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});t:{var p=t,g=o;switch(d=e,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){h=p.call(f,h,d);break t}h=p;break t;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=g.payload)?p.call(f,h,d):p)||void 0===d)break t;h=F({},h,d);break t;case 2:Lr=!0}}null!==o.callback&&0!==o.lane&&(t.flags|=64,null===(d=s.effects)?s.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,a|=d;if(null===(o=o.next)){if(null===(o=s.shared.pending))break;o=(d=o).next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}if(null===u&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,null!==(e=s.shared.interleaved)){s=e;do{a|=s.lane,s=s.next}while(s!==e)}else null===r&&(s.shared.lanes=0);Ol|=a,t.lanes=a,t.memoizedState=h}}function zr(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],s=i.callback;if(null!==s){if(i.callback=null,i=n,"function"!==typeof s)throw Error(r(191,s));s.call(i)}}}var Hr={},qr=Ss(Hr),Gr=Ss(Hr),Kr=Ss(Hr);function Xr(t){if(t===Hr)throw Error(r(174));return t}function Qr(t,e){switch(Cs(Kr,e),Cs(Gr,t),Cs(qr,Hr),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}ks(qr),Cs(qr,e)}function Yr(){ks(qr),ks(Gr),ks(Kr)}function Jr(t){Xr(Kr.current);var e=Xr(qr.current),n=lt(e,t.type);e!==n&&(Cs(Gr,t),Cs(qr,n))}function $r(t){Gr.current===t&&(ks(qr),ks(Gr))}var Zr=Ss(0);function ta(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ea=[];function na(){for(var t=0;t<ea.length;t++)ea[t]._workInProgressVersionPrimary=null;ea.length=0}var ia=b.ReactCurrentDispatcher,sa=b.ReactCurrentBatchConfig,ra=0,aa=null,oa=null,la=null,ca=!1,ua=!1,ha=0,da=0;function fa(){throw Error(r(321))}function pa(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!oi(t[n],e[n]))return!1;return!0}function ga(t,e,n,i,s,a){if(ra=a,aa=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ia.current=null===t||null===t.memoizedState?$a:Za,t=n(i,s),ua){a=0;do{if(ua=!1,ha=0,25<=a)throw Error(r(301));a+=1,la=oa=null,e.updateQueue=null,ia.current=to,t=n(i,s)}while(ua)}if(ia.current=Ja,e=null!==oa&&null!==oa.next,ra=0,la=oa=aa=null,ca=!1,e)throw Error(r(300));return t}function ma(){var t=0!==ha;return ha=0,t}function va(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=t:la=la.next=t,la}function ya(){if(null===oa){var t=aa.alternate;t=null!==t?t.memoizedState:null}else t=oa.next;var e=null===la?aa.memoizedState:la.next;if(null!==e)la=e,oa=t;else{if(null===t)throw Error(r(310));t={memoizedState:(oa=t).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=t:la=la.next=t}return la}function wa(t,e){return"function"===typeof e?e(t):e}function ba(t){var e=ya(),n=e.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=t;var i=oa,s=i.baseQueue,a=n.pending;if(null!==a){if(null!==s){var o=s.next;s.next=a.next,a.next=o}i.baseQueue=s=a,n.pending=null}if(null!==s){a=s.next,i=i.baseState;var l=o=null,c=null,u=a;do{var h=u.lane;if((ra&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:t(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,o=i):c=c.next=d,aa.lanes|=h,Ol|=h}u=u.next}while(null!==u&&u!==a);null===c?o=i:c.next=l,oi(i,e.memoizedState)||(wo=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=c,n.lastRenderedState=i}if(null!==(t=n.interleaved)){s=t;do{a=s.lane,aa.lanes|=a,Ol|=a,s=s.next}while(s!==t)}else null===s&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function _a(t){var e=ya(),n=e.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=t;var i=n.dispatch,s=n.pending,a=e.memoizedState;if(null!==s){n.pending=null;var o=s=s.next;do{a=t(a,o.action),o=o.next}while(o!==s);oi(a,e.memoizedState)||(wo=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),n.lastRenderedState=a}return[a,i]}function Ea(){}function Aa(t,e){var n=aa,i=ya(),s=e(),a=!oi(i.memoizedState,s);if(a&&(i.memoizedState=s,wo=!0),i=i.queue,La(Ca.bind(null,n,i,t),[t]),i.getSnapshot!==e||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,Ra(9,ka.bind(null,n,i,s,e),void 0,null),null===Il)throw Error(r(349));0!==(30&ra)||Sa(n,e,s)}return s}function Sa(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=aa.updateQueue)?(e={lastEffect:null,stores:null},aa.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function ka(t,e,n,i){e.value=n,e.getSnapshot=i,Ta(e)&&xa(t)}function Ca(t,e,n){return n((function(){Ta(e)&&xa(t)}))}function Ta(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!oi(t,n)}catch(i){return!0}}function xa(t){var e=Dr(t,1);null!==e&&nc(e,t,1,-1)}function Ia(t){var e=va();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:t},e.queue=t,t=t.dispatch=Ka.bind(null,aa,t),[e.memoizedState,t]}function Ra(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=aa.updateQueue)?(e={lastEffect:null,stores:null},aa.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function Ma(){return ya().memoizedState}function Pa(t,e,n,i){var s=va();aa.flags|=t,s.memoizedState=Ra(1|e,n,void 0,void 0===i?null:i)}function Na(t,e,n,i){var s=ya();i=void 0===i?null:i;var r=void 0;if(null!==oa){var a=oa.memoizedState;if(r=a.destroy,null!==i&&pa(i,a.deps))return void(s.memoizedState=Ra(e,n,r,i))}aa.flags|=t,s.memoizedState=Ra(1|e,n,r,i)}function Da(t,e){return Pa(8390656,8,t,e)}function La(t,e){return Na(2048,8,t,e)}function Oa(t,e){return Na(4,2,t,e)}function Fa(t,e){return Na(4,4,t,e)}function Ua(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Ba(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Na(4,4,Ua.bind(null,e,t),n)}function Va(){}function ja(t,e){var n=ya();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&pa(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function Wa(t,e){var n=ya();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&pa(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function za(t,e,n){return 0===(21&ra)?(t.baseState&&(t.baseState=!1,wo=!0),t.memoizedState=n):(oi(n,e)||(n=ge(),aa.lanes|=n,Ol|=n,t.baseState=!0),e)}function Ha(t,e){var n=we;we=0!==n&&4>n?n:4,t(!0);var i=sa.transition;sa.transition={};try{t(!1),e()}finally{we=n,sa.transition=i}}function qa(){return ya().memoizedState}function Ga(t,e,n){var i=ec(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Xa(t))Qa(e,n);else if(null!==(n=Nr(t,e,n,i))){nc(n,t,i,tc()),Ya(n,e,i)}}function Ka(t,e,n){var i=ec(t),s={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xa(t))Qa(e,s);else{var r=t.alternate;if(0===t.lanes&&(null===r||0===r.lanes)&&null!==(r=e.lastRenderedReducer))try{var a=e.lastRenderedState,o=r(a,n);if(s.hasEagerState=!0,s.eagerState=o,oi(o,a)){var l=e.interleaved;return null===l?(s.next=s,Pr(e)):(s.next=l.next,l.next=s),void(e.interleaved=s)}}catch(c){}null!==(n=Nr(t,e,s,i))&&(nc(n,t,i,s=tc()),Ya(n,e,i))}}function Xa(t){var e=t.alternate;return t===aa||null!==e&&e===aa}function Qa(t,e){ua=ca=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ya(t,e,n){if(0!==(4194240&n)){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ye(t,n)}}var Ja={readContext:Rr,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},$a={readContext:Rr,useCallback:function(t,e){return va().memoizedState=[t,void 0===e?null:e],t},useContext:Rr,useEffect:Da,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Pa(4194308,4,Ua.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Pa(4194308,4,t,e)},useInsertionEffect:function(t,e){return Pa(4,2,t,e)},useMemo:function(t,e){var n=va();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=va();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=Ga.bind(null,aa,t),[i.memoizedState,t]},useRef:function(t){return t={current:t},va().memoizedState=t},useState:Ia,useDebugValue:Va,useDeferredValue:function(t){return va().memoizedState=t},useTransition:function(){var t=Ia(!1),e=t[0];return t=Ha.bind(null,t[1]),va().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=aa,s=va();if(sr){if(void 0===n)throw Error(r(407));n=n()}else{if(n=e(),null===Il)throw Error(r(349));0!==(30&ra)||Sa(i,e,n)}s.memoizedState=n;var a={value:n,getSnapshot:e};return s.queue=a,Da(Ca.bind(null,i,a,t),[t]),i.flags|=2048,Ra(9,ka.bind(null,i,a,n,e),void 0,null),n},useId:function(){var t=va(),e=Il.identifierPrefix;if(sr){var n=Js;e=":"+e+"R"+(n=(Ys&~(1<<32-ae(Ys)-1)).toString(32)+n),0<(n=ha++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=da++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Za={readContext:Rr,useCallback:ja,useContext:Rr,useEffect:La,useImperativeHandle:Ba,useInsertionEffect:Oa,useLayoutEffect:Fa,useMemo:Wa,useReducer:ba,useRef:Ma,useState:function(){return ba(wa)},useDebugValue:Va,useDeferredValue:function(t){return za(ya(),oa.memoizedState,t)},useTransition:function(){return[ba(wa)[0],ya().memoizedState]},useMutableSource:Ea,useSyncExternalStore:Aa,useId:qa,unstable_isNewReconciler:!1},to={readContext:Rr,useCallback:ja,useContext:Rr,useEffect:La,useImperativeHandle:Ba,useInsertionEffect:Oa,useLayoutEffect:Fa,useMemo:Wa,useReducer:_a,useRef:Ma,useState:function(){return _a(wa)},useDebugValue:Va,useDeferredValue:function(t){var e=ya();return null===oa?e.memoizedState=t:za(e,oa.memoizedState,t)},useTransition:function(){return[_a(wa)[0],ya().memoizedState]},useMutableSource:Ea,useSyncExternalStore:Aa,useId:qa,unstable_isNewReconciler:!1};function eo(t,e){if(t&&t.defaultProps){for(var n in e=F({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}function no(t,e,n,i){n=null===(n=n(i,e=t.memoizedState))||void 0===n?e:F({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var io={isMounted:function(t){return!!(t=t._reactInternals)&&Wt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=tc(),s=ec(t),r=Ur(i,s);r.payload=e,void 0!==n&&null!==n&&(r.callback=n),null!==(e=Br(t,r,s))&&(nc(e,t,s,i),Vr(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=tc(),s=ec(t),r=Ur(i,s);r.tag=1,r.payload=e,void 0!==n&&null!==n&&(r.callback=n),null!==(e=Br(t,r,s))&&(nc(e,t,s,i),Vr(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=tc(),i=ec(t),s=Ur(n,i);s.tag=2,void 0!==e&&null!==e&&(s.callback=e),null!==(e=Br(t,s,i))&&(nc(e,t,i,n),Vr(e,t,i))}};function so(t,e,n,i,s,r,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,r,a):!e.prototype||!e.prototype.isPureReactComponent||(!li(n,i)||!li(s,r))}function ro(t,e,n){var i=!1,s=Ts,r=e.contextType;return"object"===typeof r&&null!==r?r=Rr(r):(s=Ps(e)?Rs:xs.current,r=(i=null!==(i=e.contextTypes)&&void 0!==i)?Ms(t,s):Ts),e=new e(n,r),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=io,t.stateNode=e,e._reactInternals=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=r),e}function ao(t,e,n,i){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&io.enqueueReplaceState(e,e.state,null)}function oo(t,e,n,i){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Or(t);var r=e.contextType;"object"===typeof r&&null!==r?s.context=Rr(r):(r=Ps(e)?Rs:xs.current,s.context=Ms(t,r)),s.state=t.memoizedState,"function"===typeof(r=e.getDerivedStateFromProps)&&(no(t,e,r,n),s.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(e=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),e!==s.state&&io.enqueueReplaceState(s,s.state,null),Wr(t,n,s,i),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308)}function lo(t,e){try{var n="",i=e;do{n+=j(i),i=i.return}while(i);var s=n}catch(r){s="\nError generating stack: "+r.message+"\n"+r.stack}return{value:t,source:e,stack:s,digest:null}}function co(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function uo(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function fo(t,e,n){(n=Ur(-1,n)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Hl||(Hl=!0,ql=i),uo(0,e)},n}function po(t,e,n){(n=Ur(-1,n)).tag=3;var i=t.type.getDerivedStateFromError;if("function"===typeof i){var s=e.value;n.payload=function(){return i(s)},n.callback=function(){uo(0,e)}}var r=t.stateNode;return null!==r&&"function"===typeof r.componentDidCatch&&(n.callback=function(){uo(0,e),"function"!==typeof i&&(null===Gl?Gl=new Set([this]):Gl.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function go(t,e,n){var i=t.pingCache;if(null===i){i=t.pingCache=new ho;var s=new Set;i.set(e,s)}else void 0===(s=i.get(e))&&(s=new Set,i.set(e,s));s.has(n)||(s.add(n),t=kc.bind(null,t,e,n),e.then(t,t))}function mo(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function vo(t,e,n,i,s){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=Ur(-1,1)).tag=2,Br(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=s,t)}var yo=b.ReactCurrentOwner,wo=!1;function bo(t,e,n,i){e.child=null===t?_r(e,null,n,i):br(e,t.child,n,i)}function _o(t,e,n,i,s){n=n.render;var r=e.ref;return Ir(e,s),i=ga(t,e,n,i,r,s),n=ma(),null===t||wo?(sr&&n&&tr(e),e.flags|=1,bo(t,e,i,s),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ho(t,e,s))}function Eo(t,e,n,i,s){if(null===t){var r=n.type;return"function"!==typeof r||Pc(r)||void 0!==r.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Dc(n.type,null,i,e,e.mode,s)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=r,Ao(t,e,r,i,s))}if(r=t.child,0===(t.lanes&s)){var a=r.memoizedProps;if((n=null!==(n=n.compare)?n:li)(a,i)&&t.ref===e.ref)return Ho(t,e,s)}return e.flags|=1,(t=Nc(r,i)).ref=e.ref,t.return=e,e.child=t}function Ao(t,e,n,i,s){if(null!==t){var r=t.memoizedProps;if(li(r,i)&&t.ref===e.ref){if(wo=!1,e.pendingProps=i=r,0===(t.lanes&s))return e.lanes=t.lanes,Ho(t,e,s);0!==(131072&t.flags)&&(wo=!0)}}return Co(t,e,n,i,s)}function So(t,e,n){var i=e.pendingProps,s=i.children,r=null!==t?t.memoizedState:null;if("hidden"===i.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cs(Nl,Pl),Pl|=n;else{if(0===(1073741824&n))return t=null!==r?r.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Cs(Nl,Pl),Pl|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==r?r.baseLanes:n,Cs(Nl,Pl),Pl|=i}else null!==r?(i=r.baseLanes|n,e.memoizedState=null):i=n,Cs(Nl,Pl),Pl|=i;return bo(t,e,s,n),e.child}function ko(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Co(t,e,n,i,s){var r=Ps(n)?Rs:xs.current;return r=Ms(e,r),Ir(e,s),n=ga(t,e,n,i,r,s),i=ma(),null===t||wo?(sr&&i&&tr(e),e.flags|=1,bo(t,e,n,s),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ho(t,e,s))}function To(t,e,n,i,s){if(Ps(n)){var r=!0;Os(e)}else r=!1;if(Ir(e,s),null===e.stateNode)zo(t,e),ro(e,n,i),oo(e,n,i,s),i=!0;else if(null===t){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=Rr(c):c=Ms(e,c=Ps(n)?Rs:xs.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==i||l!==c)&&ao(e,a,i,c),Lr=!1;var d=e.memoizedState;a.state=d,Wr(e,i,a,s),l=e.memoizedState,o!==i||d!==l||Is.current||Lr?("function"===typeof u&&(no(e,n,u,i),l=e.memoizedState),(o=Lr||so(e,n,o,i,d,l,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.flags|=4194308)):("function"===typeof a.componentDidMount&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),a.props=i,a.state=l,a.context=c,i=o):("function"===typeof a.componentDidMount&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,Fr(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:eo(e.type,o),a.props=c,h=e.pendingProps,d=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Rr(l):l=Ms(e,l=Ps(n)?Rs:xs.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==h||d!==l)&&ao(e,a,i,l),Lr=!1,d=e.memoizedState,a.state=d,Wr(e,i,a,s);var p=e.memoizedState;o!==h||d!==p||Is.current||Lr?("function"===typeof f&&(no(e,n,f,i),p=e.memoizedState),(c=Lr||so(e,n,c,i,d,p,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof a.componentDidUpdate&&(e.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=p),a.props=i,a.state=p,a.context=l,i=c):("function"!==typeof a.componentDidUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return xo(t,e,n,i,r,s)}function xo(t,e,n,i,s,r){ko(t,e);var a=0!==(128&e.flags);if(!i&&!a)return s&&Fs(e,n,!1),Ho(t,e,r);i=e.stateNode,yo.current=e;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return e.flags|=1,null!==t&&a?(e.child=br(e,t.child,null,r),e.child=br(e,null,o,r)):bo(t,e,o,r),e.memoizedState=i.state,s&&Fs(e,n,!0),e.child}function Io(t){var e=t.stateNode;e.pendingContext?Ds(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Ds(0,e.context,!1),Qr(t,e.containerInfo)}function Ro(t,e,n,i,s){return fr(),pr(s),e.flags|=256,bo(t,e,n,i),e.child}var Mo,Po,No,Do,Lo={dehydrated:null,treeContext:null,retryLane:0};function Oo(t){return{baseLanes:t,cachePool:null,transitions:null}}function Fo(t,e,n){var i,s=e.pendingProps,a=Zr.current,o=!1,l=0!==(128&e.flags);if((i=l)||(i=(null===t||null!==t.memoizedState)&&0!==(2&a)),i?(o=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(a|=1),Cs(Zr,1&a),null===t)return cr(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(l=s.children,t=s.fallback,o?(s=e.mode,o=e.child,l={mode:"hidden",children:l},0===(1&s)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Oc(l,s,0,null),t=Lc(t,s,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Oo(n),e.memoizedState=Lo,t):Uo(e,l));if(null!==(a=t.memoizedState)&&null!==(i=a.dehydrated))return function(t,e,n,i,s,a,o){if(n)return 256&e.flags?(e.flags&=-257,Bo(t,e,o,i=co(Error(r(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(a=i.fallback,s=e.mode,i=Oc({mode:"visible",children:i.children},s,0,null),(a=Lc(a,s,o,null)).flags|=2,i.return=e,a.return=e,i.sibling=a,e.child=i,0!==(1&e.mode)&&br(e,t.child,null,o),e.child.memoizedState=Oo(o),e.memoizedState=Lo,a);if(0===(1&e.mode))return Bo(t,e,o,null);if("$!"===s.data){if(i=s.nextSibling&&s.nextSibling.dataset)var l=i.dgst;return i=l,Bo(t,e,o,i=co(a=Error(r(419)),i,void 0))}if(l=0!==(o&t.childLanes),wo||l){if(null!==(i=Il)){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(i.suspendedLanes|o))?0:s)&&s!==a.retryLane&&(a.retryLane=s,Dr(t,s),nc(i,t,s,-1))}return gc(),Bo(t,e,o,i=co(Error(r(421))))}return"$?"===s.data?(e.flags|=128,e.child=t.child,e=Tc.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,ir=cs(s.nextSibling),nr=e,sr=!0,rr=null,null!==t&&(Ks[Xs++]=Ys,Ks[Xs++]=Js,Ks[Xs++]=Qs,Ys=t.id,Js=t.overflow,Qs=e),e=Uo(e,i.children),e.flags|=4096,e)}(t,e,l,s,i,a,n);if(o){o=s.fallback,l=e.mode,i=(a=t.child).sibling;var c={mode:"hidden",children:s.children};return 0===(1&l)&&e.child!==a?((s=e.child).childLanes=0,s.pendingProps=c,e.deletions=null):(s=Nc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==i?o=Nc(i,o):(o=Lc(o,l,n,null)).flags|=2,o.return=e,s.return=e,s.sibling=o,e.child=s,s=o,o=e.child,l=null===(l=t.child.memoizedState)?Oo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=t.childLanes&~n,e.memoizedState=Lo,s}return t=(o=t.child).sibling,s=Nc(o,{mode:"visible",children:s.children}),0===(1&e.mode)&&(s.lanes=n),s.return=e,s.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function Uo(t,e){return(e=Oc({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Bo(t,e,n,i){return null!==i&&pr(i),br(e,t.child,null,n),(t=Uo(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function Vo(t,e,n){t.lanes|=e;var i=t.alternate;null!==i&&(i.lanes|=e),xr(t.return,e,n)}function jo(t,e,n,i,s){var r=t.memoizedState;null===r?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:s}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=n,r.tailMode=s)}function Wo(t,e,n){var i=e.pendingProps,s=i.revealOrder,r=i.tail;if(bo(t,e,i.children,n),0!==(2&(i=Zr.current)))i=1&i|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Vo(t,n,e);else if(19===t.tag)Vo(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Cs(Zr,i),0===(1&e.mode))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;null!==n;)null!==(t=n.alternate)&&null===ta(t)&&(s=n),n=n.sibling;null===(n=s)?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),jo(e,!1,s,n,r);break;case"backwards":for(n=null,s=e.child,e.child=null;null!==s;){if(null!==(t=s.alternate)&&null===ta(t)){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}jo(e,!0,n,null,r);break;case"together":jo(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function zo(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ho(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Ol|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(r(153));if(null!==e.child){for(n=Nc(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Nc(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function qo(t,e){if(!sr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Go(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,i=0;if(e)for(var s=t.child;null!==s;)n|=s.lanes|s.childLanes,i|=14680064&s.subtreeFlags,i|=14680064&s.flags,s.return=t,s=s.sibling;else for(s=t.child;null!==s;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function Ko(t,e,n){var i=e.pendingProps;switch(er(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Go(e),null;case 1:case 17:return Ps(e.type)&&Ns(),Go(e),null;case 3:return i=e.stateNode,Yr(),ks(Is),ks(xs),na(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(hr(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==rr&&(ac(rr),rr=null))),Po(t,e),Go(e),null;case 5:$r(e);var s=Xr(Kr.current);if(n=e.type,null!==t&&null!=e.stateNode)No(t,e,n,i,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(null===e.stateNode)throw Error(r(166));return Go(e),null}if(t=Xr(qr.current),hr(e)){i=e.stateNode,n=e.type;var a=e.memoizedProps;switch(i[ds]=e,i[fs]=a,t=0!==(1&e.mode),n){case"dialog":Bi("cancel",i),Bi("close",i);break;case"iframe":case"object":case"embed":Bi("load",i);break;case"video":case"audio":for(s=0;s<Li.length;s++)Bi(Li[s],i);break;case"source":Bi("error",i);break;case"img":case"image":case"link":Bi("error",i),Bi("load",i);break;case"details":Bi("toggle",i);break;case"input":Y(i,a),Bi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Bi("invalid",i);break;case"textarea":st(i,a),Bi("invalid",i)}for(var l in yt(n,a),s=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==a.suppressHydrationWarning&&$i(i.textContent,c,t),s=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&$i(i.textContent,c,t),s=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Bi("scroll",i)}switch(n){case"input":G(i),Z(i,a,!0);break;case"textarea":G(i),at(i);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(i.onclick=Zi)}i=s,e.updateQueue=i,null!==i&&(e.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=ot(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof i.is?t=l.createElement(n,{is:i.is}):(t=l.createElement(n),"select"===n&&(l=t,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):t=l.createElementNS(t,n),t[ds]=e,t[fs]=i,Mo(t,e,!1,!1),e.stateNode=t;t:{switch(l=wt(n,i),n){case"dialog":Bi("cancel",t),Bi("close",t),s=i;break;case"iframe":case"object":case"embed":Bi("load",t),s=i;break;case"video":case"audio":for(s=0;s<Li.length;s++)Bi(Li[s],t);s=i;break;case"source":Bi("error",t),s=i;break;case"img":case"image":case"link":Bi("error",t),Bi("load",t),s=i;break;case"details":Bi("toggle",t),s=i;break;case"input":Y(t,i),s=Q(t,i),Bi("invalid",t);break;case"option":default:s=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},s=F({},i,{value:void 0}),Bi("invalid",t);break;case"textarea":st(t,i),s=it(t,i),Bi("invalid",t)}for(a in yt(n,s),c=s)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?mt(t,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&ht(t,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&dt(t,u):"number"===typeof u&&dt(t,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Bi("scroll",t):null!=u&&w(t,a,u,l))}switch(n){case"input":G(t),Z(t,i,!1);break;case"textarea":G(t),at(t);break;case"option":null!=i.value&&t.setAttribute("value",""+H(i.value));break;case"select":t.multiple=!!i.multiple,null!=(a=i.value)?nt(t,!!i.multiple,a,!1):null!=i.defaultValue&&nt(t,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof s.onClick&&(t.onclick=Zi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Go(e),null;case 6:if(t&&null!=e.stateNode)Do(t,e,t.memoizedProps,i);else{if("string"!==typeof i&&null===e.stateNode)throw Error(r(166));if(n=Xr(Kr.current),Xr(qr.current),hr(e)){if(i=e.stateNode,n=e.memoizedProps,i[ds]=e,(a=i.nodeValue!==n)&&null!==(t=nr))switch(t.tag){case 3:$i(i.nodeValue,n,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&$i(i.nodeValue,n,0!==(1&t.mode))}a&&(e.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[ds]=e,e.stateNode=i}return Go(e),null;case 13:if(ks(Zr),i=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(sr&&null!==ir&&0!==(1&e.mode)&&0===(128&e.flags))dr(),fr(),e.flags|=98560,a=!1;else if(a=hr(e),null!==i&&null!==i.dehydrated){if(null===t){if(!a)throw Error(r(318));if(!(a=null!==(a=e.memoizedState)?a.dehydrated:null))throw Error(r(317));a[ds]=e}else fr(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Go(e),a=!1}else null!==rr&&(ac(rr),rr=null),a=!0;if(!a)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=n,e):((i=null!==i)!==(null!==t&&null!==t.memoizedState)&&i&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&Zr.current)?0===Dl&&(Dl=3):gc())),null!==e.updateQueue&&(e.flags|=4),Go(e),null);case 4:return Yr(),Po(t,e),null===t&&Wi(e.stateNode.containerInfo),Go(e),null;case 10:return Tr(e.type._context),Go(e),null;case 19:if(ks(Zr),null===(a=e.memoizedState))return Go(e),null;if(i=0!==(128&e.flags),null===(l=a.rendering))if(i)qo(a,!1);else{if(0!==Dl||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=ta(t))){for(e.flags|=128,qo(a,!1),null!==(i=l.updateQueue)&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;null!==n;)t=i,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,t=l.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Cs(Zr,1&Zr.current|2),e.child}t=t.sibling}null!==a.tail&&Jt()>Wl&&(e.flags|=128,i=!0,qo(a,!1),e.lanes=4194304)}else{if(!i)if(null!==(t=ta(l))){if(e.flags|=128,i=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),qo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!sr)return Go(e),null}else 2*Jt()-a.renderingStartTime>Wl&&1073741824!==n&&(e.flags|=128,i=!0,qo(a,!1),e.lanes=4194304);a.isBackwards?(l.sibling=e.child,e.child=l):(null!==(n=a.last)?n.sibling=l:e.child=l,a.last=l)}return null!==a.tail?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Jt(),e.sibling=null,n=Zr.current,Cs(Zr,i?1&n|2:1&n),e):(Go(e),null);case 22:case 23:return hc(),i=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==i&&(e.flags|=8192),i&&0!==(1&e.mode)?0!==(1073741824&Pl)&&(Go(e),6&e.subtreeFlags&&(e.flags|=8192)):Go(e),null;case 24:case 25:return null}throw Error(r(156,e.tag))}function Xo(t,e){switch(er(e),e.tag){case 1:return Ps(e.type)&&Ns(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return Yr(),ks(Is),ks(xs),na(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return $r(e),null;case 13:if(ks(Zr),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(r(340));fr()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return ks(Zr),null;case 4:return Yr(),null;case 10:return Tr(e.type._context),null;case 22:case 23:return hc(),null;default:return null}}Mo=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Po=function(){},No=function(t,e,n,i){var s=t.memoizedProps;if(s!==i){t=e.stateNode,Xr(qr.current);var r,a=null;switch(n){case"input":s=Q(t,s),i=Q(t,i),a=[];break;case"select":s=F({},s,{value:void 0}),i=F({},i,{value:void 0}),a=[];break;case"textarea":s=it(t,s),i=it(t,i),a=[];break;default:"function"!==typeof s.onClick&&"function"===typeof i.onClick&&(t.onclick=Zi)}for(u in yt(n,i),n=null,s)if(!i.hasOwnProperty(u)&&s.hasOwnProperty(u)&&null!=s[u])if("style"===u){var l=s[u];for(r in l)l.hasOwnProperty(r)&&(n||(n={}),n[r]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=s?s[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(r in l)!l.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(n||(n={}),n[r]="");for(r in c)c.hasOwnProperty(r)&&l[r]!==c[r]&&(n||(n={}),n[r]=c[r])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Bi("scroll",t),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(e.updateQueue=u)&&(e.flags|=4)}},Do=function(t,e,n,i){n!==i&&(e.flags|=4)};var Qo=!1,Yo=!1,Jo="function"===typeof WeakSet?WeakSet:Set,$o=null;function Zo(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Sc(t,e,i)}else n.current=null}function tl(t,e,n){try{n()}catch(i){Sc(t,e,i)}}var el=!1;function nl(t,e,n){var i=e.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var s=i=i.next;do{if((s.tag&t)===t){var r=s.destroy;s.destroy=void 0,void 0!==r&&tl(e,n,r)}s=s.next}while(s!==i)}}function il(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function sl(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"===typeof e?e(t):e.current=t}}function rl(t){var e=t.alternate;null!==e&&(t.alternate=null,rl(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[ds],delete e[fs],delete e[gs],delete e[ms],delete e[vs])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function al(t){return 5===t.tag||3===t.tag||4===t.tag}function ol(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||al(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ll(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=Zi));else if(4!==i&&null!==(t=t.child))for(ll(t,e,n),t=t.sibling;null!==t;)ll(t,e,n),t=t.sibling}function cl(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&null!==(t=t.child))for(cl(t,e,n),t=t.sibling;null!==t;)cl(t,e,n),t=t.sibling}var ul=null,hl=!1;function dl(t,e,n){for(n=n.child;null!==n;)fl(t,e,n),n=n.sibling}function fl(t,e,n){if(re&&"function"===typeof re.onCommitFiberUnmount)try{re.onCommitFiberUnmount(se,n)}catch(o){}switch(n.tag){case 5:Yo||Zo(n,e);case 6:var i=ul,s=hl;ul=null,dl(t,e,n),hl=s,null!==(ul=i)&&(hl?(t=ul,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(t=ul,n=n.stateNode,8===t.nodeType?ls(t.parentNode,n):1===t.nodeType&&ls(t,n),We(t)):ls(ul,n.stateNode));break;case 4:i=ul,s=hl,ul=n.stateNode.containerInfo,hl=!0,dl(t,e,n),ul=i,hl=s;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){s=i=i.next;do{var r=s,a=r.destroy;r=r.tag,void 0!==a&&(0!==(2&r)||0!==(4&r))&&tl(n,e,a),s=s.next}while(s!==i)}dl(t,e,n);break;case 1:if(!Yo&&(Zo(n,e),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){Sc(n,e,o)}dl(t,e,n);break;case 21:dl(t,e,n);break;case 22:1&n.mode?(Yo=(i=Yo)||null!==n.memoizedState,dl(t,e,n),Yo=i):dl(t,e,n);break;default:dl(t,e,n)}}function pl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Jo),e.forEach((function(e){var i=xc.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))}))}}function gl(t,e){var n=e.deletions;if(null!==n)for(var i=0;i<n.length;i++){var s=n[i];try{var a=t,o=e,l=o;t:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break t;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break t}l=l.return}if(null===ul)throw Error(r(160));fl(a,o,s),ul=null,hl=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(u){Sc(s,e,u)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)ml(e,t),e=e.sibling}function ml(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(gl(e,t),vl(t),4&i){try{nl(3,t,t.return),il(3,t)}catch(m){Sc(t,t.return,m)}try{nl(5,t,t.return)}catch(m){Sc(t,t.return,m)}}break;case 1:gl(e,t),vl(t),512&i&&null!==n&&Zo(n,n.return);break;case 5:if(gl(e,t),vl(t),512&i&&null!==n&&Zo(n,n.return),32&t.flags){var s=t.stateNode;try{dt(s,"")}catch(m){Sc(t,t.return,m)}}if(4&i&&null!=(s=t.stateNode)){var a=t.memoizedProps,o=null!==n?n.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&J(s,a),wt(l,o);var u=wt(l,a);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];"style"===h?mt(s,d):"dangerouslySetInnerHTML"===h?ht(s,d):"children"===h?dt(s,d):w(s,h,d,u)}switch(l){case"input":$(s,a);break;case"textarea":rt(s,a);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?nt(s,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?nt(s,!!a.multiple,a.defaultValue,!0):nt(s,!!a.multiple,a.multiple?[]:"",!1))}s[fs]=a}catch(m){Sc(t,t.return,m)}}break;case 6:if(gl(e,t),vl(t),4&i){if(null===t.stateNode)throw Error(r(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(m){Sc(t,t.return,m)}}break;case 3:if(gl(e,t),vl(t),4&i&&null!==n&&n.memoizedState.isDehydrated)try{We(e.containerInfo)}catch(m){Sc(t,t.return,m)}break;case 4:default:gl(e,t),vl(t);break;case 13:gl(e,t),vl(t),8192&(s=t.child).flags&&(a=null!==s.memoizedState,s.stateNode.isHidden=a,!a||null!==s.alternate&&null!==s.alternate.memoizedState||(jl=Jt())),4&i&&pl(t);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&t.mode?(Yo=(u=Yo)||h,gl(e,t),Yo=u):gl(e,t),vl(t),8192&i){if(u=null!==t.memoizedState,(t.stateNode.isHidden=u)&&!h&&0!==(1&t.mode))for($o=t,h=t.child;null!==h;){for(d=$o=h;null!==$o;){switch(p=(f=$o).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Zo(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){i=f,n=f.return;try{e=i,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(m){Sc(i,n,m)}}break;case 5:Zo(f,f.return);break;case 22:if(null!==f.memoizedState){_l(d);continue}}null!==p?(p.return=f,$o=p):_l(d)}h=h.sibling}t:for(h=null,d=t;;){if(5===d.tag){if(null===h){h=d;try{s=d.stateNode,u?"function"===typeof(a=s.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,o=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=gt("display",o))}catch(m){Sc(t,t.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Sc(t,t.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gl(e,t),vl(t),4&i&&pl(t);case 21:}}function vl(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(al(n)){var i=n;break t}n=n.return}throw Error(r(160))}switch(i.tag){case 5:var s=i.stateNode;32&i.flags&&(dt(s,""),i.flags&=-33),cl(t,ol(t),s);break;case 3:case 4:var a=i.stateNode.containerInfo;ll(t,ol(t),a);break;default:throw Error(r(161))}}catch(o){Sc(t,t.return,o)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function yl(t,e,n){$o=t,wl(t,e,n)}function wl(t,e,n){for(var i=0!==(1&t.mode);null!==$o;){var s=$o,r=s.child;if(22===s.tag&&i){var a=null!==s.memoizedState||Qo;if(!a){var o=s.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Qo;var c=Yo;if(Qo=a,(Yo=l)&&!c)for($o=s;null!==$o;)l=(a=$o).child,22===a.tag&&null!==a.memoizedState?El(s):null!==l?(l.return=a,$o=l):El(s);for(;null!==r;)$o=r,wl(r,e,n),r=r.sibling;$o=s,Qo=o,Yo=c}bl(t)}else 0!==(8772&s.subtreeFlags)&&null!==r?(r.return=s,$o=r):bl(t)}}function bl(t){for(;null!==$o;){var e=$o;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Yo||il(5,e);break;case 1:var i=e.stateNode;if(4&e.flags&&!Yo)if(null===n)i.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:eo(e.type,n.memoizedProps);i.componentDidUpdate(s,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;null!==a&&zr(e,a,i);break;case 3:var o=e.updateQueue;if(null!==o){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}zr(e,o,n)}break;case 5:var l=e.stateNode;if(null===n&&4&e.flags){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var u=e.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&We(d)}}}break;default:throw Error(r(163))}Yo||512&e.flags&&sl(e)}catch(f){Sc(e,e.return,f)}}if(e===t){$o=null;break}if(null!==(n=e.sibling)){n.return=e.return,$o=n;break}$o=e.return}}function _l(t){for(;null!==$o;){var e=$o;if(e===t){$o=null;break}var n=e.sibling;if(null!==n){n.return=e.return,$o=n;break}$o=e.return}}function El(t){for(;null!==$o;){var e=$o;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{il(4,e)}catch(l){Sc(e,n,l)}break;case 1:var i=e.stateNode;if("function"===typeof i.componentDidMount){var s=e.return;try{i.componentDidMount()}catch(l){Sc(e,s,l)}}var r=e.return;try{sl(e)}catch(l){Sc(e,r,l)}break;case 5:var a=e.return;try{sl(e)}catch(l){Sc(e,a,l)}}}catch(l){Sc(e,e.return,l)}if(e===t){$o=null;break}var o=e.sibling;if(null!==o){o.return=e.return,$o=o;break}$o=e.return}}var Al,Sl=Math.ceil,kl=b.ReactCurrentDispatcher,Cl=b.ReactCurrentOwner,Tl=b.ReactCurrentBatchConfig,xl=0,Il=null,Rl=null,Ml=0,Pl=0,Nl=Ss(0),Dl=0,Ll=null,Ol=0,Fl=0,Ul=0,Bl=null,Vl=null,jl=0,Wl=1/0,zl=null,Hl=!1,ql=null,Gl=null,Kl=!1,Xl=null,Ql=0,Yl=0,Jl=null,$l=-1,Zl=0;function tc(){return 0!==(6&xl)?Jt():-1!==$l?$l:$l=Jt()}function ec(t){return 0===(1&t.mode)?1:0!==(2&xl)&&0!==Ml?Ml&-Ml:null!==gr.transition?(0===Zl&&(Zl=ge()),Zl):0!==(t=we)?t:t=void 0===(t=window.event)?16:Ye(t.type)}function nc(t,e,n,i){if(50<Yl)throw Yl=0,Jl=null,Error(r(185));ve(t,n,i),0!==(2&xl)&&t===Il||(t===Il&&(0===(2&xl)&&(Fl|=n),4===Dl&&oc(t,Ml)),ic(t,i),1===n&&0===xl&&0===(1&e.mode)&&(Wl=Jt()+500,Bs&&Ws()))}function ic(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,s=t.expirationTimes,r=t.pendingLanes;0<r;){var a=31-ae(r),o=1<<a,l=s[a];-1===l?0!==(o&n)&&0===(o&i)||(s[a]=fe(o,e)):l<=e&&(t.expiredLanes|=o),r&=~o}}(t,e);var i=de(t,t===Il?Ml:0);if(0===i)null!==n&&Xt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(null!=n&&Xt(n),1===e)0===t.tag?function(t){Bs=!0,js(t)}(lc.bind(null,t)):js(lc.bind(null,t)),as((function(){0===(6&xl)&&Ws()})),n=null;else{switch(be(i)){case 1:n=Zt;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=ie}n=Ic(n,sc.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function sc(t,e){if($l=-1,Zl=0,0!==(6&xl))throw Error(r(327));var n=t.callbackNode;if(Ec()&&t.callbackNode!==n)return null;var i=de(t,t===Il?Ml:0);if(0===i)return null;if(0!==(30&i)||0!==(i&t.expiredLanes)||e)e=mc(t,i);else{e=i;var s=xl;xl|=2;var a=pc();for(Il===t&&Ml===e||(zl=null,Wl=Jt()+500,dc(t,e));;)try{yc();break}catch(l){fc(t,l)}Cr(),kl.current=a,xl=s,null!==Rl?e=0:(Il=null,Ml=0,e=Dl)}if(0!==e){if(2===e&&(0!==(s=pe(t))&&(i=s,e=rc(t,s))),1===e)throw n=Ll,dc(t,0),oc(t,i),ic(t,Jt()),n;if(6===e)oc(t,i);else{if(s=t.current.alternate,0===(30&i)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var s=n[i],r=s.getSnapshot;s=s.value;try{if(!oi(r(),s))return!1}catch(o){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(s)&&(2===(e=mc(t,i))&&(0!==(a=pe(t))&&(i=a,e=rc(t,a))),1===e))throw n=Ll,dc(t,0),oc(t,i),ic(t,Jt()),n;switch(t.finishedWork=s,t.finishedLanes=i,e){case 0:case 1:throw Error(r(345));case 2:case 5:_c(t,Vl,zl);break;case 3:if(oc(t,i),(130023424&i)===i&&10<(e=jl+500-Jt())){if(0!==de(t,0))break;if(((s=t.suspendedLanes)&i)!==i){tc(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=is(_c.bind(null,t,Vl,zl),e);break}_c(t,Vl,zl);break;case 4:if(oc(t,i),(4194240&i)===i)break;for(e=t.eventTimes,s=-1;0<i;){var o=31-ae(i);a=1<<o,(o=e[o])>s&&(s=o),i&=~a}if(i=s,10<(i=(120>(i=Jt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Sl(i/1960))-i)){t.timeoutHandle=is(_c.bind(null,t,Vl,zl),i);break}_c(t,Vl,zl);break;default:throw Error(r(329))}}}return ic(t,Jt()),t.callbackNode===n?sc.bind(null,t):null}function rc(t,e){var n=Bl;return t.current.memoizedState.isDehydrated&&(dc(t,e).flags|=256),2!==(t=mc(t,e))&&(e=Vl,Vl=n,null!==e&&ac(e)),t}function ac(t){null===Vl?Vl=t:Vl.push.apply(Vl,t)}function oc(t,e){for(e&=~Ul,e&=~Fl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ae(e),i=1<<n;t[n]=-1,e&=~i}}function lc(t){if(0!==(6&xl))throw Error(r(327));Ec();var e=de(t,0);if(0===(1&e))return ic(t,Jt()),null;var n=mc(t,e);if(0!==t.tag&&2===n){var i=pe(t);0!==i&&(e=i,n=rc(t,i))}if(1===n)throw n=Ll,dc(t,0),oc(t,e),ic(t,Jt()),n;if(6===n)throw Error(r(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,_c(t,Vl,zl),ic(t,Jt()),null}function cc(t,e){var n=xl;xl|=1;try{return t(e)}finally{0===(xl=n)&&(Wl=Jt()+500,Bs&&Ws())}}function uc(t){null!==Xl&&0===Xl.tag&&0===(6&xl)&&Ec();var e=xl;xl|=1;var n=Tl.transition,i=we;try{if(Tl.transition=null,we=1,t)return t()}finally{we=i,Tl.transition=n,0===(6&(xl=e))&&Ws()}}function hc(){Pl=Nl.current,ks(Nl)}function dc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,ss(n)),null!==Rl)for(n=Rl.return;null!==n;){var i=n;switch(er(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Ns();break;case 3:Yr(),ks(Is),ks(xs),na();break;case 5:$r(i);break;case 4:Yr();break;case 13:case 19:ks(Zr);break;case 10:Tr(i.type._context);break;case 22:case 23:hc()}n=n.return}if(Il=t,Rl=t=Nc(t.current,null),Ml=Pl=e,Dl=0,Ll=null,Ul=Fl=Ol=0,Vl=Bl=null,null!==Mr){for(e=0;e<Mr.length;e++)if(null!==(i=(n=Mr[e]).interleaved)){n.interleaved=null;var s=i.next,r=n.pending;if(null!==r){var a=r.next;r.next=s,i.next=a}n.pending=i}Mr=null}return t}function fc(t,e){for(;;){var n=Rl;try{if(Cr(),ia.current=Ja,ca){for(var i=aa.memoizedState;null!==i;){var s=i.queue;null!==s&&(s.pending=null),i=i.next}ca=!1}if(ra=0,la=oa=aa=null,ua=!1,ha=0,Cl.current=null,null===n||null===n.return){Dl=1,Ll=e,Rl=null;break}t:{var a=t,o=n.return,l=n,c=e;if(e=Ml,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=mo(o);if(null!==p){p.flags&=-257,vo(p,o,l,0,e),1&p.mode&&go(a,u,e),c=u;var g=(e=p).updateQueue;if(null===g){var m=new Set;m.add(c),e.updateQueue=m}else g.add(c);break t}if(0===(1&e)){go(a,u,e),gc();break t}c=Error(r(426))}else if(sr&&1&l.mode){var v=mo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vo(v,o,l,0,e),pr(lo(c,l));break t}}a=c=lo(c,l),4!==Dl&&(Dl=2),null===Bl?Bl=[a]:Bl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e,jr(a,fo(0,c,e));break t;case 1:l=c;var y=a.type,w=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Gl||!Gl.has(w)))){a.flags|=65536,e&=-e,a.lanes|=e,jr(a,po(a,l,e));break t}}a=a.return}while(null!==a)}bc(n)}catch(b){e=b,Rl===n&&null!==n&&(Rl=n=n.return);continue}break}}function pc(){var t=kl.current;return kl.current=Ja,null===t?Ja:t}function gc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Il||0===(268435455&Ol)&&0===(268435455&Fl)||oc(Il,Ml)}function mc(t,e){var n=xl;xl|=2;var i=pc();for(Il===t&&Ml===e||(zl=null,dc(t,e));;)try{vc();break}catch(s){fc(t,s)}if(Cr(),xl=n,kl.current=i,null!==Rl)throw Error(r(261));return Il=null,Ml=0,Dl}function vc(){for(;null!==Rl;)wc(Rl)}function yc(){for(;null!==Rl&&!Qt();)wc(Rl)}function wc(t){var e=Al(t.alternate,t,Pl);t.memoizedProps=t.pendingProps,null===e?bc(t):Rl=e,Cl.current=null}function bc(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=Ko(n,e,Pl)))return void(Rl=n)}else{if(null!==(n=Xo(n,e)))return n.flags&=32767,void(Rl=n);if(null===t)return Dl=6,void(Rl=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Rl=e);Rl=e=t}while(null!==e);0===Dl&&(Dl=5)}function _c(t,e,n){var i=we,s=Tl.transition;try{Tl.transition=null,we=1,function(t,e,n,i){do{Ec()}while(null!==Xl);if(0!==(6&xl))throw Error(r(327));n=t.finishedWork;var s=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(r(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-ae(n),r=1<<s;e[s]=0,i[s]=-1,t[s]=-1,n&=~r}}(t,a),t===Il&&(Rl=Il=null,Ml=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Ic(ee,(function(){return Ec(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Tl.transition,Tl.transition=null;var o=we;we=1;var l=xl;xl|=4,Cl.current=null,function(t,e){if(ts=He,fi(t=di())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var i=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var s=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch(_){n=null;break t}var o=0,l=-1,c=-1,u=0,h=0,d=t,f=null;e:for(;;){for(var p;d!==n||0!==s&&3!==d.nodeType||(l=o+s),d!==a||0!==i&&3!==d.nodeType||(c=o+i),3===d.nodeType&&(o+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===t)break e;if(f===n&&++u===s&&(l=o),f===a&&++h===i&&(c=o),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(es={focusedElem:t,selectionRange:n},He=!1,$o=e;null!==$o;)if(t=(e=$o).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,$o=t;else for(;null!==$o;){e=$o;try{var g=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=e.stateNode,w=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:eo(e.type,m),v);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(r(163))}}catch(_){Sc(e,e.return,_)}if(null!==(t=e.sibling)){t.return=e.return,$o=t;break}$o=e.return}g=el,el=!1}(t,n),ml(n,t),pi(es),He=!!ts,es=ts=null,t.current=n,yl(n,t,s),Yt(),xl=l,we=o,Tl.transition=a}else t.current=n;if(Kl&&(Kl=!1,Xl=t,Ql=s),a=t.pendingLanes,0===a&&(Gl=null),function(t){if(re&&"function"===typeof re.onCommitFiberRoot)try{re.onCommitFiberRoot(se,t,void 0,128===(128&t.current.flags))}catch(e){}}(n.stateNode),ic(t,Jt()),null!==e)for(i=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],i(s.value,{componentStack:s.stack,digest:s.digest});if(Hl)throw Hl=!1,t=ql,ql=null,t;0!==(1&Ql)&&0!==t.tag&&Ec(),a=t.pendingLanes,0!==(1&a)?t===Jl?Yl++:(Yl=0,Jl=t):Yl=0,Ws()}(t,e,n,i)}finally{Tl.transition=s,we=i}return null}function Ec(){if(null!==Xl){var t=be(Ql),e=Tl.transition,n=we;try{if(Tl.transition=null,we=16>t?16:t,null===Xl)var i=!1;else{if(t=Xl,Xl=null,Ql=0,0!==(6&xl))throw Error(r(331));var s=xl;for(xl|=4,$o=t.current;null!==$o;){var a=$o,o=a.child;if(0!==(16&$o.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for($o=u;null!==$o;){var h=$o;switch(h.tag){case 0:case 11:case 15:nl(8,h,a)}var d=h.child;if(null!==d)d.return=h,$o=d;else for(;null!==$o;){var f=(h=$o).sibling,p=h.return;if(rl(h),h===u){$o=null;break}if(null!==f){f.return=p,$o=f;break}$o=p}}}var g=a.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}$o=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,$o=o;else t:for(;null!==$o;){if(0!==(2048&(a=$o).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,$o=y;break t}$o=a.return}}var w=t.current;for($o=w;null!==$o;){var b=(o=$o).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,$o=b;else t:for(o=w;null!==$o;){if(0!==(2048&(l=$o).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(E){Sc(l,l.return,E)}if(l===o){$o=null;break t}var _=l.sibling;if(null!==_){_.return=l.return,$o=_;break t}$o=l.return}}if(xl=s,Ws(),re&&"function"===typeof re.onPostCommitFiberRoot)try{re.onPostCommitFiberRoot(se,t)}catch(E){}i=!0}return i}finally{we=n,Tl.transition=e}}return!1}function Ac(t,e,n){t=Br(t,e=fo(0,e=lo(n,e),1),1),e=tc(),null!==t&&(ve(t,1,e),ic(t,e))}function Sc(t,e,n){if(3===t.tag)Ac(t,t,n);else for(;null!==e;){if(3===e.tag){Ac(e,t,n);break}if(1===e.tag){var i=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Gl||!Gl.has(i))){e=Br(e,t=po(e,t=lo(n,t),1),1),t=tc(),null!==e&&(ve(e,1,t),ic(e,t));break}}e=e.return}}function kc(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),e=tc(),t.pingedLanes|=t.suspendedLanes&n,Il===t&&(Ml&n)===n&&(4===Dl||3===Dl&&(130023424&Ml)===Ml&&500>Jt()-jl?dc(t,0):Ul|=n),ic(t,e)}function Cc(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ue,0===(130023424&(ue<<=1))&&(ue=4194304)));var n=tc();null!==(t=Dr(t,e))&&(ve(t,e,n),ic(t,n))}function Tc(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Cc(t,n)}function xc(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,s=t.memoizedState;null!==s&&(n=s.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(r(314))}null!==i&&i.delete(e),Cc(t,n)}function Ic(t,e){return Kt(t,e)}function Rc(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(t,e,n,i){return new Rc(t,e,n,i)}function Pc(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Nc(t,e){var n=t.alternate;return null===n?((n=Mc(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Dc(t,e,n,i,s,a){var o=2;if(i=t,"function"===typeof t)Pc(t)&&(o=1);else if("string"===typeof t)o=5;else t:switch(t){case A:return Lc(n.children,s,a,e);case S:o=8,s|=8;break;case k:return(t=Mc(12,n,e,2|s)).elementType=k,t.lanes=a,t;case I:return(t=Mc(13,n,e,s)).elementType=I,t.lanes=a,t;case R:return(t=Mc(19,n,e,s)).elementType=R,t.lanes=a,t;case N:return Oc(n,s,a,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case C:o=10;break t;case T:o=9;break t;case x:o=11;break t;case M:o=14;break t;case P:o=16,i=null;break t}throw Error(r(130,null==t?t:typeof t,""))}return(e=Mc(o,n,e,s)).elementType=t,e.type=i,e.lanes=a,e}function Lc(t,e,n,i){return(t=Mc(7,t,i,e)).lanes=n,t}function Oc(t,e,n,i){return(t=Mc(22,t,i,e)).elementType=N,t.lanes=n,t.stateNode={isHidden:!1},t}function Fc(t,e,n){return(t=Mc(6,t,null,e)).lanes=n,t}function Uc(t,e,n){return(e=Mc(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Bc(t,e,n,i,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=me(0),this.expirationTimes=me(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=me(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Vc(t,e,n,i,s,r,a,o,l){return t=new Bc(t,e,n,o,l),1===e?(e=1,!0===r&&(e|=8)):e=0,r=Mc(3,null,null,e),t.current=r,r.stateNode=t,r.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Or(r),t}function jc(t){if(!t)return Ts;t:{if(Wt(t=t._reactInternals)!==t||1!==t.tag)throw Error(r(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Ps(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(r(171))}if(1===t.tag){var n=t.type;if(Ps(n))return Ls(t,n,e)}return e}function Wc(t,e,n,i,s,r,a,o,l){return(t=Vc(n,i,!0,t,0,r,0,o,l)).context=jc(null),n=t.current,(r=Ur(i=tc(),s=ec(n))).callback=void 0!==e&&null!==e?e:null,Br(n,r,s),t.current.lanes=s,ve(t,s,i),ic(t,i),t}function zc(t,e,n,i){var s=e.current,r=tc(),a=ec(s);return n=jc(n),null===e.context?e.context=n:e.pendingContext=n,(e=Ur(r,a)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),null!==(t=Br(s,e,a))&&(nc(t,s,a,r),Vr(t,s,a)),a}function Hc(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function qc(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function Gc(t,e){qc(t,e),(t=t.alternate)&&qc(t,e)}Al=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||Is.current)wo=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return wo=!1,function(t,e,n){switch(e.tag){case 3:Io(e),fr();break;case 5:Jr(e);break;case 1:Ps(e.type)&&Os(e);break;case 4:Qr(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,s=e.memoizedProps.value;Cs(Er,i._currentValue),i._currentValue=s;break;case 13:if(null!==(i=e.memoizedState))return null!==i.dehydrated?(Cs(Zr,1&Zr.current),e.flags|=128,null):0!==(n&e.child.childLanes)?Fo(t,e,n):(Cs(Zr,1&Zr.current),null!==(t=Ho(t,e,n))?t.sibling:null);Cs(Zr,1&Zr.current);break;case 19:if(i=0!==(n&e.childLanes),0!==(128&t.flags)){if(i)return Wo(t,e,n);e.flags|=128}if(null!==(s=e.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Cs(Zr,Zr.current),i)break;return null;case 22:case 23:return e.lanes=0,So(t,e,n)}return Ho(t,e,n)}(t,e,n);wo=0!==(131072&t.flags)}else wo=!1,sr&&0!==(1048576&e.flags)&&Zs(e,Gs,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;zo(t,e),t=e.pendingProps;var s=Ms(e,xs.current);Ir(e,n),s=ga(null,e,i,t,s,n);var a=ma();return e.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ps(i)?(a=!0,Os(e)):a=!1,e.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Or(e),s.updater=io,e.stateNode=s,s._reactInternals=e,oo(e,i,t,n),e=xo(null,e,i,!0,a,n)):(e.tag=0,sr&&a&&tr(e),bo(null,e,s,n),e=e.child),e;case 16:i=e.elementType;t:{switch(zo(t,e),t=e.pendingProps,i=(s=i._init)(i._payload),e.type=i,s=e.tag=function(t){if("function"===typeof t)return Pc(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===x)return 11;if(t===M)return 14}return 2}(i),t=eo(i,t),s){case 0:e=Co(null,e,i,t,n);break t;case 1:e=To(null,e,i,t,n);break t;case 11:e=_o(null,e,i,t,n);break t;case 14:e=Eo(null,e,i,eo(i.type,t),n);break t}throw Error(r(306,i,""))}return e;case 0:return i=e.type,s=e.pendingProps,Co(t,e,i,s=e.elementType===i?s:eo(i,s),n);case 1:return i=e.type,s=e.pendingProps,To(t,e,i,s=e.elementType===i?s:eo(i,s),n);case 3:t:{if(Io(e),null===t)throw Error(r(387));i=e.pendingProps,s=(a=e.memoizedState).element,Fr(t,e),Wr(e,i,null,n);var o=e.memoizedState;if(i=o.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,256&e.flags){e=Ro(t,e,i,n,s=lo(Error(r(423)),e));break t}if(i!==s){e=Ro(t,e,i,n,s=lo(Error(r(424)),e));break t}for(ir=cs(e.stateNode.containerInfo.firstChild),nr=e,sr=!0,rr=null,n=_r(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fr(),i===s){e=Ho(t,e,n);break t}bo(t,e,i,n)}e=e.child}return e;case 5:return Jr(e),null===t&&cr(e),i=e.type,s=e.pendingProps,a=null!==t?t.memoizedProps:null,o=s.children,ns(i,s)?o=null:null!==a&&ns(i,a)&&(e.flags|=32),ko(t,e),bo(t,e,o,n),e.child;case 6:return null===t&&cr(e),null;case 13:return Fo(t,e,n);case 4:return Qr(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=br(e,null,i,n):bo(t,e,i,n),e.child;case 11:return i=e.type,s=e.pendingProps,_o(t,e,i,s=e.elementType===i?s:eo(i,s),n);case 7:return bo(t,e,e.pendingProps,n),e.child;case 8:case 12:return bo(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(i=e.type._context,s=e.pendingProps,a=e.memoizedProps,o=s.value,Cs(Er,i._currentValue),i._currentValue=o,null!==a)if(oi(a.value,o)){if(a.children===s.children&&!Is.current){e=Ho(t,e,n);break t}}else for(null!==(a=e.child)&&(a.return=e);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===a.tag){(c=Ur(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),xr(a.return,n,e),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===e.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(r(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),xr(o,n,e),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}bo(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,i=e.pendingProps.children,Ir(e,n),i=i(s=Rr(s)),e.flags|=1,bo(t,e,i,n),e.child;case 14:return s=eo(i=e.type,e.pendingProps),Eo(t,e,i,s=eo(i.type,s),n);case 15:return Ao(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:eo(i,s),zo(t,e),e.tag=1,Ps(i)?(t=!0,Os(e)):t=!1,Ir(e,n),ro(e,i,s),oo(e,i,s,n),xo(null,e,i,!0,t,n);case 19:return Wo(t,e,n);case 22:return So(t,e,n)}throw Error(r(156,e.tag))};var Kc="function"===typeof reportError?reportError:function(t){console.error(t)};function Xc(t){this._internalRoot=t}function Qc(t){this._internalRoot=t}function Yc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Jc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function $c(){}function Zc(t,e,n,i,s){var r=n._reactRootContainer;if(r){var a=r;if("function"===typeof s){var o=s;s=function(){var t=Hc(a);o.call(t)}}zc(e,a,t,s)}else a=function(t,e,n,i,s){if(s){if("function"===typeof i){var r=i;i=function(){var t=Hc(a);r.call(t)}}var a=Wc(e,i,t,0,null,!1,0,"",$c);return t._reactRootContainer=a,t[ps]=a.current,Wi(8===t.nodeType?t.parentNode:t),uc(),a}for(;s=t.lastChild;)t.removeChild(s);if("function"===typeof i){var o=i;i=function(){var t=Hc(l);o.call(t)}}var l=Vc(t,0,!1,null,0,!1,0,"",$c);return t._reactRootContainer=l,t[ps]=l.current,Wi(8===t.nodeType?t.parentNode:t),uc((function(){zc(e,l,n,i)})),l}(n,e,t,s,i);return Hc(a)}Qc.prototype.render=Xc.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(r(409));zc(t,e,null,null)},Qc.prototype.unmount=Xc.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;uc((function(){zc(null,t,null,null)})),e[ps]=null}},Qc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Se();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ne.length&&0!==e&&e<Ne[n].priority;n++);Ne.splice(n,0,t),0===n&&Fe(t)}},_e=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=he(e.pendingLanes);0!==n&&(ye(e,1|n),ic(e,Jt()),0===(6&xl)&&(Wl=Jt()+500,Ws()))}break;case 13:uc((function(){var e=Dr(t,1);if(null!==e){var n=tc();nc(e,t,1,n)}})),Gc(t,1)}},Ee=function(t){if(13===t.tag){var e=Dr(t,134217728);if(null!==e)nc(e,t,134217728,tc());Gc(t,134217728)}},Ae=function(t){if(13===t.tag){var e=ec(t),n=Dr(t,e);if(null!==n)nc(n,t,e,tc());Gc(t,e)}},Se=function(){return we},ke=function(t,e){var n=we;try{return we=t,e()}finally{we=n}},Et=function(t,e,n){switch(e){case"input":if($(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var s=_s(i);if(!s)throw Error(r(90));K(i),$(i,s)}}}break;case"textarea":rt(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},xt=cc,It=uc;var tu={usingClientEntryPoint:!1,Events:[ws,bs,_s,Ct,Tt,cc]},eu={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=qt(t))?null:t.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{se=iu.inject(nu),re=iu}catch(ut){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(e))throw Error(r(200));return function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}(t,e,null,n)},e.createRoot=function(t,e){if(!Yc(t))throw Error(r(299));var n=!1,i="",s=Kc;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(i=e.identifierPrefix),void 0!==e.onRecoverableError&&(s=e.onRecoverableError)),e=Vc(t,1,!1,null,0,n,0,i,s),t[ps]=e.current,Wi(8===t.nodeType?t.parentNode:t),new Xc(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(r(188));throw t=Object.keys(t).join(","),Error(r(268,t))}return t=null===(t=qt(e))?null:t.stateNode},e.flushSync=function(t){return uc(t)},e.hydrate=function(t,e,n){if(!Jc(e))throw Error(r(200));return Zc(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Yc(t))throw Error(r(405));var i=null!=n&&n.hydratedSources||null,s=!1,a="",o=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),e=Wc(e,null,t,1,null!=n?n:null,s,0,a,o),t[ps]=e.current,Wi(t),i)for(t=0;t<i.length;t++)s=(s=(n=i[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Qc(e)},e.render=function(t,e,n){if(!Jc(e))throw Error(r(200));return Zc(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Jc(t))throw Error(r(40));return!!t._reactRootContainer&&(uc((function(){Zc(null,null,t,!1,(function(){t._reactRootContainer=null,t[ps]=null}))})),!0)},e.unstable_batchedUpdates=cc,e.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Jc(n))throw Error(r(200));if(null==t||void 0===t._reactInternals)throw Error(r(38));return Zc(t,e,n,!1,i)},e.version="18.3.1-next-f1338f8080-20240426"},853:(t,e,n)=>{"use strict";t.exports=n(234)},950:(t,e,n)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(730)}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};n.r(t),n.d(t,{hasBrowserEnv:()=>ft,hasStandardBrowserEnv:()=>gt,hasStandardBrowserWebWorkerEnv:()=>mt,navigator:()=>pt,origin:()=>vt});var e=n(43),i=n(391);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function r(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}function a(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e){return function(){return t.apply(e,arguments)}}const{toString:u}=Object.prototype,{getPrototypeOf:h}=Object,{iterator:d,toStringTag:f}=Symbol,p=(g=Object.create(null),t=>{const e=u.call(t);return g[e]||(g[e]=e.slice(8,-1).toLowerCase())});var g;const m=t=>(t=t.toLowerCase(),e=>p(e)===t),v=t=>e=>typeof e===t,{isArray:y}=Array,w=v("undefined");const b=m("ArrayBuffer");const _=v("string"),E=v("function"),A=v("number"),S=t=>null!==t&&"object"===typeof t,k=t=>{if("object"!==p(t))return!1;const e=h(t);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(f in t)&&!(d in t)},C=m("Date"),T=m("File"),x=m("Blob"),I=m("FileList"),R=m("URLSearchParams"),[M,P,N,D]=["ReadableStream","Request","Response","Headers"].map(m);function L(t,e){let n,i,{allOwnKeys:s=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),y(t))for(n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else{const i=s?Object.getOwnPropertyNames(t):Object.keys(t),r=i.length;let a;for(n=0;n<r;n++)a=i[n],e.call(null,t[a],a,t)}}function O(t,e){e=e.toLowerCase();const n=Object.keys(t);let i,s=n.length;for(;s-- >0;)if(i=n[s],e===i.toLowerCase())return i;return null}const F="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,U=t=>!w(t)&&t!==F;const B=(V="undefined"!==typeof Uint8Array&&h(Uint8Array),t=>V&&t instanceof V);var V;const j=m("HTMLFormElement"),W=(t=>{let{hasOwnProperty:e}=t;return(t,n)=>e.call(t,n)})(Object.prototype),z=m("RegExp"),H=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),i={};L(n,((n,s)=>{let r;!1!==(r=e(n,s,t))&&(i[s]=r||n)})),Object.defineProperties(t,i)};const q=m("AsyncFunction"),G=((t,e)=>{return t?setImmediate:e?(n="axios@".concat(Math.random()),i=[],F.addEventListener("message",(t=>{let{source:e,data:s}=t;e===F&&s===n&&i.length&&i.shift()()}),!1),t=>{i.push(t),F.postMessage(n,"*")}):t=>setTimeout(t);var n,i})("function"===typeof setImmediate,E(F.postMessage)),K="undefined"!==typeof queueMicrotask?queueMicrotask.bind(F):"undefined"!==typeof process&&process.nextTick||G,X={isArray:y,isArrayBuffer:b,isBuffer:function(t){return null!==t&&!w(t)&&null!==t.constructor&&!w(t.constructor)&&E(t.constructor.isBuffer)&&t.constructor.isBuffer(t)},isFormData:t=>{let e;return t&&("function"===typeof FormData&&t instanceof FormData||E(t.append)&&("formdata"===(e=p(t))||"object"===e&&E(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&b(t.buffer),e},isString:_,isNumber:A,isBoolean:t=>!0===t||!1===t,isObject:S,isPlainObject:k,isReadableStream:M,isRequest:P,isResponse:N,isHeaders:D,isUndefined:w,isDate:C,isFile:T,isBlob:x,isRegExp:z,isFunction:E,isStream:t=>S(t)&&E(t.pipe),isURLSearchParams:R,isTypedArray:B,isFileList:I,forEach:L,merge:function t(){const{caseless:e}=U(this)&&this||{},n={},i=(i,s)=>{const r=e&&O(n,s)||s;k(n[r])&&k(i)?n[r]=t(n[r],i):k(i)?n[r]=t({},i):y(i)?n[r]=i.slice():n[r]=i};for(let s=0,r=arguments.length;s<r;s++)arguments[s]&&L(arguments[s],i);return n},extend:function(t,e,n){let{allOwnKeys:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return L(e,((e,i)=>{n&&E(e)?t[i]=c(e,n):t[i]=e}),{allOwnKeys:i}),t},trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,n,i)=>{t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},toFlatObject:(t,e,n,i)=>{let s,r,a;const o={};if(e=e||{},null==t)return e;do{for(s=Object.getOwnPropertyNames(t),r=s.length;r-- >0;)a=s[r],i&&!i(a,t,e)||o[a]||(e[a]=t[a],o[a]=!0);t=!1!==n&&h(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kindOf:p,kindOfTest:m,endsWith:(t,e,n)=>{t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;const i=t.indexOf(e,n);return-1!==i&&i===n},toArray:t=>{if(!t)return null;if(y(t))return t;let e=t.length;if(!A(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},forEachEntry:(t,e)=>{const n=(t&&t[d]).call(t);let i;for(;(i=n.next())&&!i.done;){const n=i.value;e.call(t,n[0],n[1])}},matchAll:(t,e)=>{let n;const i=[];for(;null!==(n=t.exec(e));)i.push(n);return i},isHTMLForm:j,hasOwnProperty:W,hasOwnProp:W,reduceDescriptors:H,freezeMethods:t=>{H(t,((e,n)=>{if(E(t)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=t[n];E(i)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(t,e)=>{const n={},i=t=>{t.forEach((t=>{n[t]=!0}))};return y(t)?i(t):i(String(t).split(e)),n},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(t,e,n){return e.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(t,e)=>null!=t&&Number.isFinite(t=+t)?t:e,findKey:O,global:F,isContextDefined:U,isSpecCompliantForm:function(t){return!!(t&&E(t.append)&&"FormData"===t[f]&&t[d])},toJSONObject:t=>{const e=new Array(10),n=(t,i)=>{if(S(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[i]=t;const s=y(t)?[]:{};return L(t,((t,e)=>{const r=n(t,i+1);!w(r)&&(s[e]=r)})),e[i]=void 0,s}}return t};return n(t,0)},isAsyncFn:q,isThenable:t=>t&&(S(t)||E(t))&&E(t.then)&&E(t.catch),setImmediate:G,asap:K,isIterable:t=>null!=t&&E(t[d])};function Q(t,e,n,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}X.inherits(Q,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:X.toJSONObject(this.config),code:this.code,status:this.status}}});const Y=Q.prototype,J={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((t=>{J[t]={value:t}})),Object.defineProperties(Q,J),Object.defineProperty(Y,"isAxiosError",{value:!0}),Q.from=(t,e,n,i,s,r)=>{const a=Object.create(Y);return X.toFlatObject(t,a,(function(t){return t!==Error.prototype}),(t=>"isAxiosError"!==t)),Q.call(a,t.message,e,n,i,s),a.cause=t,a.name=t.name,r&&Object.assign(a,r),a};const $=Q;function Z(t){return X.isPlainObject(t)||X.isArray(t)}function tt(t){return X.endsWith(t,"[]")?t.slice(0,-2):t}function et(t,e,n){return t?t.concat(e).map((function(t,e){return t=tt(t),!n&&e?"["+t+"]":t})).join(n?".":""):e}const nt=X.toFlatObject(X,{},null,(function(t){return/^is[A-Z]/.test(t)}));const it=function(t,e,n){if(!X.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const i=(n=X.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(t,e){return!X.isUndefined(e[t])}))).metaTokens,s=n.visitor||c,r=n.dots,a=n.indexes,o=(n.Blob||"undefined"!==typeof Blob&&Blob)&&X.isSpecCompliantForm(e);if(!X.isFunction(s))throw new TypeError("visitor must be a function");function l(t){if(null===t)return"";if(X.isDate(t))return t.toISOString();if(X.isBoolean(t))return t.toString();if(!o&&X.isBlob(t))throw new $("Blob is not supported. Use a Buffer instead.");return X.isArrayBuffer(t)||X.isTypedArray(t)?o&&"function"===typeof Blob?new Blob([t]):Buffer.from(t):t}function c(t,n,s){let o=t;if(t&&!s&&"object"===typeof t)if(X.endsWith(n,"{}"))n=i?n:n.slice(0,-2),t=JSON.stringify(t);else if(X.isArray(t)&&function(t){return X.isArray(t)&&!t.some(Z)}(t)||(X.isFileList(t)||X.endsWith(n,"[]"))&&(o=X.toArray(t)))return n=tt(n),o.forEach((function(t,i){!X.isUndefined(t)&&null!==t&&e.append(!0===a?et([n],i,r):null===a?n:n+"[]",l(t))})),!1;return!!Z(t)||(e.append(et(s,n,r),l(t)),!1)}const u=[],h=Object.assign(nt,{defaultVisitor:c,convertValue:l,isVisitable:Z});if(!X.isObject(t))throw new TypeError("data must be an object");return function t(n,i){if(!X.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+i.join("."));u.push(n),X.forEach(n,(function(n,r){!0===(!(X.isUndefined(n)||null===n)&&s.call(e,n,X.isString(r)?r.trim():r,i,h))&&t(n,i?i.concat(r):[r])})),u.pop()}}(t),e};function st(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,(function(t){return e[t]}))}function rt(t,e){this._pairs=[],t&&it(t,this,e)}const at=rt.prototype;at.append=function(t,e){this._pairs.push([t,e])},at.toString=function(t){const e=t?function(e){return t.call(this,e,st)}:st;return this._pairs.map((function(t){return e(t[0])+"="+e(t[1])}),"").join("&")};const ot=rt;function lt(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ct(t,e,n){if(!e)return t;const i=n&&n.encode||lt;X.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let r;if(r=s?s(e,n):X.isURLSearchParams(e)?e.toString():new ot(e,n).toString(i),r){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+r}return t}const ut=class{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){X.forEach(this.handlers,(function(e){null!==e&&t(e)}))}},ht={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},dt={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:ot,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},ft="undefined"!==typeof window&&"undefined"!==typeof document,pt="object"===typeof navigator&&navigator||void 0,gt=ft&&(!pt||["ReactNative","NativeScript","NS"].indexOf(pt.product)<0),mt="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,vt=ft&&window.location.href||"http://localhost",yt=l(l({},t),dt);const wt=function(t){function e(t,n,i,s){let r=t[s++];if("__proto__"===r)return!0;const a=Number.isFinite(+r),o=s>=t.length;if(r=!r&&X.isArray(i)?i.length:r,o)return X.hasOwnProp(i,r)?i[r]=[i[r],n]:i[r]=n,!a;i[r]&&X.isObject(i[r])||(i[r]=[]);return e(t,n,i[r],s)&&X.isArray(i[r])&&(i[r]=function(t){const e={},n=Object.keys(t);let i;const s=n.length;let r;for(i=0;i<s;i++)r=n[i],e[r]=t[r];return e}(i[r])),!a}if(X.isFormData(t)&&X.isFunction(t.entries)){const n={};return X.forEachEntry(t,((t,i)=>{e(function(t){return X.matchAll(/\w+|\[(\w*)]/g,t).map((t=>"[]"===t[0]?"":t[1]||t[0]))}(t),i,n,0)})),n}return null};const bt={transitional:ht,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const n=e.getContentType()||"",i=n.indexOf("application/json")>-1,s=X.isObject(t);s&&X.isHTMLForm(t)&&(t=new FormData(t));if(X.isFormData(t))return i?JSON.stringify(wt(t)):t;if(X.isArrayBuffer(t)||X.isBuffer(t)||X.isStream(t)||X.isFile(t)||X.isBlob(t)||X.isReadableStream(t))return t;if(X.isArrayBufferView(t))return t.buffer;if(X.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let r;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return it(t,new yt.classes.URLSearchParams,Object.assign({visitor:function(t,e,n,i){return yt.isNode&&X.isBuffer(t)?(this.append(e,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}(t,this.formSerializer).toString();if((r=X.isFileList(t))||n.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return it(r?{"files[]":t}:t,e&&new e,this.formSerializer)}}return s||i?(e.setContentType("application/json",!1),function(t,e,n){if(X.isString(t))try{return(e||JSON.parse)(t),X.trim(t)}catch(i){if("SyntaxError"!==i.name)throw i}return(n||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||bt.transitional,n=e&&e.forcedJSONParsing,i="json"===this.responseType;if(X.isResponse(t)||X.isReadableStream(t))return t;if(t&&X.isString(t)&&(n&&!this.responseType||i)){const n=!(e&&e.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(s){if(n){if("SyntaxError"===s.name)throw $.from(s,$.ERR_BAD_RESPONSE,this,null,this.response);throw s}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:yt.classes.FormData,Blob:yt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};X.forEach(["delete","get","head","post","put","patch"],(t=>{bt.headers[t]={}}));const _t=bt,Et=X.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),At=Symbol("internals");function St(t){return t&&String(t).trim().toLowerCase()}function kt(t){return!1===t||null==t?t:X.isArray(t)?t.map(kt):String(t)}function Ct(t,e,n,i,s){return X.isFunction(i)?i.call(this,e,n):(s&&(e=n),X.isString(e)?X.isString(i)?-1!==e.indexOf(i):X.isRegExp(i)?i.test(e):void 0:void 0)}class Tt{constructor(t){t&&this.set(t)}set(t,e,n){const i=this;function s(t,e,n){const s=St(e);if(!s)throw new Error("header name must be a non-empty string");const r=X.findKey(i,s);(!r||void 0===i[r]||!0===n||void 0===n&&!1!==i[r])&&(i[r||e]=kt(t))}const r=(t,e)=>X.forEach(t,((t,n)=>s(t,n,e)));if(X.isPlainObject(t)||t instanceof this.constructor)r(t,e);else if(X.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim()))r((t=>{const e={};let n,i,s;return t&&t.split("\n").forEach((function(t){s=t.indexOf(":"),n=t.substring(0,s).trim().toLowerCase(),i=t.substring(s+1).trim(),!n||e[n]&&Et[n]||("set-cookie"===n?e[n]?e[n].push(i):e[n]=[i]:e[n]=e[n]?e[n]+", "+i:i)})),e})(t),e);else if(X.isObject(t)&&X.isIterable(t)){let n,i,s={};for(const e of t){if(!X.isArray(e))throw TypeError("Object iterator must return a key-value pair");s[i=e[0]]=(n=s[i])?X.isArray(n)?[...n,e[1]]:[n,e[1]]:e[1]}r(s,e)}else null!=t&&s(e,t,n);return this}get(t,e){if(t=St(t)){const n=X.findKey(this,t);if(n){const t=this[n];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(t);)e[i[1]]=i[2];return e}(t);if(X.isFunction(e))return e.call(this,t,n);if(X.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=St(t)){const n=X.findKey(this,t);return!(!n||void 0===this[n]||e&&!Ct(0,this[n],n,e))}return!1}delete(t,e){const n=this;let i=!1;function s(t){if(t=St(t)){const s=X.findKey(n,t);!s||e&&!Ct(0,n[s],s,e)||(delete n[s],i=!0)}}return X.isArray(t)?t.forEach(s):s(t),i}clear(t){const e=Object.keys(this);let n=e.length,i=!1;for(;n--;){const s=e[n];t&&!Ct(0,this[s],s,t,!0)||(delete this[s],i=!0)}return i}normalize(t){const e=this,n={};return X.forEach(this,((i,s)=>{const r=X.findKey(n,s);if(r)return e[r]=kt(i),void delete e[s];const a=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((t,e,n)=>e.toUpperCase()+n))}(s):String(s).trim();a!==s&&delete e[s],e[a]=kt(i),n[a]=!0})),this}concat(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.constructor.concat(this,...e)}toJSON(t){const e=Object.create(null);return X.forEach(this,((n,i)=>{null!=n&&!1!==n&&(e[i]=t&&X.isArray(n)?n.join(", "):n)})),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((t=>{let[e,n]=t;return e+": "+n})).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t){const e=new this(t);for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return i.forEach((t=>e.set(t))),e}static accessor(t){const e=(this[At]=this[At]={accessors:{}}).accessors,n=this.prototype;function i(t){const i=St(t);e[i]||(!function(t,e){const n=X.toCamelCase(" "+e);["get","set","has"].forEach((i=>{Object.defineProperty(t,i+n,{value:function(t,n,s){return this[i].call(this,e,t,n,s)},configurable:!0})}))}(n,t),e[i]=!0)}return X.isArray(t)?t.forEach(i):i(t),this}}Tt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),X.reduceDescriptors(Tt.prototype,((t,e)=>{let{value:n}=t,i=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(t){this[i]=t}}})),X.freezeMethods(Tt);const xt=Tt;function It(t,e){const n=this||_t,i=e||n,s=xt.from(i.headers);let r=i.data;return X.forEach(t,(function(t){r=t.call(n,r,s.normalize(),e?e.status:void 0)})),s.normalize(),r}function Rt(t){return!(!t||!t.__CANCEL__)}function Mt(t,e,n){$.call(this,null==t?"canceled":t,$.ERR_CANCELED,e,n),this.name="CanceledError"}X.inherits(Mt,$,{__CANCEL__:!0});const Pt=Mt;function Nt(t,e,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(new $("Request failed with status code "+n.status,[$.ERR_BAD_REQUEST,$.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}const Dt=function(t,e){t=t||10;const n=new Array(t),i=new Array(t);let s,r=0,a=0;return e=void 0!==e?e:1e3,function(o){const l=Date.now(),c=i[a];s||(s=l),n[r]=o,i[r]=l;let u=a,h=0;for(;u!==r;)h+=n[u++],u%=t;if(r=(r+1)%t,r===a&&(a=(a+1)%t),l-s<e)return;const d=c&&l-c;return d?Math.round(1e3*h/d):void 0}};const Lt=function(t,e){let n,i,s=0,r=1e3/e;const a=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();s=r,n=null,i&&(clearTimeout(i),i=null),t.apply(null,e)};return[function(){const t=Date.now(),e=t-s;for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];e>=r?a(l,t):(n=l,i||(i=setTimeout((()=>{i=null,a(n)}),r-e)))},()=>n&&a(n)]},Ot=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,i=0;const s=Dt(50,250);return Lt((n=>{const r=n.loaded,a=n.lengthComputable?n.total:void 0,o=r-i,l=s(o);i=r;t({loaded:r,total:a,progress:a?r/a:void 0,bytes:o,rate:l||void 0,estimated:l&&a&&r<=a?(a-r)/l:void 0,event:n,lengthComputable:null!=a,[e?"download":"upload"]:!0})}),n)},Ft=(t,e)=>{const n=null!=t;return[i=>e[0]({lengthComputable:n,total:t,loaded:i}),e[1]]},Ut=t=>function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return X.asap((()=>t(...n)))},Bt=yt.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,yt.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(yt.origin),yt.navigator&&/(msie|trident)/i.test(yt.navigator.userAgent)):()=>!0,Vt=yt.hasStandardBrowserEnv?{write(t,e,n,i,s,r){const a=[t+"="+encodeURIComponent(e)];X.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),X.isString(i)&&a.push("path="+i),X.isString(s)&&a.push("domain="+s),!0===r&&a.push("secure"),document.cookie=a.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function jt(t,e,n){let i=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e);return t&&(i||0==n)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const Wt=t=>t instanceof xt?l({},t):t;function zt(t,e){e=e||{};const n={};function i(t,e,n,i){return X.isPlainObject(t)&&X.isPlainObject(e)?X.merge.call({caseless:i},t,e):X.isPlainObject(e)?X.merge({},e):X.isArray(e)?e.slice():e}function s(t,e,n,s){return X.isUndefined(e)?X.isUndefined(t)?void 0:i(void 0,t,0,s):i(t,e,0,s)}function r(t,e){if(!X.isUndefined(e))return i(void 0,e)}function a(t,e){return X.isUndefined(e)?X.isUndefined(t)?void 0:i(void 0,t):i(void 0,e)}function o(n,s,r){return r in e?i(n,s):r in t?i(void 0,n):void 0}const l={url:r,method:r,data:r,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(t,e,n)=>s(Wt(t),Wt(e),0,!0)};return X.forEach(Object.keys(Object.assign({},t,e)),(function(i){const r=l[i]||s,a=r(t[i],e[i],i);X.isUndefined(a)&&r!==o||(n[i]=a)})),n}const Ht=t=>{const e=zt({},t);let n,{data:i,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:a,headers:o,auth:l}=e;if(e.headers=o=xt.from(o),e.url=ct(jt(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),X.isFormData(i))if(yt.hasStandardBrowserEnv||yt.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(!1!==(n=o.getContentType())){const[t,...e]=n?n.split(";").map((t=>t.trim())).filter(Boolean):[];o.setContentType([t||"multipart/form-data",...e].join("; "))}if(yt.hasStandardBrowserEnv&&(s&&X.isFunction(s)&&(s=s(e)),s||!1!==s&&Bt(e.url))){const t=r&&a&&Vt.read(a);t&&o.set(r,t)}return e},qt="undefined"!==typeof XMLHttpRequest&&function(t){return new Promise((function(e,n){const i=Ht(t);let s=i.data;const r=xt.from(i.headers).normalize();let a,o,l,c,u,{responseType:h,onUploadProgress:d,onDownloadProgress:f}=i;function p(){c&&c(),u&&u(),i.cancelToken&&i.cancelToken.unsubscribe(a),i.signal&&i.signal.removeEventListener("abort",a)}let g=new XMLHttpRequest;function m(){if(!g)return;const i=xt.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders());Nt((function(t){e(t),p()}),(function(t){n(t),p()}),{data:h&&"text"!==h&&"json"!==h?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:i,config:t,request:g}),g=null}g.open(i.method.toUpperCase(),i.url,!0),g.timeout=i.timeout,"onloadend"in g?g.onloadend=m:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(m)},g.onabort=function(){g&&(n(new $("Request aborted",$.ECONNABORTED,t,g)),g=null)},g.onerror=function(){n(new $("Network Error",$.ERR_NETWORK,t,g)),g=null},g.ontimeout=function(){let e=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const s=i.transitional||ht;i.timeoutErrorMessage&&(e=i.timeoutErrorMessage),n(new $(e,s.clarifyTimeoutError?$.ETIMEDOUT:$.ECONNABORTED,t,g)),g=null},void 0===s&&r.setContentType(null),"setRequestHeader"in g&&X.forEach(r.toJSON(),(function(t,e){g.setRequestHeader(e,t)})),X.isUndefined(i.withCredentials)||(g.withCredentials=!!i.withCredentials),h&&"json"!==h&&(g.responseType=i.responseType),f&&([l,u]=Ot(f,!0),g.addEventListener("progress",l)),d&&g.upload&&([o,c]=Ot(d),g.upload.addEventListener("progress",o),g.upload.addEventListener("loadend",c)),(i.cancelToken||i.signal)&&(a=e=>{g&&(n(!e||e.type?new Pt(null,t,g):e),g.abort(),g=null)},i.cancelToken&&i.cancelToken.subscribe(a),i.signal&&(i.signal.aborted?a():i.signal.addEventListener("abort",a)));const v=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(i.url);v&&-1===yt.protocols.indexOf(v)?n(new $("Unsupported protocol "+v+":",$.ERR_BAD_REQUEST,t)):g.send(s||null)}))},Gt=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let n,i=new AbortController;const s=function(t){if(!n){n=!0,a();const e=t instanceof Error?t:this.reason;i.abort(e instanceof $?e:new Pt(e instanceof Error?e.message:e))}};let r=e&&setTimeout((()=>{r=null,s(new $("timeout ".concat(e," of ms exceeded"),$.ETIMEDOUT))}),e);const a=()=>{t&&(r&&clearTimeout(r),r=null,t.forEach((t=>{t.unsubscribe?t.unsubscribe(s):t.removeEventListener("abort",s)})),t=null)};t.forEach((t=>t.addEventListener("abort",s)));const{signal:o}=i;return o.unsubscribe=()=>X.asap(a),o}};function Kt(t,e){this.v=t,this.k=e}function Xt(t){return function(){return new Qt(t.apply(this,arguments))}}function Qt(t){var e,n;function i(e,n){try{var r=t[e](n),a=r.value,o=a instanceof Kt;Promise.resolve(o?a.v:a).then((function(n){if(o){var l="return"===e?"return":"next";if(!a.k||n.done)return i(l,n);n=t[l](n).value}s(r.done?"return":"normal",n)}),(function(t){i("throw",t)}))}catch(t){s("throw",t)}}function s(t,s){switch(t){case"return":e.resolve({value:s,done:!0});break;case"throw":e.reject(s);break;default:e.resolve({value:s,done:!1})}(e=e.next)?i(e.key,e.arg):n=null}this._invoke=function(t,s){return new Promise((function(r,a){var o={key:t,arg:s,resolve:r,reject:a,next:null};n?n=n.next=o:(e=n=o,i(t,s))}))},"function"!=typeof t.return&&(this.return=void 0)}function Yt(t){return new Kt(t,0)}function Jt(t){var e={},n=!1;function i(e,i){return n=!0,i=new Promise((function(n){n(t[e](i))})),{done:!1,value:new Kt(i,1)}}return e["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},e.next=function(t){return n?(n=!1,t):i("next",t)},"function"==typeof t.throw&&(e.throw=function(t){if(n)throw n=!1,t;return i("throw",t)}),"function"==typeof t.return&&(e.return=function(t){return n?(n=!1,t):i("return",t)}),e}function $t(t){var e,n,i,s=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);s--;){if(n&&null!=(e=t[n]))return e.call(t);if(i&&null!=(e=t[i]))return new Zt(e.call(t));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function Zt(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return Zt=function(t){this.s=t,this.n=t.next},Zt.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var n=this.s.return;return void 0===n?Promise.resolve({value:t,done:!0}):e(n.apply(this.s,arguments))},throw:function(t){var n=this.s.return;return void 0===n?Promise.reject(t):e(n.apply(this.s,arguments))}},new Zt(t)}Qt.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Qt.prototype.next=function(t){return this._invoke("next",t)},Qt.prototype.throw=function(t){return this._invoke("throw",t)},Qt.prototype.return=function(t){return this._invoke("return",t)};const te=function*(t,e){let n=t.byteLength;if(!e||n<e)return void(yield t);let i,s=0;for(;s<n;)i=s+e,yield t.slice(s,i),s=i},ee=function(){var t=Xt((function*(t,e){var n,i=!1,s=!1;try{for(var r,a=$t(ne(t));i=!(r=yield Yt(a.next())).done;i=!1){const t=r.value;yield*Jt($t(te(t,e)))}}catch(o){s=!0,n=o}finally{try{i&&null!=a.return&&(yield Yt(a.return()))}finally{if(s)throw n}}}));return function(e,n){return t.apply(this,arguments)}}(),ne=function(){var t=Xt((function*(t){if(t[Symbol.asyncIterator])return void(yield*Jt($t(t)));const e=t.getReader();try{for(;;){const{done:t,value:n}=yield Yt(e.read());if(t)break;yield n}}finally{yield Yt(e.cancel())}}));return function(e){return t.apply(this,arguments)}}(),ie=(t,e,n,i)=>{const s=ee(t,e);let r,a=0,o=t=>{r||(r=!0,i&&i(t))};return new ReadableStream({async pull(t){try{const{done:e,value:i}=await s.next();if(e)return o(),void t.close();let r=i.byteLength;if(n){let t=a+=r;n(t)}t.enqueue(new Uint8Array(i))}catch(e){throw o(e),e}},cancel:t=>(o(t),s.return())},{highWaterMark:2})},se="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,re=se&&"function"===typeof ReadableStream,ae=se&&("function"===typeof TextEncoder?(oe=new TextEncoder,t=>oe.encode(t)):async t=>new Uint8Array(await new Response(t).arrayBuffer()));var oe;const le=function(t){try{for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return!!t(...n)}catch(s){return!1}},ce=re&&le((()=>{let t=!1;const e=new Request(yt.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e})),ue=re&&le((()=>X.isReadableStream(new Response("").body))),he={stream:ue&&(t=>t.body)};var de;se&&(de=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((t=>{!he[t]&&(he[t]=X.isFunction(de[t])?e=>e[t]():(e,n)=>{throw new $("Response type '".concat(t,"' is not supported"),$.ERR_NOT_SUPPORT,n)})})));const fe=async(t,e)=>{const n=X.toFiniteNumber(t.getContentLength());return null==n?(async t=>{if(null==t)return 0;if(X.isBlob(t))return t.size;if(X.isSpecCompliantForm(t)){const e=new Request(yt.origin,{method:"POST",body:t});return(await e.arrayBuffer()).byteLength}return X.isArrayBufferView(t)||X.isArrayBuffer(t)?t.byteLength:(X.isURLSearchParams(t)&&(t+=""),X.isString(t)?(await ae(t)).byteLength:void 0)})(e):n},pe={http:null,xhr:qt,fetch:se&&(async t=>{let{url:e,method:n,data:i,signal:s,cancelToken:r,timeout:a,onDownloadProgress:o,onUploadProgress:c,responseType:u,headers:h,withCredentials:d="same-origin",fetchOptions:f}=Ht(t);u=u?(u+"").toLowerCase():"text";let p,g=Gt([s,r&&r.toAbortSignal()],a);const m=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let v;try{if(c&&ce&&"get"!==n&&"head"!==n&&0!==(v=await fe(h,i))){let t,n=new Request(e,{method:"POST",body:i,duplex:"half"});if(X.isFormData(i)&&(t=n.headers.get("content-type"))&&h.setContentType(t),n.body){const[t,e]=Ft(v,Ot(Ut(c)));i=ie(n.body,65536,t,e)}}X.isString(d)||(d=d?"include":"omit");const s="credentials"in Request.prototype;p=new Request(e,l(l({},f),{},{signal:g,method:n.toUpperCase(),headers:h.normalize().toJSON(),body:i,duplex:"half",credentials:s?d:void 0}));let r=await fetch(p,f);const a=ue&&("stream"===u||"response"===u);if(ue&&(o||a&&m)){const t={};["status","statusText","headers"].forEach((e=>{t[e]=r[e]}));const e=X.toFiniteNumber(r.headers.get("content-length")),[n,i]=o&&Ft(e,Ot(Ut(o),!0))||[];r=new Response(ie(r.body,65536,n,(()=>{i&&i(),m&&m()})),t)}u=u||"text";let y=await he[X.findKey(he,u)||"text"](r,t);return!a&&m&&m(),await new Promise(((e,n)=>{Nt(e,n,{data:y,headers:xt.from(r.headers),status:r.status,statusText:r.statusText,config:t,request:p})}))}catch(y){if(m&&m(),y&&"TypeError"===y.name&&/Load failed|fetch/i.test(y.message))throw Object.assign(new $("Network Error",$.ERR_NETWORK,t,p),{cause:y.cause||y});throw $.from(y,y&&y.code,t,p)}})};X.forEach(pe,((t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(n){}Object.defineProperty(t,"adapterName",{value:e})}}));const ge=t=>"- ".concat(t),me=t=>X.isFunction(t)||null===t||!1===t,ve=t=>{t=X.isArray(t)?t:[t];const{length:e}=t;let n,i;const s={};for(let r=0;r<e;r++){let e;if(n=t[r],i=n,!me(n)&&(i=pe[(e=String(n)).toLowerCase()],void 0===i))throw new $("Unknown adapter '".concat(e,"'"));if(i)break;s[e||"#"+r]=i}if(!i){const t=Object.entries(s).map((t=>{let[e,n]=t;return"adapter ".concat(e," ")+(!1===n?"is not supported by the environment":"is not available in the build")}));let n=e?t.length>1?"since :\n"+t.map(ge).join("\n"):" "+ge(t[0]):"as no adapter specified";throw new $("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return i};function ye(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Pt(null,t)}function we(t){ye(t),t.headers=xt.from(t.headers),t.data=It.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1);return ve(t.adapter||_t.adapter)(t).then((function(e){return ye(t),e.data=It.call(t,t.transformResponse,e),e.headers=xt.from(e.headers),e}),(function(e){return Rt(e)||(ye(t),e&&e.response&&(e.response.data=It.call(t,t.transformResponse,e.response),e.response.headers=xt.from(e.response.headers))),Promise.reject(e)}))}const be="1.10.0",_e={};["object","boolean","number","function","string","symbol"].forEach(((t,e)=>{_e[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}}));const Ee={};_e.transitional=function(t,e,n){function i(t,e){return"[Axios v"+be+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return(n,s,r)=>{if(!1===t)throw new $(i(s," has been removed"+(e?" in "+e:"")),$.ERR_DEPRECATED);return e&&!Ee[s]&&(Ee[s]=!0,console.warn(i(s," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,s,r)}},_e.spelling=function(t){return(e,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(t)),!0)};const Ae={assertOptions:function(t,e,n){if("object"!==typeof t)throw new $("options must be an object",$.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let s=i.length;for(;s-- >0;){const r=i[s],a=e[r];if(a){const e=t[r],n=void 0===e||a(e,r,t);if(!0!==n)throw new $("option "+r+" must be "+n,$.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new $("Unknown option "+r,$.ERR_BAD_OPTION)}},validators:_e},Se=Ae.validators;class ke{constructor(t){this.defaults=t||{},this.interceptors={request:new ut,response:new ut}}async request(t,e){try{return await this._request(t,e)}catch(n){if(n instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const e=t.stack?t.stack.replace(/^.+\n/,""):"";try{n.stack?e&&!String(n.stack).endsWith(e.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+e):n.stack=e}catch(i){}}throw n}}_request(t,e){"string"===typeof t?(e=e||{}).url=t:e=t||{},e=zt(this.defaults,e);const{transitional:n,paramsSerializer:i,headers:s}=e;void 0!==n&&Ae.assertOptions(n,{silentJSONParsing:Se.transitional(Se.boolean),forcedJSONParsing:Se.transitional(Se.boolean),clarifyTimeoutError:Se.transitional(Se.boolean)},!1),null!=i&&(X.isFunction(i)?e.paramsSerializer={serialize:i}:Ae.assertOptions(i,{encode:Se.function,serialize:Se.function},!0)),void 0!==e.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),Ae.assertOptions(e,{baseUrl:Se.spelling("baseURL"),withXsrfToken:Se.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let r=s&&X.merge(s.common,s[e.method]);s&&X.forEach(["delete","get","head","post","put","patch","common"],(t=>{delete s[t]})),e.headers=xt.concat(r,s);const a=[];let o=!0;this.interceptors.request.forEach((function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(o=o&&t.synchronous,a.unshift(t.fulfilled,t.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(t){l.push(t.fulfilled,t.rejected)}));let u,h=0;if(!o){const t=[we.bind(this),void 0];for(t.unshift.apply(t,a),t.push.apply(t,l),u=t.length,c=Promise.resolve(e);h<u;)c=c.then(t[h++],t[h++]);return c}u=a.length;let d=e;for(h=0;h<u;){const t=a[h++],e=a[h++];try{d=t(d)}catch(f){e.call(this,f);break}}try{c=we.call(this,d)}catch(f){return Promise.reject(f)}for(h=0,u=l.length;h<u;)c=c.then(l[h++],l[h++]);return c}getUri(t){return ct(jt((t=zt(this.defaults,t)).baseURL,t.url,t.allowAbsoluteUrls),t.params,t.paramsSerializer)}}X.forEach(["delete","get","head","options"],(function(t){ke.prototype[t]=function(e,n){return this.request(zt(n||{},{method:t,url:e,data:(n||{}).data}))}})),X.forEach(["post","put","patch"],(function(t){function e(e){return function(n,i,s){return this.request(zt(s||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}ke.prototype[t]=e(),ke.prototype[t+"Form"]=e(!0)}));const Ce=ke;class Te{constructor(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise((function(t){e=t}));const n=this;this.promise.then((t=>{if(!n._listeners)return;let e=n._listeners.length;for(;e-- >0;)n._listeners[e](t);n._listeners=null})),this.promise.then=t=>{let e;const i=new Promise((t=>{n.subscribe(t),e=t})).then(t);return i.cancel=function(){n.unsubscribe(e)},i},t((function(t,i,s){n.reason||(n.reason=new Pt(t,i,s),e(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=e=>{t.abort(e)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new Te((function(e){t=e})),cancel:t}}}const xe=Te;const Ie={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ie).forEach((t=>{let[e,n]=t;Ie[n]=e}));const Re=Ie;const Me=function t(e){const n=new Ce(e),i=c(Ce.prototype.request,n);return X.extend(i,Ce.prototype,n,{allOwnKeys:!0}),X.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return t(zt(e,n))},i}(_t);Me.Axios=Ce,Me.CanceledError=Pt,Me.CancelToken=xe,Me.isCancel=Rt,Me.VERSION=be,Me.toFormData=it,Me.AxiosError=$,Me.Cancel=Me.CanceledError,Me.all=function(t){return Promise.all(t)},Me.spread=function(t){return function(e){return t.apply(null,e)}},Me.isAxiosError=function(t){return X.isObject(t)&&!0===t.isAxiosError},Me.mergeConfig=zt,Me.AxiosHeaders=xt,Me.formToJSON=t=>wt(X.isHTMLForm(t)?new FormData(t):t),Me.getAdapter=ve,Me.HttpStatusCode=Re,Me.default=Me;const Pe=Me;function Ne(t,e,n){e||(e=[]);var i=e.length++;return Object.defineProperty({},"_",{set:function(s){e[i]=s,t.apply(n,e)}})}function De(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Le(t,e){De(t,e),e.add(t)}function Oe(t,e,n){De(t,e),e.set(t,n)}function Fe(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function Ue(t,e,n){return n(Fe(t,e))}function Be(t,e){return t.get(Fe(t,e))}function Ve(t,e,n){return t.set(Fe(t,e),n),n}var je,We,ze,He,qe,Ge,Ke,Xe,Qe,Ye,Je,$e,Ze,tn,en;const nn="object"===typeof process&&process+""==="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type),sn=[.001,0,0,.001,0,0],rn=1.35,an=1,on=2,ln=4,cn=16,un=32,hn=64,dn=128,fn=256,pn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},gn={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},mn={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},vn=0,yn=1,wn=2,bn=3,_n=3,En=4,An={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Sn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},kn=1,Cn=2,Tn=3,xn=4,In=5,Rn={ERRORS:0,WARNINGS:1,INFOS:5},Mn={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Pn=0,Nn=1,Dn=2,Ln=3;let On=Rn.WARNINGS;function Fn(t){Number.isInteger(t)&&(On=t)}function Un(){return On}function Bn(t){On>=Rn.INFOS&&console.log("Info: ".concat(t))}function Vn(t){On>=Rn.WARNINGS&&console.log("Warning: ".concat(t))}function jn(t){throw new Error(t)}function Wn(t,e){t||jn(e)}function zn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return null;if(n&&"string"===typeof t){if(n.addDefaultProtocol&&t.startsWith("www.")){const e=t.match(/\./g);(null===e||void 0===e?void 0:e.length)>=2&&(t="http://".concat(t))}if(n.tryConvertEncoding)try{t=decodeURIComponent(escape(t))}catch(s){}}const i=e?URL.parse(t,e):URL.parse(t);return function(t){switch(null===t||void 0===t?void 0:t.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i)?i:null}function Hn(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=URL.parse(t);return i?(i.hash=e,i.href):n&&zn(t,"http://example.com")?t.split("#",1)[0]+"".concat(e?"#".concat(e):""):""}function qn(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.defineProperty(t,e,{value:n,enumerable:!i,configurable:!0,writable:!1}),n}const Gn=function(){function t(t,e){this.message=t,this.name=e}return t.prototype=new Error,t.constructor=t,t}();class Kn extends Gn{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Xn extends Gn{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Qn extends Gn{constructor(t){super(t,"InvalidPDFException")}}class Yn extends Gn{constructor(t,e,n){super(t,"ResponseException"),this.status=e,this.missing=n}}class Jn extends Gn{constructor(t){super(t,"FormatError")}}class $n extends Gn{constructor(t){super(t,"AbortException")}}function Zn(t){"object"===typeof t&&void 0!==(null===t||void 0===t?void 0:t.length)||jn("Invalid argument for bytesToString");const e=t.length,n=8192;if(e<n)return String.fromCharCode.apply(null,t);const i=[];for(let s=0;s<e;s+=n){const r=Math.min(s+n,e),a=t.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function ti(t){"string"!==typeof t&&jn("Invalid argument for stringToBytes");const e=t.length,n=new Uint8Array(e);for(let i=0;i<e;++i)n[i]=255&t.charCodeAt(i);return n}class ei{static get isLittleEndian(){return qn(this,"isLittleEndian",function(){const t=new Uint8Array(4);return t[0]=1,1===new Uint32Array(t.buffer,0,1)[0]}())}static get isEvalSupported(){return qn(this,"isEvalSupported",function(){try{return new Function(""),!0}catch(t){return!1}}())}static get isOffscreenCanvasSupported(){return qn(this,"isOffscreenCanvasSupported","undefined"!==typeof OffscreenCanvas)}static get isImageDecoderSupported(){return qn(this,"isImageDecoderSupported","undefined"!==typeof ImageDecoder)}static get platform(){const{platform:t,userAgent:e}=navigator;return qn(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){var t,e;return qn(this,"isCSSRoundSupported",null===(t=globalThis.CSS)||void 0===t||null===(e=t.supports)||void 0===e?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const ni=Array.from(Array(256).keys(),(t=>t.toString(16).padStart(2,"0")));class ii{static makeHexColor(t,e,n){return"#".concat(ni[t]).concat(ni[e]).concat(ni[n])}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=t[n],s=t[n+1];t[n]=i*e[0]+s*e[2]+e[4],t[n+1]=i*e[1]+s*e[3]+e[5]}static applyTransformToBezier(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=e[0],s=e[1],r=e[2],a=e[3],o=e[4],l=e[5];for(let c=0;c<6;c+=2){const e=t[n+c],u=t[n+c+1];t[n+c]=e*i+u*r+o,t[n+c+1]=e*s+u*a+l}}static applyInverseTransform(t,e){const n=t[0],i=t[1],s=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-i*e[2]+e[2]*e[5]-e[4]*e[3])/s,t[1]=(-n*e[1]+i*e[0]+e[4]*e[1]-e[5]*e[0])/s}static axialAlignedBoundingBox(t,e,n){const i=e[0],s=e[1],r=e[2],a=e[3],o=e[4],l=e[5],c=t[0],u=t[1],h=t[2],d=t[3];let f=i*c+o,p=f,g=i*h+o,m=g,v=a*u+l,y=v,w=a*d+l,b=w;if(0!==s||0!==r){const t=s*c,e=s*h,n=r*u,i=r*d;f+=n,m+=n,g+=i,p+=i,v+=t,b+=t,w+=e,y+=e}n[0]=Math.min(n[0],f,g,p,m),n[1]=Math.min(n[1],v,w,y,b),n[2]=Math.max(n[2],f,g,p,m),n[3]=Math.max(n[3],v,w,y,b)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const n=t[0],i=t[1],s=t[2],r=t[3],a=n**2+i**2,o=n*s+i*r,l=s**2+r**2,c=(a+l)/2,u=Math.sqrt(c**2-(a*l-o**2));e[0]=Math.sqrt(c+u||1),e[1]=Math.sqrt(c-u||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>i)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),r=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>r?null:[n,s,i,r]}static pointBoundingBox(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}static rectBoundingBox(t,e,n,i,s){s[0]=Math.min(s[0],t,n),s[1]=Math.min(s[1],e,i),s[2]=Math.max(s[2],t,n),s[3]=Math.max(s[3],e,i)}static bezierBoundingBox(t,e,n,i,s,r,a,o,l){l[0]=Math.min(l[0],t,a),l[1]=Math.min(l[1],e,o),l[2]=Math.max(l[2],t,a),l[3]=Math.max(l[3],e,o),Fe(ii,this,ri).call(this,t,n,s,a,e,i,r,o,3*(3*(n-s)-t+a),6*(t-2*n+s),3*(n-t),l),Fe(ii,this,ri).call(this,t,n,s,a,e,i,r,o,3*(3*(i-r)-e+o),6*(e-2*i+r),3*(i-e),l)}}function si(t,e,n,i,s,r,a,o,l,c){if(l<=0||l>=1)return;const u=1-l,h=l*l,d=h*l,f=u*(u*(u*t+3*l*e)+3*h*n)+d*i,p=u*(u*(u*s+3*l*r)+3*h*a)+d*o;c[0]=Math.min(c[0],f),c[1]=Math.min(c[1],p),c[2]=Math.max(c[2],f),c[3]=Math.max(c[3],p)}function ri(t,e,n,i,s,r,a,o,l,c,u,h){if(Math.abs(l)<1e-12)return void(Math.abs(c)>=1e-12&&Fe(je,this,si).call(this,t,e,n,i,s,r,a,o,-u/c,h));const d=c**2-4*u*l;if(d<0)return;const f=Math.sqrt(d),p=2*l;Fe(je,this,si).call(this,t,e,n,i,s,r,a,o,(-c+f)/p,h),Fe(je,this,si).call(this,t,e,n,i,s,r,a,o,(-c-f)/p,h)}je=ii;let ai=null,oi=null;function li(){if("function"===typeof crypto.randomUUID)return crypto.randomUUID();const t=new Uint8Array(32);return crypto.getRandomValues(t),Zn(t)}const ci="pdfjs_internal_id_";function ui(t,e,n){return Math.min(Math.max(t,e),n)}function hi(t){return Uint8Array.prototype.toBase64?t.toBase64():btoa(Zn(t))}"function"!==typeof Promise.try&&(Promise.try=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return new Promise((e=>{e(t(...n))}))}),"function"!==typeof Math.sumPrecise&&(Math.sumPrecise=function(t){return t.reduce(((t,e)=>t+e),0)});const di="http://www.w3.org/2000/svg";class fi{}async function pi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(bi(t,document.baseURI)){const n=await fetch(t);if(!n.ok)throw new Error(n.statusText);switch(e){case"arraybuffer":return n.arrayBuffer();case"blob":return n.blob();case"json":return n.json()}return n.text()}return new Promise(((n,i)=>{const s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE)if(200!==s.status&&0!==s.status)i(new Error(s.statusText));else{switch(e){case"arraybuffer":case"blob":case"json":return void n(s.response)}n(s.responseText)}},s.send(null)}))}We=fi,a(fi,"CSS",96),a(fi,"PDF",72),a(fi,"PDF_TO_CSS_UNITS",We.CSS/We.PDF);class gi{constructor(t){let{viewBox:e,userUnit:n,scale:i,rotation:s,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}=t;this.viewBox=e,this.userUnit=n,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=a,i*=n;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let u,h,d,f,p,g,m,v;switch(s%=360,s<0&&(s+=360),s){case 180:u=-1,h=0,d=0,f=1;break;case 90:u=0,h=1,d=1,f=0;break;case 270:u=0,h=-1,d=-1,f=0;break;case 0:u=1,h=0,d=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(d=-d,f=-f),0===u?(p=Math.abs(c-e[1])*i+r,g=Math.abs(l-e[0])*i+a,m=(e[3]-e[1])*i,v=(e[2]-e[0])*i):(p=Math.abs(l-e[0])*i+r,g=Math.abs(c-e[1])*i+a,m=(e[2]-e[0])*i,v=(e[3]-e[1])*i),this.transform=[u*i,h*i,d*i,f*i,p-u*i*l-d*i*c,g-h*i*l-f*i*c],this.width=m,this.height=v}get rawDims(){const t=this.viewBox;return qn(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone(){let{scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new gi({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:s})}convertToViewportPoint(t,e){const n=[t,e];return ii.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const e=[t[0],t[1]];ii.applyTransform(e,this.transform);const n=[t[2],t[3]];return ii.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){const n=[t,e];return ii.applyInverseTransform(n,this.transform),n}}class mi extends Gn{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super(t,"RenderingCancelledException"),this.extraDelay=e}}function vi(t){const e=t.length;let n=0;for(;n<e&&""===t[n].trim();)n++;return"data:"===t.substring(n,n+5).toLowerCase()}function yi(t){return"string"===typeof t&&/\.pdf$/i.test(t)}class wi{constructor(){a(this,"started",Object.create(null)),a(this,"times",[])}time(t){t in this.started&&Vn("Timer is already running for ".concat(t)),this.started[t]=Date.now()}timeEnd(t){t in this.started||Vn("Timer has not been started for ".concat(t)),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:i,end:s}of this.times)t.push("".concat(n.padEnd(e)," ").concat(s-i,"ms\n"));return t.join("")}}function bi(t,e){const n=e?URL.parse(t,e):URL.parse(t);return"http:"===(null===n||void 0===n?void 0:n.protocol)||"https:"===(null===n||void 0===n?void 0:n.protocol)}function _i(t){t.preventDefault()}function Ei(t){t.preventDefault(),t.stopPropagation()}class Ai{static toDateObject(t){if(!t||"string"!==typeof t)return null;Fe(Ai,this,Si)._||(Si._=Fe(Ai,this,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?")));const e=Fe(Ai,this,Si)._.exec(t);if(!e)return null;const n=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let r=parseInt(e[4],10);r=r>=0&&r<=23?r:0;let a=parseInt(e[5],10);a=a>=0&&a<=59?a:0;let o=parseInt(e[6],10);o=o>=0&&o<=59?o:0;const l=e[7]||"Z";let c=parseInt(e[8],10);c=c>=0&&c<=23?c:0;let u=parseInt(e[9],10)||0;return u=u>=0&&u<=59?u:0,"-"===l?(r+=c,a+=u):"+"===l&&(r-=c,a-=u),new Date(Date.UTC(n,i,s,r,a,o))}}var Si={_:void 0};function ki(t){if(t.startsWith("#")){const e=parseInt(t.slice(1),16);return[(16711680&e)>>16,(65280&e)>>8,255&e]}return t.startsWith("rgb(")?t.slice(4,-1).split(",").map((t=>parseInt(t))):t.startsWith("rgba(")?t.slice(5,-1).split(",").map((t=>parseInt(t))).slice(0,3):(Vn('Not a valid color format: "'.concat(t,'"')),[0,0,0])}function Ci(t){const{a:e,b:n,c:i,d:s,e:r,f:a}=t.getTransform();return[e,n,i,s,r,a]}function Ti(t){const{a:e,b:n,c:i,d:s,e:r,f:a}=t.getTransform().invertSelf();return[e,n,i,s,r,a]}function xi(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e instanceof gi){const{pageWidth:i,pageHeight:s}=e.rawDims,{style:r}=t,a=ei.isCSSRoundSupported,o="var(--total-scale-factor) * ".concat(i,"px"),l="var(--total-scale-factor) * ".concat(s,"px"),c=a?"round(down, ".concat(o,", var(--scale-round-x))"):"calc(".concat(o,")"),u=a?"round(down, ".concat(l,", var(--scale-round-y))"):"calc(".concat(l,")");n&&e.rotation%180!==0?(r.width=u,r.height=c):(r.width=c,r.height=u)}i&&t.setAttribute("data-main-rotation",e.rotation)}class Ii{constructor(){const{pixelRatio:t}=Ii;this.sx=t,this.sy=t}get scaled(){return 1!==this.sx||1!==this.sy}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,r=1/0,a=1/0,o=1/0;(n=Ii.capPixels(n,s))>0&&(r=Math.sqrt(n/(t*e))),-1!==i&&(a=i/t,o=i/e);const l=Math.min(r,a,o);return(this.sx>l||this.sy>l)&&(this.sx=l,this.sy=l,!0)}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,n):n}return t}}const Ri=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var Mi=new WeakMap,Pi=new WeakMap,Ni=new WeakMap,Di=new WeakMap,Li=new WeakMap,Oi=new WeakMap,Fi=new WeakSet;class Ui{constructor(t){Le(this,Fi),Oe(this,Mi,null),Oe(this,Pi,null),Oe(this,Ni,void 0),Oe(this,Di,null),Oe(this,Li,null),Oe(this,Oi,null),Ve(Ni,this,t),qi._||(qi._=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const t=Ve(Mi,this,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=Be(Ni,this)._uiManager._signal;t.addEventListener("contextmenu",_i,{signal:e}),t.addEventListener("pointerdown",Bi,{signal:e});const n=Ve(Di,this,document.createElement("div"));n.className="buttons",t.append(n);const i=Be(Ni,this).toolbarPosition;if(i){const{style:e}=t,n="ltr"===Be(Ni,this)._uiManager.direction?1-i[0]:i[0];e.insetInlineEnd="".concat(100*n,"%"),e.top="calc(".concat(100*i[1],"% + var(--editor-toolbar-vert-offset))")}return Fe(Fi,this,zi).call(this),t}get div(){return Be(Mi,this)}hide(){var t;Be(Mi,this).classList.add("hidden"),null===(t=Be(Pi,this))||void 0===t||t.hideDropdown()}show(){var t;Be(Mi,this).classList.remove("hidden"),null===(t=Be(Li,this))||void 0===t||t.shown()}async addAltText(t){const e=await t.render();Fe(Fi,this,Wi).call(this,e),Be(Di,this).prepend(e,Ue(Fi,this,Hi)),Ve(Li,this,t)}addColorPicker(t){Ve(Pi,this,t);const e=t.renderButton();Fe(Fi,this,Wi).call(this,e),Be(Di,this).prepend(e,Ue(Fi,this,Hi))}async addEditSignatureButton(t){const e=Ve(Oi,this,await t.renderEditButton(Be(Ni,this)));Fe(Fi,this,Wi).call(this,e),Be(Di,this).prepend(e,Ue(Fi,this,Hi))}updateEditSignatureButton(t){Be(Oi,this)&&(Be(Oi,this).title=t)}remove(){var t;Be(Mi,this).remove(),null===(t=Be(Pi,this))||void 0===t||t.destroy(),Ve(Pi,this,null)}}function Bi(t){t.stopPropagation()}function Vi(t){Be(Ni,this)._focusEventsAllowed=!1,Ei(t)}function ji(t){Be(Ni,this)._focusEventsAllowed=!0,Ei(t)}function Wi(t){const e=Be(Ni,this)._uiManager._signal;t.addEventListener("focusin",Fe(Fi,this,Vi).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",Fe(Fi,this,ji).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",_i,{signal:e})}function zi(){const{editorType:t,_uiManager:e}=Be(Ni,this),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",qi._[t]),Fe(Fi,this,Wi).call(this,n),n.addEventListener("click",(t=>{e.delete()}),{signal:e._signal}),Be(Di,this).append(n)}function Hi(t){const e=document.createElement("div");return e.className="divider",e}var qi={_:null},Gi=new WeakMap,Ki=new WeakMap,Xi=new WeakMap,Qi=new WeakSet;class Yi{constructor(t){Le(this,Qi),Oe(this,Gi,null),Oe(this,Ki,null),Oe(this,Xi,void 0),Ve(Xi,this,t)}show(t,e,n){const[i,s]=Fe(Qi,this,$i).call(this,e,n),{style:r}=Be(Ki,this)||Ve(Ki,this,Fe(Qi,this,Ji).call(this));t.append(Be(Ki,this)),r.insetInlineEnd="".concat(100*i,"%"),r.top="calc(".concat(100*s,"% + var(--editor-toolbar-vert-offset))")}hide(){Be(Ki,this).remove()}}function Ji(){const t=Ve(Ki,this,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",_i,{signal:Be(Xi,this)._signal});const e=Ve(Gi,this,document.createElement("div"));return e.className="buttons",t.append(e),Fe(Qi,this,Zi).call(this),t}function $i(t,e){let n=0,i=0;for(const s of t){const t=s.y+s.height;if(t<n)continue;const r=s.x+(e?s.width:0);t>n?(i=r,n=t):e?r>i&&(i=r):r<i&&(i=r)}return[e?1-i:i,n]}function Zi(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=Be(Xi,this)._signal;t.addEventListener("contextmenu",_i,{signal:n}),t.addEventListener("click",(()=>{Be(Xi,this).highlightSelection("floating_button")}),{signal:n}),Be(Gi,this).append(t)}function ts(t,e,n){for(const i of n)e.addEventListener(i,t[i].bind(t))}var es=new WeakMap;class ns{constructor(){Oe(this,es,0)}get id(){var t,e;return"".concat("pdfjs_internal_editor_").concat((Ve(es,this,(t=Be(es,this),e=t++,t)),e))}}var is=new WeakMap,ss=new WeakMap,rs=new WeakMap,as=new WeakSet;class os{constructor(){Le(this,as),Oe(this,is,li()),Oe(this,ss,0),Oe(this,rs,null)}static get _isSVGFittingCanvas(){const t=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),e=new Image;e.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>';return qn(this,"_isSVGFittingCanvas",e.decode().then((()=>(t.drawImage(e,0,0,1,1,0,0,1,3),0===new Uint32Array(t.getImageData(0,0,1,1).data.buffer)[0]))))}async getFromFile(t){const{lastModified:e,name:n,size:i,type:s}=t;return Fe(as,this,ls).call(this,"".concat(e,"_").concat(n,"_").concat(i,"_").concat(s),t)}async getFromUrl(t){return Fe(as,this,ls).call(this,t,t)}async getFromBlob(t,e){const n=await e;return Fe(as,this,ls).call(this,t,n)}async getFromId(t){Be(rs,this)||Ve(rs,this,new Map);const e=Be(rs,this).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:t}=e;return delete e.blobPromise,this.getFromBlob(e.id,t)}return this.getFromUrl(e.url)}getFromCanvas(t,e){var n,i,s;Be(rs,this)||Ve(rs,this,new Map);let r=Be(rs,this).get(t);if(null!==(s=r)&&void 0!==s&&s.bitmap)return r.refCounter+=1,r;const a=new OffscreenCanvas(e.width,e.height);return a.getContext("2d").drawImage(e,0,0),r={bitmap:a.transferToImageBitmap(),id:"image_".concat(Be(is,this),"_").concat((Ve(ss,this,(n=Be(ss,this),i=n++,n)),i)),refCounter:1,isSvg:!1},Be(rs,this).set(t,r),Be(rs,this).set(r.id,r),r}getSvgUrl(t){const e=Be(rs,this).get(t);return null!==e&&void 0!==e&&e.isSvg?e.svgUrl:null}deleteId(t){var e;Be(rs,this)||Ve(rs,this,new Map);const n=Be(rs,this).get(t);if(!n)return;if(n.refCounter-=1,0!==n.refCounter)return;const{bitmap:i}=n;if(!n.url&&!n.file){const t=new OffscreenCanvas(i.width,i.height);t.getContext("bitmaprenderer").transferFromImageBitmap(i),n.blobPromise=t.convertToBlob()}null===(e=i.close)||void 0===e||e.call(i),n.bitmap=null}isValidId(t){return t.startsWith("image_".concat(Be(is,this),"_"))}}async function ls(t,e){var n;Be(rs,this)||Ve(rs,this,new Map);let i=Be(rs,this).get(t);if(null===i)return null;if(null!==(n=i)&&void 0!==n&&n.bitmap)return i.refCounter+=1,i;try{var s,r;let t;if(i||(i={bitmap:null,id:"image_".concat(Be(is,this),"_").concat((Ve(ss,this,(s=Be(ss,this),r=s++,s)),r)),refCounter:0,isSvg:!1}),"string"===typeof e?(i.url=e,t=await pi(e,"blob")):e instanceof File?t=i.file=e:e instanceof Blob&&(t=e),"image/svg+xml"===t.type){const e=ze._isSVGFittingCanvas,n=new FileReader,s=new Image,r=new Promise(((t,r)=>{s.onload=()=>{i.bitmap=s,i.isSvg=!0,t()},n.onload=async()=>{const t=i.svgUrl=n.result;s.src=await e?"".concat(t,"#svgView(preserveAspectRatio(none))"):t},s.onerror=n.onerror=r}));n.readAsDataURL(t),await r}else i.bitmap=await createImageBitmap(t);i.refCounter=1}catch(a){Vn(a),i=null}return Be(rs,this).set(t,i),i&&Be(rs,this).set(i.id,i),i}ze=os;var cs=new WeakMap,us=new WeakMap,hs=new WeakMap,ds=new WeakMap;class fs{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;Oe(this,cs,[]),Oe(this,us,!1),Oe(this,hs,void 0),Oe(this,ds,-1),Ve(hs,this,t)}add(t){let{cmd:e,undo:n,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}=t;if(s&&e(),Be(us,this))return;const l={cmd:e,undo:n,post:i,type:r};if(-1===Be(ds,this))return Be(cs,this).length>0&&(Be(cs,this).length=0),Ve(ds,this,0),void Be(cs,this).push(l);if(a&&Be(cs,this)[Be(ds,this)].type===r)return o&&(l.undo=Be(cs,this)[Be(ds,this)].undo),void(Be(cs,this)[Be(ds,this)]=l);const c=Be(ds,this)+1;c===Be(hs,this)?Be(cs,this).splice(0,1):(Ve(ds,this,c),c<Be(cs,this).length&&Be(cs,this).splice(c)),Be(cs,this).push(l)}undo(){if(-1===Be(ds,this))return;Ve(us,this,!0);const{undo:t,post:e}=Be(cs,this)[Be(ds,this)];t(),null===e||void 0===e||e(),Ve(us,this,!1),Ve(ds,this,Be(ds,this)-1)}redo(){if(Be(ds,this)<Be(cs,this).length-1){Ve(ds,this,Be(ds,this)+1),Ve(us,this,!0);const{cmd:t,post:e}=Be(cs,this)[Be(ds,this)];t(),null===e||void 0===e||e(),Ve(us,this,!1)}}hasSomethingToUndo(){return-1!==Be(ds,this)}hasSomethingToRedo(){return Be(ds,this)<Be(cs,this).length-1}cleanType(t){if(-1!==Be(ds,this)){for(let e=Be(ds,this);e>=0;e--)if(Be(cs,this)[e].type!==t)return Be(cs,this).splice(e+1,Be(ds,this)-e),void Ve(ds,this,e);Be(cs,this).length=0,Ve(ds,this,-1)}}destroy(){Ve(cs,this,null)}}var ps=new WeakSet;class gs{constructor(t){Le(this,ps),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=ei.platform;for(const[n,i,s={}]of t)for(const t of n){const n=t.startsWith("mac+");e&&n?(this.callbacks.set(t.slice(4),{callback:i,options:s}),this.allKeys.add(t.split("+").at(-1))):e||n||(this.callbacks.set(t,{callback:i,options:s}),this.allKeys.add(t.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(Fe(ps,this,ms).call(this,e));if(!n)return;const{callback:i,options:{bubbles:s=!1,args:r=[],checker:a=null}}=n;a&&!a(t,e)||(i.bind(t,...r,e)(),s||Ei(e))}}function ms(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}class vs{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return function(t){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const n of t.keys()){e.style.color=n;const i=window.getComputedStyle(e).color;t.set(n,ki(i))}e.remove()}(t),qn(this,"_colors",t)}convert(t){const e=ki(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,i]of this._colors)if(i.every(((t,n)=>t===e[n])))return vs._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?ii.makeHexColor(...e):t}}a(vs,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));var ys=new WeakMap,ws=new WeakMap,bs=new WeakMap,_s=new WeakMap,Es=new WeakMap,As=new WeakMap,Ss=new WeakMap,ks=new WeakMap,Cs=new WeakMap,Ts=new WeakMap,xs=new WeakMap,Is=new WeakMap,Rs=new WeakMap,Ms=new WeakMap,Ps=new WeakMap,Ns=new WeakMap,Ds=new WeakMap,Ls=new WeakMap,Os=new WeakMap,Fs=new WeakMap,Us=new WeakMap,Bs=new WeakMap,Vs=new WeakMap,js=new WeakMap,Ws=new WeakMap,zs=new WeakMap,Hs=new WeakMap,qs=new WeakMap,Gs=new WeakMap,Ks=new WeakMap,Xs=new WeakMap,Qs=new WeakMap,Ys=new WeakMap,Js=new WeakMap,$s=new WeakMap,Zs=new WeakMap,tr=new WeakMap,er=new WeakMap,nr=new WeakMap,ir=new WeakMap,sr=new WeakMap,rr=new WeakMap,ar=new WeakMap,or=new WeakMap,lr=new WeakSet;class cr{static get _keyboardManager(){const t=cr.prototype,e=t=>Be(rr,t).contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&t.hasSomethingToControl(),n=(t,e)=>{let{target:n}=e;if(n instanceof HTMLInputElement){const{type:t}=n;return"text"!==t&&"number"!==t}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return qn(this,"_keyboardManager",new gs([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(t,e)=>{let{target:n}=e;return!(n instanceof HTMLButtonElement)&&Be(rr,t).contains(n)&&!t.isEnterHandled}}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(t,e)=>{let{target:n}=e;return!(n instanceof HTMLButtonElement)&&Be(rr,t).contains(document.activeElement)}}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}constructor(t,e,n,i,s,r,o,l,c,u,h,d,f,p){Le(this,lr),Oe(this,ys,new AbortController),Oe(this,ws,null),Oe(this,bs,new Map),Oe(this,_s,new Map),Oe(this,Es,null),Oe(this,As,null),Oe(this,Ss,null),Oe(this,ks,new fs),Oe(this,Cs,null),Oe(this,Ts,null),Oe(this,xs,0),Oe(this,Is,new Set),Oe(this,Rs,null),Oe(this,Ms,null),Oe(this,Ps,new Set),a(this,"_editorUndoBar",null),Oe(this,Ns,!1),Oe(this,Ds,!1),Oe(this,Ls,!1),Oe(this,Os,null),Oe(this,Fs,null),Oe(this,Us,null),Oe(this,Bs,null),Oe(this,Vs,!1),Oe(this,js,null),Oe(this,Ws,new ns),Oe(this,zs,!1),Oe(this,Hs,!1),Oe(this,qs,null),Oe(this,Gs,null),Oe(this,Ks,null),Oe(this,Xs,null),Oe(this,Qs,null),Oe(this,Ys,gn.NONE),Oe(this,Js,new Set),Oe(this,$s,null),Oe(this,Zs,null),Oe(this,tr,null),Oe(this,er,null),Oe(this,nr,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1}),Oe(this,ir,[0,0]),Oe(this,sr,null),Oe(this,rr,null),Oe(this,ar,null),Oe(this,or,null);const g=this._signal=Be(ys,this).signal;Ve(rr,this,t),Ve(ar,this,e),Ve(Es,this,n),Ve(Zs,this,i),this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:g}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),s._on("setpreference",this.onSetPreference.bind(this),{signal:g}),s._on("switchannotationeditorparams",(t=>this.updateParams(t.type,t.value)),{signal:g}),Fe(lr,this,gr).call(this),Fe(lr,this,Er).call(this),Fe(lr,this,yr).call(this),Ve(As,this,r.annotationStorage),Ve(Os,this,r.filterFactory),Ve(tr,this,o),Ve(Bs,this,l||null),Ve(Ns,this,c),Ve(Ds,this,u),Ve(Ls,this,h),Ve(Qs,this,d||null),this.viewParameters={realScale:fi.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=!1!==p}destroy(){var t,e,n,i,s,r,a,o;null===(t=Be(or,this))||void 0===t||t.resolve(),Ve(or,this,null),null===(e=Be(ys,this))||void 0===e||e.abort(),Ve(ys,this,null),this._signal=null;for(const l of Be(_s,this).values())l.destroy();Be(_s,this).clear(),Be(bs,this).clear(),Be(Ps,this).clear(),null===(n=Be(Xs,this))||void 0===n||n.clear(),Ve(ws,this,null),Be(Js,this).clear(),Be(ks,this).destroy(),null===(i=Be(Es,this))||void 0===i||i.destroy(),null===(s=Be(Zs,this))||void 0===s||s.destroy(),null===(r=Be(js,this))||void 0===r||r.hide(),Ve(js,this,null),null===(a=Be(Ks,this))||void 0===a||a.destroy(),Ve(Ks,this,null),Be(Fs,this)&&(clearTimeout(Be(Fs,this)),Ve(Fs,this,null)),Be(sr,this)&&(clearTimeout(Be(sr,this)),Ve(sr,this,null)),null===(o=this._editorUndoBar)||void 0===o||o.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return Be(Qs,this)}get useNewAltTextFlow(){return Be(Ds,this)}get useNewAltTextWhenAddingImage(){return Be(Ls,this)}get hcmFilter(){return qn(this,"hcmFilter",Be(tr,this)?Be(Os,this).addHCMFilter(Be(tr,this).foreground,Be(tr,this).background):"none")}get direction(){return qn(this,"direction",getComputedStyle(Be(rr,this)).direction)}get highlightColors(){return qn(this,"highlightColors",Be(Bs,this)?new Map(Be(Bs,this).split(",").map((t=>t.split("=").map((t=>t.trim()))))):null)}get highlightColorNames(){return qn(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,(t=>t.reverse()))):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),Ve(Ts,this,t)}setMainHighlightColorPicker(t){Ve(Ks,this,t)}editAltText(t){var e;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===(e=Be(Es,this))||void 0===e||e.editAltText(this,t,n)}getSignature(t){var e;null===(e=Be(Zs,this))||void 0===e||e.getSignature({uiManager:this,editor:t})}get signatureManager(){return Be(Zs,this)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference(t){let{name:e,value:n}=t;if("enableNewAltTextWhenAddingImage"===e)Ve(Ls,this,n)}onPageChanging(t){let{pageNumber:e}=t;Ve(xs,this,e-1)}focusMainContainer(){Be(rr,this).focus()}findParent(t,e){for(const n of Be(_s,this).values()){const{x:i,y:s,width:r,height:a}=n.div.getBoundingClientRect();if(t>=i&&t<=i+r&&e>=s&&e<=s+a)return n}return null}disableUserSelect(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Be(ar,this).classList.toggle("noUserSelect",t)}addShouldRescale(t){Be(Ps,this).add(t)}removeShouldRescale(t){Be(Ps,this).delete(t)}onScaleChanging(t){var e;let{scale:n}=t;this.commitOrRemove(),this.viewParameters.realScale=n*fi.PDF_TO_CSS_UNITS;for(const i of Be(Ps,this))i.onScaleChanging();null===(e=Be(Ts,this))||void 0===e||e.onScaleChanging()}onRotationChanging(t){let{pagesRotation:e}=t;this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:r}=e,a=e.toString(),o=Fe(lr,this,ur).call(this,e).closest(".textLayer"),l=this.getSelectionBoxes(o);if(!l)return;e.empty();const c=Fe(lr,this,hr).call(this,o),u=Be(Ys,this)===gn.NONE,h=()=>{null===c||void 0===c||c.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:l,anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:r,text:a}),u&&this.showAllEditors("highlight",!0,!0)};u?this.switchToMode(gn.HIGHLIGHT,h):h()}addToAnnotationStorage(t){t.isEmpty()||!Be(As,this)||Be(As,this).has(t.id)||Be(As,this).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,Be(Vs,this)&&(Ve(Vs,this,!1),Fe(lr,this,pr).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of Be(Js,this))if(e.div.contains(t)){Ve(Gs,this,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!Be(Gs,this))return;const[t,e]=Be(Gs,this);Ve(Gs,this,null),e.addEventListener("focusin",(()=>{t._focusEventsAllowed=!0}),{once:!0,signal:this._signal}),e.focus()}addEditListeners(){Fe(lr,this,yr).call(this),Fe(lr,this,br).call(this)}removeEditListeners(){Fe(lr,this,wr).call(this),Fe(lr,this,_r).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of Be(Ms,this))if(n.isHandlingMimeForPasting(e))return t.dataTransfer.dropEffect="copy",void t.preventDefault()}drop(t){for(const e of t.dataTransfer.items)for(const n of Be(Ms,this))if(n.isHandlingMimeForPasting(e.type))return n.paste(e,this.currentLayer),void t.preventDefault()}copy(t){var e;if(t.preventDefault(),null===(e=Be(ws,this))||void 0===e||e.commitOrRemove(),!this.hasSelection)return;const n=[];for(const i of Be(Js,this)){const t=i.serialize(!0);t&&n.push(t)}0!==n.length&&t.clipboardData.setData("application/pdfjs",JSON.stringify(n))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const t of Be(Ms,this))if(t.isHandlingMimeForPasting(r.type))return void t.paste(r,this.currentLayer);let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(s){return void Vn('paste: "'.concat(s.message,'".'))}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const t=[];for(const r of n){const e=await i.deserialize(r);if(!e)return;t.push(e)}const e=()=>{for(const e of t)Fe(lr,this,Tr).call(this,e);Fe(lr,this,Rr).call(this,t)},s=()=>{for(const e of t)e.remove()};this.addCommands({cmd:e,undo:s,mustExec:!0})}catch(s){Vn('paste: "'.concat(s.message,'".'))}}keydown(t){this.isShiftKeyDown||"Shift"!==t.key||(this.isShiftKeyDown=!0),Be(Ys,this)===gn.NONE||this.isEditorHandlingKeyboard||cr._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&"Shift"===t.key&&(this.isShiftKeyDown=!1,Be(Vs,this)&&(Ve(Vs,this,!1),Fe(lr,this,pr).call(this,"main_toolbar")))}onEditingAction(t){let{name:e}=t;switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu")}}setEditingState(t){t?(Fe(lr,this,mr).call(this),Fe(lr,this,br).call(this),Fe(lr,this,Ar).call(this,{isEditing:Be(Ys,this)!==gn.NONE,isEmpty:Fe(lr,this,Ir).call(this),hasSomethingToUndo:Be(ks,this).hasSomethingToUndo(),hasSomethingToRedo:Be(ks,this).hasSomethingToRedo(),hasSelectedEditor:!1})):(Fe(lr,this,vr).call(this),Fe(lr,this,_r).call(this),Fe(lr,this,Ar).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!Be(Ms,this)){Ve(Ms,this,t);for(const t of Be(Ms,this))Fe(lr,this,Sr).call(this,t.defaultPropertiesToUpdate)}}getId(){return Be(Ws,this).id}get currentLayer(){return Be(_s,this).get(Be(xs,this))}getLayer(t){return Be(_s,this).get(t)}get currentPageIndex(){return Be(xs,this)}addLayer(t){Be(_s,this).set(t.pageIndex,t),Be(zs,this)?t.enable():t.disable()}removeLayer(t){Be(_s,this).delete(t.pageIndex)}async updateMode(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Be(Ys,this)!==t&&(!Be(or,this)||(await Be(or,this).promise,Be(or,this)))){var s,r;if(Ve(or,this,Promise.withResolvers()),null===(e=Be(Ts,this))||void 0===e||e.commitOrRemove(),Ve(Ys,this,t),t===gn.NONE)return this.setEditingState(!1),Fe(lr,this,Cr).call(this),null===(s=this._editorUndoBar)||void 0===s||s.hide(),void Be(or,this).resolve();if(t===gn.SIGNATURE)await(null===(r=Be(Zs,this))||void 0===r?void 0:r.loadSignatures());this.setEditingState(!0),await Fe(lr,this,kr).call(this),this.unselectAll();for(const e of Be(_s,this).values())e.updateMode(t);if(!n)return i&&this.addNewEditorFromKeyboard(),void Be(or,this).resolve();for(const t of Be(bs,this).values())t.annotationElementId===n||t.id===n?(this.setSelected(t),t.enterInEditMode()):t.unselect();Be(or,this).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==Be(Ys,this)&&this._eventBus.dispatch("switchannotationeditormode",l({source:this},t))}updateParams(t,e){var n;if(Be(Ms,this)){switch(t){case mn.CREATE:return void this.currentLayer.addNewEditor(e);case mn.HIGHLIGHT_DEFAULT_COLOR:null===(n=Be(Ks,this))||void 0===n||n.updateColor(e);break;case mn.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(Be(er,this)||Ve(er,this,new Map)).set(t,e),this.showAllEditors("highlight",e)}for(const n of Be(Js,this))n.updateParams(t,e);for(const n of Be(Ms,this))n.updateDefaultParams(t,e)}}showAllEditors(t,e){var n,i;for(const s of Be(bs,this).values())s.editorType===t&&s.show(e);(null===(n=null===(i=Be(er,this))||void 0===i?void 0:i.get(mn.HIGHLIGHT_SHOW_ALL))||void 0===n||n)!==e&&Fe(lr,this,Sr).call(this,[[mn.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(Be(Hs,this)!==t){Ve(Hs,this,t);for(const e of Be(_s,this).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const n of Be(bs,this).values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return Be(bs,this).get(t)}addEditor(t){Be(bs,this).set(t.id,t)}removeEditor(t){var e,n;(t.div.contains(document.activeElement)&&(Be(Fs,this)&&clearTimeout(Be(Fs,this)),Ve(Fs,this,setTimeout((()=>{this.focusMainContainer(),Ve(Fs,this,null)}),0))),Be(bs,this).delete(t.id),t.annotationElementId)&&(null===(e=Be(Xs,this))||void 0===e||e.delete(t.annotationElementId));(this.unselect(t),t.annotationElementId&&Be(Is,this).has(t.annotationElementId))||(null===(n=Be(As,this))||void 0===n||n.remove(t.id))}addDeletedAnnotationElement(t){Be(Is,this).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return Be(Is,this).has(t)}removeDeletedAnnotationElement(t){Be(Is,this).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){Be(ws,this)!==t&&(Ve(ws,this,t),t&&Fe(lr,this,Sr).call(this,t.propertiesToUpdate))}updateUI(t){Ue(lr,this,xr)===t&&Fe(lr,this,Sr).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){Fe(lr,this,Sr).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(Be(Js,this).has(t))return Be(Js,this).delete(t),t.unselect(),void Fe(lr,this,Ar).call(this,{hasSelectedEditor:this.hasSelection});Be(Js,this).add(t),t.select(),Fe(lr,this,Sr).call(this,t.propertiesToUpdate),Fe(lr,this,Ar).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;null===(e=Be(Ts,this))||void 0===e||e.commitOrRemove();for(const n of Be(Js,this))n!==t&&n.unselect();Be(Js,this).clear(),Be(Js,this).add(t),t.select(),Fe(lr,this,Sr).call(this,t.propertiesToUpdate),Fe(lr,this,Ar).call(this,{hasSelectedEditor:!0})}isSelected(t){return Be(Js,this).has(t)}get firstSelectedEditor(){return Be(Js,this).values().next().value}unselect(t){t.unselect(),Be(Js,this).delete(t),Fe(lr,this,Ar).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==Be(Js,this).size}get isEnterHandled(){return 1===Be(Js,this).size&&this.firstSelectedEditor.isEnterHandled}undo(){var t;Be(ks,this).undo(),Fe(lr,this,Ar).call(this,{hasSomethingToUndo:Be(ks,this).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Fe(lr,this,Ir).call(this)}),null===(t=this._editorUndoBar)||void 0===t||t.hide()}redo(){Be(ks,this).redo(),Fe(lr,this,Ar).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:Be(ks,this).hasSomethingToRedo(),isEmpty:Fe(lr,this,Ir).call(this)})}addCommands(t){Be(ks,this).add(t),Fe(lr,this,Ar).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Fe(lr,this,Ir).call(this)})}cleanUndoStack(t){Be(ks,this).cleanType(t)}delete(){var t;this.commitOrRemove();const e=null===(t=this.currentLayer)||void 0===t?void 0:t.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const n=e?[e]:[...Be(Js,this)],i=()=>{for(const t of n)Fe(lr,this,Tr).call(this,t)};this.addCommands({cmd:()=>{var t;null===(t=this._editorUndoBar)||void 0===t||t.show(i,1===n.length?n[0].editorType:n.length);for(const e of n)e.remove()},undo:i,mustExec:!0})}commitOrRemove(){var t;null===(t=Be(ws,this))||void 0===t||t.commitOrRemove()}hasSomethingToControl(){return Be(ws,this)||this.hasSelection}selectAll(){for(const t of Be(Js,this))t.commit();Fe(lr,this,Rr).call(this,Be(bs,this).values())}unselectAll(){var t;if((!Be(ws,this)||(Be(ws,this).commitOrRemove(),Be(Ys,this)===gn.NONE))&&(null===(t=Be(Ts,this))||void 0===t||!t.commitOrRemove())&&this.hasSelection){for(const t of Be(Js,this))t.unselect();Be(Js,this).clear(),Fe(lr,this,Ar).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]||this.commitOrRemove(),!this.hasSelection)return;Be(ir,this)[0]+=t,Be(ir,this)[1]+=e;const[n,i]=Be(ir,this),s=[...Be(Js,this)];Be(sr,this)&&clearTimeout(Be(sr,this)),Ve(sr,this,setTimeout((()=>{Ve(sr,this,null),Be(ir,this)[0]=Be(ir,this)[1]=0,this.addCommands({cmd:()=>{for(const t of s)Be(bs,this).has(t.id)&&(t.translateInPage(n,i),t.translationDone())},undo:()=>{for(const t of s)Be(bs,this).has(t.id)&&(t.translateInPage(-n,-i),t.translationDone())},mustExec:!1})}),1e3));for(const r of s)r.translateInPage(t,e),r.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Ve(Rs,this,new Map);for(const t of Be(Js,this))Be(Rs,this).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!Be(Rs,this))return!1;this.disableUserSelect(!1);const t=Be(Rs,this);Ve(Rs,this,null);let e=!1;for(const[{x:i,y:s,pageIndex:r},a]of t)a.newX=i,a.newY=s,a.newPageIndex=r,e||(e=i!==a.savedX||s!==a.savedY||r!==a.savedPageIndex);if(!e)return!1;const n=(t,e,n,i)=>{if(Be(bs,this).has(t.id)){const s=Be(_s,this).get(i);s?t._setParentAndPosition(s,e,n):(t.pageIndex=i,t.x=e,t.y=n)}};return this.addCommands({cmd:()=>{for(const[e,{newX:i,newY:s,newPageIndex:r}]of t)n(e,i,s,r)},undo:()=>{for(const[e,{savedX:i,savedY:s,savedPageIndex:r}]of t)n(e,i,s,r)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(Be(Rs,this))for(const n of Be(Rs,this).keys())n.drag(t,e)}rebuild(t){if(null===t.parent){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return(null===(t=this.getActive())||void 0===t?void 0:t.shouldGetKeyboardEvents())||1===Be(Js,this).size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return Be(ws,this)===t}getActive(){return Be(ws,this)}getMode(){return Be(Ys,this)}get imageManager(){return qn(this,"imageManager",new os)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let l=0,c=e.rangeCount;l<c;l++)if(!t.contains(e.getRangeAt(l).commonAncestorContainer))return null;const{x:n,y:i,width:s,height:r}=t.getBoundingClientRect();let a;switch(t.getAttribute("data-main-rotation")){case"90":a=(t,e,a,o)=>({x:(e-i)/r,y:1-(t+a-n)/s,width:o/r,height:a/s});break;case"180":a=(t,e,a,o)=>({x:1-(t+a-n)/s,y:1-(e+o-i)/r,width:a/s,height:o/r});break;case"270":a=(t,e,a,o)=>({x:1-(e+o-i)/r,y:(t-n)/s,width:o/r,height:a/s});break;default:a=(t,e,a,o)=>({x:(t-n)/s,y:(e-i)/r,width:a/s,height:o/r})}const o=[];for(let l=0,c=e.rangeCount;l<c;l++){const t=e.getRangeAt(l);if(!t.collapsed)for(const{x:e,y:n,width:i,height:s}of t.getClientRects())0!==i&&0!==s&&o.push(a(e,n,i,s))}return 0===o.length?null:o}addChangedExistingAnnotation(t){let{annotationElementId:e,id:n}=t;(Be(Ss,this)||Ve(Ss,this,new Map)).set(e,n)}removeChangedExistingAnnotation(t){var e;let{annotationElementId:n}=t;null===(e=Be(Ss,this))||void 0===e||e.delete(n)}renderAnnotationElement(t){var e;const n=null===(e=Be(Ss,this))||void 0===e?void 0:e.get(t.data.id);if(!n)return;const i=Be(As,this).getRawValue(n);i&&(Be(Ys,this)!==gn.NONE||i.hasBeenModified)&&i.renderAnnotationElement(t)}setMissingCanvas(t,e,n){var i;const s=null===(i=Be(Xs,this))||void 0===i?void 0:i.get(t);s&&(s.setCanvas(e,n),Be(Xs,this).delete(t))}addMissingCanvas(t,e){(Be(Xs,this)||Ve(Xs,this,new Map)).set(t,e)}}function ur(t){let{anchorNode:e}=t;return e.nodeType===Node.TEXT_NODE?e.parentElement:e}function hr(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of Be(_s,this).values())if(n.hasTextLayer(t))return n;return null}function dr(){const t=document.getSelection();if(!t||t.isCollapsed)return;const e=Fe(lr,this,ur).call(this,t).closest(".textLayer"),n=this.getSelectionBoxes(e);n&&(Be(js,this)||Ve(js,this,new Yi(this)),Be(js,this).show(e,n,"ltr"===this.direction))}function fr(){var t;const e=document.getSelection();if(!e||e.isCollapsed){var n;if(Be($s,this))null===(n=Be(js,this))||void 0===n||n.hide(),Ve($s,this,null),Fe(lr,this,Ar).call(this,{hasSelectedText:!1});return}const{anchorNode:i}=e;if(i===Be($s,this))return;const s=Fe(lr,this,ur).call(this,e).closest(".textLayer");var r;if(s){if(null===(t=Be(js,this))||void 0===t||t.hide(),Ve($s,this,i),Fe(lr,this,Ar).call(this,{hasSelectedText:!0}),(Be(Ys,this)===gn.HIGHLIGHT||Be(Ys,this)===gn.NONE)&&(Be(Ys,this)===gn.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),Ve(Vs,this,this.isShiftKeyDown),!this.isShiftKeyDown)){const t=Be(Ys,this)===gn.HIGHLIGHT?Fe(lr,this,hr).call(this,s):null;null===t||void 0===t||t.toggleDrawing();const e=new AbortController,n=this.combinedSignal(e),i=n=>{"pointerup"===n.type&&0!==n.button||(e.abort(),null===t||void 0===t||t.toggleDrawing(!0),"pointerup"===n.type&&Fe(lr,this,pr).call(this,"main_toolbar"))};window.addEventListener("pointerup",i,{signal:n}),window.addEventListener("blur",i,{signal:n})}}else Be($s,this)&&(null===(r=Be(js,this))||void 0===r||r.hide(),Ve($s,this,null),Fe(lr,this,Ar).call(this,{hasSelectedText:!1}))}function pr(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Be(Ys,this)===gn.HIGHLIGHT?this.highlightSelection(t):Be(Ns,this)&&Fe(lr,this,dr).call(this)}function gr(){document.addEventListener("selectionchange",Fe(lr,this,fr).bind(this),{signal:this._signal})}function mr(){if(Be(Us,this))return;Ve(Us,this,new AbortController);const t=this.combinedSignal(Be(Us,this));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}function vr(){var t;null===(t=Be(Us,this))||void 0===t||t.abort(),Ve(Us,this,null)}function yr(){if(Be(qs,this))return;Ve(qs,this,new AbortController);const t=this.combinedSignal(Be(qs,this));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}function wr(){var t;null===(t=Be(qs,this))||void 0===t||t.abort(),Ve(qs,this,null)}function br(){if(Be(Cs,this))return;Ve(Cs,this,new AbortController);const t=this.combinedSignal(Be(Cs,this));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}function _r(){var t;null===(t=Be(Cs,this))||void 0===t||t.abort(),Ve(Cs,this,null)}function Er(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}function Ar(t){Object.entries(t).some((t=>{let[e,n]=t;return Be(nr,this)[e]!==n}))&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(Be(nr,this),t)}),Be(Ys,this)===gn.HIGHLIGHT&&!1===t.hasSelectedEditor&&Fe(lr,this,Sr).call(this,[[mn.HIGHLIGHT_FREE,!0]]))}function Sr(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}async function kr(){if(!Be(zs,this)){Ve(zs,this,!0);const t=[];for(const e of Be(_s,this).values())t.push(e.enable());await Promise.all(t);for(const e of Be(bs,this).values())e.enable()}}function Cr(){if(this.unselectAll(),Be(zs,this)){Ve(zs,this,!1);for(const t of Be(_s,this).values())t.disable();for(const t of Be(bs,this).values())t.disable()}}function Tr(t){const e=Be(_s,this).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}function xr(t){let e=null;for(e of Be(Js,t));return e}function Ir(){if(0===Be(bs,this).size)return!0;if(1===Be(bs,this).size)for(const t of Be(bs,this).values())return t.isEmpty();return!1}function Rr(t){for(const e of Be(Js,this))e.unselect();Be(Js,this).clear();for(const e of t)e.isEmpty()||(Be(Js,this).add(e),e.select());Fe(lr,this,Ar).call(this,{hasSelectedEditor:this.hasSelection})}a(cr,"TRANSLATE_SMALL",1),a(cr,"TRANSLATE_BIG",10);var Mr=new WeakMap,Pr=new WeakMap,Nr=new WeakMap,Dr=new WeakMap,Lr=new WeakMap,Or=new WeakMap,Fr=new WeakMap,Ur=new WeakMap,Br=new WeakMap,Vr=new WeakMap,jr=new WeakMap,Wr=new WeakMap,zr=new WeakSet;class Hr{constructor(t){Le(this,zr),Oe(this,Mr,null),Oe(this,Pr,!1),Oe(this,Nr,null),Oe(this,Dr,null),Oe(this,Lr,null),Oe(this,Or,null),Oe(this,Fr,!1),Oe(this,Ur,null),Oe(this,Br,null),Oe(this,Vr,null),Oe(this,jr,null),Oe(this,Wr,!1),Ve(Br,this,t),Ve(Wr,this,t._uiManager.useNewAltTextFlow),Kr._||(Kr._=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){var e;null!==(e=Hr._l10n)&&void 0!==e||(Hr._l10n=t)}async render(){const t=Ve(Nr,this,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=Ve(Dr,this,document.createElement("span"));t.append(e),Be(Wr,this)?(t.classList.add("new"),t.setAttribute("data-l10n-id",Kr._.missing),e.setAttribute("data-l10n-id",Kr._["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=Be(Br,this)._uiManager._signal;t.addEventListener("contextmenu",_i,{signal:n}),t.addEventListener("pointerdown",(t=>t.stopPropagation()),{signal:n});const i=t=>{t.preventDefault(),Be(Br,this)._uiManager.editAltText(Be(Br,this)),Be(Wr,this)&&Be(Br,this)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:Ue(zr,this,qr)}})};return t.addEventListener("click",i,{capture:!0,signal:n}),t.addEventListener("keydown",(e=>{e.target===t&&"Enter"===e.key&&(Ve(Fr,this,!0),i(e))}),{signal:n}),await Fe(zr,this,Gr).call(this),t}finish(){Be(Nr,this)&&(Be(Nr,this).focus({focusVisible:Be(Fr,this)}),Ve(Fr,this,!1))}isEmpty(){return Be(Wr,this)?null===Be(Mr,this):!Be(Mr,this)&&!Be(Pr,this)}hasData(){return Be(Wr,this)?null!==Be(Mr,this)||!!Be(Vr,this):this.isEmpty()}get guessedText(){return Be(Vr,this)}async setGuessedText(t){null===Be(Mr,this)&&(Ve(Vr,this,t),Ve(jr,this,await Hr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),Fe(zr,this,Gr).call(this))}toggleAltTextBadge(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e;if(!Be(Wr,this)||Be(Mr,this))return null===(e=Be(Ur,this))||void 0===e||e.remove(),void Ve(Ur,this,null);if(!Be(Ur,this)){const t=Ve(Ur,this,document.createElement("div"));t.className="noAltTextBadge",Be(Br,this).div.append(t)}Be(Ur,this).classList.toggle("hidden",!t)}serialize(t){let e=Be(Mr,this);return t||Be(Vr,this)!==e||(e=Be(jr,this)),{altText:e,decorative:Be(Pr,this),guessedText:Be(Vr,this),textWithDisclaimer:Be(jr,this)}}get data(){return{altText:Be(Mr,this),decorative:Be(Pr,this)}}set data(t){let{altText:e,decorative:n,guessedText:i,textWithDisclaimer:s,cancel:r=!1}=t;i&&(Ve(Vr,this,i),Ve(jr,this,s)),Be(Mr,this)===e&&Be(Pr,this)===n||(r||(Ve(Mr,this,e),Ve(Pr,this,n)),Fe(zr,this,Gr).call(this))}toggle(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Be(Nr,this)&&(!t&&Be(Or,this)&&(clearTimeout(Be(Or,this)),Ve(Or,this,null)),Be(Nr,this).disabled=!t)}shown(){Be(Br,this)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:Ue(zr,this,qr)}})}destroy(){var t,e;null===(t=Be(Nr,this))||void 0===t||t.remove(),Ve(Nr,this,null),Ve(Dr,this,null),Ve(Lr,this,null),null===(e=Be(Ur,this))||void 0===e||e.remove(),Ve(Ur,this,null)}}function qr(t){return(Be(Mr,t)?"added":null===Be(Mr,t)&&t.guessedText&&"review")||"missing"}async function Gr(){const t=Be(Nr,this);if(!t)return;if(Be(Wr,this)){var e,n;if(t.classList.toggle("done",!!Be(Mr,this)),t.setAttribute("data-l10n-id",Kr._[Ue(zr,this,qr)]),null===(e=Be(Dr,this))||void 0===e||e.setAttribute("data-l10n-id",Kr._["".concat(Ue(zr,this,qr),"-label")]),!Be(Mr,this))return void(null===(n=Be(Lr,this))||void 0===n||n.remove())}else{var i;if(!Be(Mr,this)&&!Be(Pr,this))return t.classList.remove("done"),void(null===(i=Be(Lr,this))||void 0===i||i.remove());t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let s=Be(Lr,this);if(!s){Ve(Lr,this,s=document.createElement("span")),s.className="tooltip",s.setAttribute("role","tooltip"),s.id="alt-text-tooltip-".concat(Be(Br,this).id);const e=100,n=Be(Br,this)._uiManager._signal;n.addEventListener("abort",(()=>{clearTimeout(Be(Or,this)),Ve(Or,this,null)}),{once:!0}),t.addEventListener("mouseenter",(()=>{Ve(Or,this,setTimeout((()=>{Ve(Or,this,null),Be(Lr,this).classList.add("show"),Be(Br,this)._reportTelemetry({action:"alt_text_tooltip"})}),e))}),{signal:n}),t.addEventListener("mouseleave",(()=>{var t;Be(Or,this)&&(clearTimeout(Be(Or,this)),Ve(Or,this,null)),null===(t=Be(Lr,this))||void 0===t||t.classList.remove("show")}),{signal:n})}Be(Pr,this)?s.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(s.removeAttribute("data-l10n-id"),s.textContent=Be(Mr,this)),s.parentNode||t.append(s);const r=Be(Br,this).getElementForAltText();null===r||void 0===r||r.setAttribute("aria-describedby",s.id)}var Kr={_:null};a(Hr,"_l10n",null);var Xr=new WeakMap,Qr=new WeakMap,Yr=new WeakMap,Jr=new WeakMap,$r=new WeakMap,Zr=new WeakMap,ta=new WeakMap,ea=new WeakMap,na=new WeakMap,ia=new WeakMap,sa=new WeakMap,ra=new WeakMap,aa=new WeakSet;class oa{constructor(t){let{container:e,isPinchingDisabled:n=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:a=null,signal:o}=t;Le(this,aa),Oe(this,Xr,void 0),Oe(this,Qr,!1),Oe(this,Yr,null),Oe(this,Jr,void 0),Oe(this,$r,void 0),Oe(this,Zr,void 0),Oe(this,ta,void 0),Oe(this,ea,null),Oe(this,na,void 0),Oe(this,ia,null),Oe(this,sa,void 0),Oe(this,ra,null),Ve(Xr,this,e),Ve(Yr,this,i),Ve(Jr,this,n),Ve($r,this,s),Ve(Zr,this,r),Ve(ta,this,a),Ve(sa,this,new AbortController),Ve(na,this,AbortSignal.any([o,Be(sa,this).signal])),e.addEventListener("touchstart",Fe(aa,this,la).bind(this),{passive:!1,signal:Be(na,this)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ii.pixelRatio}destroy(){var t,e;null===(t=Be(sa,this))||void 0===t||t.abort(),Ve(sa,this,null),null===(e=Be(ea,this))||void 0===e||e.abort(),Ve(ea,this,null)}}function la(t){var e,n;if(null!==(e=Be(Jr,this))&&void 0!==e&&e.call(this))return;if(1===t.touches.length){if(Be(ea,this))return;const t=Ve(ea,this,new AbortController),e=AbortSignal.any([Be(na,this),t.signal]),n=Be(Xr,this),i={capture:!0,signal:e,passive:!1},s=t=>{var e;"touch"===t.pointerType&&(null===(e=Be(ea,this))||void 0===e||e.abort(),Ve(ea,this,null))};return n.addEventListener("pointerdown",(t=>{"touch"===t.pointerType&&(Ei(t),s(t))}),i),n.addEventListener("pointerup",s,i),void n.addEventListener("pointercancel",s,i)}if(!Be(ra,this)){var i;Ve(ra,this,new AbortController);const t=AbortSignal.any([Be(na,this),Be(ra,this).signal]),e=Be(Xr,this),n={signal:t,capture:!1,passive:!1};e.addEventListener("touchmove",Fe(aa,this,ca).bind(this),n);const s=Fe(aa,this,ua).bind(this);e.addEventListener("touchend",s,n),e.addEventListener("touchcancel",s,n),n.capture=!0,e.addEventListener("pointerdown",Ei,n),e.addEventListener("pointermove",Ei,n),e.addEventListener("pointercancel",Ei,n),e.addEventListener("pointerup",Ei,n),null===(i=Be($r,this))||void 0===i||i.call(this)}if(Ei(t),2!==t.touches.length||null!==(n=Be(Yr,this))&&void 0!==n&&n.call(this))return void Ve(ia,this,null);let[s,r]=t.touches;s.identifier>r.identifier&&([s,r]=[r,s]),Ve(ia,this,{touch0X:s.screenX,touch0Y:s.screenY,touch1X:r.screenX,touch1Y:r.screenY})}function ca(t){var e;if(!Be(ia,this)||2!==t.touches.length)return;Ei(t);let[n,i]=t.touches;n.identifier>i.identifier&&([n,i]=[i,n]);const{screenX:s,screenY:r}=n,{screenX:a,screenY:o}=i,l=Be(ia,this),{touch0X:c,touch0Y:u,touch1X:h,touch1Y:d}=l,f=h-c,p=d-u,g=a-s,m=o-r,v=Math.hypot(g,m)||1,y=Math.hypot(f,p)||1;if(!Be(Qr,this)&&Math.abs(y-v)<=He.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=r,l.touch1X=a,l.touch1Y=o,!Be(Qr,this))return void Ve(Qr,this,!0);const w=[(s+a)/2,(r+o)/2];null===(e=Be(Zr,this))||void 0===e||e.call(this,w,y,v)}function ua(t){if(!(t.touches.length>=2)){var e;if(Be(ra,this))Be(ra,this).abort(),Ve(ra,this,null),null===(e=Be(ta,this))||void 0===e||e.call(this);Be(ia,this)&&(Ei(t),Ve(ia,this,null),Ve(Qr,this,!1))}}He=oa;var ha=new WeakMap,da=new WeakMap,fa=new WeakMap,pa=new WeakMap,ga=new WeakMap,ma=new WeakMap,va=new WeakMap,ya=new WeakMap,wa=new WeakMap,ba=new WeakMap,_a=new WeakMap,Ea=new WeakMap,Aa=new WeakMap,Sa=new WeakMap,ka=new WeakMap,Ca=new WeakMap,Ta=new WeakMap,xa=new WeakMap,Ia=new WeakMap,Ra=new WeakMap,Ma=new WeakMap,Pa=new WeakMap,Na=new WeakMap,Da=new WeakMap,La=new WeakSet;class Oa{static get _resizerKeyboardManager(){const t=Oa.prototype._resizeWithKeyboard,e=cr.TRANSLATE_SMALL,n=cr.TRANSLATE_BIG;return qn(this,"_resizerKeyboardManager",new gs([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],Oa.prototype._stopResizingWithKeyboard]]))}constructor(t){Le(this,La),Oe(this,ha,null),Oe(this,da,null),Oe(this,fa,null),Oe(this,pa,!1),Oe(this,ga,null),Oe(this,ma,""),Oe(this,va,!1),Oe(this,ya,null),Oe(this,wa,null),Oe(this,ba,null),Oe(this,_a,null),Oe(this,Ea,""),Oe(this,Aa,!1),Oe(this,Sa,null),Oe(this,ka,!1),Oe(this,Ca,!1),Oe(this,Ta,!1),Oe(this,xa,null),Oe(this,Ia,0),Oe(this,Ra,0),Oe(this,Ma,null),Oe(this,Pa,null),a(this,"isSelected",!1),a(this,"_isCopy",!1),a(this,"_editToolbar",null),a(this,"_initialOptions",Object.create(null)),a(this,"_initialData",null),a(this,"_isVisible",!0),a(this,"_uiManager",null),a(this,"_focusEventsAllowed",!0),Oe(this,Na,!1),Oe(this,Da,Oa._zIndex++),this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:r}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[s,r];const[o,l]=this.parentDimensions;this.x=t.x/o,this.y=t.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return qn(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new no({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){var n;if(null!==(n=Oa._l10n)&&void 0!==n||(Oa._l10n=t),Oa._l10nResizer||(Oa._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),-1!==Oa._borderLineWidth)return;const i=getComputedStyle(document.documentElement);Oa._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){jn("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return Be(Na,this)}set _isDraggable(t){var e;Ve(Na,this,t),null===(e=this.div)||void 0===e||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(2*t),this.y+=this.width*t/(2*e);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(2*t),this.y-=this.width*t/(2*e);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=Be(Da,this)}setParent(t){null!==t?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):Fe(La,this,eo).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(Be(Aa,this)?Ve(Aa,this,!1):this.parent.setSelected(this))}focusout(t){var e;if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const n=t.relatedTarget;null!==n&&void 0!==n&&n.closest("#".concat(this.id))||(t.preventDefault(),null!==(e=this.parent)&&void 0!==e&&e.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,i){const[s,r]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(t+n)/s,this.y=(e+i)/r,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[n,i]=this.parentDimensions;this.setAt(t*n,e*i,this.width*n,this.height*i),this._onTranslated()}translate(t,e){Fe(La,this,Fa).call(this,this.parentDimensions,t,e)}translateInPage(t,e){Be(Sa,this)||Ve(Sa,this,[this.x,this.y,this.width,this.height]),Fe(La,this,Fa).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){Be(Sa,this)||Ve(Sa,this,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[i,s]}=this;if(this.x+=t/i,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:t,y:e}=this.div.getBoundingClientRect();this.parent.findNewParent(this,t,e)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:r,y:a}=this;const[o,l]=this.getBaseTranslation();r+=o,a+=l;const{style:c}=n;c.left="".concat((100*r).toFixed(2),"%"),c.top="".concat((100*a).toFixed(2),"%"),this._onTranslating(r,a),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!Be(Sa,this)&&(Be(Sa,this)[0]!==this.x||Be(Sa,this)[1]!==this.y)}get _hasBeenResized(){return!!Be(Sa,this)&&(Be(Sa,this)[2]!==this.width||Be(Sa,this)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=Oa,i=n/t,s=n/e;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.rotation;const{div:{style:e},pageDimensions:[n,i]}=this;let{x:s,y:r,width:a,height:o}=this;if(a*=n,o*=i,s*=n,r*=i,this._mustFixPosition)switch(t){case 0:s=ui(s,0,n-a),r=ui(r,0,i-o);break;case 90:s=ui(s,0,n-o),r=ui(r,a,i);break;case 180:s=ui(s,a,n),r=ui(r,o,i);break;case 270:s=ui(s,o,n),r=ui(r,0,i-a)}this.x=s/=n,this.y=r/=i;const[l,c]=this.getBaseTranslation();s+=l,r+=c,e.left="".concat((100*s).toFixed(2),"%"),e.top="".concat((100*r).toFixed(2),"%"),this.moveInDOM()}screenToPageTranslation(t,e){return Ua.call(Oa,t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Ua.call(Oa,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,i]=this.parentDimensions,{style:s}=this.div;s.width="".concat((100*t/n).toFixed(2),"%"),Be(va,this)||(s.height="".concat((100*e/i).toFixed(2),"%"))}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,i=n.endsWith("%"),s=!Be(va,this)&&e.endsWith("%");if(i&&s)return;const[r,a]=this.parentDimensions;i||(t.width="".concat((100*parseFloat(n)/r).toFixed(2),"%")),Be(va,this)||s||(t.height="".concat((100*parseFloat(e)/a).toFixed(2),"%"))}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(1e4*t)/1e4}_onResizing(){}altTextFinish(){var t;null===(t=Be(fa,this))||void 0===t||t.finish()}async addEditToolbar(){return this._editToolbar||Be(Ca,this)||(this._editToolbar=new Ui(this),this.div.append(this._editToolbar.render()),Be(fa,this)&&await this._editToolbar.addAltText(Be(fa,this))),this._editToolbar}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,null===(t=Be(fa,this))||void 0===t||t.destroy())}addContainer(t){var e;const n=null===(e=this._editToolbar)||void 0===e?void 0:e.div;n?n.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){Be(fa,this)||(Hr.initialize(Oa._l10n),Ve(fa,this,new Hr(this)),Be(ha,this)&&(Be(fa,this).data=Be(ha,this),Ve(ha,this,null)),await this.addEditToolbar())}get altTextData(){var t;return null===(t=Be(fa,this))||void 0===t?void 0:t.data}set altTextData(t){Be(fa,this)&&(Be(fa,this).data=t)}get guessedAltText(){var t;return null===(t=Be(fa,this))||void 0===t?void 0:t.guessedText}async setGuessedAltText(t){var e;await(null===(e=Be(fa,this))||void 0===e?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return null===(e=Be(fa,this))||void 0===e?void 0:e.serialize(t)}hasAltText(){return!!Be(fa,this)&&!Be(fa,this).isEmpty()}hasAltTextData(){var t,e;return null!==(t=null===(e=Be(fa,this))||void 0===e?void 0:e.hasData())&&void 0!==t&&t}render(){var t;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=Be(pa,this)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),Fe(La,this,Ya).call(this);const[n,i]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth="".concat((100*i/n).toFixed(2),"%"),e.style.maxHeight="".concat((100*n/i).toFixed(2),"%"));const[s,r]=this.getInitialTranslation();return this.translate(s,r),ts(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(Be(Pa,this)||Ve(Pa,this,new oa({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:Fe(La,this,qa).bind(this),onPinching:Fe(La,this,Ga).bind(this),onPinchEnd:Fe(La,this,Ka).bind(this),signal:this._uiManager._signal}))),null===(t=this._uiManager._editorUndoBar)||void 0===t||t.hide(),e}pointerdown(t){const{isMac:e}=ei.platform;0!==t.button||t.ctrlKey&&e?t.preventDefault():(Ve(Aa,this,!0),this._isDraggable?Fe(La,this,Qa).call(this,t):Fe(La,this,Xa).call(this,t))}_onStartDragging(){}_onStopDragging(){}moveInDOM(){Be(xa,this)&&clearTimeout(Be(xa,this)),Ve(xa,this,setTimeout((()=>{var t;Ve(xa,this,null),null===(t=this.parent)||void 0===t||t.moveEditorInDOM(this)}),0))}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotation;const i=this.parentScale,[s,r]=this.pageDimensions,[a,o]=this.pageTranslation,l=t/i,c=e/i,u=this.x*s,h=this.y*r,d=this.width*s,f=this.height*r;switch(n){case 0:return[u+l+a,r-h-c-f+o,u+l+d+a,r-h-c+o];case 90:return[u+c+a,r-h+l+o,u+c+f+a,r-h+l+d+o];case 180:return[u-l-d+a,r-h+c+o,u-l+a,r-h+c+f+o];case 270:return[u-c-f+a,r-h-l-d+o,u-c+a,r-h-l+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,i,s,r]=t,a=s-n,o=r-i;switch(this.rotation){case 0:return[n,e-r,a,o];case 90:return[n,e-i,o,a];case 180:return[s,e-i,a,o];case 270:return[s,e-r,o,a];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return!this.isInEditMode()&&(this.parent.setEditingState(!1),Ve(Ca,this,!0),!0)}disableEditMode(){return!!this.isInEditMode()&&(this.parent.setEditingState(!0),Ve(Ca,this,!1),!0)}isInEditMode(){return Be(Ca,this)}shouldGetKeyboardEvents(){return Be(Ta,this)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:r}=window;return e<r&&i>0&&t<s&&n>0}rebuild(){Fe(La,this,Ya).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:(null===(t=this._initialData)||void 0===t?void 0:t.popupRef)||""}}serialize(){jn("An editor must be serializable")}static async deserialize(t,e,n){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n});i.rotation=t.rotation,Ve(ha,i,t.accessibilityData),i._isCopy=t.isCopy||!1;const[s,r]=i.pageDimensions,[a,o,l,c]=i.getRectInCurrentCoords(t.rect,r);return i.x=a/s,i.y=o/r,i.width=l/s,i.height=c/r,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){var t,e;if(null===(t=Be(_a,this))||void 0===t||t.abort(),Ve(_a,this,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),Be(xa,this)&&(clearTimeout(Be(xa,this)),Ve(xa,this,null)),Fe(La,this,eo).call(this),this.removeEditToolbar(),Be(Ma,this)){for(const t of Be(Ma,this).values())clearTimeout(t);Ve(Ma,this,null)}this.parent=null,null===(e=Be(Pa,this))||void 0===e||e.destroy(),Ve(Pa,this,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Fe(La,this,Va).call(this),Be(ya,this).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||"Enter"!==t.key)return;this._uiManager.setSelected(this),Ve(ba,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=Be(ya,this).children;if(!Be(da,this)){Ve(da,this,Array.from(e));const t=Fe(La,this,Ja).bind(this),n=Fe(La,this,$a).bind(this),i=this._uiManager._signal;for(const e of Be(da,this)){const s=e.getAttribute("data-resizer-name");e.setAttribute("role","spinbutton"),e.addEventListener("keydown",t,{signal:i}),e.addEventListener("blur",n,{signal:i}),e.addEventListener("focus",Fe(La,this,Za).bind(this,s),{signal:i}),e.setAttribute("data-l10n-id",Oa._l10nResizer[s])}}const n=Be(da,this)[0];let i=0;for(const r of e){if(r===n)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(Be(da,this).length/4);if(s!==i){if(s<i)for(let e=0;e<i-s;e++)Be(ya,this).append(Be(ya,this).firstChild);else if(s>i)for(let e=0;e<s-i;e++)Be(ya,this).firstChild.before(Be(ya,this).lastChild);let t=0;for(const n of e){const e=Be(da,this)[t++].getAttribute("data-resizer-name");n.setAttribute("data-l10n-id",Oa._l10nResizer[e])}}Fe(La,this,to).call(this,0),Ve(Ta,this,!0),Be(ya,this).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){Be(Ta,this)&&Fe(La,this,Ha).call(this,Be(Ea,this),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){Fe(La,this,eo).call(this),this.div.focus()}select(){var t,e,n;this.isSelected&&this._editToolbar||(this.isSelected=!0,this.makeResizable(),null===(t=this.div)||void 0===t||t.classList.add("selectedEditor"),this._editToolbar?(null===(e=this._editToolbar)||void 0===e||e.show(),null===(n=Be(fa,this))||void 0===n||n.toggleAltTextBadge(!1)):this.addEditToolbar().then((()=>{var t,e;null!==(t=this.div)&&void 0!==t&&t.classList.contains("selectedEditor")&&(null===(e=this._editToolbar)||void 0===e||e.show())})))}unselect(){var t,e,n,i,s;this.isSelected&&(this.isSelected=!1,null===(t=Be(ya,this))||void 0===t||t.classList.add("hidden"),null===(e=this.div)||void 0===e||e.classList.remove("selectedEditor"),null!==(n=this.div)&&void 0!==n&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),null===(i=this._editToolbar)||void 0===i||i.hide(),null===(s=Be(fa,this))||void 0===s||s.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return Be(ka,this)}set isEditing(t){Ve(ka,this,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){Ve(va,this,!0);const n=t/e,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){Be(Ma,this)||Ve(Ma,this,new Map);const{action:e}=t;let n=Be(Ma,this).get(e);return n&&clearTimeout(n),n=setTimeout((()=>{this._reportTelemetry(t),Be(Ma,this).delete(e),0===Be(Ma,this).size&&Ve(Ma,this,null)}),Oa._telemetryTimeout),void Be(Ma,this).set(e,n)}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),Ve(pa,this,!1)}disable(){this.div&&(this.div.tabIndex=-1),Ve(pa,this,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(e){if("CANVAS"===e.nodeName){const t=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.before(e)}}else e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);return e}resetAnnotationElement(t){const{firstChild:e}=t.container;"DIV"===(null===e||void 0===e?void 0:e.nodeName)&&e.classList.contains("annotationContent")&&e.remove()}}function Fa(t,e,n){let[i,s]=t;[e,n]=this.screenToPageTranslation(e,n),this.x+=e/i,this.y+=n/s,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}function Ua(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}function Ba(t){switch(t){case 90:{const[t,e]=this.pageDimensions;return[0,-t/e,e/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,e]=this.pageDimensions;return[0,t/e,-e/t,0]}default:return[1,0,0,1]}}function Va(){if(Be(ya,this))return;Ve(ya,this,document.createElement("div")),Be(ya,this).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const t=document.createElement("div");Be(ya,this).append(t),t.classList.add("resizer",n),t.setAttribute("data-resizer-name",n),t.addEventListener("pointerdown",Fe(La,this,ja).bind(this,n),{signal:e}),t.addEventListener("contextmenu",_i,{signal:e}),t.tabIndex=-1}this.div.prepend(Be(ya,this))}function ja(t,e){var n;e.preventDefault();const{isMac:i}=ei.platform;if(0!==e.button||e.ctrlKey&&i)return;null===(n=Be(fa,this))||void 0===n||n.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,Ve(wa,this,[e.screenX,e.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",Fe(La,this,Ha).bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Ei,{passive:!1,signal:a}),window.addEventListener("contextmenu",_i,{signal:a}),Ve(ba,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const c=()=>{var t;r.abort(),this.parent.togglePointerEvents(!0),null===(t=Be(fa,this))||void 0===t||t.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=o,this.div.style.cursor=l,Fe(La,this,za).call(this)};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})}function Wa(t,e,n,i){this.width=n,this.height=i,this.x=t,this.y=e;const[s,r]=this.parentDimensions;this.setDims(s*n,r*i),this.fixAndSetPosition(),this._onResized()}function za(){if(!Be(ba,this))return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:i}=Be(ba,this);Ve(ba,this,null);const s=this.x,r=this.y,a=this.width,o=this.height;s===t&&r===e&&a===n&&o===i||this.addCommands({cmd:Fe(La,this,Wa).bind(this,s,r,a,o),undo:Fe(La,this,Wa).bind(this,t,e,n,i),mustExec:!0})}function Ha(t,e){const[n,i]=this.parentDimensions,s=this.x,r=this.y,a=this.width,o=this.height,l=qe.MIN_SIZE/n,c=qe.MIN_SIZE/i,u=Fe(La,this,Ba).call(this,this.rotation),h=(t,e)=>[u[0]*t+u[2]*e,u[1]*t+u[3]*e],d=Fe(La,this,Ba).call(this,360-this.rotation);let f,p,g=!1,m=!1;switch(t){case"topLeft":g=!0,f=(t,e)=>[0,0],p=(t,e)=>[t,e];break;case"topMiddle":f=(t,e)=>[t/2,0],p=(t,e)=>[t/2,e];break;case"topRight":g=!0,f=(t,e)=>[t,0],p=(t,e)=>[0,e];break;case"middleRight":m=!0,f=(t,e)=>[t,e/2],p=(t,e)=>[0,e/2];break;case"bottomRight":g=!0,f=(t,e)=>[t,e],p=(t,e)=>[0,0];break;case"bottomMiddle":f=(t,e)=>[t/2,e],p=(t,e)=>[t/2,0];break;case"bottomLeft":g=!0,f=(t,e)=>[0,e],p=(t,e)=>[t,0];break;case"middleLeft":m=!0,f=(t,e)=>[0,e/2],p=(t,e)=>[t,e/2]}const v=f(a,o),y=p(a,o);let w=h(...y);const b=qe._round(s+w[0]),_=qe._round(r+w[1]);let E,A,S=1,k=1;if(e.fromKeyboard)({deltaX:E,deltaY:A}=e);else{const{screenX:t,screenY:n}=e,[i,s]=Be(wa,this);[E,A]=this.screenToPageTranslation(t-i,n-s),Be(wa,this)[0]=t,Be(wa,this)[1]=n}if([E,A]=((t,e)=>[d[0]*t+d[2]*e,d[1]*t+d[3]*e])(E/n,A/i),g){const t=Math.hypot(a,o);S=k=Math.max(Math.min(Math.hypot(y[0]-v[0]-E,y[1]-v[1]-A)/t,1/a,1/o),l/a,c/o)}else m?S=ui(Math.abs(y[0]-v[0]-E),l,1)/a:k=ui(Math.abs(y[1]-v[1]-A),c,1)/o;const C=qe._round(a*S),T=qe._round(o*k);w=h(...p(C,T));const x=b-w[0],I=_-w[1];Be(Sa,this)||Ve(Sa,this,[this.x,this.y,this.width,this.height]),this.width=C,this.height=T,this.x=x,this.y=I,this.setDims(n*C,i*T),this.fixAndSetPosition(),this._onResizing()}function qa(){var t;Ve(ba,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),null===(t=Be(fa,this))||void 0===t||t.toggle(!1),this.parent.togglePointerEvents(!1)}function Ga(t,e,n){let i=n/e*.7+1-.7;if(1===i)return;const s=Fe(La,this,Ba).call(this,this.rotation),r=(t,e)=>[s[0]*t+s[2]*e,s[1]*t+s[3]*e],[a,o]=this.parentDimensions,l=this.x,c=this.y,u=this.width,h=this.height,d=qe.MIN_SIZE/a,f=qe.MIN_SIZE/o;i=Math.max(Math.min(i,1/u,1/h),d/u,f/h);const p=qe._round(u*i),g=qe._round(h*i);if(p===u&&g===h)return;Be(Sa,this)||Ve(Sa,this,[l,c,u,h]);const m=r(u/2,h/2),v=qe._round(l+m[0]),y=qe._round(c+m[1]),w=r(p/2,g/2);this.x=v-w[0],this.y=y-w[1],this.width=p,this.height=g,this.setDims(a*p,o*g),this.fixAndSetPosition(),this._onResizing()}function Ka(){var t;null===(t=Be(fa,this))||void 0===t||t.toggle(!0),this.parent.togglePointerEvents(!0),Fe(La,this,za).call(this)}function Xa(t){const{isMac:e}=ei.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}function Qa(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),r={capture:!0,passive:!1,signal:s},a=t=>{i.abort(),Ve(ga,this,null),Ve(Aa,this,!1),this._uiManager.endDragSession()||Fe(La,this,Xa).call(this,t),n&&this._onStopDragging()};e&&(Ve(Ia,this,t.clientX),Ve(Ra,this,t.clientY),Ve(ga,this,t.pointerId),Ve(ma,this,t.pointerType),window.addEventListener("pointermove",(t=>{n||(n=!0,this._onStartDragging());const{clientX:e,clientY:i,pointerId:s}=t;if(s!==Be(ga,this))return void Ei(t);const[r,a]=this.screenToPageTranslation(e-Be(Ia,this),i-Be(Ra,this));Ve(Ia,this,e),Ve(Ra,this,i),this._uiManager.dragSelectedEditors(r,a)}),r),window.addEventListener("touchmove",Ei,r),window.addEventListener("pointerdown",(t=>{t.pointerType===Be(ma,this)&&(Be(Pa,this)||t.isPrimary)&&a(t),Ei(t)}),r));const o=t=>{Be(ga,this)&&Be(ga,this)!==t.pointerId?Ei(t):a(t)};window.addEventListener("pointerup",o,{signal:s}),window.addEventListener("blur",o,{signal:s})}function Ya(){if(Be(_a,this)||!this.div)return;Ve(_a,this,new AbortController);const t=this._uiManager.combinedSignal(Be(_a,this));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}function Ja(t){qe._resizerKeyboardManager.exec(this,t)}function $a(t){var e;Be(Ta,this)&&(null===(e=t.relatedTarget)||void 0===e?void 0:e.parentNode)!==Be(ya,this)&&Fe(La,this,eo).call(this)}function Za(t){Ve(Ea,this,Be(Ta,this)?t:"")}function to(t){if(Be(da,this))for(const e of Be(da,this))e.tabIndex=t}function eo(){Ve(Ta,this,!1),Fe(La,this,to).call(this,-1),Fe(La,this,za).call(this)}qe=Oa,a(Oa,"_l10n",null),a(Oa,"_l10nResizer",null),a(Oa,"_borderLineWidth",-1),a(Oa,"_colorManager",new vs),a(Oa,"_zIndex",1),a(Oa,"_telemetryTimeout",1e3);class no extends Oa{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const io=3285377520,so=4294901760,ro=65535;class ao{constructor(t){this.h1=t?4294967295&t:io,this.h2=t?4294967295&t:io}update(t){let e,n;if("string"===typeof t){e=new Uint8Array(2*t.length),n=0;for(let i=0,s=t.length;i<s;i++){const s=t.charCodeAt(i);s<=255?e[n++]=s:(e[n++]=s>>>8,e[n++]=255&s)}}else{if(!ArrayBuffer.isView(t))throw new Error("Invalid data format, must be a string or TypedArray.");e=t.slice(),n=e.byteLength}const i=n>>2,s=n-4*i,r=new Uint32Array(e.buffer,0,i);let a=0,o=0,l=this.h1,c=this.h2;const u=3432918353,h=461845907,d=11601,f=13715;for(let p=0;p<i;p++)1&p?(a=r[p],a=a*u&so|a*d&ro,a=a<<15|a>>>17,a=a*h&so|a*f&ro,l^=a,l=l<<13|l>>>19,l=5*l+3864292196):(o=r[p],o=o*u&so|o*d&ro,o=o<<15|o>>>17,o=o*h&so|o*f&ro,c^=o,c=c<<13|c>>>19,c=5*c+3864292196);switch(a=0,s){case 3:a^=e[4*i+2]<<16;case 2:a^=e[4*i+1]<<8;case 1:a^=e[4*i],a=a*u&so|a*d&ro,a=a<<15|a>>>17,a=a*h&so|a*f&ro,1&i?l^=a:c^=a}this.h1=l,this.h2=c}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=3981806797*t&so|36045*t&ro,e=4283543511*e&so|(2950163797*(e<<16|t>>>16)&so)>>>16,t^=e>>>1,t=444984403*t&so|60499*t&ro,e=3301882366*e&so|(3120437893*(e<<16|t>>>16)&so)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const oo=Object.freeze({map:null,hash:"",transfer:void 0});var lo=new WeakMap,co=new WeakMap,uo=new WeakMap,ho=new WeakSet;class fo{constructor(){Le(this,ho),Oe(this,lo,!1),Oe(this,co,null),Oe(this,uo,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=Be(uo,this).get(t);return void 0===n?e:Object.assign(e,n)}getRawValue(t){return Be(uo,this).get(t)}remove(t){if(Be(uo,this).delete(t),0===Be(uo,this).size&&this.resetModified(),"function"===typeof this.onAnnotationEditor){for(const t of Be(uo,this).values())if(t instanceof Oa)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=Be(uo,this).get(t);let i=!1;if(void 0!==n)for(const[s,r]of Object.entries(e))n[s]!==r&&(i=!0,n[s]=r);else i=!0,Be(uo,this).set(t,e);i&&Fe(ho,this,po).call(this),e instanceof Oa&&"function"===typeof this.onAnnotationEditor&&this.onAnnotationEditor(e.constructor._type)}has(t){return Be(uo,this).has(t)}get size(){return Be(uo,this).size}resetModified(){Be(lo,this)&&(Ve(lo,this,!1),"function"===typeof this.onResetModified&&this.onResetModified())}get print(){return new mo(this)}get serializable(){if(0===Be(uo,this).size)return oo;const t=new Map,e=new ao,n=[],i=Object.create(null);let s=!1;for(const[r,a]of Be(uo,this)){const n=a instanceof Oa?a.serialize(!1,i):a;n&&(t.set(r,n),e.update("".concat(r,":").concat(JSON.stringify(n))),s||(s=!!n.bitmap))}if(s)for(const r of t.values())r.bitmap&&n.push(r.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:oo}get editorStats(){let t=null;const e=new Map;for(const s of Be(uo,this).values()){var n;if(!(s instanceof Oa))continue;const r=s.telemetryFinalData;if(!r)continue;const{type:a}=r;e.has(a)||e.set(a,Object.getPrototypeOf(s).constructor),t||(t=Object.create(null));const o=(n=t)[a]||(n[a]=new Map);for(const[t,e]of Object.entries(r)){var i;if("type"===t)continue;let n=o.get(t);n||(n=new Map,o.set(t,n));const s=null!==(i=n.get(e))&&void 0!==i?i:0;n.set(e,s+1)}}for(const[s,r]of e)t[s]=r.computeTelemetryFinalData(t[s]);return t}resetModifiedIds(){Ve(co,this,null)}get modifiedIds(){if(Be(co,this))return Be(co,this);const t=[];for(const e of Be(uo,this).values())e instanceof Oa&&e.annotationElementId&&e.serialize()&&t.push(e.annotationElementId);return Ve(co,this,{ids:new Set(t),hash:t.join(",")})}[Symbol.iterator](){return Be(uo,this).entries()}}function po(){Be(lo,this)||(Ve(lo,this,!0),"function"===typeof this.onSetModified&&this.onSetModified())}var go=new WeakMap;class mo extends fo{constructor(t){super(),Oe(this,go,void 0);const{map:e,hash:n,transfer:i}=t.serializable,s=structuredClone(e,i?{transfer:i}:null);Ve(go,this,{map:s,hash:n,transfer:i})}get print(){jn("Should not call PrintAnnotationStorage.print")}get serializable(){return Be(go,this)}get modifiedIds(){return qn(this,"modifiedIds",{ids:new Set,hash:""})}}var vo=new WeakMap;class yo{constructor(t){let{ownerDocument:e=globalThis.document,styleElement:n=null}=t;Oe(this,vo,new Set),this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),Be(vo,this).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(t){let{systemFontInfo:e,disableFontFace:n,_inspectFont:i}=t;if(e&&!Be(vo,this).has(e.loadedName))if(Wn(!n,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:t,src:n,style:r}=e,a=new FontFace(t,n,r);this.addNativeFontFace(a);try{await a.load(),Be(vo,this).add(t),null===i||void 0===i||i(e)}catch(s){Vn("Cannot load system font: ".concat(e.baseFontName,", installing it could help to improve PDF rendering.")),this.removeNativeFontFace(a)}}else jn("Not implemented: loadSystemFont without the Font Loading API.")}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo)return void await this.loadSystemFont(t);if(this.isFontLoadingAPISupported){const e=t.createNativeFontFace();if(e){this.addNativeFontFace(e);try{await e.loaded}catch(n){throw Vn("Failed to load font '".concat(e.family,"': '").concat(n,"'.")),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise((e=>{const n=this._queueLoadingCallback(e);this._prepareFontLoadEvent(t,n)}))}}get isFontLoadingAPISupported(){var t;return qn(this,"isFontLoadingAPISupported",!(null===(t=this._document)||void 0===t||!t.fonts))}get isSyncFontLoadingSupported(){return qn(this,"isSyncFontLoadingSupported",nn||ei.platform.isFirefox)}_queueLoadingCallback(t){const{loadingRequests:e}=this,n={done:!1,complete:function(){for(Wn(!n.done,"completeRequest() cannot be called twice."),n.done=!0;e.length>0&&e[0].done;){const t=e.shift();setTimeout(t.callback,0)}},callback:t};return e.push(n),n}get _loadTestFont(){return qn(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(t,e){function n(t,e){return t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|255&t.charCodeAt(e+3)}function i(t,e,n,i){return t.substring(0,e)+i+t.substring(e+n)}let s,r;const a=this._document.createElement("canvas");a.width=1,a.height=1;const o=a.getContext("2d");let l=0;const c="lt".concat(Date.now()).concat(this.loadTestFontId++);let u=this._loadTestFont;u=i(u,976,c.length,c);const h=1482184792;let d=n(u,16);for(s=0,r=c.length-3;s<r;s+=4)d=d-h+n(c,s)|0;var f;s<c.length&&(d=d-h+n(c+"XXX",s)|0),u=i(u,16,4,(f=d,String.fromCharCode(f>>24&255,f>>16&255,f>>8&255,255&f)));const p="url(data:font/opentype;base64,".concat(btoa(u),");"),g='@font-face {font-family:"'.concat(c,'";src:').concat(p,"}");this.insertRule(g);const m=this._document.createElement("div");m.style.visibility="hidden",m.style.width=m.style.height="10px",m.style.position="absolute",m.style.top=m.style.left="0px";for(const v of[t.loadedName,c]){const t=this._document.createElement("span");t.textContent="Hi",t.style.fontFamily=v,m.append(t)}this._document.body.append(m),function t(e,n){if(++l>30)return Vn("Load test font never loaded."),void n();o.font="30px "+e,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0?n():setTimeout(t.bind(null,e,n))}(c,(()=>{m.remove(),e.complete()}))}}class wo{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this._inspectFont=e}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(this.cssFontInfo){const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style="oblique ".concat(this.cssFontInfo.italicAngle,"deg")),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}else e=new FontFace(this.loadedName,this.data,{});return null===(t=this._inspectFont)||void 0===t||t.call(this,this),e}createFontFaceRule(){var t;if(!this.data||this.disableFontFace)return null;const e="url(data:".concat(this.mimetype,";base64,").concat(hi(this.data),");");let n;if(this.cssFontInfo){let t="font-weight: ".concat(this.cssFontInfo.fontWeight,";");this.cssFontInfo.italicAngle&&(t+="font-style: oblique ".concat(this.cssFontInfo.italicAngle,"deg;")),n='@font-face {font-family:"'.concat(this.cssFontInfo.fontFamily,'";').concat(t,"src:").concat(e,"}")}else n='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(e,"}");return null===(t=this._inspectFont)||void 0===t||t.call(this,this,e),n}getPathGenerator(t,e){if(void 0!==this.compiledGlyphs[e])return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let i;try{i=t.get(n)}catch(r){Vn('getPathGenerator - ignoring character: "'.concat(r,'".'))}const s=new Path2D(i||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=s}}function bo(t){if("string"!==typeof t)return null;if(t.endsWith("/"))return t;throw new Error('Invalid factory url: "'.concat(t,'" must include trailing slash.'))}const _o=t=>"object"===typeof t&&Number.isInteger(null===t||void 0===t?void 0:t.num)&&t.num>=0&&Number.isInteger(null===t||void 0===t?void 0:t.gen)&&t.gen>=0,Eo=function(t,e,n){if(!Array.isArray(n)||n.length<2)return!1;const[i,s,...r]=n;if(!t(i)&&!Number.isInteger(i))return!1;if(!e(s))return!1;const a=r.length;let o=!0;switch(s.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return 0===a;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(4!==a)return!1;o=!1;break;default:return!1}for(const l of r)if(!("number"===typeof l||o&&null===l))return!1;return!0}.bind(null,_o,(t=>"object"===typeof t&&"string"===typeof(null===t||void 0===t?void 0:t.name)));var Ao=new WeakMap,So=new WeakMap;class ko{constructor(){Oe(this,Ao,new Map),Oe(this,So,Promise.resolve())}postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};Be(So,this).then((()=>{for(const[t]of Be(Ao,this))t.call(this,n)}))}addEventListener(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=null;if((null===n||void 0===n?void 0:n.signal)instanceof AbortSignal){const{signal:s}=n;if(s.aborted)return void Vn("LoopbackPort - cannot use an `aborted` signal.");const r=()=>this.removeEventListener(t,e);i=()=>s.removeEventListener("abort",r),s.addEventListener("abort",r)}Be(Ao,this).set(e,i)}removeEventListener(t,e){const n=Be(Ao,this).get(e);null===n||void 0===n||n(),Be(Ao,this).delete(e)}terminate(){for(const[,t]of Be(Ao,this))null===t||void 0===t||t();Be(Ao,this).clear()}}const Co=1,To=2,xo=1,Io=2,Ro=3,Mo=4,Po=5,No=6,Do=7,Lo=8;function Oo(){}function Fo(t){if(t instanceof $n||t instanceof Qn||t instanceof Kn||t instanceof Yn||t instanceof Xn)return t;switch(t instanceof Error||"object"===typeof t&&null!==t||jn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),t.name){case"AbortException":return new $n(t.message);case"InvalidPDFException":return new Qn(t.message);case"PasswordException":return new Kn(t.message,t.code);case"ResponseException":return new Yn(t.message,t.status,t.missing);case"UnknownErrorException":return new Xn(t.message,t.details)}return new Xn(t.message,t.toString())}var Uo=new WeakMap,Bo=new WeakSet;class Vo{constructor(t,e,n){Le(this,Bo),Oe(this,Uo,new AbortController),this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",Fe(Bo,this,jo).bind(this),{signal:Be(Uo,this).signal})}on(t,e){const n=this.actionHandler;if(n[t])throw new Error('There is already an actionName called "'.concat(t,'"'));n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},n)}catch(r){s.reject(r)}return s.promise}sendWithStream(t,e,n,i){const s=this.streamId++,r=this.sourceName,a=this.targetName,o=this.comObj;return new ReadableStream({start:n=>{const l=Promise.withResolvers();return this.streamControllers[s]={controller:n,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:r,targetName:a,action:t,streamId:s,data:e,desiredSize:n.desiredSize},i),l.promise},pull:t=>{const e=Promise.withResolvers();return this.streamControllers[s].pullCall=e,o.postMessage({sourceName:r,targetName:a,stream:No,streamId:s,desiredSize:t.desiredSize}),e.promise},cancel:t=>{Wn(t instanceof Error,"cancel must have a valid reason");const e=Promise.withResolvers();return this.streamControllers[s].cancelCall=e,this.streamControllers[s].isClosed=!0,o.postMessage({sourceName:r,targetName:a,stream:xo,streamId:s,reason:Fo(t)}),e.promise}},n)}destroy(){var t;null===(t=Be(Uo,this))||void 0===t||t.abort(),Ve(Uo,this,null)}}function jo(t){let{data:e}=t;if(e.targetName!==this.sourceName)return;if(e.stream)return void Fe(Bo,this,zo).call(this,e);if(e.callback){const t=e.callbackId,n=this.callbackCapabilities[t];if(!n)throw new Error("Cannot resolve callback ".concat(t));if(delete this.callbackCapabilities[t],e.callback===Co)n.resolve(e.data);else{if(e.callback!==To)throw new Error("Unexpected callback case");n.reject(Fo(e.reason))}return}const n=this.actionHandler[e.action];if(!n)throw new Error("Unknown action from worker: ".concat(e.action));if(e.callbackId){const t=this.sourceName,i=e.sourceName,s=this.comObj;Promise.try(n,e.data).then((function(n){s.postMessage({sourceName:t,targetName:i,callback:Co,callbackId:e.callbackId,data:n})}),(function(n){s.postMessage({sourceName:t,targetName:i,callback:To,callbackId:e.callbackId,reason:Fo(n)})}))}else e.streamId?Fe(Bo,this,Wo).call(this,e):n(e.data)}function Wo(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,s=this.comObj,r=this,a=this.actionHandler[t.action],o={enqueue(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const o=this.desiredSize;this.desiredSize-=r,o>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:i,stream:Mo,streamId:e,chunk:t},a)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:Ro,streamId:e}),delete r.streamSinks[e])},error(t){Wn(t instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:Po,streamId:e,reason:Fo(t)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[e]=o,Promise.try(a,t.data,o).then((function(){s.postMessage({sourceName:n,targetName:i,stream:Lo,streamId:e,success:!0})}),(function(t){s.postMessage({sourceName:n,targetName:i,stream:Lo,streamId:e,reason:Fo(t)})}))}function zo(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,s=this.comObj,r=this.streamControllers[e],a=this.streamSinks[e];switch(t.stream){case Lo:t.success?r.startCall.resolve():r.startCall.reject(Fo(t.reason));break;case Do:t.success?r.pullCall.resolve():r.pullCall.reject(Fo(t.reason));break;case No:if(!a){s.postMessage({sourceName:n,targetName:i,stream:Do,streamId:e,success:!0});break}a.desiredSize<=0&&t.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=t.desiredSize,Promise.try(a.onPull||Oo).then((function(){s.postMessage({sourceName:n,targetName:i,stream:Do,streamId:e,success:!0})}),(function(t){s.postMessage({sourceName:n,targetName:i,stream:Do,streamId:e,reason:Fo(t)})}));break;case Mo:if(Wn(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(t.chunk);break;case Ro:if(Wn(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),Fe(Bo,this,Ho).call(this,r,e);break;case Po:Wn(r,"error should have stream controller"),r.controller.error(Fo(t.reason)),Fe(Bo,this,Ho).call(this,r,e);break;case Io:t.success?r.cancelCall.resolve():r.cancelCall.reject(Fo(t.reason)),Fe(Bo,this,Ho).call(this,r,e);break;case xo:if(!a)break;const o=Fo(t.reason);Promise.try(a.onCancel||Oo,o).then((function(){s.postMessage({sourceName:n,targetName:i,stream:Io,streamId:e,success:!0})}),(function(t){s.postMessage({sourceName:n,targetName:i,stream:Io,streamId:e,reason:Fo(t)})})),a.sinkCapability.reject(o),a.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async function Ho(t,e){var n,i,s;await Promise.allSettled([null===(n=t.startCall)||void 0===n?void 0:n.promise,null===(i=t.pullCall)||void 0===i?void 0:i.promise,null===(s=t.cancelCall)||void 0===s?void 0:s.promise]),delete this.streamControllers[e]}var qo=new WeakMap;class Go{constructor(t){let{enableHWA:e=!1}=t;Oe(this,qo,!1),Ve(qo,this,e)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!Be(qo,this)})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){jn("Abstract method `_createCanvas` called.")}}class Ko extends Go{constructor(t){let{ownerDocument:e=globalThis.document,enableHWA:n=!1}=t;super({enableHWA:n}),this._document=e}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class Xo{constructor(t){let{baseUrl:e=null,isCompressed:n=!0}=t;this.baseUrl=e,this.isCompressed=n}async fetch(t){let{name:e}=t;if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const n=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(n).then((t=>({cMapData:t,isCompressed:this.isCompressed}))).catch((t=>{throw new Error("Unable to load ".concat(this.isCompressed?"binary ":"","CMap at: ").concat(n))}))}async _fetch(t){jn("Abstract method `_fetch` called.")}}class Qo extends Xo{async _fetch(t){const e=await pi(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):ti(e)}}class Yo{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,i,s){return"none"}destroy(){}}var Jo=new WeakMap,$o=new WeakMap,Zo=new WeakMap,tl=new WeakMap,el=new WeakMap,nl=new WeakMap,il=new WeakMap,sl=new WeakSet;class rl extends Yo{constructor(t){let{docId:e,ownerDocument:n=globalThis.document}=t;super(),Le(this,sl),Oe(this,Jo,void 0),Oe(this,$o,void 0),Oe(this,Zo,void 0),Oe(this,tl,void 0),Oe(this,el,void 0),Oe(this,nl,void 0),Oe(this,il,0),Ve(tl,this,e),Ve(el,this,n)}addFilter(t){var e,n;if(!t)return"none";let i=Ue(sl,this,al).get(t);if(i)return i;const[s,r,a]=Fe(sl,this,cl).call(this,t),o=1===t.length?s:"".concat(s).concat(r).concat(a);if(i=Ue(sl,this,al).get(o),i)return Ue(sl,this,al).set(t,i),i;const l="g_".concat(Be(tl,this),"_transfer_map_").concat((Ve(il,this,(e=Be(il,this),n=e++,e)),n)),c=Fe(sl,this,ul).call(this,l);Ue(sl,this,al).set(t,c),Ue(sl,this,al).set(o,c);const u=Fe(sl,this,fl).call(this,l);return Fe(sl,this,gl).call(this,s,r,a,u),c}addHCMFilter(t,e){var n;const i="".concat(t,"-").concat(e),s="base";let r=Ue(sl,this,ol).get(s);if((null===(n=r)||void 0===n?void 0:n.key)===i)return r.url;var a;r?(null===(a=r.filter)||void 0===a||a.remove(),r.key=i,r.url="none",r.filter=null):(r={key:i,url:"none",filter:null},Ue(sl,this,ol).set(s,r));if(!t||!e)return r.url;const o=Fe(sl,this,vl).call(this,t);t=ii.makeHexColor(...o);const l=Fe(sl,this,vl).call(this,e);if(e=ii.makeHexColor(...l),Ue(sl,this,ll).style.color="","#000000"===t&&"#ffffff"===e||t===e)return r.url;const c=new Array(256);for(let p=0;p<=255;p++){const t=p/255;c[p]=t<=.03928?t/12.92:((t+.055)/1.055)**2.4}const u=c.join(","),h="g_".concat(Be(tl,this),"_hcm_filter"),d=r.filter=Fe(sl,this,fl).call(this,h);Fe(sl,this,gl).call(this,u,u,u,d),Fe(sl,this,dl).call(this,d);const f=(t,e)=>{const n=o[t]/255,i=l[t]/255,s=new Array(e+1);for(let r=0;r<=e;r++)s[r]=n+r/e*(i-n);return s.join(",")};return Fe(sl,this,gl).call(this,f(0,5),f(1,5),f(2,5),d),r.url=Fe(sl,this,ul).call(this,h),r.url}addAlphaFilter(t){var e,n;let i=Ue(sl,this,al).get(t);if(i)return i;const[s]=Fe(sl,this,cl).call(this,[t]),r="alpha_".concat(s);if(i=Ue(sl,this,al).get(r),i)return Ue(sl,this,al).set(t,i),i;const a="g_".concat(Be(tl,this),"_alpha_map_").concat((Ve(il,this,(e=Be(il,this),n=e++,e)),n)),o=Fe(sl,this,ul).call(this,a);Ue(sl,this,al).set(t,o),Ue(sl,this,al).set(r,o);const l=Fe(sl,this,fl).call(this,a);return Fe(sl,this,ml).call(this,s,l),o}addLuminosityFilter(t){var e,n;let i,s,r=Ue(sl,this,al).get(t||"luminosity");if(r)return r;if(t?([i]=Fe(sl,this,cl).call(this,[t]),s="luminosity_".concat(i)):s="luminosity",r=Ue(sl,this,al).get(s),r)return Ue(sl,this,al).set(t,r),r;const a="g_".concat(Be(tl,this),"_luminosity_map_").concat((Ve(il,this,(e=Be(il,this),n=e++,e)),n)),o=Fe(sl,this,ul).call(this,a);Ue(sl,this,al).set(t,o),Ue(sl,this,al).set(s,o);const l=Fe(sl,this,fl).call(this,a);return Fe(sl,this,hl).call(this,l),t&&Fe(sl,this,ml).call(this,i,l),o}addHighlightHCMFilter(t,e,n,i,s){var r;const a="".concat(e,"-").concat(n,"-").concat(i,"-").concat(s);let o=Ue(sl,this,ol).get(t);if((null===(r=o)||void 0===r?void 0:r.key)===a)return o.url;var l;o?(null===(l=o.filter)||void 0===l||l.remove(),o.key=a,o.url="none",o.filter=null):(o={key:a,url:"none",filter:null},Ue(sl,this,ol).set(t,o));if(!e||!n)return o.url;const[c,u]=[e,n].map(Fe(sl,this,vl).bind(this));let h=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[f,p]=[i,s].map(Fe(sl,this,vl).bind(this));d<h&&([h,d,f,p]=[d,h,p,f]),Ue(sl,this,ll).style.color="";const g=(t,e,n)=>{const i=new Array(256),s=(d-h)/n,r=t/255,a=(e-t)/(255*n);let o=0;for(let l=0;l<=n;l++){const t=Math.round(h+l*s),e=r+l*a;for(let n=o;n<=t;n++)i[n]=e;o=t+1}for(let l=o;l<256;l++)i[l]=i[o-1];return i.join(",")},m="g_".concat(Be(tl,this),"_hcm_").concat(t,"_filter"),v=o.filter=Fe(sl,this,fl).call(this,m);return Fe(sl,this,dl).call(this,v),Fe(sl,this,gl).call(this,g(f[0],p[0],5),g(f[1],p[1],5),g(f[2],p[2],5),v),o.url=Fe(sl,this,ul).call(this,m),o.url}destroy(){var t,e,n,i;arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&null!==(t=Be(nl,this))&&void 0!==t&&t.size||(null===(e=Be(Zo,this))||void 0===e||e.parentNode.parentNode.remove(),Ve(Zo,this,null),null===(n=Be($o,this))||void 0===n||n.clear(),Ve($o,this,null),null===(i=Be(nl,this))||void 0===i||i.clear(),Ve(nl,this,null),Ve(il,this,0))}}function al(t){return Be($o,t)||Ve($o,t,new Map)}function ol(t){return Be(nl,t)||Ve(nl,t,new Map)}function ll(t){if(!Be(Zo,t)){const e=Be(el,t).createElement("div"),{style:n}=e;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const i=Be(el,t).createElementNS(di,"svg");i.setAttribute("width",0),i.setAttribute("height",0),Ve(Zo,t,Be(el,t).createElementNS(di,"defs")),e.append(i),i.append(Be(Zo,t)),Be(el,t).body.append(e)}return Be(Zo,t)}function cl(t){if(1===t.length){const e=t[0],n=new Array(256);for(let t=0;t<256;t++)n[t]=e[t]/255;const i=n.join(",");return[i,i,i]}const[e,n,i]=t,s=new Array(256),r=new Array(256),a=new Array(256);for(let o=0;o<256;o++)s[o]=e[o]/255,r[o]=n[o]/255,a[o]=i[o]/255;return[s.join(","),r.join(","),a.join(",")]}function ul(t){if(void 0===Be(Jo,this)){Ve(Jo,this,"");const t=Be(el,this).URL;t!==Be(el,this).baseURI&&(vi(t)?Vn('#createUrl: ignore "data:"-URL for performance reasons.'):Ve(Jo,this,Hn(t,"")))}return"url(".concat(Be(Jo,this),"#").concat(t,")")}function hl(t){const e=Be(el,this).createElementNS(di,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}function dl(t){const e=Be(el,this).createElementNS(di,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}function fl(t){const e=Be(el,this).createElementNS(di,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),Ue(sl,this,ll).append(e),e}function pl(t,e,n){const i=Be(el,this).createElementNS(di,e);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),t.append(i)}function gl(t,e,n,i){const s=Be(el,this).createElementNS(di,"feComponentTransfer");i.append(s),Fe(sl,this,pl).call(this,s,"feFuncR",t),Fe(sl,this,pl).call(this,s,"feFuncG",e),Fe(sl,this,pl).call(this,s,"feFuncB",n)}function ml(t,e){const n=Be(el,this).createElementNS(di,"feComponentTransfer");e.append(n),Fe(sl,this,pl).call(this,n,"feFuncA",t)}function vl(t){return Ue(sl,this,ll).style.color=t,ki(getComputedStyle(Ue(sl,this,ll)).getPropertyValue("color"))}class yl{constructor(t){let{baseUrl:e=null}=t;this.baseUrl=e}async fetch(t){let{filename:e}=t;if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const n="".concat(this.baseUrl).concat(e);return this._fetch(n).catch((t=>{throw new Error("Unable to load font data at: ".concat(n))}))}async _fetch(t){jn("Abstract method `_fetch` called.")}}class wl extends yl{async _fetch(t){const e=await pi(t,"arraybuffer");return new Uint8Array(e)}}class bl{constructor(t){let{baseUrl:e=null}=t;this.baseUrl=e}async fetch(t){let{filename:e}=t;if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const n="".concat(this.baseUrl).concat(e);return this._fetch(n).catch((t=>{throw new Error("Unable to load wasm data at: ".concat(n))}))}async _fetch(t){jn("Abstract method `_fetch` called.")}}class _l extends bl{async _fetch(t){const e=await pi(t,"arraybuffer");return new Uint8Array(e)}}async function El(t){const e=process.getBuiltinModule("fs"),n=await e.promises.readFile(t);return new Uint8Array(n)}nn&&Vn("Please use the `legacy` build in Node.js environments.");class Al extends Yo{}class Sl extends Go{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire("file:///C:/Users/joelt/Desktop/JOE%20AI/frontend/joe-frontend/node_modules/pdfjs-dist/build/pdf.mjs")("@napi-rs/canvas").createCanvas(t,e)}}class kl extends Xo{async _fetch(t){return El(t)}}class Cl extends yl{async _fetch(t){return El(t)}}class Tl extends bl{async _fetch(t){return El(t)}}const xl="Fill",Il="Stroke",Rl="Shading";function Ml(t,e){if(!e)return;const n=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],n,i),t.clip(s)}class Pl{isModifyingCurrentTransform(){return!1}getPattern(){jn("Abstract method `getPattern` called.")}}class Nl extends Pl{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;"axial"===this._type?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,i){let s;if(i===Il||i===xl){const r=e.current.getClippedPathBoundingBox(i,Ci(t))||[0,0,0,0],a=Math.ceil(r[2]-r[0])||1,o=Math.ceil(r[3]-r[1])||1,l=e.cachedCanvases.getCanvas("pattern",a,o),c=l.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-r[0],-r[1]),n=ii.transform(n,[1,0,0,1,r[0],r[1]]),c.transform(...e.baseTransform),this.matrix&&c.transform(...this.matrix),Ml(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),s=t.createPattern(l.canvas,"no-repeat");const u=new DOMMatrix(n);s.setTransform(u)}else Ml(t,this._bbox),s=this._createGradient(t);return s}}function Dl(t,e,n,i,s,r,a,o){const l=e.coords,c=e.colors,u=t.data,h=4*t.width;let d;l[n+1]>l[i+1]&&(d=n,n=i,i=d,d=r,r=a,a=d),l[i+1]>l[s+1]&&(d=i,i=s,s=d,d=a,a=o,o=d),l[n+1]>l[i+1]&&(d=n,n=i,i=d,d=r,r=a,a=d);const f=(l[n]+e.offsetX)*e.scaleX,p=(l[n+1]+e.offsetY)*e.scaleY,g=(l[i]+e.offsetX)*e.scaleX,m=(l[i+1]+e.offsetY)*e.scaleY,v=(l[s]+e.offsetX)*e.scaleX,y=(l[s+1]+e.offsetY)*e.scaleY;if(p>=y)return;const w=c[r],b=c[r+1],_=c[r+2],E=c[a],A=c[a+1],S=c[a+2],k=c[o],C=c[o+1],T=c[o+2],x=Math.round(p),I=Math.round(y);let R,M,P,N,D,L,O,F;for(let U=x;U<=I;U++){if(U<m){const t=U<p?0:(p-U)/(p-m);R=f-(f-g)*t,M=w-(w-E)*t,P=b-(b-A)*t,N=_-(_-S)*t}else{let t;t=U>y?1:m===y?0:(m-U)/(m-y),R=g-(g-v)*t,M=E-(E-k)*t,P=A-(A-C)*t,N=S-(S-T)*t}let t;t=U<p?0:U>y?1:(p-U)/(p-y),D=f-(f-v)*t,L=w-(w-k)*t,O=b-(b-C)*t,F=_-(_-T)*t;const e=Math.round(Math.min(R,D)),n=Math.round(Math.max(R,D));let i=h*U+4*e;for(let s=e;s<=n;s++)t=(R-s)/(R-D),t<0?t=0:t>1&&(t=1),u[i++]=M-(M-L)*t|0,u[i++]=P-(P-O)*t|0,u[i++]=N-(N-F)*t|0,u[i++]=255}}function Ll(t,e,n){const i=e.coords,s=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(r=0;r<l;r++){let e=r*o;for(let r=0;r<c;r++,e++)Dl(t,n,i[e],i[e+1],i[e+o],s[e],s[e+1],s[e+o]),Dl(t,n,i[e+o+1],i[e+1],i[e+o],s[e+o+1],s[e+1],s[e+o])}break;case"triangles":for(r=0,a=i.length;r<a;r+=3)Dl(t,n,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class Ol extends Pl{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,n){const i=Math.floor(this._bounds[0]),s=Math.floor(this._bounds[1]),r=Math.ceil(this._bounds[2])-i,a=Math.ceil(this._bounds[3])-s,o=Math.min(Math.ceil(Math.abs(r*t[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(a*t[1]*1.1)),3e3),c=r/o,u=a/l,h={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-s,scaleX:1/c,scaleY:1/u},d=o+4,f=l+4,p=n.getCanvas("mesh",d,f),g=p.context,m=g.createImageData(o,l);if(e){const t=m.data;for(let n=0,i=t.length;n<i;n+=4)t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=255}for(const v of this._figures)Ll(m,v,h);g.putImageData(m,2,2);return{canvas:p.canvas,offsetX:i-2*c,offsetY:s-2*u,scaleX:c,scaleY:u}}isModifyingCurrentTransform(){return!0}getPattern(t,e,n,i){Ml(t,this._bbox);const s=new Float32Array(2);if(i===Rl)ii.singularValueDecompose2dScale(Ci(t),s);else if(this.matrix){ii.singularValueDecompose2dScale(this.matrix,s);const[t,n]=s;ii.singularValueDecompose2dScale(e.baseTransform,s),s[0]*=t,s[1]*=n}else ii.singularValueDecompose2dScale(e.baseTransform,s);const r=this._createMeshCanvas(s,i===Rl?null:this._background,e.cachedCanvases);return i!==Rl&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(r.offsetX,r.offsetY),t.scale(r.scaleX,r.scaleY),t.createPattern(r.canvas,"no-repeat")}}class Fl extends Pl{getPattern(){return"hotpink"}}const Ul=1,Bl=2;class Vl{constructor(t,e,n,i){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:i,tilingType:s,color:r,canvasGraphicsFactory:a}=this;let{xstep:o,ystep:l}=this;o=Math.abs(o),l=Math.abs(l),Bn("TilingType: "+s);const c=e[0],u=e[1],h=e[2],d=e[3],f=h-c,p=d-u,g=new Float32Array(2);ii.singularValueDecompose2dScale(this.matrix,g);const[m,v]=g;ii.singularValueDecompose2dScale(this.baseTransform,g);const y=m*g[0],w=v*g[1];let b=f,_=p,E=!1,A=!1;const S=Math.ceil(o*y),k=Math.ceil(l*w);S>=Math.ceil(f*y)?b=o:E=!0,k>=Math.ceil(p*w)?_=l:A=!0;const C=this.getSizeAndScale(b,this.ctx.canvas.width,y),T=this.getSizeAndScale(_,this.ctx.canvas.height,w),x=t.cachedCanvases.getCanvas("pattern",C.size,T.size),I=x.context,R=a.createCanvasGraphics(I);if(R.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(R,i,r),I.translate(-C.scale*c,-T.scale*u),R.transform(C.scale,0,0,T.scale,0,0),I.save(),this.clipBbox(R,c,u,h,d),R.baseTransform=Ci(R.ctx),R.executeOperatorList(n),R.endDrawing(),I.restore(),E||A){const e=x.canvas;E&&(b=o),A&&(_=l);const n=this.getSizeAndScale(b,this.ctx.canvas.width,y),i=this.getSizeAndScale(_,this.ctx.canvas.height,w),s=n.size,r=i.size,a=t.cachedCanvases.getCanvas("pattern-workaround",s,r),h=a.context,d=E?Math.floor(f/o):0,g=A?Math.floor(p/l):0;for(let t=0;t<=d;t++)for(let n=0;n<=g;n++)h.drawImage(e,s*t,r*n,s,r,0,0,s,r);return{canvas:a.canvas,scaleX:n.scale,scaleY:i.scale,offsetX:c,offsetY:u}}return{canvas:x.canvas,scaleX:C.scale,scaleY:T.scale,offsetX:c,offsetY:u}}getSizeAndScale(t,e,n){const i=Math.max(Vl.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*n);return s>=i?s=i:n=s/t,{scale:n,size:s}}clipBbox(t,e,n,i,s){const r=i-e,a=s-n;t.ctx.rect(e,n,r,a),ii.axialAlignedBoundingBox([e,n,i,s],Ci(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const i=t.ctx,s=t.current;switch(e){case Ul:const{fillStyle:t,strokeStyle:r}=this.ctx;i.fillStyle=s.fillColor=t,i.strokeStyle=s.strokeColor=r;break;case Bl:i.fillStyle=i.strokeStyle=n,s.fillColor=s.strokeColor=n;break;default:throw new Jn("Unsupported paint type: ".concat(e))}}isModifyingCurrentTransform(){return!1}getPattern(t,e,n,i){let s=n;i!==Rl&&(s=ii.transform(s,e.baseTransform),this.matrix&&(s=ii.transform(s,this.matrix)));const r=this.createPatternCanvas(e);let a=new DOMMatrix(s);a=a.translate(r.offsetX,r.offsetY),a=a.scale(1/r.scaleX,1/r.scaleY);const o=t.createPattern(r.canvas,"repeat");return o.setTransform(a),o}}function jl(t){let{src:e,srcPos:n=0,dest:i,width:s,height:r,nonBlackColor:a=4294967295,inverseDecode:o=!1}=t;const l=ei.isLittleEndian?4278190080:255,[c,u]=o?[a,l]:[l,a],h=s>>3,d=7&s,f=e.length;i=new Uint32Array(i.buffer);let p=0;for(let g=0;g<r;g++){for(const s=n+h;n<s;n++){const t=n<f?e[n]:255;i[p++]=128&t?u:c,i[p++]=64&t?u:c,i[p++]=32&t?u:c,i[p++]=16&t?u:c,i[p++]=8&t?u:c,i[p++]=4&t?u:c,i[p++]=2&t?u:c,i[p++]=1&t?u:c}if(0===d)continue;const t=n<f?e[n++]:255;for(let e=0;e<d;e++)i[p++]=t&1<<7-e?u:c}return{srcPos:n,destPos:p}}a(Vl,"MAX_PATTERN_SIZE",3e3);const Wl=16,zl=new DOMMatrix,Hl=new Float32Array(2),ql=new Float32Array([1/0,1/0,-1/0,-1/0]);class Gl{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let i;return void 0!==this.cache[t]?(i=this.cache[t],this.canvasFactory.reset(i,e,n)):(i=this.canvasFactory.create(e,n),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Kl(t,e,n,i,s,r,a,o,l,c){const[u,h,d,f,p,g]=Ci(t);if(0===h&&0===d){const m=a*u+p,v=Math.round(m),y=o*f+g,w=Math.round(y),b=(a+l)*u+p,_=Math.abs(Math.round(b)-v)||1,E=(o+c)*f+g,A=Math.abs(Math.round(E)-w)||1;return t.setTransform(Math.sign(u),0,0,Math.sign(f),v,w),t.drawImage(e,n,i,s,r,0,0,_,A),t.setTransform(u,h,d,f,p,g),[_,A]}if(0===u&&0===f){const m=o*d+p,v=Math.round(m),y=a*h+g,w=Math.round(y),b=(o+c)*d+p,_=Math.abs(Math.round(b)-v)||1,E=(a+l)*h+g,A=Math.abs(Math.round(E)-w)||1;return t.setTransform(0,Math.sign(h),Math.sign(d),0,v,w),t.drawImage(e,n,i,s,r,0,0,A,_),t.setTransform(u,h,d,f,p,g),[A,_]}t.drawImage(e,n,i,s,r,a,o,l,c);return[Math.hypot(u,h)*l,Math.hypot(d,f)*c]}class Xl{constructor(t,e){a(this,"alphaIsShape",!1),a(this,"fontSize",0),a(this,"fontSizeScale",1),a(this,"textMatrix",null),a(this,"textMatrixScale",1),a(this,"fontMatrix",sn),a(this,"leading",0),a(this,"x",0),a(this,"y",0),a(this,"lineX",0),a(this,"lineY",0),a(this,"charSpacing",0),a(this,"wordSpacing",0),a(this,"textHScale",1),a(this,"textRenderingMode",vn),a(this,"textRise",0),a(this,"fillColor","#000000"),a(this,"strokeColor","#000000"),a(this,"patternFill",!1),a(this,"patternStroke",!1),a(this,"fillAlpha",1),a(this,"strokeAlpha",1),a(this,"lineWidth",1),a(this,"activeSMask",null),a(this,"transferMaps","none"),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=ql.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xl,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.minMax.slice();if(t===Il){e||jn("Stroke bounding box must include transform."),ii.singularValueDecompose2dScale(e,Hl);const t=Hl[0]*this.lineWidth/2,i=Hl[1]*this.lineWidth/2;n[0]-=t,n[1]-=i,n[2]+=t,n[3]+=i}return n}updateClipFromPath(){const t=ii.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(ql,0)}getClippedPathBoundingBox(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xl,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return ii.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Ql(t,e){if(e instanceof ImageData)return void t.putImageData(e,0,0);const n=e.height,i=e.width,s=n%Wl,r=(n-s)/Wl,a=0===s?r:r+1,o=t.createImageData(i,Wl);let l,c=0;const u=e.data,h=o.data;let d,f,p,g;if(e.kind===An.GRAYSCALE_1BPP){const e=u.byteLength,n=new Uint32Array(h.buffer,0,h.byteLength>>2),g=n.length,m=i+7>>3,v=4294967295,y=ei.isLittleEndian?4278190080:255;for(d=0;d<a;d++){for(p=d<r?Wl:s,l=0,f=0;f<p;f++){const t=e-c;let s=0;const r=t>m?i:8*t-7,a=-8&r;let o=0,h=0;for(;s<a;s+=8)h=u[c++],n[l++]=128&h?v:y,n[l++]=64&h?v:y,n[l++]=32&h?v:y,n[l++]=16&h?v:y,n[l++]=8&h?v:y,n[l++]=4&h?v:y,n[l++]=2&h?v:y,n[l++]=1&h?v:y;for(;s<r;s++)0===o&&(h=u[c++],o=128),n[l++]=h&o?v:y,o>>=1}for(;l<g;)n[l++]=0;t.putImageData(o,0,d*Wl)}}else if(e.kind===An.RGBA_32BPP){for(f=0,g=i*Wl*4,d=0;d<r;d++)h.set(u.subarray(c,c+g)),c+=g,t.putImageData(o,0,f),f+=Wl;d<a&&(g=i*s*4,h.set(u.subarray(c,c+g)),t.putImageData(o,0,f))}else{if(e.kind!==An.RGB_24BPP)throw new Error("bad image kind: ".concat(e.kind));for(p=Wl,g=i*p,d=0;d<a;d++){for(d>=r&&(p=s,g=i*p),l=0,f=g;f--;)h[l++]=u[c++],h[l++]=u[c++],h[l++]=u[c++],h[l++]=255;t.putImageData(o,0,d*Wl)}}}function Yl(t,e){if(e.bitmap)return void t.drawImage(e.bitmap,0,0);const n=e.height,i=e.width,s=n%Wl,r=(n-s)/Wl,a=0===s?r:r+1,o=t.createImageData(i,Wl);let l=0;const c=e.data,u=o.data;for(let h=0;h<a;h++){const e=h<r?Wl:s;({srcPos:l}=jl({src:c,srcPos:l,dest:u,width:i,height:e,nonBlackColor:0})),t.putImageData(o,0,h*Wl)}}function Jl(t,e){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of n)void 0!==t[i]&&(e[i]=t[i]);void 0!==t.setLineDash&&(e.setLineDash(t.getLineDash()),e.lineDashOffset=t.lineDashOffset)}function $l(t){t.strokeStyle=t.fillStyle="#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",void 0!==t.setLineDash&&(t.setLineDash([]),t.lineDashOffset=0);const{filter:e}=t;"none"!==e&&""!==e&&(t.filter="none")}function Zl(t,e){if(e)return!0;ii.singularValueDecompose2dScale(t,Hl);const n=Math.fround(Ii.pixelRatio*fi.PDF_TO_CSS_UNITS);return Hl[0]<=n&&Hl[1]<=n}const tc=["butt","round","square"],ec=["miter","round","bevel"],nc={},ic={};var sc=new WeakSet;class rc{constructor(t,e,n,i,s,r,a,o){let{optionalContentConfig:l,markedContentStack:c=null}=r;Le(this,sc),this.ctx=t,this.current=new Xl(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new Gl(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=a,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=o,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"string"===typeof t?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing(t){let{transform:e,viewport:n,transparency:i=!1,background:s=null}=t;const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,i){const t=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=t.canvas,this.ctx=t.context,this.ctx.save(),this.ctx.transform(...Ci(this.compositeCtx))}this.ctx.save(),$l(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=Ci(this.ctx)}executeOperatorList(t,e,n,i){const s=t.argsArray,r=t.fnArray;let a=e||0;const o=s.length;if(o===a)return a;const l=o-a>10&&"function"===typeof n,c=l?Date.now()+15:0;let u=0;const h=this.commonObjs,d=this.objs;let f;for(;;){if(void 0!==i&&a===i.nextBreakPoint)return i.breakIt(a,n),a;if(f=r[a],f!==Mn.dependency)this[f].apply(this,s[a]);else for(const t of s[a]){const e=t.startsWith("g_")?h:d;if(!e.has(t))return e.get(t,n),a}if(a++,a===o)return a;if(l&&++u>10){if(Date.now()>c)return n(),a;u=0}}}endDrawing(){Fe(sc,this,ac).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),Fe(sc,this,oc).call(this)}_scaleImage(t,e){var n,i;const s=null!==(n=t.width)&&void 0!==n?n:t.displayWidth,r=null!==(i=t.height)&&void 0!==i?i:t.displayHeight;let a,o,l=Math.max(Math.hypot(e[0],e[1]),1),c=Math.max(Math.hypot(e[2],e[3]),1),u=s,h=r,d="prescale1";for(;l>2&&u>1||c>2&&h>1;){let e=u,n=h;l>2&&u>1&&(e=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/e),c>2&&h>1&&(n=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,c/=h/n),a=this.cachedCanvases.getCanvas(d,e,n),o=a.context,o.clearRect(0,0,e,n),o.drawImage(t,0,0,u,h,0,0,e,n),t=a.canvas,u=e,h=n,d="prescale1"===d?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t){const e=this.ctx,{width:n,height:i}=t,s=this.current.fillColor,r=this.current.patternFill,a=Ci(e);let o,l,c,u;if((t.bitmap||t.data)&&t.count>1){const e=t.bitmap||t.data.buffer;l=JSON.stringify(r?a:[a.slice(0,4),s]),o=this._cachedBitmapsMap.get(e),o||(o=new Map,this._cachedBitmapsMap.set(e,o));const n=o.get(l);if(n&&!r){return{canvas:n,offsetX:Math.round(Math.min(a[0],a[2])+a[4]),offsetY:Math.round(Math.min(a[1],a[3])+a[5])}}c=n}c||(u=this.cachedCanvases.getCanvas("maskCanvas",n,i),Yl(u.context,t));let h=ii.transform(a,[1/n,0,0,-1/i,0,0]);h=ii.transform(h,[1,0,0,1,0,-i]);const d=ql.slice();ii.axialAlignedBoundingBox([0,0,n,i],h,d);const[f,p,g,m]=d,v=Math.round(g-f)||1,y=Math.round(m-p)||1,w=this.cachedCanvases.getCanvas("fillCanvas",v,y),b=w.context,_=f,E=p;b.translate(-_,-E),b.transform(...h),c||(c=this._scaleImage(u.canvas,Ti(b)),c=c.img,o&&r&&o.set(l,c)),b.imageSmoothingEnabled=Zl(Ci(b),t.interpolate),Kl(b,c,0,0,c.width,c.height,0,0,n,i),b.globalCompositeOperation="source-in";const A=ii.transform(Ti(b),[1,0,0,1,-_,-E]);return b.fillStyle=r?s.getPattern(e,this,A,xl):s,b.fillRect(0,0,n,i),o&&!r&&(this.cachedCanvases.delete("fillCanvas"),o.set(l,w.canvas)),{canvas:w.canvas,offsetX:Math.round(_),offsetY:Math.round(E)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=tc[t]}setLineJoin(t){this.ctx.lineJoin=ec[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(t),n.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,n]of t)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx;const s=this.ctx=i.context;s.setTransform(this.suspendedCtx.getTransform()),Jl(this.suspendedCtx,s),function(t,e){if(t._removeMirroring)throw new Error("Context is already forwarding operations.");t.__originalSave=t.save,t.__originalRestore=t.restore,t.__originalRotate=t.rotate,t.__originalScale=t.scale,t.__originalTranslate=t.translate,t.__originalTransform=t.transform,t.__originalSetTransform=t.setTransform,t.__originalResetTransform=t.resetTransform,t.__originalClip=t.clip,t.__originalMoveTo=t.moveTo,t.__originalLineTo=t.lineTo,t.__originalBezierCurveTo=t.bezierCurveTo,t.__originalRect=t.rect,t.__originalClosePath=t.closePath,t.__originalBeginPath=t.beginPath,t._removeMirroring=()=>{t.save=t.__originalSave,t.restore=t.__originalRestore,t.rotate=t.__originalRotate,t.scale=t.__originalScale,t.translate=t.__originalTranslate,t.transform=t.__originalTransform,t.setTransform=t.__originalSetTransform,t.resetTransform=t.__originalResetTransform,t.clip=t.__originalClip,t.moveTo=t.__originalMoveTo,t.lineTo=t.__originalLineTo,t.bezierCurveTo=t.__originalBezierCurveTo,t.rect=t.__originalRect,t.closePath=t.__originalClosePath,t.beginPath=t.__originalBeginPath,delete t._removeMirroring},t.save=function(){e.save(),this.__originalSave()},t.restore=function(){e.restore(),this.__originalRestore()},t.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},t.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},t.transform=function(t,n,i,s,r,a){e.transform(t,n,i,s,r,a),this.__originalTransform(t,n,i,s,r,a)},t.setTransform=function(t,n,i,s,r,a){e.setTransform(t,n,i,s,r,a),this.__originalSetTransform(t,n,i,s,r,a)},t.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},t.rotate=function(t){e.rotate(t),this.__originalRotate(t)},t.clip=function(t){e.clip(t),this.__originalClip(t)},t.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},t.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},t.bezierCurveTo=function(t,n,i,s,r,a){e.bezierCurveTo(t,n,i,s,r,a),this.__originalBezierCurveTo(t,n,i,s,r,a)},t.rect=function(t,n,i,s){e.rect(t,n,i,s),this.__originalRect(t,n,i,s)},t.closePath=function(){e.closePath(),this.__originalClosePath()},t.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}(s,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Jl(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,i){const s=i[0],r=i[1],a=i[2]-s,o=i[3]-r;0!==a&&0!==o&&(this.genericComposeSMask(e.context,n,a,o,e.subtype,e.backdrop,e.transferMap,s,r,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,i,s,r,a,o,l,c,u){let h=t.canvas,d=o-c,f=l-u;if(r)if(d<0||f<0||d+n>h.width||f+i>h.height){const t=this.cachedCanvases.getCanvas("maskExtension",n,i),e=t.context;e.drawImage(h,-d,-f),e.globalCompositeOperation="destination-atop",e.fillStyle=r,e.fillRect(0,0,n,i),e.globalCompositeOperation="source-over",h=t.canvas,d=f=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const e=new Path2D;e.rect(d,f,n,i),t.clip(e),t.globalCompositeOperation="destination-atop",t.fillStyle=r,t.fillRect(d,f,n,i),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),"Alpha"===s&&a?e.filter=this.filterFactory.addAlphaFilter(a):"Luminosity"===s&&(e.filter=this.filterFactory.addLuminosityFilter(a));const p=new Path2D;p.rect(o,l,n,i),e.clip(p),e.globalCompositeOperation="destination-in",e.drawImage(h,d,f,n,i,o,l,n,i),e.restore()}save(){this.inSMaskMode&&Jl(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){0!==this.stateStack.length?(this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Jl(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null):this.inSMaskMode&&this.endSMaskMode()}transform(t,e,n,i,s,r){this.ctx.transform(t,e,n,i,s,r),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n){let[i]=e;if(!n)return i||(i=e[0]=new Path2D),void this[t](i);if(!(i instanceof Path2D)){const t=e[0]=new Path2D;for(let e=0,n=i.length;e<n;)switch(i[e++]){case Pn:t.moveTo(i[e++],i[e++]);break;case Nn:t.lineTo(i[e++],i[e++]);break;case Dn:t.bezierCurveTo(i[e++],i[e++],i[e++],i[e++],i[e++],i[e++]);break;case Ln:t.closePath();break;default:Vn("Unrecognized drawing path operator: ".concat(i[e-1]))}i=t}ii.axialAlignedBoundingBox(n,Ci(this.ctx),this.current.minMax),this[t](i)}closePath(){this.ctx.closePath()}stroke(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.ctx,i=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if("object"===typeof i&&null!==i&&void 0!==i&&i.getPattern){const e=i.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=i.getPattern(n,this,Ti(n),Il),e){const i=new Path2D;i.addPath(t,n.getTransform().invertSelf().multiplySelf(e)),t=i}this.rescaleAndStroke(t,!1),n.restore()}else this.rescaleAndStroke(t,!0);e&&this.consumePath(t,this.current.getClippedPathBoundingBox(Il,Ci(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(t){this.stroke(t)}fill(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.ctx,i=this.current.fillColor;let s=!1;if(this.current.patternFill){const e=i.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.fillStyle=i.getPattern(n,this,Ti(n),xl),e){const i=new Path2D;i.addPath(t,n.getTransform().invertSelf().multiplySelf(e)),t=i}s=!0}const r=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==r&&(this.pendingEOFill?(n.fill(t,"evenodd"),this.pendingEOFill=!1):n.fill(t)),s&&n.restore(),e&&this.consumePath(t,r)}eoFill(t){this.pendingEOFill=!0,this.fill(t)}fillStroke(t){this.fill(t,!1),this.stroke(t,!1),this.consumePath(t)}eoFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}closeFillStroke(t){this.fillStroke(t)}closeEOFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}endPath(t){this.consumePath(t)}rawFillPath(t){this.ctx.fill(t)}clip(){this.pendingClip=nc}eoClip(){this.pendingClip=ic}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(void 0===t)return;const n=new Path2D,i=e.getTransform().invertSelf();for(const{transform:s,x:r,y:a,fontSize:o,path:l}of t)n.addPath(l,new DOMMatrix(s).preMultiplySelf(i).translate(r,a).scale(o,-o));e.clip(n),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var n;const i=this.commonObjs.get(t),s=this.current;if(!i)throw new Error("Can't find font for ".concat(t));if(s.fontMatrix=i.fontMatrix||sn,0!==s.fontMatrix[0]&&0!==s.fontMatrix[3]||Vn("Invalid font matrix for font "+t),e<0?(e=-e,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const r=i.loadedName||"sans-serif",a=(null===(n=i.systemFontInfo)||void 0===n?void 0:n.css)||'"'.concat(r,'", ').concat(i.fallbackName);let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let c=e;e<16?c=16:e>100&&(c=100),this.current.fontSizeScale=e/c,this.ctx.font="".concat(l," ").concat(o," ").concat(c,"px ").concat(a)}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t){const{current:e}=this;e.textMatrix=t,e.textMatrixScale=Math.hypot(t[0],t[1]),e.x=e.lineX=0,e.y=e.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,n,i,s){const r=this.ctx,a=this.current,o=a.font,l=a.textRenderingMode,c=a.fontSize/a.fontSizeScale,u=l&_n,h=!!(l&En),d=a.patternFill&&!o.missingFile,f=a.patternStroke&&!o.missingFile;let p;if((o.disableFontFace||h||d||f)&&(p=o.getPathGenerator(this.commonObjs,t)),o.disableFontFace||d||f){let t;if(r.save(),r.translate(e,n),r.scale(c,-c),u!==vn&&u!==wn||(i?(t=r.getTransform(),r.setTransform(...i),r.fill(Fe(sc,this,lc).call(this,p,t,i))):r.fill(p)),u===yn||u===wn)if(s){t||(t=r.getTransform()),r.setTransform(...s);const{a:e,b:n,c:i,d:a}=t,o=ii.inverseTransform(s),l=ii.transform([e,n,i,a,0,0],o);ii.singularValueDecompose2dScale(l,Hl),r.lineWidth*=Math.max(Hl[0],Hl[1])/c,r.stroke(Fe(sc,this,lc).call(this,p,t,s))}else r.lineWidth/=c,r.stroke(p);r.restore()}else u!==vn&&u!==wn||r.fillText(t,e,n),u!==yn&&u!==wn||r.strokeText(t,e,n);if(h){(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ci(r),x:e,y:n,fontSize:c,path:p})}}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){n=!0;break}return qn(this,"isFontSubpixelAAEnabled",n)}showText(t){const e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);const i=e.fontSize;if(0===i)return;const s=this.ctx,r=e.fontSizeScale,a=e.charSpacing,o=e.wordSpacing,l=e.fontDirection,c=e.textHScale*l,u=t.length,h=n.vertical,d=h?1:-1,f=n.defaultVMetrics,p=i*e.fontMatrix[0],g=e.textRenderingMode===vn&&!n.disableFontFace&&!e.patternFill;let m,v;if(s.save(),e.textMatrix&&s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),l>0?s.scale(c,-1):s.scale(c,1),e.patternFill){s.save();const t=e.fillColor.getPattern(s,this,Ti(s),xl);m=Ci(s),s.restore(),s.fillStyle=t}if(e.patternStroke){s.save();const t=e.strokeColor.getPattern(s,this,Ti(s),Il);v=Ci(s),s.restore(),s.strokeStyle=t}let y=e.lineWidth;const w=e.textMatrixScale;if(0===w||0===y){const t=e.textRenderingMode&_n;t!==yn&&t!==wn||(y=this.getSinglePixelWidth())}else y/=w;if(1!==r&&(s.scale(r,r),y/=r),s.lineWidth=y,n.isInvalidPDFjsFont){const n=[];let i=0;for(const e of t)n.push(e.unicode),i+=e.width;return s.fillText(n.join(""),0,0),e.x+=i*p*c,s.restore(),void this.compose()}let b,_=0;for(b=0;b<u;++b){const e=t[b];if("number"===typeof e){_+=d*e*i/1e3;continue}let c=!1;const u=(e.isSpace?o:0)+a,y=e.fontChar,w=e.accent;let E,A,S=e.width;if(h){const t=e.vmetric||f,n=-(e.vmetric?t[1]:.5*S)*p,i=t[2]*p;S=t?-t[0]:S,E=n/r,A=(_+i)/r}else E=_/r,A=0;if(n.remeasure&&S>0){const t=1e3*s.measureText(y).width/i*r;if(S<t&&this.isFontSubpixelAAEnabled){const e=S/t;c=!0,s.save(),s.scale(e,1),E/=e}else S!==t&&(E+=(S-t)/2e3*i/r)}if(this.contentVisible&&(e.isInFont||n.missingFile))if(g&&!w)s.fillText(y,E,A);else if(this.paintChar(y,E,A,m,v),w){const t=E+i*w.offset.x/r,e=A-i*w.offset.y/r;this.paintChar(w.fontChar,t,e,m,v)}_+=h?S*p-u*l:S*p+u*l,c&&s.restore()}h?e.y-=_:e.x+=_*c,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,n=this.current,i=n.font,s=n.fontSize,r=n.fontDirection,a=i.vertical?1:-1,o=n.charSpacing,l=n.wordSpacing,c=n.textHScale*r,u=n.fontMatrix||sn,h=t.length;let d,f,p,g;if(!(n.textRenderingMode===bn)&&0!==s){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),n.textMatrix&&e.transform(...n.textMatrix),e.translate(n.x,n.y+n.textRise),e.scale(c,r),d=0;d<h;++d){if(f=t[d],"number"===typeof f){g=a*f*s/1e3,this.ctx.translate(g,0),n.x+=g*c;continue}const r=(f.isSpace?l:0)+o,h=i.charProcOperatorList[f.operatorListId];h?this.contentVisible&&(this.save(),e.scale(s,s),e.transform(...u),this.executeOperatorList(h),this.restore()):Vn('Type3 character "'.concat(f.operatorListId,'" is not available.'));const m=[f.width,0];ii.applyTransform(m,u),p=m[0]*s+r,e.translate(p,0),n.x+=p*c}e.restore()}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,n,i,s,r){const a=new Path2D;a.rect(n,i,s-n,r-i),this.ctx.clip(a),this.endPath()}getColorN_Pattern(t){let e;if("TilingPattern"===t[0]){const n=this.baseTransform||Ci(this.ctx),i={createCanvasGraphics:t=>new rc(t,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Vl(t,this.ctx,i,n)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t){this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t){this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.cachedPatterns.has(t)?e=this.cachedPatterns.get(t):(e=function(t){switch(t[0]){case"RadialAxial":return new Nl(t);case"Mesh":return new Ol(t);case"Dummy":return new Fl}throw new Error("Unknown IR type: ".concat(t[0]))}(this.getObject(t)),this.cachedPatterns.set(t,e)),n&&(e.matrix=n),e}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,Ti(e),Rl);const i=Ti(e);if(i){const{width:t,height:n}=e.canvas,s=ql.slice();ii.axialAlignedBoundingBox([0,0,t,n],i,s);const[r,a,o,l]=s;this.ctx.fillRect(r,a,o-r,l-a)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){jn("Should not call beginInlineImage")}beginImageData(){jn("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Ci(this.ctx),e)){ii.axialAlignedBoundingBox(e,this.baseTransform,this.current.minMax);const[t,n,i,s]=e,r=new Path2D;r.rect(t,n,i-t,s-n),this.ctx.clip(r),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||Bn("TODO: Support non-isolated groups."),t.knockout&&Vn("Knockout groups not supported.");const n=Ci(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=ql.slice();ii.axialAlignedBoundingBox(t.bbox,Ci(e),i);const s=[0,0,e.canvas.width,e.canvas.height];i=ii.intersect(i,s)||[0,0,0,0];const r=Math.floor(i[0]),a=Math.floor(i[1]),o=Math.max(Math.ceil(i[2])-r,1),l=Math.max(Math.ceil(i[3])-a,1);this.current.startNewPathAndClipBox([0,0,o,l]);let c="groupAt"+this.groupLevel;t.smask&&(c+="_smask_"+this.smaskCounter++%2);const u=this.cachedCanvases.getCanvas(c,o,l),h=u.context;h.translate(-r,-a),h.transform(...n);let d=new Path2D;const[f,p,g,m]=t.bbox;if(d.rect(f,p,g-f,m-p),t.matrix){const e=new Path2D;e.addPath(d,new DOMMatrix(t.matrix)),d=e}h.clip(d),t.smask?this.smaskStack.push({canvas:u.canvas,context:h,offsetX:r,offsetY:a,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(r,a),e.save()),Jl(e,h),this.ctx=h,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const t=Ci(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...t);const n=ql.slice();ii.axialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],t,n),this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(t,e,n,i,s){if(Fe(sc,this,ac).call(this),$l(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const i=e[2]-e[0],r=e[3]-e[1];if(s&&this.annotationCanvasMap){(n=n.slice())[4]-=e[0],n[5]-=e[1],(e=e.slice())[0]=e[1]=0,e[2]=i,e[3]=r,ii.singularValueDecompose2dScale(Ci(this.ctx),Hl);const{viewportScale:s}=this,a=Math.ceil(i*this.outputScaleX*s),o=Math.ceil(r*this.outputScaleY*s);this.annotationCanvas=this.canvasFactory.create(a,o);const{canvas:l,context:c}=this.annotationCanvas;this.annotationCanvasMap.set(t,l),this.annotationCanvas.savedCtx=this.ctx,this.ctx=c,this.ctx.save(),this.ctx.setTransform(Hl[0],0,0,-Hl[1],0,r*Hl[1]),$l(this.ctx)}else{$l(this.ctx),this.endPath();const t=new Path2D;t.rect(e[0],e[1],i,r),this.ctx.clip(t)}}this.current=new Xl(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Fe(sc,this,oc).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;(t=this.getObject(t.data,t)).count=e;const n=this.ctx,i=this._createMaskCanvas(t),s=i.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(s,i.offsetX,i.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;if(!this.contentVisible)return;t=this.getObject(t.data,t);const a=this.ctx;a.save();const o=Ci(a);a.transform(e,n,i,s,0,0);const l=this._createMaskCanvas(t);a.setTransform(1,0,0,1,l.offsetX-o[4],l.offsetY-o[5]);for(let c=0,u=r.length;c<u;c+=2){const t=ii.transform(o,[e,n,i,s,r[c],r[c+1]]);a.drawImage(l.canvas,t[4],t[5])}a.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const s of t){const{data:t,width:r,height:a,transform:o}=s,l=this.cachedCanvases.getCanvas("maskCanvas",r,a),c=l.context;c.save();Yl(c,this.getObject(t,s)),c.globalCompositeOperation="source-in",c.fillStyle=i?n.getPattern(c,this,Ti(e),xl):n,c.fillRect(0,0,r,a),c.restore(),e.save(),e.transform(...o),e.scale(1,-1),Kl(e,l.canvas,0,0,r,a,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);e?this.paintInlineImageXObject(e):Vn("Dependent image isn't ready yet")}paintImageXObjectRepeat(t,e,n,i){if(!this.contentVisible)return;const s=this.getObject(t);if(!s)return void Vn("Dependent image isn't ready yet");const r=s.width,a=s.height,o=[];for(let l=0,c=i.length;l<c;l+=2)o.push({transform:[e,0,0,n,i[l],i[l+1]],x:0,y:0,w:r,h:a});this.paintInlineImageXObjectGroup(s,o)}applyTransferMapsToCanvas(t){return"none"!==this.current.transferMaps&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if("none"===this.current.transferMaps)return t.bitmap;const{bitmap:e,width:n,height:i}=t,s=this.cachedCanvases.getCanvas("inlineImage",n,i),r=s.context;return r.filter=this.current.transferMaps,r.drawImage(e,0,0),r.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,n=t.height,i=this.ctx;this.save();const{filter:s}=i;let r;if("none"!==s&&""!==s&&(i.filter="none"),i.scale(1/e,-1/n),t.bitmap)r=this.applyTransferMapsToBitmap(t);else if("function"===typeof HTMLElement&&t instanceof HTMLElement||!t.data)r=t;else{const i=this.cachedCanvases.getCanvas("inlineImage",e,n).context;Ql(i,t),r=this.applyTransferMapsToCanvas(i)}const a=this._scaleImage(r,Ti(i));i.imageSmoothingEnabled=Zl(Ci(i),t.interpolate),Kl(i,a.img,0,0,a.paintWidth,a.paintHeight,0,-n,e,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const e=t.width,n=t.height,s=this.cachedCanvases.getCanvas("inlineImage",e,n).context;Ql(s,t),i=this.applyTransferMapsToCanvas(s)}for(const s of e)n.save(),n.transform(...s.transform),n.scale(1,-1),Kl(n,i,s.x,s.y,s.w,s.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t,e){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(n||(this.pendingClip===ic?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Ci(this.ctx);if(0===t[1]&&0===t[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:t}=this.current,{a:e,b:n,c:i,d:s}=this.ctx.getTransform();let r,a;if(0===n&&0===i){const n=Math.abs(e),i=Math.abs(s);if(n===i)if(0===t)r=a=1/n;else{const e=n*t;r=a=e<1?1/e:1}else if(0===t)r=1/n,a=1/i;else{const e=n*t,s=i*t;r=e<1?1/e:1,a=s<1?1/s:1}}else{const o=Math.abs(e*s-n*i),l=Math.hypot(e,n),c=Math.hypot(i,s);if(0===t)r=c/o,a=l/o;else{const e=t*o;r=c>e?c/e:1,a=l>e?l/e:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:n,current:{lineWidth:i}}=this,[s,r]=this.getScaleForStroking();if(s===r)return n.lineWidth=(i||1)*s,void n.stroke(t);const a=n.getLineDash();e&&n.save(),n.scale(s,r),zl.a=1/s,zl.d=1/r;const o=new Path2D;if(o.addPath(t,zl),a.length>0){const t=Math.max(s,r);n.setLineDash(a.map((e=>e/t))),n.lineDashOffset/=t}n.lineWidth=i||1,n.stroke(o),e&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}function ac(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}function oc(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==t){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}function lc(t,e,n){const i=new Path2D;return i.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),i}for(const n in Mn)void 0!==rc.prototype[n]&&(rc.prototype[Mn[n]]=rc.prototype[n]);class cc{static get workerPort(){return Fe(cc,this,uc)._}static set workerPort(t){if(!("undefined"!==typeof Worker&&t instanceof Worker)&&null!==t)throw new Error("Invalid `workerPort` type.");uc._=Fe(cc,this,t)}static get workerSrc(){return Fe(cc,this,hc)._}static set workerSrc(t){if("string"!==typeof t)throw new Error("Invalid `workerSrc` type.");hc._=Fe(cc,this,t)}}var uc={_:null},hc={_:""},dc=new WeakMap,fc=new WeakMap;class pc{constructor(t){let{parsedData:e,rawData:n}=t;Oe(this,dc,void 0),Oe(this,fc,void 0),Ve(dc,this,e),Ve(fc,this,n)}getRaw(){return Be(fc,this)}get(t){var e;return null!==(e=Be(dc,this).get(t))&&void 0!==e?e:null}[Symbol.iterator](){return Be(dc,this).entries()}}const gc=Symbol("INTERNAL");var mc=new WeakMap,vc=new WeakMap,yc=new WeakMap,wc=new WeakMap;class bc{constructor(t,e){let{name:n,intent:i,usage:s,rbGroups:r}=e;Oe(this,mc,!1),Oe(this,vc,!1),Oe(this,yc,!1),Oe(this,wc,!0),Ve(mc,this,!!(t&on)),Ve(vc,this,!!(t&ln)),this.name=n,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(Be(yc,this))return Be(wc,this);if(!Be(wc,this))return!1;const{print:t,view:e}=this.usage;return Be(mc,this)?"OFF"!==(null===e||void 0===e?void 0:e.viewState):!Be(vc,this)||"OFF"!==(null===t||void 0===t?void 0:t.printState)}_setVisible(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t!==gc&&jn("Internal method `_setVisible` called."),Ve(yc,this,n),Ve(wc,this,e)}}var _c=new WeakMap,Ec=new WeakMap,Ac=new WeakMap,Sc=new WeakMap,kc=new WeakSet;class Cc{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:on;if(Le(this,kc),Oe(this,_c,null),Oe(this,Ec,new Map),Oe(this,Ac,null),Oe(this,Sc,null),this.renderingIntent=e,this.name=null,this.creator=null,null!==t){this.name=t.name,this.creator=t.creator,Ve(Sc,this,t.order);for(const n of t.groups)Be(Ec,this).set(n.id,new bc(e,n));if("OFF"===t.baseState)for(const t of Be(Ec,this).values())t._setVisible(gc,!1);for(const e of t.on)Be(Ec,this).get(e)._setVisible(gc,!0);for(const e of t.off)Be(Ec,this).get(e)._setVisible(gc,!1);Ve(Ac,this,this.getHash())}}isVisible(t){if(0===Be(Ec,this).size)return!0;if(!t)return Bn("Optional content group not defined."),!0;if("OCG"===t.type)return Be(Ec,this).has(t.id)?Be(Ec,this).get(t.id).visible:(Vn("Optional content group not found: ".concat(t.id)),!0);if("OCMD"===t.type){if(t.expression)return Fe(kc,this,Tc).call(this,t.expression);if(!t.policy||"AnyOn"===t.policy){for(const e of t.ids){if(!Be(Ec,this).has(e))return Vn("Optional content group not found: ".concat(e)),!0;if(Be(Ec,this).get(e).visible)return!0}return!1}if("AllOn"===t.policy){for(const e of t.ids){if(!Be(Ec,this).has(e))return Vn("Optional content group not found: ".concat(e)),!0;if(!Be(Ec,this).get(e).visible)return!1}return!0}if("AnyOff"===t.policy){for(const e of t.ids){if(!Be(Ec,this).has(e))return Vn("Optional content group not found: ".concat(e)),!0;if(!Be(Ec,this).get(e).visible)return!0}return!1}if("AllOff"===t.policy){for(const e of t.ids){if(!Be(Ec,this).has(e))return Vn("Optional content group not found: ".concat(e)),!0;if(Be(Ec,this).get(e).visible)return!1}return!0}return Vn("Unknown optional content policy ".concat(t.policy,".")),!0}return Vn("Unknown group type ".concat(t.type,".")),!0}setVisibility(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=Be(Ec,this).get(t);if(i){if(n&&e&&i.rbGroups.length)for(const e of i.rbGroups)for(const n of e){var s;if(n!==t)null===(s=Be(Ec,this).get(n))||void 0===s||s._setVisible(gc,!1,!0)}i._setVisible(gc,!!e,!0),Ve(_c,this,null)}else Vn("Optional content group not found: ".concat(t))}setOCGState(t){let e,{state:n,preserveRB:i}=t;for(const s of n){switch(s){case"ON":case"OFF":case"Toggle":e=s;continue}const t=Be(Ec,this).get(s);if(t)switch(e){case"ON":this.setVisibility(s,!0,i);break;case"OFF":this.setVisibility(s,!1,i);break;case"Toggle":this.setVisibility(s,!t.visible,i)}}Ve(_c,this,null)}get hasInitialVisibility(){return null===Be(Ac,this)||this.getHash()===Be(Ac,this)}getOrder(){return Be(Ec,this).size?Be(Sc,this)?Be(Sc,this).slice():[...Be(Ec,this).keys()]:null}getGroup(t){return Be(Ec,this).get(t)||null}getHash(){if(null!==Be(_c,this))return Be(_c,this);const t=new ao;for(const[e,n]of Be(Ec,this))t.update("".concat(e,":").concat(n.visible));return Ve(_c,this,t.hexdigest())}[Symbol.iterator](){return Be(Ec,this).entries()}}function Tc(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let i=1;i<e;i++){const e=t[i];let s;if(Array.isArray(e))s=Fe(kc,this,Tc).call(this,e);else{if(!Be(Ec,this).has(e))return Vn("Optional content group not found: ".concat(e)),!0;s=Be(Ec,this).get(e).visible}switch(n){case"And":if(!s)return!1;break;case"Or":if(s)return!0;break;case"Not":return!s;default:return!0}}return"And"===n}class xc{constructor(t,e){let{disableRange:n=!1,disableStream:i=!1}=e;Wn(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:a,contentDispositionFilename:o}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(null===r||void 0===r?void 0:r.length)>0){const t=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(t)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!n,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener(((t,e)=>{this._onReceiveData({begin:t,chunk:e})})),t.addProgressListener(((t,e)=>{this._onProgress({loaded:t,total:e})})),t.addProgressiveReadListener((t=>{this._onReceiveData({chunk:t})})),t.addProgressiveDoneListener((()=>{this._onProgressiveDone()})),t.transportReady()}_onReceiveData(t){let{begin:e,chunk:n}=t;const i=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;if(void 0===e)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{Wn(this._rangeReaders.some((function(t){return t._begin===e&&(t._enqueue(i),!0)})),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t,e;return null!==(t=null===(e=this._fullRequestReader)||void 0===e?void 0:e._loaded)&&void 0!==t?t:0}_onProgress(t){var e,n,i,s;void 0===t.total?null===(e=this._rangeReaders[0])||void 0===e||null===(n=e.onProgress)||void 0===n||n.call(e,{loaded:t.loaded}):null===(i=this._fullRequestReader)||void 0===i||null===(s=i.onProgress)||void 0===s||s.call(i,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;null===(t=this._fullRequestReader)||void 0===t||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Wn(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Ic(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new Rc(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){var e;null===(e=this._fullRequestReader)||void 0===e||e.cancel(t);for(const n of this._rangeReaders.slice(0))n.cancel(t);this._pdfDataRangeTransport.abort()}}class Ic{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._stream=t,this._done=n||!1,this._filename=yi(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length>0){this._requests.shift().resolve({value:t,done:!1})}else this._queuedChunks.push(t);this._loaded+=t.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){return{value:this._queuedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Rc{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Mc(t,e){const n=new Headers;if(!t||!e||"object"!==typeof e)return n;for(const i in e){const t=e[i];void 0!==t&&n.append(i,t)}return n}function Pc(t){var e,n;return null!==(e=null===(n=URL.parse(t))||void 0===n?void 0:n.origin)&&void 0!==e?e:null}function Nc(t){let{responseHeaders:e,isHttp:n,rangeChunkSize:i,disableRange:s}=t;const r={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(e.get("Content-Length"),10);if(!Number.isInteger(a))return r;if(r.suggestedLength=a,a<=2*i)return r;if(s||!n)return r;if("bytes"!==e.get("Accept-Ranges"))return r;return"identity"!==(e.get("Content-Encoding")||"identity")||(r.allowRangeRequests=!0),r}function Dc(t){const e=t.get("Content-Disposition");if(e){let t=function(t){let e=!0,n=i("filename\\*","i").exec(t);if(n){n=n[1];let t=a(n);return t=unescape(t),t=o(t),t=l(t),r(t)}if(n=function(t){const e=[];let n;const s=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=s.exec(t));){let[,t,i,s]=n;if(t=parseInt(t,10),t in e){if(0===t)break}else e[t]=[i,s]}const r=[];for(let i=0;i<e.length&&i in e;++i){let[t,n]=e[i];n=a(n),t&&(n=unescape(n),0===i&&(n=o(n))),r.push(n)}return r.join("")}(t),n)return r(l(n));if(n=i("filename","i").exec(t),n){n=n[1];let t=a(n);return t=l(t),r(t)}function i(t,e){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',e)}function s(t,n){if(t){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const i=new TextDecoder(t,{fatal:!0}),s=ti(n);n=i.decode(s),e=!1}catch(i){}}return n}function r(t){return e&&/[\x80-\xff]/.test(t)&&(t=s("utf-8",t),e&&(t=s("iso-8859-1",t))),t}function a(t){if(t.startsWith('"')){const e=t.slice(1).split('\\"');for(let t=0;t<e.length;++t){const n=e[t].indexOf('"');-1!==n&&(e[t]=e[t].slice(0,n),e.length=t+1),e[t]=e[t].replaceAll(/\\(.)/g,"$1")}t=e.join('"')}return t}function o(t){const e=t.indexOf("'");return-1===e?t:s(t.slice(0,e),t.slice(e+1).replace(/^[^']*'/,""))}function l(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(t,e,n,i){if("q"===n||"Q"===n)return s(e,i=(i=i.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,(function(t,e){return String.fromCharCode(parseInt(e,16))})));try{i=atob(i)}catch(r){}return s(e,i)}))}return""}(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch(n){}if(yi(t))return t}return null}function Lc(t,e){return new Yn("Unexpected server response (".concat(t,') while retrieving PDF "').concat(e,'".'),t,404===t||0===t&&e.startsWith("file:"))}function Oc(t){return 200===t||206===t}function Fc(t,e,n){return{method:"GET",headers:t,signal:n.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Uc(t){return t instanceof Uint8Array?t.buffer:t instanceof ArrayBuffer?t:(Vn("getArrayBuffer - unexpected data format: ".concat(t)),new Uint8Array(t).buffer)}class Bc{constructor(t){a(this,"_responseOrigin",null),this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Mc(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t,e;return null!==(t=null===(e=this._fullRequestReader)||void 0===e?void 0:e._loaded)&&void 0!==t?t:0}getFullReader(){return Wn(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Vc(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new jc(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;null===(e=this._fullRequestReader)||void 0===e||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class Vc{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),i=e.url;fetch(i,Fc(n,this._withCredentials,this._abortController)).then((e=>{if(t._responseOrigin=Pc(e.url),!Oc(e.status))throw Lc(e.status,i);this._reader=e.body.getReader(),this._headersCapability.resolve();const n=e.headers,{allowRangeRequests:s,suggestedLength:r}=Nc({responseHeaders:n,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=r||this._contentLength,this._filename=Dc(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new $n("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;await this._headersCapability.promise;const{value:e,done:n}=await this._reader.read();return n?{value:e,done:n}:(this._loaded+=e.byteLength,null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Uc(e),done:!1})}cancel(t){var e;null===(e=this._reader)||void 0===e||e.cancel(t),this._abortController.abort()}}class jc{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range","bytes=".concat(e,"-").concat(n-1));const r=i.url;fetch(r,Fc(s,this._withCredentials,this._abortController)).then((e=>{const n=Pc(e.url);if(n!==t._responseOrigin)throw new Error('Expected range response-origin "'.concat(n,'" to match "').concat(t._responseOrigin,'".'));if(!Oc(e.status))throw Lc(e.status,r);this._readCapability.resolve(),this._reader=e.body.getReader()})).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;await this._readCapability.promise;const{value:e,done:n}=await this._reader.read();return n?{value:e,done:n}:(this._loaded+=e.byteLength,null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:this._loaded}),{value:Uc(e),done:!1})}cancel(t){var e;null===(e=this._reader)||void 0===e||e.cancel(t),this._abortController.abort()}}class Wc{constructor(t){let{url:e,httpHeaders:n,withCredentials:i}=t;a(this,"_responseOrigin",null),this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Mc(this.isHttp,n),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[s,r]of this.headers)e.setRequestHeader(s,r);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range","bytes=".concat(t.begin,"-").concat(t.end-1)),i.expectedStatus=206):i.expectedStatus=200,e.responseType="arraybuffer",Wn(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){var n;const i=this.pendingRequests[t];i&&(null===(n=i.onProgress)||void 0===n||n.call(i,e))}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==i.readyState)return;if(!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],0===i.status&&this.isHttp)return void n.onError(i.status);const s=i.status||200;if(!(200===s&&206===n.expectedStatus)&&s!==n.expectedStatus)return void n.onError(i.status);const r=function(t){const e=t.response;return"string"!==typeof e?e:ti(e).buffer}(i);if(206===s){const t=i.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(t);e?n.onDone({begin:parseInt(e[1],10),chunk:r}):(Vn('Missing or invalid "Content-Range" header.'),n.onError(0))}else r?n.onDone({begin:0,chunk:r}):n.onError(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class zc{constructor(t){this._source=t,this._manager=new Wc(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Wn(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Hc(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new qc(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;null===(e=this._fullRequestReader)||void 0===e||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class Hc{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Pc(e.responseURL);const n=e.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map((t=>{const[e,...n]=t.split(": ");return[e,n.join(": ")]})):[]),{allowRangeRequests:s,suggestedLength:r}=Nc({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=Dc(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t)if(this._requests.length>0){this._requests.shift().resolve({value:t.chunk,done:!1})}else this._cachedChunks.push(t.chunk);if(this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Lc(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0){return{value:this._cachedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class qc{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Pc(null===(t=this._manager.getRequestXhr(this._requestId))||void 0===t?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error('Expected range response-origin "'.concat(e,'" to match "').concat(this._manager._responseOrigin,'".')),this._onError(0))}_close(){var t;null===(t=this.onClosed)||void 0===t||t.call(this,this)}_onDone(t){const e=t.chunk;if(this._requests.length>0){this._requests.shift().resolve({value:e,done:!1})}else this._queuedChunk=e;this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){var e;null!==(e=this._storedError)&&void 0!==e||(this._storedError=Lc(t,this._url));for(const n of this._requests)n.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:t.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Gc=/^[a-z][a-z0-9\-+.]+:/i;class Kc{constructor(t){this.source=t,this.url=function(t){if(Gc.test(t))return new URL(t);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(t))}(t.url),Wn("file:"===this.url.protocol,"PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t,e;return null!==(t=null===(e=this._fullRequestReader)||void 0===e?void 0:e._loaded)&&void 0!==t?t:0}getFullReader(){return Wn(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Xc(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new Qc(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;null===(e=this._fullRequestReader)||void 0===e||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class Xc{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then((t=>{this._contentLength=t.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()}),(t=>{"ENOENT"===t.code&&(t=Lc(0,this._url.href)),this._storedError=t,this._headersCapability.reject(t)}))}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();if(null===e)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=e.length,null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(e).buffer,done:!1}}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new $n("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Qc{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=t.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();if(null===e)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=e.length,null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:this._loaded});return{value:new Uint8Array(e).buffer,done:!1}}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),this._storedError&&this._readableStream.destroy(this._storedError)}}const Yc=Symbol("INITIAL_DATA");var Jc=new WeakMap,$c=new WeakSet;class Zc{constructor(){Le(this,$c),Oe(this,Jc,Object.create(null))}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e){const n=Fe($c,this,tu).call(this,t);return n.promise.then((()=>e(n.data))),null}const n=Be(Jc,this)[t];if(!n||n.data===Yc)throw new Error("Requesting object that isn't resolved yet ".concat(t,"."));return n.data}has(t){const e=Be(Jc,this)[t];return!!e&&e.data!==Yc}delete(t){const e=Be(Jc,this)[t];return!(!e||e.data===Yc)&&(delete Be(Jc,this)[t],!0)}resolve(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=Fe($c,this,tu).call(this,t);n.data=e,n.resolve()}clear(){for(const e in Be(Jc,this)){var t;const{data:n}=Be(Jc,this)[e];null===n||void 0===n||null===(t=n.bitmap)||void 0===t||t.close()}Ve(Jc,this,Object.create(null))}*[Symbol.iterator](){for(const t in Be(Jc,this)){const{data:e}=Be(Jc,this)[t];e!==Yc&&(yield[t,e])}}}function tu(t){var e;return(e=Be(Jc,this))[t]||(e[t]=l(l({},Promise.withResolvers()),{},{data:Yc}))}var eu=new WeakMap,nu=new WeakMap,iu=new WeakMap,su=new WeakMap,ru=new WeakMap,au=new WeakMap,ou=new WeakMap,lu=new WeakMap,cu=new WeakMap,uu=new WeakMap,hu=new WeakMap,du=new WeakMap,fu=new WeakMap,pu=new WeakMap,gu=new WeakMap,mu=new WeakMap,vu=new WeakMap,yu=new WeakMap,wu=new WeakSet;class bu{constructor(t){var e;let{textContentSource:n,container:i,viewport:s}=t;if(Le(this,wu),Oe(this,eu,Promise.withResolvers()),Oe(this,nu,null),Oe(this,iu,!1),Oe(this,su,!(null===(e=globalThis.FontInspector)||void 0===e||!e.enabled)),Oe(this,ru,null),Oe(this,au,null),Oe(this,ou,0),Oe(this,lu,0),Oe(this,cu,null),Oe(this,uu,null),Oe(this,hu,0),Oe(this,du,0),Oe(this,fu,Object.create(null)),Oe(this,pu,[]),Oe(this,gu,null),Oe(this,mu,[]),Oe(this,vu,new WeakMap),Oe(this,yu,null),n instanceof ReadableStream)Ve(gu,this,n);else{if("object"!==typeof n)throw new Error('No "textContentSource" parameter specified.');Ve(gu,this,new ReadableStream({start(t){t.enqueue(n),t.close()}}))}Ve(nu,this,Ve(uu,this,i)),Ve(du,this,s.scale*Ii.pixelRatio),Ve(hu,this,s.rotation),Ve(au,this,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:a,pageX:o,pageY:l}=s.rawDims;Ve(yu,this,[1,0,0,-1,-o,l+a]),Ve(lu,this,r),Ve(ou,this,a),Cu.call(bu),xi(i,s),Be(eu,this).promise.finally((()=>{Pu._.delete(this),Ve(au,this,null),Ve(fu,this,null)})).catch((()=>{}))}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=ei.platform;return qn(this,"fontFamilyMap",new Map([["sans-serif","".concat(t&&e?"Calibri, ":"","sans-serif")],["monospace","".concat(t&&e?"Lucida Console, ":"","monospace")]]))}render(){const t=()=>{Be(cu,this).read().then((e=>{var n;let{value:i,done:s}=e;s?Be(eu,this).resolve():(null!==(n=Be(ru,this))&&void 0!==n||Ve(ru,this,i.lang),Object.assign(Be(fu,this),i.styles),Fe(wu,this,_u).call(this,i.items),t())}),Be(eu,this).reject)};return Ve(cu,this,Be(gu,this).getReader()),Pu._.add(this),t(),Be(eu,this).promise}update(t){let{viewport:e,onBefore:n=null}=t;const i=e.scale*Ii.pixelRatio,s=e.rotation;if(s!==Be(hu,this)&&(null===n||void 0===n||n(),Ve(hu,this,s),xi(Be(uu,this),{rotation:s})),i!==Be(du,this)){null===n||void 0===n||n(),Ve(du,this,i);const t={div:null,properties:null,ctx:Su.call(bu,Be(ru,this))};for(const e of Be(mu,this))t.properties=Be(vu,this).get(e),t.div=e,Fe(wu,this,Au).call(this,t)}}cancel(){var t;const e=new $n("TextLayer task cancelled.");null===(t=Be(cu,this))||void 0===t||t.cancel(e).catch((()=>{})),Ve(cu,this,null),Be(eu,this).reject(e)}get textDivs(){return Be(mu,this)}get textContentItemsStr(){return Be(pu,this)}static cleanup(){if(!(Fe(bu,this,Pu)._.size>0)){Fe(bu,this,xu)._.clear();for(const{canvas:t}of Fe(bu,this,Iu)._.values())t.remove();Fe(bu,this,Iu)._.clear()}}}function _u(t){var e,n;if(Be(iu,this))return;null!==(n=(e=Be(au,this)).ctx)&&void 0!==n||(e.ctx=Su.call(Ge,Be(ru,this)));const i=Be(mu,this),s=Be(pu,this);for(const r of t){if(i.length>1e5)return Vn("Ignoring additional textDivs for performance reasons."),void Ve(iu,this,!0);if(void 0!==r.str)s.push(r.str),Fe(wu,this,Eu).call(this,r);else if("beginMarkedContentProps"===r.type||"beginMarkedContent"===r.type){const t=Be(nu,this);Ve(nu,this,document.createElement("span")),Be(nu,this).classList.add("markedContent"),null!==r.id&&Be(nu,this).setAttribute("id","".concat(r.id)),t.append(Be(nu,this))}else"endMarkedContent"===r.type&&Ve(nu,this,Be(nu,this).parentNode)}}function Eu(t){const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,fontSize:0};Be(mu,this).push(e);const i=ii.transform(Be(yu,this),t.transform);let s=Math.atan2(i[1],i[0]);const r=Be(fu,this)[t.fontName];r.vertical&&(s+=Math.PI/2);let a=Be(su,this)&&r.fontSubstitution||r.fontFamily;a=Ge.fontFamilyMap.get(a)||a;const o=Math.hypot(i[2],i[3]),l=o*Tu.call(Ge,a,r,Be(ru,this));let c,u;0===s?(c=i[4],u=i[5]-l):(c=i[4]+l*Math.sin(s),u=i[5]-l*Math.cos(s));const h="calc(var(--total-scale-factor) *",d=e.style;Be(nu,this)===Be(uu,this)?(d.left="".concat((100*c/Be(lu,this)).toFixed(2),"%"),d.top="".concat((100*u/Be(ou,this)).toFixed(2),"%")):(d.left="".concat(h).concat(c.toFixed(2),"px)"),d.top="".concat(h).concat(u.toFixed(2),"px)")),d.fontSize="".concat(h).concat((Mu._*o).toFixed(2),"px)"),d.fontFamily=a,n.fontSize=o,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,Be(su,this)&&(e.dataset.fontName=r.fontSubstitutionLoadedName||t.fontName),0!==s&&(n.angle=s*(180/Math.PI));let f=!1;if(t.str.length>1)f=!0;else if(" "!==t.str&&t.transform[0]!==t.transform[3]){const e=Math.abs(t.transform[0]),n=Math.abs(t.transform[3]);e!==n&&Math.max(e,n)/Math.min(e,n)>1.5&&(f=!0)}if(f&&(n.canvasWidth=r.vertical?t.height:t.width),Be(vu,this).set(e,n),Be(au,this).div=e,Be(au,this).properties=n,Fe(wu,this,Au).call(this,Be(au,this)),n.hasText&&Be(nu,this).append(e),n.hasEOL){const t=document.createElement("br");t.setAttribute("role","presentation"),Be(nu,this).append(t)}}function Au(t){const{div:e,properties:n,ctx:i}=t,{style:s}=e;let r="";if(Mu._>1&&(r="scale(".concat(1/Mu._,")")),0!==n.canvasWidth&&n.hasText){const{fontFamily:t}=s,{canvasWidth:a,fontSize:o}=n;ku.call(Ge,i,o*Be(du,this),t);const{width:l}=i.measureText(e.textContent);l>0&&(r="scaleX(".concat(a*Be(du,this)/l,") ").concat(r))}0!==n.angle&&(r="rotate(".concat(n.angle,"deg) ").concat(r)),r.length>0&&(s.transform=r)}function Su(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=Fe(Ge,this,Iu)._.get(t||(t=""));if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),Fe(Ge,this,Iu)._.set(t,e),Fe(Ge,this,Ru)._.set(e,{size:0,family:""})}return e}function ku(t,e,n){const i=Fe(Ge,this,Ru)._.get(t);e===i.size&&n===i.family||(t.font="".concat(e,"px ").concat(n),i.size=e,i.family=n)}function Cu(){if(null!==Fe(Ge,this,Mu)._)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),Mu._=Fe(Ge,this,t.getBoundingClientRect().height),t.remove()}function Tu(t,e,n){const i=Fe(Ge,this,xu)._.get(t);if(i)return i;const s=Fe(Ge,this,Su).call(this,n);s.canvas.width=s.canvas.height=30,Fe(Ge,this,ku).call(this,s,30,t);const r=s.measureText(""),a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let l=.8;return a?l=a/(a+o):(ei.platform.isFirefox&&Vn("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?l=e.ascent:e.descent&&(l=1+e.descent)),Fe(Ge,this,xu)._.set(t,l),l}Ge=bu;var xu={_:new Map},Iu={_:new Map},Ru={_:new WeakMap},Mu={_:null},Pu={_:new Set};class Nu{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};return function t(n){var i;if(!n)return;let s=null;const r=n.name;if("#text"===r)s=n.value;else{if(!Nu.shouldBuildText(r))return;null!==n&&void 0!==n&&null!==(i=n.attributes)&&void 0!==i&&i.textContent?s=n.attributes.textContent:n.value&&(s=n.value)}if(null!==s&&e.push({str:s}),n.children)for(const e of n.children)t(e)}(t),n}static shouldBuildText(t){return!("textarea"===t||"input"===t||"option"===t||"select"===t)}}function Du(){var t,e;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"string"===typeof n||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const i=new Lu,{docId:s}=i,r=n.url?function(t){if(t instanceof URL)return t.href;if("string"===typeof t){if(nn)return t;const e=URL.parse(t,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(n.url):null,a=n.data?function(t){if(nn&&"undefined"!==typeof Buffer&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if("string"===typeof t)return ti(t);if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)||"object"===typeof t&&!isNaN(null===t||void 0===t?void 0:t.length))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(n.data):null,o=n.httpHeaders||null,l=!0===n.withCredentials,c=null!==(t=n.password)&&void 0!==t?t:null,u=n.range instanceof Wu?n.range:null,h=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:65536;let d=n.worker instanceof Zu?n.worker:null;const f=n.verbosity,p="string"!==typeof n.docBaseUrl||vi(n.docBaseUrl)?null:n.docBaseUrl,g=bo(n.cMapUrl),m=!1!==n.cMapPacked,v=n.CMapReaderFactory||(nn?kl:Qo),y=bo(n.iccUrl),w=bo(n.standardFontDataUrl),b=n.StandardFontDataFactory||(nn?Cl:wl),_=bo(n.wasmUrl),E=n.WasmFactory||(nn?Tl:_l),A=!0!==n.stopAtErrors,S=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,k=!1!==n.isEvalSupported,C="boolean"===typeof n.isOffscreenCanvasSupported?n.isOffscreenCanvasSupported:!nn,T="boolean"===typeof n.isImageDecoderSupported?n.isImageDecoderSupported:!nn&&(ei.platform.isFirefox||!globalThis.chrome),x=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,I="boolean"===typeof n.disableFontFace?n.disableFontFace:nn,R=!0===n.fontExtraProperties,M=!0===n.enableXfa,P=n.ownerDocument||globalThis.document,N=!0===n.disableRange,D=!0===n.disableStream,L=!0===n.disableAutoFetch,O=!0===n.pdfBug,F=n.CanvasFactory||(nn?Sl:Ko),U=n.FilterFactory||(nn?Al:rl),B=!0===n.enableHWA,V=!1!==n.useWasm,j=u?u.length:null!==(e=n.length)&&void 0!==e?e:NaN,W="boolean"===typeof n.useSystemFonts?n.useSystemFonts:!nn&&!I,z="boolean"===typeof n.useWorkerFetch?n.useWorkerFetch:!!(v===Qo&&b===wl&&E===_l&&g&&w&&_&&bi(g,document.baseURI)&&bi(w,document.baseURI)&&bi(_,document.baseURI));Fn(f);const H={canvasFactory:new F({ownerDocument:P,enableHWA:B}),filterFactory:new U({docId:s,ownerDocument:P}),cMapReaderFactory:z?null:new v({baseUrl:g,isCompressed:m}),standardFontDataFactory:z?null:new b({baseUrl:w}),wasmFactory:z?null:new E({baseUrl:_})};d||(d=Zu.create({verbosity:f,port:cc.workerPort}),i._worker=d);const q={docId:s,apiVersion:"5.3.31",data:a,password:c,disableAutoFetch:L,rangeChunkSize:h,length:j,docBaseUrl:p,enableXfa:M,evaluatorOptions:{maxImageSize:S,disableFontFace:I,ignoreErrors:A,isEvalSupported:k,isOffscreenCanvasSupported:C,isImageDecoderSupported:T,canvasMaxAreaInBytes:x,fontExtraProperties:R,useSystemFonts:W,useWasm:V,useWorkerFetch:z,cMapUrl:g,iccUrl:y,standardFontDataUrl:w,wasmUrl:_}},G={ownerDocument:P,pdfBug:O,styleElement:null,loadingParams:{disableAutoFetch:L,enableXfa:M}};return d.promise.then((function(){if(i.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const t=d.messageHandler.sendWithPromise("GetDocRequest",q,a?[a.buffer]:null);let e;if(u)e=new xc(u,{disableRange:N,disableStream:D});else if(!a){if(!r)throw new Error("getDocument - no `url` parameter provided.");const t=bi(r)?Bc:nn?Kc:zc;e=new t({url:r,length:j,httpHeaders:o,withCredentials:l,rangeChunkSize:h,disableRange:N,disableStream:D})}return t.then((t=>{if(i.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const n=new Vo(s,t,d.port),r=new ph(n,i,e,G,H);i._transport=r,n.send("Ready",null)}))})).catch(i._capability.reject),i}class Lu{constructor(){a(this,"_capability",Promise.withResolvers()),a(this,"_transport",null),a(this,"_worker",null),a(this,"docId","d".concat((Ou._=(Ke=Ou._,Xe=Ke++,Ke),Xe))),a(this,"destroyed",!1),a(this,"onPassword",null),a(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var t;this.destroyed=!0;try{var e,n;null!==(e=this._worker)&&void 0!==e&&e.port&&(this._worker._pendingDestroy=!0),await(null===(n=this._transport)||void 0===n?void 0:n.destroy())}catch(s){var i;throw null!==(i=this._worker)&&void 0!==i&&i.port&&delete this._worker._pendingDestroy,s}this._transport=null,null===(t=this._worker)||void 0===t||t.destroy(),this._worker=null}async getData(){return this._transport.getData()}}var Ou={_:0},Fu=new WeakMap,Uu=new WeakMap,Bu=new WeakMap,Vu=new WeakMap,ju=new WeakMap;class Wu{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Oe(this,Fu,Promise.withResolvers()),Oe(this,Uu,[]),Oe(this,Bu,[]),Oe(this,Vu,[]),Oe(this,ju,[]),this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=i}addRangeListener(t){Be(ju,this).push(t)}addProgressListener(t){Be(Vu,this).push(t)}addProgressiveReadListener(t){Be(Bu,this).push(t)}addProgressiveDoneListener(t){Be(Uu,this).push(t)}onDataRange(t,e){for(const n of Be(ju,this))n(t,e)}onDataProgress(t,e){Be(Fu,this).promise.then((()=>{for(const n of Be(Vu,this))n(t,e)}))}onDataProgressiveRead(t){Be(Fu,this).promise.then((()=>{for(const e of Be(Bu,this))e(t)}))}onDataProgressiveDone(){Be(Fu,this).promise.then((()=>{for(const t of Be(Uu,this))t()}))}transportReady(){Be(Fu,this).resolve()}requestDataRange(t,e){jn("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class zu{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return qn(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){let{intent:t="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Hu=new WeakMap,qu=new WeakSet;class Gu{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Le(this,qu),Oe(this,Hu,!1),this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=i?new wi:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new Zc,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:s=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new gi({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:s})}getAnnotations(){let{intent:t="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return qn(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return(null===(t=this._transport._htmlForXfa)||void 0===t?void 0:t.children[this._pageIndex])||null}render(t){var e,n;let{canvasContext:i,viewport:s,intent:r="display",annotationMode:a=pn.ENABLE,transform:o=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:u=null,pageColors:h=null,printAnnotationStorage:d=null,isEditing:f=!1}=t;null===(e=this._stats)||void 0===e||e.time("Overall");const p=this._transport.getRenderingIntent(r,a,d,f),{renderingIntent:g,cacheKey:m}=p;Ve(Hu,this,!1),c||(c=this._transport.getOptionalContentConfig(g));let v=this._intentStates.get(m);v||(v=Object.create(null),this._intentStates.set(m,v)),v.streamReaderCancelTimeout&&(clearTimeout(v.streamReaderCancelTimeout),v.streamReaderCancelTimeout=null);const y=!!(g&ln);var w;v.displayReadyCapability||(v.displayReadyCapability=Promise.withResolvers(),v.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(w=this._stats)||void 0===w||w.time("Page Request"),this._pumpOperatorList(p));const b=t=>{var e;(v.renderTasks.delete(_),y&&Ve(Hu,this,!0),Fe(qu,this,Ku).call(this),t?(_.capability.reject(t),this._abortOperatorList({intentState:v,reason:t instanceof Error?t:new Error(t)})):_.capability.resolve(),this._stats)&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),null!==(e=globalThis.Stats)&&void 0!==e&&e.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},_=new wh({callback:b,params:{canvasContext:i,viewport:s,transform:o,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:v.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!y,pdfBug:this._pdfBug,pageColors:h});((n=v).renderTasks||(n.renderTasks=new Set)).add(_);const E=_.task;return Promise.all([v.displayReadyCapability.promise,c]).then((t=>{var e;let[n,i]=t;if(this.destroyed)b();else{if(null===(e=this._stats)||void 0===e||e.time("Rendering"),!(i.renderingIntent&g))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");_.initializeGraphics({transparency:n,optionalContentConfig:i}),_.operatorListChanged()}})).catch(b),E}getOperatorList(){let{intent:t="display",annotationMode:e=pn.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=this._transport.getRenderingIntent(t,e,n,i,!0);let r,a=this._intentStates.get(s.cacheKey);var o,l;(a||(a=Object.create(null),this._intentStates.set(s.cacheKey,a)),a.opListReadCapability)||(r=Object.create(null),r.operatorListChanged=function(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(r))},a.opListReadCapability=Promise.withResolvers(),((o=a).renderTasks||(o.renderTasks=new Set)).add(r),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(l=this._stats)||void 0===l||l.time("Page Request"),this._pumpOperatorList(s));return a.opListReadCapability.promise}streamTextContent(){let{includeMarkedContent:t=!1,disableNormalization:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===t,disableNormalization:!0===e},{highWaterMark:100,size:t=>t.items.length})}getTextContent(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then((t=>Nu.textContent(t)));const e=this.streamTextContent(t);return new Promise((function(t,n){const i=e.getReader(),s={items:[],styles:Object.create(null),lang:null};!function e(){i.read().then((function(n){var i;let{value:r,done:a}=n;a?t(s):(null!==(i=s.lang)&&void 0!==i||(s.lang=r.lang),Object.assign(s.styles,r.styles),s.items.push(...r.items),e())}),n)}()}))}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),Ve(Hu,this,!1),Promise.all(t)}cleanup(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ve(Hu,this,!0);const e=Fe(qu,this,Ku).call(this);return t&&e&&this._stats&&(this._stats=new wi),e}_startRenderPage(t,e){var n,i;const s=this._intentStates.get(e);s&&(null===(n=this._stats)||void 0===n||n.timeEnd("Page Request"),null===(i=s.displayReadyCapability)||void 0===i||i.resolve(t))}_renderPageChunk(t,e){for(let n=0,i=t.length;n<i;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&Fe(qu,this,Ku).call(this)}_pumpOperatorList(t){let{renderingIntent:e,cacheKey:n,annotationStorageSerializable:i,modifiedIds:s}=t;const{map:r,transfer:a}=i,o=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:n,annotationStorage:r,modifiedIds:s},a).getReader(),l=this._intentStates.get(n);l.streamReader=o;const c=()=>{o.read().then((t=>{let{value:e,done:n}=t;n?l.streamReader=null:this._transport.destroyed||(this._renderPageChunk(e,l),c())}),(t=>{if(l.streamReader=null,!this._transport.destroyed){if(l.operatorList){l.operatorList.lastChunk=!0;for(const t of l.renderTasks)t.operatorListChanged();Fe(qu,this,Ku).call(this)}if(l.displayReadyCapability)l.displayReadyCapability.reject(t);else{if(!l.opListReadCapability)throw t;l.opListReadCapability.reject(t)}}}))};c()}_abortOperatorList(t){let{intentState:e,reason:n,force:i=!1}=t;if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(n instanceof mi){let t=100;return n.extraDelay>0&&n.extraDelay<1e3&&(t+=n.extraDelay),void(e.streamReaderCancelTimeout=setTimeout((()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:n,force:!0})}),t))}}if(e.streamReader.cancel(new $n(n.message)).catch((()=>{})),e.streamReader=null,!this._transport.destroyed){for(const[t,n]of this._intentStates)if(n===e){this._intentStates.delete(t);break}this.cleanup()}}}get stats(){return this._stats}}function Ku(){if(!Be(Hu,this)||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Ve(Hu,this,!1),!0}var Xu=new WeakMap,Qu=new WeakMap,Yu=new WeakMap,Ju=new WeakMap,$u=new WeakSet;class Zu{constructor(){let{name:t=null,port:e=null,verbosity:n=Un()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Le(this,$u),Oe(this,Xu,Promise.withResolvers()),Oe(this,Qu,null),Oe(this,Yu,null),Oe(this,Ju,null),this.name=t,this.destroyed=!1,this.verbosity=n,e){if(oh._.has(e))throw new Error("Cannot use more than one PDFWorker per port.");oh._.set(e,this),Fe($u,this,eh).call(this,e)}else Fe($u,this,nh).call(this)}get promise(){return Be(Xu,this).promise}get port(){return Be(Yu,this)}get messageHandler(){return Be(Qu,this)}destroy(){var t,e;this.destroyed=!0,null===(t=Be(Ju,this))||void 0===t||t.terminate(),Ve(Ju,this,null),oh._.delete(Be(Yu,this)),Ve(Yu,this,null),null===(e=Be(Qu,this))||void 0===e||e.destroy(),Ve(Qu,this,null)}static create(t){const e=Fe(Zu,this,oh)._.get(null===t||void 0===t?void 0:t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Zu(t)}static get workerSrc(){if(cc.workerSrc)return cc.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return qn(this,"_setupFakeWorkerGlobal",(async()=>{if(Ue(Zu,this,sh))return Ue(Zu,this,sh);return(await import(this.workerSrc)).WorkerMessageHandler})())}}function th(){Be(Xu,this).resolve(),Be(Qu,this).send("configure",{verbosity:this.verbosity})}function eh(t){Ve(Yu,this,t),Ve(Qu,this,new Vo("main","worker",t)),Be(Qu,this).on("ready",(()=>{})),Fe($u,this,th).call(this)}function nh(){if(ah._||sh(Qe))return void Fe($u,this,ih).call(this);let{workerSrc:t}=Qe;try{Qe._isSameOrigin(window.location,t)||(t=Qe._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new Vo("main","worker",e),i=()=>{s.abort(),n.destroy(),e.terminate(),this.destroyed?Be(Xu,this).reject(new Error("Worker was destroyed")):Fe($u,this,ih).call(this)},s=new AbortController;e.addEventListener("error",(()=>{Be(Ju,this)||i()}),{signal:s.signal}),n.on("test",(t=>{s.abort(),!this.destroyed&&t?(Ve(Qu,this,n),Ve(Yu,this,e),Ve(Ju,this,e),Fe($u,this,th).call(this)):i()})),n.on("ready",(t=>{if(s.abort(),this.destroyed)i();else try{r()}catch(e){Fe($u,this,ih).call(this)}}));const r=()=>{const t=new Uint8Array;n.send("test",t,[t.buffer])};return void r()}catch(e){Bn("The worker has been disabled.")}Fe($u,this,ih).call(this)}function ih(){ah._||(Vn("Setting up fake worker."),ah._=!0),Qe._setupFakeWorkerGlobal.then((t=>{var e,n;if(this.destroyed)return void Be(Xu,this).reject(new Error("Worker was destroyed"));const i=new ko;Ve(Yu,this,i);const s="fake".concat((rh._=(e=rh._,n=e++,e),n)),r=new Vo(s+"_worker",s,i);t.setup(r,i),Ve(Qu,this,new Vo(s,s+"_worker",i)),Fe($u,this,th).call(this)})).catch((t=>{Be(Xu,this).reject(new Error('Setting up fake worker failed: "'.concat(t.message,'".')))}))}function sh(t){try{var e;return(null===(e=globalThis.pdfjsWorker)||void 0===e?void 0:e.WorkerMessageHandler)||null}catch(n){return null}}Qe=Zu;var rh={_:0},ah={_:!1},oh={_:new WeakMap};nn&&(ah._=Fe(Qe,Qe,!0),cc.workerSrc||(cc.workerSrc="./pdf.worker.mjs")),Qe._isSameOrigin=(t,e)=>{const n=URL.parse(t);if(null===n||void 0===n||!n.origin||"null"===n.origin)return!1;const i=new URL(e,n);return n.origin===i.origin},Qe._createCDNWrapper=t=>{const e='await import("'.concat(t,'");');return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Qe.fromPort=t=>{var e;if(e="`PDFWorker.fromPort` - please use `PDFWorker.create` instead.",console.log("Deprecated API usage: "+e),null===t||void 0===t||!t.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Qe.create(t)};var lh=new WeakMap,ch=new WeakMap,uh=new WeakMap,hh=new WeakMap,dh=new WeakMap,fh=new WeakSet;class ph{constructor(t,e,n,i,s){Le(this,fh),Oe(this,lh,new Map),Oe(this,ch,new Map),Oe(this,uh,new Map),Oe(this,hh,new Map),Oe(this,dh,null),this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Zc,this.fontLoader=new yo({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return qn(this,"annotationStorage",new fo)}getRenderingIntent(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pn.ENABLE,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=on,a=oo;switch(t){case"any":r=an;break;case"display":break;case"print":r=ln;break;default:Vn("getRenderingIntent - invalid intent: ".concat(t))}const o=r&ln&&n instanceof mo?n:this.annotationStorage;switch(e){case pn.DISABLE:r+=hn;break;case pn.ENABLE:break;case pn.ENABLE_FORMS:r+=cn;break;case pn.ENABLE_STORAGE:r+=un,a=o.serializable;break;default:Vn("getRenderingIntent - invalid annotationMode: ".concat(e))}i&&(r+=dn),s&&(r+=fn);const{ids:l,hash:c}=o.modifiedIds;return{renderingIntent:r,cacheKey:[r,a.hash,c].join("_"),annotationStorageSerializable:a,modifiedIds:l}}destroy(){var t;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),null===(t=Be(dh,this))||void 0===t||t.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of Be(ch,this).values())e.push(i._destroy());Be(ch,this).clear(),Be(uh,this).clear(),Be(hh,this).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const n=this.messageHandler.sendWithPromise("Terminate",null);return e.push(n),Promise.all(e).then((()=>{var t,e;this.commonObjs.clear(),this.fontLoader.clear(),Be(lh,this).clear(),this.filterFactory.destroy(),bu.cleanup(),null===(t=this._networkStream)||void 0===t||t.cancelAllRequests(new $n("Worker was terminated.")),null===(e=this.messageHandler)||void 0===e||e.destroy(),this.messageHandler=null,this.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",((t,e)=>{Wn(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},e.onPull=()=>{this._fullReader.read().then((function(t){let{value:n,done:i}=t;i?e.close():(Wn(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(n),1,[n]))})).catch((t=>{e.error(t)}))},e.onCancel=t=>{this._fullReader.cancel(t),e.ready.catch((t=>{if(!this.destroyed)throw t}))}})),t.on("ReaderHeadersReady",(async t=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:i,contentLength:s}=this._fullReader;if(!n||!i){var r;if(this._lastProgress)null===(r=e.onProgress)||void 0===r||r.call(e,this._lastProgress);this._fullReader.onProgress=t=>{var n;null===(n=e.onProgress)||void 0===n||n.call(e,{loaded:t.loaded,total:t.total})}}return{isStreamingSupported:n,isRangeSupported:i,contentLength:s}})),t.on("GetRangeReader",((t,e)=>{Wn(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(t.begin,t.end);n?(e.onPull=()=>{n.read().then((function(t){let{value:n,done:i}=t;i?e.close():(Wn(n instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(n),1,[n]))})).catch((t=>{e.error(t)}))},e.onCancel=t=>{n.cancel(t),e.ready.catch((t=>{if(!this.destroyed)throw t}))}):e.close()})),t.on("GetDoc",(t=>{let{pdfInfo:n}=t;this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new zu(n,this))})),t.on("DocException",(t=>{e._capability.reject(Fo(t))})),t.on("PasswordRequest",(t=>{Ve(dh,this,Promise.withResolvers());try{if(!e.onPassword)throw Fo(t);const n=t=>{t instanceof Error?Be(dh,this).reject(t):Be(dh,this).resolve({password:t})};e.onPassword(n,t.code)}catch(n){Be(dh,this).reject(n)}return Be(dh,this).promise})),t.on("DataLoaded",(t=>{var n;null===(n=e.onProgress)||void 0===n||n.call(e,{loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)})),t.on("StartRenderPage",(t=>{if(this.destroyed)return;Be(ch,this).get(t.pageIndex)._startRenderPage(t.transparency,t.cacheKey)})),t.on("commonobj",(e=>{var n;let[i,s,r]=e;if(this.destroyed)return null;if(this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in r){const t=r.error;Vn("Error during font loading: ".concat(t)),this.commonObjs.resolve(i,t);break}const e=this._params.pdfBug&&null!==(n=globalThis.FontInspector)&&void 0!==n&&n.enabled?(t,e)=>globalThis.FontInspector.fontAdded(t,e):null,a=new wo(r,e);this.fontLoader.bind(a).catch((()=>t.sendWithPromise("FontFallback",{id:i}))).finally((()=>{!a.fontExtraProperties&&a.data&&(a.data=null),this.commonObjs.resolve(i,a)}));break;case"CopyLocalImage":const{imageRef:o}=r;Wn(o,"The imageRef must be defined.");for(const t of Be(ch,this).values())for(const[,e]of t.objs)if((null===e||void 0===e?void 0:e.ref)===o)return e.dataLen?(this.commonObjs.resolve(i,structuredClone(e)),e.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error("Got unknown common object type ".concat(s))}return null})),t.on("obj",(t=>{let[e,n,i,s]=t;if(this.destroyed)return;const r=Be(ch,this).get(n);var a;if(!r.objs.has(e))if(0!==r._intentStates.size)switch(i){case"Image":case"Pattern":r.objs.resolve(e,s);break;default:throw new Error("Got unknown object type ".concat(i))}else null===s||void 0===s||null===(a=s.bitmap)||void 0===a||a.close()})),t.on("DocProgress",(t=>{var n;this.destroyed||null===(n=e.onProgress)||void 0===n||n.call(e,{loaded:t.loaded,total:t.total})})),t.on("FetchBinaryData",(async t=>{if(this.destroyed)throw new Error("Worker was destroyed.");const e=this[t.type];if(!e)throw new Error("".concat(t.type," not initialized, see the `useWorkerFetch` parameter."));return e.fetch(t)}))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var t,e;this.annotationStorage.size<=0&&Vn("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:n,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:n,filename:null!==(t=null===(e=this._fullReader)||void 0===e?void 0:e.filename)&&void 0!==t?t:null},i).finally((()=>{this.annotationStorage.resetModified()}))}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=Be(uh,this).get(e);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then((n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&Be(hh,this).set(n.refStr,t);const i=new Gu(e,n,this,this._params.pdfBug);return Be(ch,this).set(e,i),i}));return Be(uh,this).set(e,i),i}getPageIndex(t){return _o(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return Fe(fh,this,gh).call(this,"GetFieldObjects")}hasJSActions(){return Fe(fh,this,gh).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return"string"!==typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Fe(fh,this,gh).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return Fe(fh,this,gh).call(this,"GetOptionalContentConfig").then((e=>new Cc(e,t)))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=Be(lh,this).get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then((t=>{var e,n,i,s;return{info:t[0],metadata:t[1]?new pc(t[1]):null,contentDispositionFilename:null!==(e=null===(n=this._fullReader)||void 0===n?void 0:n.filename)&&void 0!==e?e:null,contentLength:null!==(i=null===(s=this._fullReader)||void 0===s?void 0:s.contentLength)&&void 0!==i?i:null}}));return Be(lh,this).set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of Be(ch,this).values()){if(!t.cleanup())throw new Error("startCleanup: Page ".concat(t.pageNumber," is currently rendering."))}this.commonObjs.clear(),t||this.fontLoader.clear(),Be(lh,this).clear(),this.filterFactory.destroy(!0),bu.cleanup()}}cachedPageNumber(t){var e;if(!_o(t))return null;const n=0===t.gen?"".concat(t.num,"R"):"".concat(t.num,"R").concat(t.gen);return null!==(e=Be(hh,this).get(n))&&void 0!==e?e:null}}function gh(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=Be(lh,this).get(t);if(n)return n;const i=this.messageHandler.sendWithPromise(t,e);return Be(lh,this).set(t,i),i}var mh=new WeakMap;class vh{constructor(t){Oe(this,mh,null),a(this,"onContinue",null),a(this,"onError",null),Ve(mh,this,t)}get promise(){return Be(mh,this).capability.promise}cancel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Be(mh,this).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=Be(mh,this).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=Be(mh,this);return t.form||t.canvas&&(null===e||void 0===e?void 0:e.size)>0}}var yh=new WeakMap;class wh{constructor(t){let{callback:e,params:n,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:u=!1,pdfBug:h=!1,pageColors:d=null}=t;Oe(this,yh,null),this.callback=e,this.params=n,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=h,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===u&&"undefined"!==typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new vh(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=n.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics(t){var e,n;let{transparency:i=!1,optionalContentConfig:s}=t;if(this.cancelled)return;if(this._canvas){if(bh._.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");bh._.add(this._canvas)}this._pdfBug&&null!==(e=globalThis.StepperManager)&&void 0!==e&&e.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:a,transform:o,background:l}=this.params;this.gfx=new rc(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:s},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:o,viewport:a,transparency:i,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,null===(n=this.graphicsReadyCallback)||void 0===n||n.call(this)}cancel(){var t,e,n;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.running=!1,this.cancelled=!0,null===(t=this.gfx)||void 0===t||t.endDrawing(),Be(yh,this)&&(window.cancelAnimationFrame(Be(yh,this)),Ve(yh,this,null)),bh._.delete(this._canvas),i||(i=new mi("Rendering cancelled, page ".concat(this._pageIndex+1),s)),this.callback(i),null===(e=(n=this.task).onError)||void 0===e||e.call(n,i)}operatorListChanged(){var t;this.graphicsReady?(null===(t=this.stepper)||void 0===t||t.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?Ve(yh,this,window.requestAnimationFrame((()=>{Ve(yh,this,null),this._nextBound().catch(this._cancelBound)}))):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),bh._.delete(this._canvas),this.callback())))}}var bh={_:new WeakSet};function _h(t){return Math.floor(255*Math.max(0,Math.min(1,t))).toString(16).padStart(2,"0")}function Eh(t){return Math.max(0,Math.min(255,255*t))}class Ah{static CMYK_G(t){let[e,n,i,s]=t;return["G",1-Math.min(1,.3*e+.59*i+.11*n+s)]}static G_CMYK(t){let[e]=t;return["CMYK",0,0,0,1-e]}static G_RGB(t){let[e]=t;return["RGB",e,e,e]}static G_rgb(t){let[e]=t;return e=Eh(e),[e,e,e]}static G_HTML(t){let[e]=t;const n=_h(e);return"#".concat(n).concat(n).concat(n)}static RGB_G(t){let[e,n,i]=t;return["G",.3*e+.59*n+.11*i]}static RGB_rgb(t){return t.map(Eh)}static RGB_HTML(t){return"#".concat(t.map(_h).join(""))}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB(t){let[e,n,i,s]=t;return["RGB",1-Math.min(1,e+s),1-Math.min(1,i+s),1-Math.min(1,n+s)]}static CMYK_rgb(t){let[e,n,i,s]=t;return[Eh(1-Math.min(1,e+s)),Eh(1-Math.min(1,i+s)),Eh(1-Math.min(1,n+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK(t){let[e,n,i]=t;const s=1-e,r=1-n,a=1-i;return["CMYK",s,r,a,Math.min(s,r,a)]}}class Sh{create(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width","".concat(t,"px")),i.setAttribute("height","".concat(e,"px"))),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox","0 0 ".concat(t," ").concat(e)),i}createElement(t){if("string"!==typeof t)throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){jn("Abstract method `_createSVG` called.")}}class kh extends Sh{_createSVG(t){return document.createElementNS(di,t)}}class Ch{static setupStorage(t,e,n,i,s){const r=i.getValue(e,{value:null});switch(n.name){case"textarea":if(null!==r.value&&(t.textContent=r.value),"print"===s)break;t.addEventListener("input",(t=>{i.setValue(e,{value:t.target.value})}));break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(r.value===n.attributes.xfaOn?t.setAttribute("checked",!0):r.value===n.attributes.xfaOff&&t.removeAttribute("checked"),"print"===s)break;t.addEventListener("change",(t=>{i.setValue(e,{value:t.target.checked?t.target.getAttribute("xfaOn"):t.target.getAttribute("xfaOff")})}))}else{if(null!==r.value&&t.setAttribute("value",r.value),"print"===s)break;t.addEventListener("input",(t=>{i.setValue(e,{value:t.target.value})}))}break;case"select":if(null!==r.value){t.setAttribute("value",r.value);for(const t of n.children)t.attributes.value===r.value?t.attributes.selected=!0:t.attributes.hasOwnProperty("selected")&&delete t.attributes.selected}t.addEventListener("input",(t=>{const n=t.target.options,s=-1===n.selectedIndex?"":n[n.selectedIndex].value;i.setValue(e,{value:s})}))}}static setAttributes(t){let{html:e,element:n,storage:i=null,intent:s,linkService:r}=t;const{attributes:a}=n,o=e instanceof HTMLAnchorElement;"radio"===a.type&&(a.name="".concat(a.name,"-").concat(s));for(const[l,c]of Object.entries(a))if(null!==c&&void 0!==c)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||"href"!==l&&"newWindow"!==l)&&e.setAttribute(l,c)}o&&r.addLinkAttributes(e,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(e,a.dataId,n,i)}static render(t){const e=t.annotationStorage,n=t.linkService,i=t.xfaHtml,s=t.intent||"display",r=document.createElement(i.name);i.attributes&&this.setAttributes({html:r,element:i,intent:s,linkService:n});const a="richText"!==s,o=t.div;if(o.append(r),t.viewport){const e="matrix(".concat(t.viewport.transform.join(","),")");o.style.transform=e}a&&o.setAttribute("class","xfaLayer xfaFont");const l=[];if(0===i.children.length){if(i.value){const t=document.createTextNode(i.value);r.append(t),a&&Nu.shouldBuildText(i.name)&&l.push(t)}return{textDivs:l}}const c=[[i,-1,r]];for(;c.length>0;){var u,h;const[t,i,r]=c.at(-1);if(i+1===t.children.length){c.pop();continue}const o=t.children[++c.at(-1)[1]];if(null===o)continue;const{name:d}=o;if("#text"===d){const t=document.createTextNode(o.value);l.push(t),r.append(t);continue}const f=null!==o&&void 0!==o&&null!==(u=o.attributes)&&void 0!==u&&u.xmlns?document.createElementNS(o.attributes.xmlns,d):document.createElement(d);if(r.append(f),o.attributes&&this.setAttributes({html:f,element:o,storage:e,intent:s,linkService:n}),(null===(h=o.children)||void 0===h?void 0:h.length)>0)c.push([o,-1,f]);else if(o.value){const t=document.createTextNode(o.value);a&&Nu.shouldBuildText(d)&&l.push(t),f.append(t)}}for(const d of o.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:l}}static update(t){const e="matrix(".concat(t.viewport.transform.join(","),")");t.div.style.transform=e,t.div.hidden=!1}}const Th=1e3,xh=new WeakSet;class Ih{static create(t){switch(t.data.annotationType){case Sn.LINK:return new Fh(t);case Sn.TEXT:return new jh(t);case Sn.WIDGET:switch(t.data.fieldType){case"Tx":return new zh(t);case"Btn":return t.data.radioButton?new Gh(t):t.data.checkBox?new qh(t):new Kh(t);case"Ch":return new Xh(t);case"Sig":return new Hh(t)}return new Wh(t);case Sn.POPUP:return new Qh(t);case Sn.FREETEXT:return new Cd(t);case Sn.LINE:return new xd(t);case Sn.SQUARE:return new Rd(t);case Sn.CIRCLE:return new Pd(t);case Sn.POLYLINE:return new Dd(t);case Sn.CARET:return new Od(t);case Sn.INK:return new Vd(t);case Sn.POLYGON:return new Ld(t);case Sn.HIGHLIGHT:return new Wd(t);case Sn.UNDERLINE:return new zd(t);case Sn.SQUIGGLY:return new Hd(t);case Sn.STRIKEOUT:return new qd(t);case Sn.STAMP:return new Gd(t);case Sn.FILEATTACHMENT:return new Qd(t);default:return new Dh(t)}}}var Rh=new WeakMap,Mh=new WeakMap,Ph=new WeakMap,Nh=new WeakSet;class Dh{constructor(t){let{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Le(this,Nh),Oe(this,Rh,null),Oe(this,Mh,!1),Oe(this,Ph,null),this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData(t){let{titleObj:e,contentsObj:n,richText:i}=t;return!!(null!==e&&void 0!==e&&e.str||null!==n&&void 0!==n&&n.str||null!==i&&void 0!==i&&i.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Dh._hasPopupData(this.data)}updateEdited(t){var e;if(!this.container)return;Be(Rh,this)||Ve(Rh,this,{rect:this.data.rect.slice(0)});const{rect:n}=t;n&&Fe(Nh,this,Lh).call(this,n),null===(e=Be(Ph,this))||void 0===e||e.popup.updateEdited(t)}resetEdited(){var t;Be(Rh,this)&&(Fe(Nh,this,Lh).call(this,Be(Rh,this).rect),null===(t=Be(Ph,this))||void 0===t||t.popup.resetEdited(),Ve(Rh,this,null))}_createContainer(t){const{data:e,parent:{page:n,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof Wh||(s.tabIndex=Th);const{style:r}=s;if(r.zIndex=this.parent.zIndex++,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof Qh){const{rotation:t}=e;return e.hasOwnCanvas||0===t||this.setRotation(t,s),s}const{width:a,height:o}=this;if(!t&&e.borderStyle.width>0){r.borderWidth="".concat(e.borderStyle.width,"px");const t=e.borderStyle.horizontalCornerRadius,n=e.borderStyle.verticalCornerRadius;if(t>0||n>0){const e="calc(".concat(t,"px * var(--total-scale-factor)) / calc(").concat(n,"px * var(--total-scale-factor))");r.borderRadius=e}else if(this instanceof Gh){const t="calc(".concat(a,"px * var(--total-scale-factor)) / calc(").concat(o,"px * var(--total-scale-factor))");r.borderRadius=t}switch(e.borderStyle.style){case kn:r.borderStyle="solid";break;case Cn:r.borderStyle="dashed";break;case Tn:Vn("Unimplemented border style: beveled");break;case xn:Vn("Unimplemented border style: inset");break;case In:r.borderBottomStyle="solid"}const i=e.borderColor||null;i?(Ve(Mh,this,!0),r.borderColor=ii.makeHexColor(0|i[0],0|i[1],0|i[2])):r.borderWidth=0}const l=ii.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:c,pageHeight:u,pageX:h,pageY:d}=i.rawDims;r.left="".concat(100*(l[0]-h)/c,"%"),r.top="".concat(100*(l[1]-d)/u,"%");const{rotation:f}=e;return e.hasOwnCanvas||0===f?(r.width="".concat(100*a/c,"%"),r.height="".concat(100*o/u,"%")):this.setRotation(f,s),s}setRotation(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims;let{width:s,height:r}=this;t%180!==0&&([s,r]=[r,s]),e.style.width="".concat(100*s/n,"%"),e.style.height="".concat(100*r/i,"%"),e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(t,e,n)=>{const i=n.detail[t],s=i[0],r=i.slice(1);n.target.style[e]=Ah["".concat(s,"_HTML")](r),this.annotationStorage.setValue(this.data.id,{[e]:Ah["".concat(s,"_rgb")](r)})};return qn(this,"_commonActions",{display:t=>{const{display:e}=t.detail,n=e%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:1===e||2===e})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:e}=t.detail;this.container.style.visibility=e?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:e,noView:e})},focus:t=>{setTimeout((()=>t.target.focus({preventScroll:!1})),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:t=>{const e=t.detail.rotation;this.setRotation(e),this.annotationStorage.setValue(this.data.id,{rotation:e})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const i of Object.keys(e.detail)){const s=t[i]||n[i];null===s||void 0===s||s(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[i,s]of Object.entries(e)){const r=n[i];if(r){r({detail:{[i]:s},target:t}),delete e[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,i,s]=this.data.rect.map((t=>Math.fround(t)));if(8===t.length){const[r,a,o,l]=t.subarray(2,6);if(i===r&&s===a&&e===o&&n===l)return}const{style:r}=this.container;let a;if(Be(Mh,this)){const{borderColor:t,borderWidth:e}=r;r.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">','<g fill="transparent" stroke="'.concat(t,'" stroke-width="').concat(e,'">')],this.container.classList.add("hasBorder")}const o=i-e,l=s-n,{svgFactory:c}=this,u=c.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0);const h=c.createElement("defs");u.append(h);const d=c.createElement("clipPath"),f="clippath_".concat(this.data.id);d.setAttribute("id",f),d.setAttribute("clipPathUnits","objectBoundingBox"),h.append(d);for(let g=2,m=t.length;g<m;g+=8){var p;const n=t[g],i=t[g+1],r=t[g+2],u=t[g+3],h=c.createElement("rect"),f=(r-e)/o,m=(s-i)/l,v=(n-r)/o,y=(i-u)/l;h.setAttribute("x",f),h.setAttribute("y",m),h.setAttribute("width",v),h.setAttribute("height",y),d.append(h),null===(p=a)||void 0===p||p.push('<rect vector-effect="non-scaling-stroke" x="'.concat(f,'" y="').concat(m,'" width="').concat(v,'" height="').concat(y,'"/>'))}Be(Mh,this)&&(a.push("</g></svg>')"),r.backgroundImage=a.join("")),this.container.append(u),this.container.style.clipPath="url(#".concat(f,")")}_createPopup(){const{data:t}=this,e=Ve(Ph,this,new Qh({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:"popup_".concat(t.id),rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){jn("Abstract method `AnnotationElement.render` called")}_getElementsByName(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:t,id:s,exportValues:r}of i){if(-1===t)continue;if(s===e)continue;const i="string"===typeof r?r:null,a=document.querySelector('[data-element-id="'.concat(s,'"]'));!a||xh.has(a)?n.push({id:s,exportValue:i,domElement:a}):Vn("_getElementsByName - element not allowed: ".concat(s))}return n}for(const i of document.getElementsByName(t)){const{exportValue:t}=i,s=i.getAttribute("data-element-id");s!==e&&(xh.has(i)&&n.push({id:s,exportValue:t,domElement:i}))}return n}show(){var t;this.container&&(this.container.hidden=!1),null===(t=this.popup)||void 0===t||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),null===(t=this.popup)||void 0===t||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",(()=>{var n;null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})}))}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}function Lh(t){const{container:{style:e},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:a,pageY:o}}}}=this;null===n||void 0===n||n.splice(0,4,...t),e.left="".concat(100*(t[0]-a)/s,"%"),e.top="".concat(100*(r-t[3]+o)/r,"%"),0===i?(e.width="".concat(100*(t[2]-t[0])/s,"%"),e.height="".concat(100*(t[3]-t[1])/r,"%")):this.setRotation(i)}var Oh=new WeakSet;class Fh extends Dh{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(t,{isRenderable:!0,ignoreBorder:!(null===e||void 0===e||!e.ignoreBorder),createQuadrilaterals:!0}),Le(this,Oh),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let i=!1;return t.url?(e.addLinkAttributes(n,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(n,t.action),i=!0):t.attachment?(Fe(Oh,this,Bh).call(this,n,t.attachment,t.attachmentDest),i=!0):t.setOCGState?(Fe(Oh,this,Vh).call(this,n,t.setOCGState),i=!0):t.dest?(this._bindLink(n,t.dest),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),i=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||""===e)&&Fe(Oh,this,Uh).call(this)}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),Fe(Oh,this,Uh).call(this)}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(e.actions)){const s=n.get(i);s&&(t[s]=()=>{var t;return null===(t=this.linkService.eventBus)||void 0===t||t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:i}}),!1})}t.onclick||(t.onclick=()=>!1),Fe(Oh,this,Uh).call(this)}_bindResetFormAction(t,e){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),Fe(Oh,this,Uh).call(this),!this._fieldObjects)return Vn('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(n||(t.onclick=()=>!1));t.onclick=()=>{null===n||void 0===n||n();const{fields:t,refs:i,include:s}=e,r=[];if(0!==t.length||0!==i.length){const e=new Set(i);for(const n of t){const t=this._fieldObjects[n]||[];for(const{id:n}of t)e.add(n)}for(const t of Object.values(this._fieldObjects))for(const n of t)e.has(n.id)===s&&r.push(n)}else for(const e of Object.values(this._fieldObjects))r.push(...e);const a=this.annotationStorage,o=[];for(const e of r){const{id:t}=e;switch(o.push(t),e.type){case"text":{const n=e.defaultValue||"";a.setValue(t,{value:n});break}case"checkbox":case"radiobutton":{const n=e.defaultValue===e.exportValues;a.setValue(t,{value:n});break}case"combobox":case"listbox":{const n=e.defaultValue||"";a.setValue(t,{value:n});break}default:continue}const n=document.querySelector('[data-element-id="'.concat(t,'"]'));n&&(xh.has(n)?n.dispatchEvent(new Event("resetform")):Vn("_bindResetFormAction - element not allowed: ".concat(t)))}var l;this.enableScripting&&(null===(l=this.linkService.eventBus)||void 0===l||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:o,name:"ResetForm"}}));return!1}}}function Uh(){this.container.setAttribute("data-internal-link","")}function Bh(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>{var t;return null===(t=this.downloadManager)||void 0===t||t.openOrDownloadData(e.content,e.filename,n),!1},Fe(Oh,this,Uh).call(this)}function Vh(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),Fe(Oh,this,Uh).call(this)}class jh extends Dh{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Wh extends Dh{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&("CANVAS"===(null===(e=t.previousSibling)||void 0===e?void 0:e.nodeName)&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return ei.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,i,s){n.includes("mouse")?t.addEventListener(n,(t=>{var e;null===(e=this.linkService.eventBus)||void 0===e||e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(t),shift:t.shiftKey,modifier:this._getKeyModifier(t)}})})):t.addEventListener(n,(t=>{var r;if("blur"===n){if(!e.focused||!t.relatedTarget)return;e.focused=!1}else if("focus"===n){if(e.focused)return;e.focused=!0}s&&(null===(r=this.linkService.eventBus)||void 0===r||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(t)}}))}))}_setEventListeners(t,e,n,i){for(const[o,l]of n){var s,r,a;if("Action"===l||null!==(s=this.data.actions)&&void 0!==s&&s[l])"Focus"!==l&&"Blur"!==l||e||(e={focused:!1}),this._setEventListener(t,e,o,l,i),"Focus"!==l||null!==(r=this.data.actions)&&void 0!==r&&r.Blur?"Blur"!==l||null!==(a=this.data.actions)&&void 0!==a&&a.Focus||this._setEventListener(t,e,"focus","Focus",null):this._setEventListener(t,e,"blur","Blur",null)}}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=null===e?"transparent":ii.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||9,s=t.style;let r;const a=t=>Math.round(10*t)/10;if(this.data.multiLine){const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2),e=t/(Math.round(t/(rn*i))||1);r=Math.min(i,a(e/rn))}else{const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2);r=Math.min(i,a(t/rn))}s.fontSize="calc(".concat(r,"px * var(--total-scale-factor))"),s.color=ii.makeHexColor(n[0],n[1],n[2]),null!==this.data.textAlignment&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class zh extends Wh{constructor(t){super(t,{isRenderable:t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue})}setPropertyOnSiblings(t,e,n,i){const s=this.annotationStorage;for(const r of this._getElementsByName(t.name,t.id))r.domElement&&(r.domElement[e]=n),s.setValue(r.id,{[i]:n})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){var i;const r=t.getValue(e,{value:this.data.fieldValue});let a=r.value||"";const o=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;o&&a.length>o&&(a=a.slice(0,o));let l=r.formattedValue||(null===(i=this.data.textContent)||void 0===i?void 0:i.join("\n"))||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const c={userValue:a,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=null!==l&&void 0!==l?l:a,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",null!==l&&void 0!==l?l:a),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),xh.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=Th,this._setRequired(n,this.data.required),o&&(n.maxLength=o),n.addEventListener("input",(i=>{t.setValue(e,{value:i.target.value}),this.setPropertyOnSiblings(n,"value",i.target.value,"value"),c.formattedValue=null})),n.addEventListener("resetform",(t=>{var e;const i=null!==(e=this.data.defaultFieldValue)&&void 0!==e?e:"";n.value=c.userValue=i,c.formattedValue=null}));let u=t=>{const{formattedValue:e}=c;null!==e&&void 0!==e&&(t.target.value=e),t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){var s;n.addEventListener("focus",(t=>{var e;if(c.focused)return;const{target:n}=t;c.userValue&&(n.value=c.userValue),c.lastCommittedValue=n.value,c.commitKey=1,null!==(e=this.data.actions)&&void 0!==e&&e.Focus||(c.focused=!0)})),n.addEventListener("updatefromsandbox",(n=>{this.showElementAndHideCanvas(n.target);const i={value(n){var i;c.userValue=null!==(i=n.detail.value)&&void 0!==i?i:"",t.setValue(e,{value:c.userValue.toString()}),n.target.value=c.userValue},formattedValue(n){const{formattedValue:i}=n.detail;c.formattedValue=i,null!==i&&void 0!==i&&n.target!==document.activeElement&&(n.target.value=i),t.setValue(e,{formattedValue:i})},selRange(t){t.target.setSelectionRange(...t.detail.selRange)},charLimit:n=>{var i;const{charLimit:s}=n.detail,{target:r}=n;if(0===s)return void r.removeAttribute("maxLength");r.setAttribute("maxLength",s);let a=c.userValue;!a||a.length<=s||(a=a.slice(0,s),r.value=c.userValue=a,t.setValue(e,{value:a}),null===(i=this.linkService.eventBus)||void 0===i||i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:a,willCommit:!0,commitKey:1,selStart:r.selectionStart,selEnd:r.selectionEnd}}))}};this._dispatchEventFromSandbox(i,n)})),n.addEventListener("keydown",(t=>{var n;c.commitKey=1;let i=-1;if("Escape"===t.key?i=0:"Enter"!==t.key||this.data.multiLine?"Tab"===t.key&&(c.commitKey=3):i=2,-1===i)return;const{value:s}=t.target;c.lastCommittedValue!==s&&(c.lastCommittedValue=s,c.userValue=s,null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:s,willCommit:!0,commitKey:i,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}))}));const i=u;u=null,n.addEventListener("blur",(t=>{var n;if(!c.focused||!t.relatedTarget)return;null!==(n=this.data.actions)&&void 0!==n&&n.Blur||(c.focused=!1);const{value:s}=t.target;var r;(c.userValue=s,c.lastCommittedValue!==s)&&(null===(r=this.linkService.eventBus)||void 0===r||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:s,willCommit:!0,commitKey:c.commitKey,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}));i(t)})),null!==(s=this.data.actions)&&void 0!==s&&s.Keystroke&&n.addEventListener("beforeinput",(t=>{var n;c.lastCommittedValue=null;const{data:i,target:s}=t,{value:r,selectionStart:a,selectionEnd:o}=s;let l=a,u=o;switch(t.inputType){case"deleteWordBackward":{const t=r.substring(0,a).match(/\w*[^\w]*$/);t&&(l-=t[0].length);break}case"deleteWordForward":{const t=r.substring(a).match(/^[^\w]*\w*/);t&&(u+=t[0].length);break}case"deleteContentBackward":a===o&&(l-=1);break;case"deleteContentForward":a===o&&(u+=1)}t.preventDefault(),null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:r,change:i||"",willCommit:!1,selStart:l,selEnd:u}})})),this._setEventListeners(n,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.value))}if(u&&n.addEventListener("blur",u),this.data.comb){const t=(this.data.rect[2]-this.data.rect[0])/o;n.classList.add("comb"),n.style.letterSpacing="calc(".concat(t,"px * var(--total-scale-factor) - 1ch)")}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Hh extends Wh{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class qh extends Wh{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;"string"===typeof i&&(i="Off"!==i,t.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return xh.add(s),s.setAttribute("data-element-id",n),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=Th,s.addEventListener("change",(i=>{const{name:s,checked:r}=i.target;for(const a of this._getElementsByName(s,n)){const n=r&&a.exportValue===e.exportValue;a.domElement&&(a.domElement.checked=n),t.setValue(a.id,{value:n})}t.setValue(n,{value:r})})),s.addEventListener("resetform",(t=>{const n=e.defaultFieldValue||"Off";t.target.checked=n===e.exportValue})),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",(e=>{const i={value(e){e.target.checked="Off"!==e.detail.value,t.setValue(n,{value:e.target.checked})}};this._dispatchEventFromSandbox(i,e)})),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Gh extends Wh{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if("string"===typeof i&&(i=i!==e.buttonValue,t.setValue(n,{value:i})),i)for(const r of this._getElementsByName(e.fieldName,n))t.setValue(r.id,{value:!1});const s=document.createElement("input");if(xh.add(s),s.setAttribute("data-element-id",n),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=Th,s.addEventListener("change",(e=>{const{name:i,checked:s}=e.target;for(const r of this._getElementsByName(i,n))t.setValue(r.id,{value:!1});t.setValue(n,{value:s})})),s.addEventListener("resetform",(t=>{const n=e.defaultFieldValue;t.target.checked=null!==n&&void 0!==n&&n===e.buttonValue})),this.enableScripting&&this.hasJSActions){const i=e.buttonValue;s.addEventListener("updatefromsandbox",(e=>{const s={value:e=>{const s=i===e.detail.value;for(const i of this._getElementsByName(e.target.name)){const e=s&&i.id===n;i.domElement&&(i.domElement.checked=e),t.setValue(i.id,{value:e})}}};this._dispatchEventFromSandbox(s,e)})),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Kh extends Fh{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",(t=>{this._dispatchEventFromSandbox({},t)}))),t}}class Xh extends Wh{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");xh.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=Th;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",(t=>{const e=this.data.defaultFieldValue;for(const n of i.options)n.selected=n.value===e}));for(const c of this.data.options){const t=document.createElement("option");t.textContent=c.displayValue,t.value=c.exportValue,n.value.includes(c.exportValue)&&(t.setAttribute("selected",!0),s=!1),i.append(t)}let r=null;if(s){const t=document.createElement("option");t.value=" ",t.setAttribute("hidden",!0),t.setAttribute("selected",!0),i.prepend(t),r=()=>{t.remove(),i.removeEventListener("input",r),r=null},i.addEventListener("input",r)}const a=t=>{const e=t?"value":"textContent",{options:n,multiple:s}=i;return s?Array.prototype.filter.call(n,(t=>t.selected)).map((t=>t[e])):-1===n.selectedIndex?null:n[n.selectedIndex][e]};let o=a(!1);const l=t=>{const e=t.target.options;return Array.prototype.map.call(e,(t=>({displayValue:t.textContent,exportValue:t.value})))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",(n=>{const s={value(n){var s;null===(s=r)||void 0===s||s();const l=n.detail.value,c=new Set(Array.isArray(l)?l:[l]);for(const t of i.options)t.selected=c.has(t.value);t.setValue(e,{value:a(!0)}),o=a(!1)},multipleSelection(t){i.multiple=!0},remove(n){const s=i.options,r=n.detail.remove;if(s[r].selected=!1,i.remove(r),s.length>0){-1===Array.prototype.findIndex.call(s,(t=>t.selected))&&(s[0].selected=!0)}t.setValue(e,{value:a(!0),items:l(n)}),o=a(!1)},clear(n){for(;0!==i.length;)i.remove(0);t.setValue(e,{value:null,items:[]}),o=a(!1)},insert(n){const{index:s,displayValue:r,exportValue:c}=n.detail.insert,u=i.children[s],h=document.createElement("option");h.textContent=r,h.value=c,u?u.before(h):i.append(h),t.setValue(e,{value:a(!0),items:l(n)}),o=a(!1)},items(n){const{items:s}=n.detail;for(;0!==i.length;)i.remove(0);for(const t of s){const{displayValue:e,exportValue:n}=t,s=document.createElement("option");s.textContent=e,s.value=n,i.append(s)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:a(!0),items:l(n)}),o=a(!1)},indices(n){const i=new Set(n.detail.indices);for(const t of n.target.options)t.selected=i.has(t.index);t.setValue(e,{value:a(!0)}),o=a(!1)},editable(t){t.target.disabled=!t.detail.editable}};this._dispatchEventFromSandbox(s,n)})),i.addEventListener("input",(n=>{var i;const s=a(!0),r=a(!1);t.setValue(e,{value:s}),n.preventDefault(),null===(i=this.linkService.eventBus)||void 0===i||i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:o,change:r,changeEx:s,willCommit:!1,commitKey:1,keyDown:!1}})})),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],(t=>t.target.value))):i.addEventListener("input",(function(n){t.setValue(e,{value:a(!0)})})),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Qh extends Dh{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:Dh._hasPopupData(e)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new md({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const n of this.elements)n.popup=t,n.container.ariaHasPopup="dialog",e.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",e.map((t=>"".concat(ci).concat(t))).join(",")),this.container}}var Yh=new WeakMap,Jh=new WeakMap,$h=new WeakMap,Zh=new WeakMap,td=new WeakMap,ed=new WeakMap,nd=new WeakMap,id=new WeakMap,sd=new WeakMap,rd=new WeakMap,ad=new WeakMap,od=new WeakMap,ld=new WeakMap,cd=new WeakMap,ud=new WeakMap,hd=new WeakMap,dd=new WeakMap,fd=new WeakMap,pd=new WeakMap,gd=new WeakSet;class md{constructor(t){let{container:e,color:n,elements:i,titleObj:s,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:c,parentRect:u,open:h}=t;Le(this,gd),Oe(this,Yh,Fe(gd,this,_d).bind(this)),Oe(this,Jh,Fe(gd,this,kd).bind(this)),Oe(this,$h,Fe(gd,this,Sd).bind(this)),Oe(this,Zh,Fe(gd,this,Ad).bind(this)),Oe(this,td,null),Oe(this,ed,null),Oe(this,nd,null),Oe(this,id,null),Oe(this,sd,null),Oe(this,rd,null),Oe(this,ad,null),Oe(this,od,!1),Oe(this,ld,null),Oe(this,cd,null),Oe(this,ud,null),Oe(this,hd,null),Oe(this,dd,null),Oe(this,fd,null),Oe(this,pd,!1),Ve(ed,this,e),Ve(dd,this,s),Ve(nd,this,a),Ve(hd,this,o),Ve(rd,this,l),Ve(td,this,n),Ve(ud,this,c),Ve(ad,this,u),Ve(sd,this,i),Ve(id,this,Ai.toDateObject(r)),this.trigger=i.flatMap((t=>t.getElementsToTriggerPopup()));for(const f of this.trigger)f.addEventListener("click",Be(Zh,this)),f.addEventListener("mouseenter",Be($h,this)),f.addEventListener("mouseleave",Be(Jh,this)),f.classList.add("popupTriggerArea");for(const f of i){var d;null===(d=f.container)||void 0===d||d.addEventListener("keydown",Be(Yh,this))}Be(ed,this).hidden=!0,h&&Fe(gd,this,Ad).call(this)}render(){if(Be(ld,this))return;const t=Ve(ld,this,document.createElement("div"));if(t.className="popup",Be(td,this)){const e=t.style.outlineColor=ii.makeHexColor(...Be(td,this));t.style.backgroundColor="color-mix(in srgb, ".concat(e," 30%, white)")}const e=document.createElement("span");e.className="header";const n=document.createElement("h1");if(e.append(n),({dir:n.dir,str:n.textContent}=Be(dd,this)),t.append(e),Be(id,this)){const t=document.createElement("span");t.classList.add("popupDate"),t.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),t.setAttribute("data-l10n-args",JSON.stringify({dateObj:Be(id,this).valueOf()})),e.append(t)}const i=Ue(gd,this,vd);if(i)Ch.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const e=this._formatContents(Be(nd,this));t.append(e)}Be(ed,this).append(t)}_formatContents(t){let{str:e,dir:n}=t;const i=document.createElement("p");i.classList.add("popupContent"),i.dir=n;const s=e.split(/(?:\r\n?|\n)/);for(let r=0,a=s.length;r<a;++r){const t=s[r];i.append(document.createTextNode(t)),r<a-1&&i.append(document.createElement("br"))}return i}updateEdited(t){var e;let{rect:n,popupContent:i}=t;Be(fd,this)||Ve(fd,this,{contentsObj:Be(nd,this),richText:Be(hd,this)}),n&&Ve(cd,this,null),i&&(Ve(hd,this,Fe(gd,this,bd).call(this,i)),Ve(nd,this,null)),null===(e=Be(ld,this))||void 0===e||e.remove(),Ve(ld,this,null)}resetEdited(){var t;Be(fd,this)&&(({contentsObj:Ne(Ve,[nd,this])._,richText:Ne(Ve,[hd,this])._}=Be(fd,this)),Ve(fd,this,null),null===(t=Be(ld,this))||void 0===t||t.remove(),Ve(ld,this,null),Ve(cd,this,null))}forceHide(){Ve(pd,this,this.isVisible),Be(pd,this)&&(Be(ed,this).hidden=!0)}maybeShow(){Be(pd,this)&&(Be(ld,this)||Fe(gd,this,Sd).call(this),Ve(pd,this,!1),Be(ed,this).hidden=!1)}get isVisible(){return!1===Be(ed,this).hidden}}function vd(t){const e=Be(hd,t),n=Be(nd,t);return null===e||void 0===e||!e.str||null!==n&&void 0!==n&&n.str&&n.str!==e.str?null:Be(hd,t).html||null}function yd(t){var e;return(null===(e=Ue(gd,t,vd))||void 0===e||null===(e=e.attributes)||void 0===e||null===(e=e.style)||void 0===e?void 0:e.fontSize)||0}function wd(t){var e;return(null===(e=Ue(gd,t,vd))||void 0===e||null===(e=e.attributes)||void 0===e||null===(e=e.style)||void 0===e?void 0:e.color)||null}function bd(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:Ue(gd,this,wd),fontSize:Ue(gd,this,yd)?"calc(".concat(Ue(gd,this,yd),"px * var(--total-scale-factor))"):""}};for(const s of t.split("\n"))e.push({name:"span",value:s,attributes:i});return n}function _d(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||("Enter"===t.key||"Escape"===t.key&&Be(od,this))&&Fe(gd,this,Ad).call(this)}function Ed(){if(null!==Be(cd,this))return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:i,pageY:s}}}=Be(rd,this);let r=!!Be(ad,this),a=Be(r?ad:ud,this);for(const d of Be(sd,this))if(!a||null!==ii.intersect(d.data.rect,a)){a=d.data.rect,r=!0;break}const o=ii.normalizeRect([a[0],t[3]-a[1]+t[1],a[2],t[3]-a[3]+t[1]]),l=r?a[2]-a[0]+5:0,c=o[0]+l,u=o[1];Ve(cd,this,[100*(c-i)/e,100*(u-s)/n]);const{style:h}=Be(ed,this);h.left="".concat(Be(cd,this)[0],"%"),h.top="".concat(Be(cd,this)[1],"%")}function Ad(){Ve(od,this,!Be(od,this)),Be(od,this)?(Fe(gd,this,Sd).call(this),Be(ed,this).addEventListener("click",Be(Zh,this)),Be(ed,this).addEventListener("keydown",Be(Yh,this))):(Fe(gd,this,kd).call(this),Be(ed,this).removeEventListener("click",Be(Zh,this)),Be(ed,this).removeEventListener("keydown",Be(Yh,this)))}function Sd(){Be(ld,this)||this.render(),this.isVisible?Be(od,this)&&Be(ed,this).classList.add("focused"):(Fe(gd,this,Ed).call(this),Be(ed,this).hidden=!1,Be(ed,this).style.zIndex=parseInt(Be(ed,this).style.zIndex)+1e3)}function kd(){Be(ed,this).classList.remove("focused"),!Be(od,this)&&this.isVisible&&(Be(ed,this).hidden=!0,Be(ed,this).style.zIndex=parseInt(Be(ed,this).style.zIndex)-1e3)}class Cd extends Dh{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=gn.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Td=new WeakMap;class xd extends Dh{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),Oe(this,Td,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:n}=this,i=this.svgFactory.create(e,n,!0),s=Ve(Td,this,this.svgFactory.createElement("svg:line"));return s.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),s.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),s.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),s.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),s.setAttribute("stroke-width",t.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Be(Td,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var Id=new WeakMap;class Rd extends Dh{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),Oe(this,Id,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:n}=this,i=this.svgFactory.create(e,n,!0),s=t.borderStyle.width,r=Ve(Id,this,this.svgFactory.createElement("svg:rect"));return r.setAttribute("x",s/2),r.setAttribute("y",s/2),r.setAttribute("width",e-s),r.setAttribute("height",n-s),r.setAttribute("stroke-width",s||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Be(Id,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var Md=new WeakMap;class Pd extends Dh{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),Oe(this,Md,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:n}=this,i=this.svgFactory.create(e,n,!0),s=t.borderStyle.width,r=Ve(Md,this,this.svgFactory.createElement("svg:ellipse"));return r.setAttribute("cx",e/2),r.setAttribute("cy",n/2),r.setAttribute("rx",e/2-s/2),r.setAttribute("ry",n/2-s/2),r.setAttribute("stroke-width",s||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Be(Md,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var Nd=new WeakMap;class Dd extends Dh{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),Oe(this,Nd,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:n,popupRef:i},width:s,height:r}=this;if(!e)return this.container;const a=this.svgFactory.create(s,r,!0);let o=[];for(let c=0,u=e.length;c<u;c+=2){const n=e[c]-t[0],i=t[3]-e[c+1];o.push("".concat(n,",").concat(i))}o=o.join(" ");const l=Ve(Nd,this,this.svgFactory.createElement(this.svgElementName));return l.setAttribute("points",o),l.setAttribute("stroke-width",n.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Be(Nd,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ld extends Dd{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Od extends Dh{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Fd=new WeakMap,Ud=new WeakMap,Bd=new WeakSet;class Vd extends Dh{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),Le(this,Bd),Oe(this,Fd,null),Oe(this,Ud,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType="InkHighlight"===this.data.it?gn.HIGHLIGHT:gn.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:n,borderStyle:i,popupRef:s}}=this,{transform:r,width:a,height:o}=Fe(Bd,this,jd).call(this,e,t),l=this.svgFactory.create(a,o,!0),c=Ve(Fd,this,this.svgFactory.createElement("svg:g"));l.append(c),c.setAttribute("stroke-width",i.width||1),c.setAttribute("stroke-linecap","round"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-miterlimit",10),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),c.setAttribute("transform",r);for(let u=0,h=n.length;u<h;u++){const t=this.svgFactory.createElement(this.svgElementName);Be(Ud,this).push(t),t.setAttribute("points",n[u].join(",")),c.append(t)}return!s&&this.hasPopupData&&this._createPopup(),this.container.append(l),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:n,rect:i}=t,s=Be(Fd,this);if(e>=0&&s.setAttribute("stroke-width",e||1),n)for(let r=0,a=Be(Ud,this).length;r<a;r++)Be(Ud,this)[r].setAttribute("points",n[r].join(","));if(i){const{transform:t,width:e,height:n}=Fe(Bd,this,jd).call(this,this.data.rotation,i);s.parentElement.setAttribute("viewBox","0 0 ".concat(e," ").concat(n)),s.setAttribute("transform",t)}}getElementsToTriggerPopup(){return Be(Ud,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}function jd(t,e){switch(t){case 90:return{transform:"rotate(90) translate(".concat(-e[0],",").concat(e[1],") scale(1,-1)"),width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:"rotate(180) translate(".concat(-e[2],",").concat(e[1],") scale(1,-1)"),width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:"rotate(270) translate(".concat(-e[2],",").concat(e[3],") scale(1,-1)"),width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:"translate(".concat(-e[0],",").concat(e[3],") scale(1,-1)"),width:e[2]-e[0],height:e[3]-e[1]}}}class Wd extends Dh{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=gn.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class zd extends Dh{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Hd extends Dh{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class qd extends Dh{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Gd extends Dh{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=gn.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Kd=new WeakMap,Xd=new WeakSet;class Qd extends Dh{constructor(t){var e;super(t,{isRenderable:!0}),Le(this,Xd),Oe(this,Kd,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,null===(e=this.linkService.eventBus)||void 0===e||e.dispatch("fileattachmentannotation",l({source:this},n))}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let n;e.hasAppearance||0===e.fillAlpha?n=document.createElement("div"):(n=document.createElement("img"),n.src="".concat(this.imageResourcesPath,"annotation-").concat(/paperclip/i.test(e.name)?"paperclip":"pushpin",".svg"),e.fillAlpha&&e.fillAlpha<1&&(n.style="filter: opacity(".concat(Math.round(100*e.fillAlpha),"%);"))),n.addEventListener("dblclick",Fe(Xd,this,Yd).bind(this)),Ve(Kd,this,n);const{isMac:i}=ei.platform;return t.addEventListener("keydown",(t=>{"Enter"===t.key&&(i?t.metaKey:t.ctrlKey)&&Fe(Xd,this,Yd).call(this)})),!e.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return Be(Kd,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}function Yd(){var t;null===(t=this.downloadManager)||void 0===t||t.openOrDownloadData(this.content,this.filename)}var Jd=new WeakMap,$d=new WeakMap,Zd=new WeakMap,tf=new WeakMap,ef=new WeakSet;class nf{constructor(t){let{div:e,accessibilityManager:n,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:a,structTreeLayer:o}=t;Le(this,ef),Oe(this,Jd,null),Oe(this,$d,null),Oe(this,Zd,new Map),Oe(this,tf,null),this.div=e,Ve(Jd,this,n),Ve($d,this,i),Ve(tf,this,o||null),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return Be(Zd,this).size>0}async render(t){const{annotations:e}=t,n=this.div;xi(n,this.viewport);const i=new Map,s={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new kh,annotationStorage:t.annotationStorage||new fo,enableScripting:!0===t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const t=a.annotationType===Sn.POPUP;if(t){const t=i.get(a.id);if(!t)continue;s.elements=t}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;s.data=a;const e=Ih.create(s);if(!e.isRenderable)continue;if(!t&&a.popupRef){const t=i.get(a.popupRef);t?t.push(e):i.set(a.popupRef,[e])}const n=e.render();var r;if(a.hidden&&(n.style.visibility="hidden"),await Fe(ef,this,sf).call(this,n,a.id),e._isEditable)Be(Zd,this).set(e.data.id,e),null===(r=this._annotationEditorUIManager)||void 0===r||r.renderAnnotationElement(e)}Fe(ef,this,rf).call(this)}async addLinkAnnotations(t,e){const n={data:null,layer:this.div,linkService:e,svgFactory:new kh,parent:this};for(const i of t){i.borderStyle||(i.borderStyle=nf._defaultBorderStyle),n.data=i;const t=Ih.create(n);if(!t.isRenderable)continue;const e=t.render();await Fe(ef,this,sf).call(this,e,i.id)}}update(t){let{viewport:e}=t;const n=this.div;this.viewport=e,xi(n,{rotation:e.rotation}),Fe(ef,this,rf).call(this),n.hidden=!1}getEditableAnnotations(){return Array.from(Be(Zd,this).values())}getEditableAnnotation(t){return Be(Zd,this).get(t)}static get _defaultBorderStyle(){return qn(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:kn,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}async function sf(t,e){var n,i;const s=t.firstChild||t,r=s.id="".concat(ci).concat(e),a=await(null===(n=Be(tf,this))||void 0===n?void 0:n.getAriaAttributes(r));if(a)for(const[o,l]of a)s.setAttribute(o,l);this.div.append(t),null===(i=Be(Jd,this))||void 0===i||i.moveElementInDOM(this.div,t,s,!1)}function rf(){if(!Be($d,this))return;const t=this.div;for(const[n,i]of Be($d,this)){const s=t.querySelector('[data-annotation-id="'.concat(n,'"]'));if(!s)continue;i.className="annotationContent";const{firstChild:r}=s;r?"CANVAS"===r.nodeName?r.replaceWith(i):r.classList.contains("annotationContent")?r.after(i):r.before(i):s.append(i);const a=Be(Zd,this).get(n);var e;if(a)if(a._hasNoCanvas)null===(e=this._annotationEditorUIManager)||void 0===e||e.setMissingCanvas(n,s.id,i),a._hasNoCanvas=!1;else a.canvas=i}Be($d,this).clear()}const af=/\r\n?|\n/g;var of=new WeakMap,lf=new WeakMap,cf=new WeakMap,uf=new WeakMap,hf=new WeakMap,df=new WeakSet;class ff extends Oa{static get _keyboardManager(){const t=ff.prototype,e=t=>t.isEmpty(),n=cr.TRANSLATE_SMALL,i=cr.TRANSLATE_BIG;return qn(this,"_keyboardManager",new gs([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}]]))}constructor(t){super(l(l({},t),{},{name:"freeTextEditor"})),Le(this,df),Oe(this,of,void 0),Oe(this,lf,""),Oe(this,cf,"".concat(this.id,"-editor")),Oe(this,uf,null),Oe(this,hf,void 0),Ve(of,this,t.color||ff._defaultColor||Oa._defaultLineColor),Ve(hf,this,t.fontSize||ff._defaultFontSize)}static initialize(t,e){Oa.initialize(t,e);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case mn.FREETEXT_SIZE:ff._defaultFontSize=e;break;case mn.FREETEXT_COLOR:ff._defaultColor=e}}updateParams(t,e){switch(t){case mn.FREETEXT_SIZE:Fe(df,this,pf).call(this,e);break;case mn.FREETEXT_COLOR:Fe(df,this,gf).call(this,e)}}static get defaultPropertiesToUpdate(){return[[mn.FREETEXT_SIZE,ff._defaultFontSize],[mn.FREETEXT_COLOR,ff._defaultColor||Oa._defaultLineColor]]}get propertiesToUpdate(){return[[mn.FREETEXT_SIZE,Be(hf,this)],[mn.FREETEXT_COLOR,Be(of,this)]]}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-ff._internalPadding*t,-(ff._internalPadding+Be(hf,this))*t]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),Ve(uf,this,new AbortController);const t=this._uiManager.combinedSignal(Be(uf,this));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return!!super.disableEditMode()&&(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",Be(cf,this)),this._isDraggable=!0,null===(t=Be(uf,this))||void 0===t||t.abort(),Ve(uf,this,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0)}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var e;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),null!==(e=this._initialOptions)&&void 0!==e&&e.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=Be(lf,this),e=Ve(lf,this,Fe(df,this,mf).call(this).trimEnd());if(t===e)return;const n=t=>{Ve(lf,this,t),t?(Fe(df,this,wf).call(this),this._uiManager.rebuild(this),Fe(df,this,vf).call(this)):this.remove()};this.addCommands({cmd:()=>{n(e)},undo:()=>{n(t)},mustExec:!1}),Fe(df,this,vf).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&"Enter"===t.key&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){ff._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",Be(cf,this)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize="calc(".concat(Be(hf,this),"px * var(--total-scale-factor))"),n.color=Be(of,this),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[n,i]=this.parentDimensions;if(this.annotationElementId){const{position:s}=this._initialData;let[r,a]=this.getInitialTranslation();[r,a]=this.pageTranslationToScreen(r,a);const[o,l]=this.pageDimensions,[c,u]=this.pageTranslation;let h,d;switch(this.rotation){case 0:h=t+(s[0]-c)/o,d=e+this.height-(s[1]-u)/l;break;case 90:h=t+(s[0]-c)/o,d=e-(s[1]-u)/l,[r,a]=[a,-r];break;case 180:h=t-this.width+(s[0]-c)/o,d=e-(s[1]-u)/l,[r,a]=[-r,-a];break;case 270:h=t+(s[0]-c-this.height*l)/o,d=e+(s[1]-u-this.width*o)/l,[r,a]=[-a,r]}this.setAt(h*n,d*i,r,a)}else this._moveAfterPaste(t,e);Fe(df,this,wf).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:n}=e;if(1===n.length&&"text/plain"===n[0])return;t.preventDefault();const i=_f.call(ff,e.getData("text")||"").replaceAll(af,"\n");if(!i)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const r=s.getRangeAt(0);if(!i.includes("\n"))return r.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),void s.collapseToStart();const{startContainer:a,startOffset:o}=r,l=[],c=[];if(a.nodeType===Node.TEXT_NODE){const t=a.parentElement;if(c.push(a.nodeValue.slice(o).replaceAll(af,"")),t!==this.editorDiv){let e=l;for(const n of this.editorDiv.childNodes)n!==t?e.push(yf.call(ff,n)):e=c}l.push(a.nodeValue.slice(0,o).replaceAll(af,""))}else if(a===this.editorDiv){let t=l,e=0;for(const n of this.editorDiv.childNodes)e++===o&&(t=c),t.push(yf.call(ff,n))}Ve(lf,this,"".concat(l.join("\n")).concat(i).concat(c.join("\n"))),Fe(df,this,wf).call(this);const u=new Range;let h=Math.sumPrecise(l.map((t=>t.length)));for(const{firstChild:d}of this.editorDiv.childNodes)if(d.nodeType===Node.TEXT_NODE){const t=d.nodeValue.length;if(h<=t){u.setStart(d,h),u.setEnd(d,h);break}h-=t}s.removeAllRanges(),s.addRange(u)}get contentDiv(){return this.editorDiv}static async deserialize(t,e,n){let i=null;if(t instanceof Cd){const{data:{defaultAppearanceData:{fontSize:e,fontColor:n},rect:s,rotation:r,id:a,popupRef:o},textContent:l,textPosition:c,parent:{page:{pageNumber:u}}}=t;if(!l||0===l.length)return null;i=t={annotationType:gn.FREETEXT,color:Array.from(n),fontSize:e,value:l.join("\n"),position:c,pageIndex:u-1,rect:s.slice(0),rotation:r,id:a,deleted:!1,popupRef:o}}const s=await super.deserialize(t,e,n);return Ve(hf,s,t.fontSize),Ve(of,s,ii.makeHexColor(...t.color)),Ve(lf,s,_f.call(ff,t.value)),s.annotationElementId=t.id||null,s._initialData=i,s}serialize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=ff._internalPadding*this.parentScale,n=this.getRect(e,e),i=Oa._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:Be(of,this)),s={annotationType:gn.FREETEXT,color:i,fontSize:Be(hf,this),value:Fe(df,this,bf).call(this),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(s.isCopy=!0,s):this.annotationElementId&&!Fe(df,this,Ef).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:n}=e;n.fontSize="calc(".concat(Be(hf,this),"px * var(--total-scale-factor))"),n.color=Be(of,this),e.replaceChildren();for(const s of Be(lf,this).split("\n")){const t=document.createElement("div");t.append(s?document.createTextNode(s):document.createElement("br")),e.append(t)}const i=ff._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(i,i),popupContent:Be(lf,this)}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}function pf(t){const e=t=>{this.editorDiv.style.fontSize="calc(".concat(t,"px * var(--total-scale-factor))"),this.translate(0,-(t-Be(hf,this))*this.parentScale),Ve(hf,this,t),Fe(df,this,vf).call(this)},n=Be(hf,this);this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mn.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function gf(t){const e=t=>{Ve(of,this,this.editorDiv.style.color=t)},n=Be(of,this);this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mn.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function mf(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes){var n;(null===(n=e)||void 0===n?void 0:n.nodeType)===Node.TEXT_NODE&&"BR"===i.nodeName||(t.push(yf.call(Ye,i)),e=i)}return t.join("\n")}function vf(){const[t,e]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:t,div:e}=this,i=e.style.display,s=e.classList.contains("hidden");e.classList.remove("hidden"),e.style.display="hidden",t.div.append(this.div),n=e.getBoundingClientRect(),e.remove(),e.style.display=i,e.classList.toggle("hidden",s)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/e):(this.width=n.height/t,this.height=n.width/e),this.fixAndSetPosition()}function yf(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(af,"")}function wf(){if(this.editorDiv.replaceChildren(),Be(lf,this))for(const t of Be(lf,this).split("\n")){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}function bf(){return Be(lf,this).replaceAll("\xa0"," ")}function _f(t){return t.replaceAll(" ","\xa0")}function Ef(t){const{value:e,fontSize:n,color:i,pageIndex:s}=this._initialData;return this._hasBeenMoved||t.value!==e||t.fontSize!==n||t.color.some(((t,e)=>t!==i[e]))||t.pageIndex!==s}Ye=ff,a(ff,"_freeTextDefaultContent",""),a(ff,"_internalPadding",0),a(ff,"_defaultColor",null),a(ff,"_defaultFontSize",10),a(ff,"_type","freetext"),a(ff,"_editorType",gn.FREETEXT);class Af{toSVGPath(){jn("Abstract method `toSVGPath` must be implemented.")}get box(){jn("Abstract getter `box` must be implemented.")}serialize(t,e){jn("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,i,s,r){r||(r=new Float32Array(t.length));for(let a=0,o=t.length;a<o;a+=2)r[a]=e+t[a]*i,r[a+1]=n+t[a+1]*s;return r}static _rescaleAndSwap(t,e,n,i,s,r){r||(r=new Float32Array(t.length));for(let a=0,o=t.length;a<o;a+=2)r[a]=e+t[a+1]*i,r[a+1]=n+t[a]*s;return r}static _translate(t,e,n,i){i||(i=new Float32Array(t.length));for(let s=0,r=t.length;s<r;s+=2)i[s]=e+t[s],i[s+1]=n+t[s+1];return i}static svgRound(t){return Math.round(1e4*t)}static _normalizePoint(t,e,n,i,s){switch(s){case 90:return[1-e/n,t/i];case 180:return[1-t/n,1-e/i];case 270:return[e/n,1-t/i];default:return[t/n,e/i]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,i,s,r){return[(t+5*n)/6,(e+5*i)/6,(5*n+s)/6,(5*i+r)/6,(n+s)/2,(i+r)/2]}}a(Af,"PRECISION",1e-4);var Sf=new WeakMap,kf=new WeakMap,Cf=new WeakMap,Tf=new WeakMap,xf=new WeakMap,If=new WeakMap,Rf=new WeakMap,Mf=new WeakMap,Pf=new WeakMap,Nf=new WeakMap,Df=new WeakMap,Lf=new WeakMap,Of=new WeakMap,Ff=new WeakSet;class Uf{constructor(t,e,n,i,s){let{x:r,y:a}=t,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;Le(this,Ff),Oe(this,Sf,void 0),Oe(this,kf,[]),Oe(this,Cf,void 0),Oe(this,Tf,void 0),Oe(this,xf,[]),Oe(this,If,new Float32Array(18)),Oe(this,Rf,void 0),Oe(this,Mf,void 0),Oe(this,Pf,void 0),Oe(this,Nf,void 0),Oe(this,Df,void 0),Oe(this,Lf,void 0),Oe(this,Of,[]),Ve(Sf,this,e),Ve(Lf,this,i*n),Ve(Tf,this,s),Be(If,this).set([NaN,NaN,NaN,NaN,r,a],6),Ve(Cf,this,o),Ve(Nf,this,Gf._*n),Ve(Pf,this,Kf._*n),Ve(Df,this,n),Be(Of,this).push(r,a)}isEmpty(){return isNaN(Be(If,this)[8])}add(t){var e;let{x:n,y:i}=t;Ve(Rf,this,n),Ve(Mf,this,i);const[s,r,a,o]=Be(Sf,this);let[l,c,u,h]=Be(If,this).subarray(8,12);const d=n-u,f=i-h,p=Math.hypot(d,f);if(p<Be(Pf,this))return!1;const g=p-Be(Nf,this),m=g/p,v=m*d,y=m*f;let w=l,b=c;l=u,c=h,u+=v,h+=y,null===(e=Be(Of,this))||void 0===e||e.push(n,i);const _=v/g,E=-y/g*Be(Lf,this),A=_*Be(Lf,this);if(Be(If,this).set(Be(If,this).subarray(2,8),0),Be(If,this).set([u+E,h+A],4),Be(If,this).set(Be(If,this).subarray(14,18),12),Be(If,this).set([u-E,h-A],16),isNaN(Be(If,this)[6]))return 0===Be(xf,this).length&&(Be(If,this).set([l+E,c+A],2),Be(xf,this).push(NaN,NaN,NaN,NaN,(l+E-s)/a,(c+A-r)/o),Be(If,this).set([l-E,c-A],14),Be(kf,this).push(NaN,NaN,NaN,NaN,(l-E-s)/a,(c-A-r)/o)),Be(If,this).set([w,b,l,c,u,h],6),!this.isEmpty();Be(If,this).set([w,b,l,c,u,h],6);return Math.abs(Math.atan2(b-c,w-l)-Math.atan2(y,v))<Math.PI/2?([l,c,u,h]=Be(If,this).subarray(2,6),Be(xf,this).push(NaN,NaN,NaN,NaN,((l+u)/2-s)/a,((c+h)/2-r)/o),[l,c,w,b]=Be(If,this).subarray(14,18),Be(kf,this).push(NaN,NaN,NaN,NaN,((w+l)/2-s)/a,((b+c)/2-r)/o),!0):([w,b,l,c,u,h]=Be(If,this).subarray(0,6),Be(xf,this).push(((w+5*l)/6-s)/a,((b+5*c)/6-r)/o,((5*l+u)/6-s)/a,((5*c+h)/6-r)/o,((l+u)/2-s)/a,((c+h)/2-r)/o),[u,h,l,c,w,b]=Be(If,this).subarray(12,18),Be(kf,this).push(((w+5*l)/6-s)/a,((b+5*c)/6-r)/o,((5*l+u)/6-s)/a,((5*c+h)/6-r)/o,((l+u)/2-s)/a,((c+h)/2-r)/o),!0)}toSVGPath(){if(this.isEmpty())return"";const t=Be(xf,this),e=Be(kf,this);if(isNaN(Be(If,this)[6])&&!this.isEmpty())return Fe(Ff,this,Vf).call(this);const n=[];n.push("M".concat(t[4]," ").concat(t[5]));for(let i=6;i<t.length;i+=6)isNaN(t[i])?n.push("L".concat(t[i+4]," ").concat(t[i+5])):n.push("C".concat(t[i]," ").concat(t[i+1]," ").concat(t[i+2]," ").concat(t[i+3]," ").concat(t[i+4]," ").concat(t[i+5]));Fe(Ff,this,Wf).call(this,n);for(let i=e.length-6;i>=6;i-=6)isNaN(e[i])?n.push("L".concat(e[i+4]," ").concat(e[i+5])):n.push("C".concat(e[i]," ").concat(e[i+1]," ").concat(e[i+2]," ").concat(e[i+3]," ").concat(e[i+4]," ").concat(e[i+5]));return Fe(Ff,this,jf).call(this,n),n.join(" ")}newFreeDrawOutline(t,e,n,i,s,r){return new np(t,e,n,i,s,r)}getOutlines(){var t,e;const n=Be(xf,this),i=Be(kf,this),s=Be(If,this),[r,a,o,l]=Be(Sf,this),c=new Float32Array((null!==(t=null===(e=Be(Of,this))||void 0===e?void 0:e.length)&&void 0!==t?t:0)+2);for(let d=0,f=c.length-2;d<f;d+=2)c[d]=(Be(Of,this)[d]-r)/o,c[d+1]=(Be(Of,this)[d+1]-a)/l;if(c[c.length-2]=(Be(Rf,this)-r)/o,c[c.length-1]=(Be(Mf,this)-a)/l,isNaN(s[6])&&!this.isEmpty())return Fe(Ff,this,zf).call(this,c);const u=new Float32Array(Be(xf,this).length+24+Be(kf,this).length);let h=n.length;for(let d=0;d<h;d+=2)isNaN(n[d])?u[d]=u[d+1]=NaN:(u[d]=n[d],u[d+1]=n[d+1]);h=Fe(Ff,this,qf).call(this,u,h);for(let d=i.length-6;d>=6;d-=6)for(let t=0;t<6;t+=2)isNaN(i[d+t])?(u[h]=u[h+1]=NaN,h+=2):(u[h]=i[d+t],u[h+1]=i[d+t+1],h+=2);return Fe(Ff,this,Hf).call(this,u,h),this.newFreeDrawOutline(u,c,Be(Sf,this),Be(Df,this),Be(Cf,this),Be(Tf,this))}}function Bf(){const t=Be(If,this).subarray(4,6),e=Be(If,this).subarray(16,18),[n,i,s,r]=Be(Sf,this);return[(Be(Rf,this)+(t[0]-e[0])/2-n)/s,(Be(Mf,this)+(t[1]-e[1])/2-i)/r,(Be(Rf,this)+(e[0]-t[0])/2-n)/s,(Be(Mf,this)+(e[1]-t[1])/2-i)/r]}function Vf(){const[t,e,n,i]=Be(Sf,this),[s,r,a,o]=Fe(Ff,this,Bf).call(this);return"M".concat((Be(If,this)[2]-t)/n," ").concat((Be(If,this)[3]-e)/i," L").concat((Be(If,this)[4]-t)/n," ").concat((Be(If,this)[5]-e)/i," L").concat(s," ").concat(r," L").concat(a," ").concat(o," L").concat((Be(If,this)[16]-t)/n," ").concat((Be(If,this)[17]-e)/i," L").concat((Be(If,this)[14]-t)/n," ").concat((Be(If,this)[15]-e)/i," Z")}function jf(t){const e=Be(kf,this);t.push("L".concat(e[4]," ").concat(e[5]," Z"))}function Wf(t){const[e,n,i,s]=Be(Sf,this),r=Be(If,this).subarray(4,6),a=Be(If,this).subarray(16,18),[o,l,c,u]=Fe(Ff,this,Bf).call(this);t.push("L".concat((r[0]-e)/i," ").concat((r[1]-n)/s," L").concat(o," ").concat(l," L").concat(c," ").concat(u," L").concat((a[0]-e)/i," ").concat((a[1]-n)/s))}function zf(t){const e=Be(If,this),[n,i,s,r]=Be(Sf,this),[a,o,l,c]=Fe(Ff,this,Bf).call(this),u=new Float32Array(36);return u.set([NaN,NaN,NaN,NaN,(e[2]-n)/s,(e[3]-i)/r,NaN,NaN,NaN,NaN,(e[4]-n)/s,(e[5]-i)/r,NaN,NaN,NaN,NaN,a,o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,(e[16]-n)/s,(e[17]-i)/r,NaN,NaN,NaN,NaN,(e[14]-n)/s,(e[15]-i)/r],0),this.newFreeDrawOutline(u,t,Be(Sf,this),Be(Df,this),Be(Cf,this),Be(Tf,this))}function Hf(t,e){const n=Be(kf,this);return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+6}function qf(t,e){const n=Be(If,this).subarray(4,6),i=Be(If,this).subarray(16,18),[s,r,a,o]=Be(Sf,this),[l,c,u,h]=Fe(Ff,this,Bf).call(this);return t.set([NaN,NaN,NaN,NaN,(n[0]-s)/a,(n[1]-r)/o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(i[0]-s)/a,(i[1]-r)/o],e),e+24}var Gf={_:8},Kf={_:Gf._+2},Xf=new WeakMap,Qf=new WeakMap,Yf=new WeakMap,Jf=new WeakMap,$f=new WeakMap,Zf=new WeakMap,tp=new WeakMap,ep=new WeakSet;class np extends Af{constructor(t,e,n,i,s,r){super(),Le(this,ep),Oe(this,Xf,void 0),Oe(this,Qf,new Float32Array(4)),Oe(this,Yf,void 0),Oe(this,Jf,void 0),Oe(this,$f,void 0),Oe(this,Zf,void 0),Oe(this,tp,void 0),Ve(tp,this,t),Ve($f,this,e),Ve(Xf,this,n),Ve(Zf,this,i),Ve(Yf,this,s),Ve(Jf,this,r),this.lastPoint=[NaN,NaN],Fe(ep,this,ip).call(this,r);const[a,o,l,c]=Be(Qf,this);for(let u=0,h=t.length;u<h;u+=2)t[u]=(t[u]-a)/l,t[u+1]=(t[u+1]-o)/c;for(let u=0,h=e.length;u<h;u+=2)e[u]=(e[u]-a)/l,e[u+1]=(e[u+1]-o)/c}toSVGPath(){const t=["M".concat(Be(tp,this)[4]," ").concat(Be(tp,this)[5])];for(let e=6,n=Be(tp,this).length;e<n;e+=6)isNaN(Be(tp,this)[e])?t.push("L".concat(Be(tp,this)[e+4]," ").concat(Be(tp,this)[e+5])):t.push("C".concat(Be(tp,this)[e]," ").concat(Be(tp,this)[e+1]," ").concat(Be(tp,this)[e+2]," ").concat(Be(tp,this)[e+3]," ").concat(Be(tp,this)[e+4]," ").concat(Be(tp,this)[e+5]));return t.push("Z"),t.join(" ")}serialize(t,e){let[n,i,s,r]=t;const a=s-n,o=r-i;let l,c;switch(e){case 0:l=Af._rescale(Be(tp,this),n,r,a,-o),c=Af._rescale(Be($f,this),n,r,a,-o);break;case 90:l=Af._rescaleAndSwap(Be(tp,this),n,i,a,o),c=Af._rescaleAndSwap(Be($f,this),n,i,a,o);break;case 180:l=Af._rescale(Be(tp,this),s,i,-a,o),c=Af._rescale(Be($f,this),s,i,-a,o);break;case 270:l=Af._rescaleAndSwap(Be(tp,this),s,r,-a,-o),c=Af._rescaleAndSwap(Be($f,this),s,r,-a,-o)}return{outline:Array.from(l),points:[Array.from(c)]}}get box(){return Be(Qf,this)}newOutliner(t,e,n,i,s){return new Uf(t,e,n,i,s,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}getNewOutline(t,e){const[n,i,s,r]=Be(Qf,this),[a,o,l,c]=Be(Xf,this),u=s*l,h=r*c,d=n*l+a,f=i*c+o,p=this.newOutliner({x:Be($f,this)[0]*u+d,y:Be($f,this)[1]*h+f},Be(Xf,this),Be(Zf,this),t,Be(Jf,this),null!==e&&void 0!==e?e:Be(Yf,this));for(let g=2;g<Be($f,this).length;g+=2)p.add({x:Be($f,this)[g]*u+d,y:Be($f,this)[g+1]*h+f});return p.getOutlines()}}function ip(t){const e=Be(tp,this);let n=e[4],i=e[5];const s=[n,i,n,i];let r=n,a=i;const o=t?Math.max:Math.min;for(let c=6,u=e.length;c<u;c+=6){const t=e[c+4],l=e[c+5];if(isNaN(e[c]))ii.pointBoundingBox(t,l,s),a<l?(r=t,a=l):a===l&&(r=o(r,t));else{const t=[1/0,1/0,-1/0,-1/0];ii.bezierBoundingBox(n,i,...e.slice(c,c+6),t),ii.rectBoundingBox(...t,s),a<t[3]?(r=t[2],a=t[3]):a===t[3]&&(r=o(r,t[2]))}n=t,i=l}const l=Be(Qf,this);l[0]=s[0]-Be(Yf,this),l[1]=s[1]-Be(Yf,this),l[2]=s[2]-s[0]+2*Be(Yf,this),l[3]=s[3]-s[1]+2*Be(Yf,this),this.lastPoint=[r,a]}var sp=new WeakMap,rp=new WeakMap,ap=new WeakMap,op=new WeakMap,lp=new WeakSet;class cp{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Le(this,lp),Oe(this,sp,void 0),Oe(this,rp,void 0),Oe(this,ap,[]),Oe(this,op,[]);const s=[1/0,1/0,-1/0,-1/0],r=10**-4;for(const{x:d,y:f,width:p,height:g}of t){const t=Math.floor((d-e)/r)*r,n=Math.ceil((d+p+e)/r)*r,i=Math.floor((f-e)/r)*r,a=Math.ceil((f+g+e)/r)*r,o=[t,i,a,!0],l=[n,i,a,!1];Be(ap,this).push(o,l),ii.rectBoundingBox(t,i,n,a,s)}const a=s[2]-s[0]+2*n,o=s[3]-s[1]+2*n,l=s[0]-n,c=s[1]-n,u=Be(ap,this).at(i?-1:-2),h=[u[0],u[2]];for(const d of Be(ap,this)){const[t,e,n]=d;d[0]=(t-l)/a,d[1]=(e-c)/o,d[2]=(n-c)/o}Ve(sp,this,new Float32Array([l,c,a,o])),Ve(rp,this,h)}getOutlines(){Be(ap,this).sort(((t,e)=>t[0]-e[0]||t[1]-e[1]||t[2]-e[2]));const t=[];for(const e of Be(ap,this))e[3]?(t.push(...Fe(lp,this,pp).call(this,e)),Fe(lp,this,dp).call(this,e)):(Fe(lp,this,fp).call(this,e),t.push(...Fe(lp,this,pp).call(this,e)));return Fe(lp,this,up).call(this,t)}}function up(t){const e=[],n=new Set;for(const r of t){const[t,n,i]=r;e.push([t,n,r],[t,i,r])}e.sort(((t,e)=>t[1]-e[1]||t[0]-e[0]));for(let r=0,a=e.length;r<a;r+=2){const t=e[r][2],i=e[r+1][2];t.push(i),i.push(t),n.add(t),n.add(i)}const i=[];let s;for(;n.size>0;){const t=n.values().next().value;let[e,r,a,o,l]=t;n.delete(t);let c=e,u=r;for(s=[e,a],i.push(s);;){let t;if(n.has(o))t=o;else{if(!n.has(l))break;t=l}n.delete(t),[e,r,a,o,l]=t,c!==e&&(s.push(c,u,e,u===r?r:a),c=e),u=u===r?a:r}s.push(c,u)}return new vp(i,Be(sp,this),Be(rp,this))}function hp(t){const e=Be(op,this);let n=0,i=e.length-1;for(;n<=i;){const s=n+i>>1,r=e[s][0];if(r===t)return s;r<t?n=s+1:i=s-1}return i+1}function dp(t){let[,e,n]=t;const i=Fe(lp,this,hp).call(this,e);Be(op,this).splice(i,0,[e,n])}function fp(t){let[,e,n]=t;const i=Fe(lp,this,hp).call(this,e);for(let s=i;s<Be(op,this).length;s++){const[t,i]=Be(op,this)[s];if(t!==e)break;if(t===e&&i===n)return void Be(op,this).splice(s,1)}for(let s=i-1;s>=0;s--){const[t,i]=Be(op,this)[s];if(t!==e)break;if(t===e&&i===n)return void Be(op,this).splice(s,1)}}function pp(t){const[e,n,i]=t,s=[[e,n,i]],r=Fe(lp,this,hp).call(this,i);for(let a=0;a<r;a++){const[t,n]=Be(op,this)[a];for(let i=0,r=s.length;i<r;i++){const[,a,o]=s[i];if(!(n<=a||o<=t))if(a>=t)if(o>n)s[i][1]=n;else{if(1===r)return[];s.splice(i,1),i--,r--}else s[i][2]=t,o>n&&s.push([e,n,o])}}return s}var gp=new WeakMap,mp=new WeakMap;class vp extends Af{constructor(t,e,n){super(),Oe(this,gp,void 0),Oe(this,mp,void 0),Ve(mp,this,t),Ve(gp,this,e),this.lastPoint=n}toSVGPath(){const t=[];for(const e of Be(mp,this)){let[n,i]=e;t.push("M".concat(n," ").concat(i));for(let s=2;s<e.length;s+=2){const r=e[s],a=e[s+1];r===n?(t.push("V".concat(a)),i=a):a===i&&(t.push("H".concat(r)),n=r)}t.push("Z")}return t.join(" ")}serialize(t,e){let[n,i,s,r]=t;const a=[],o=s-n,l=r-i;for(const c of Be(mp,this)){const t=new Array(c.length);for(let e=0;e<c.length;e+=2)t[e]=n+c[e]*o,t[e+1]=r-c[e+1]*l;a.push(t)}return a}get box(){return Be(gp,this)}get classNamesForOutlining(){return["highlightOutline"]}}class yp extends Uf{newFreeDrawOutline(t,e,n,i,s,r){return new wp(t,e,n,i,s,r)}}class wp extends np{newOutliner(t,e,n,i,s){return new yp(t,e,n,i,s,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}}var bp=new WeakMap,_p=new WeakMap,Ep=new WeakMap,Ap=new WeakMap,Sp=new WeakMap,kp=new WeakMap,Cp=new WeakMap,Tp=new WeakMap,xp=new WeakMap,Ip=new WeakMap,Rp=new WeakMap,Mp=new WeakSet;class Pp{static get _keyboardManager(){return qn(this,"_keyboardManager",new gs([[["Escape","mac+Escape"],Pp.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Pp.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Pp.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Pp.prototype._moveToPrevious],[["Home","mac+Home"],Pp.prototype._moveToBeginning],[["End","mac+End"],Pp.prototype._moveToEnd]]))}constructor(t){var e;let{editor:n=null,uiManager:i=null}=t;Le(this,Mp),Oe(this,bp,null),Oe(this,_p,null),Oe(this,Ep,void 0),Oe(this,Ap,null),Oe(this,Sp,!1),Oe(this,kp,!1),Oe(this,Cp,null),Oe(this,Tp,void 0),Oe(this,xp,null),Oe(this,Ip,null),Oe(this,Rp,void 0),n?(Ve(kp,this,!1),Ve(Rp,this,mn.HIGHLIGHT_COLOR),Ve(Cp,this,n)):(Ve(kp,this,!0),Ve(Rp,this,mn.HIGHLIGHT_DEFAULT_COLOR)),Ve(Ip,this,(null===n||void 0===n?void 0:n._uiManager)||i),Ve(Tp,this,Be(Ip,this)._eventBus),Ve(Ep,this,(null===n||void 0===n?void 0:n.color)||(null===(e=Be(Ip,this))||void 0===e?void 0:e.highlightColors.values().next().value)||"#FFFF98"),Bp._||(Bp._=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}renderButton(){const t=Ve(bp,this,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=Be(Ip,this)._signal;t.addEventListener("click",Fe(Mp,this,Op).bind(this),{signal:e}),t.addEventListener("keydown",Fe(Mp,this,Lp).bind(this),{signal:e});const n=Ve(_p,this,document.createElement("span"));return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=Be(Ep,this),t.append(n),t}renderMainDropdown(){const t=Ve(Ap,this,Fe(Mp,this,Np).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===Be(bp,this))return void Fe(Mp,this,Op).call(this,t);const e=t.target.getAttribute("data-color");e&&Fe(Mp,this,Dp).call(this,e,t)}_moveToNext(t){var e,n;Ue(Mp,this,Up)?t.target!==Be(bp,this)?null===(e=t.target.nextSibling)||void 0===e||e.focus():null===(n=Be(Ap,this).firstChild)||void 0===n||n.focus():Fe(Mp,this,Op).call(this,t)}_moveToPrevious(t){var e,n;t.target!==(null===(e=Be(Ap,this))||void 0===e?void 0:e.firstChild)&&t.target!==Be(bp,this)?(Ue(Mp,this,Up)||Fe(Mp,this,Op).call(this,t),null===(n=t.target.previousSibling)||void 0===n||n.focus()):Ue(Mp,this,Up)&&this._hideDropdownFromKeyboard()}_moveToBeginning(t){var e;Ue(Mp,this,Up)?null===(e=Be(Ap,this).firstChild)||void 0===e||e.focus():Fe(Mp,this,Op).call(this,t)}_moveToEnd(t){var e;Ue(Mp,this,Up)?null===(e=Be(Ap,this).lastChild)||void 0===e||e.focus():Fe(Mp,this,Op).call(this,t)}hideDropdown(){var t,e;null===(t=Be(Ap,this))||void 0===t||t.classList.add("hidden"),null===(e=Be(xp,this))||void 0===e||e.abort(),Ve(xp,this,null)}_hideDropdownFromKeyboard(){var t;Be(kp,this)||(Ue(Mp,this,Up)?(this.hideDropdown(),Be(bp,this).focus({preventScroll:!0,focusVisible:Be(Sp,this)})):null===(t=Be(Cp,this))||void 0===t||t.unselect())}updateColor(t){if(Be(_p,this)&&(Be(_p,this).style.backgroundColor=t),!Be(Ap,this))return;const e=Be(Ip,this).highlightColors.values();for(const n of Be(Ap,this).children)n.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;null===(t=Be(bp,this))||void 0===t||t.remove(),Ve(bp,this,null),Ve(_p,this,null),null===(e=Be(Ap,this))||void 0===e||e.remove(),Ve(Ap,this,null)}}function Np(){const t=document.createElement("div"),e=Be(Ip,this)._signal;t.addEventListener("contextmenu",_i,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,i]of Be(Ip,this).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=n,s.setAttribute("data-l10n-id",Bp._[n]);const r=document.createElement("span");s.append(r),r.className="swatch",r.style.backgroundColor=i,s.setAttribute("aria-selected",i===Be(Ep,this)),s.addEventListener("click",Fe(Mp,this,Dp).bind(this,i),{signal:e}),t.append(s)}return t.addEventListener("keydown",Fe(Mp,this,Lp).bind(this),{signal:e}),t}function Dp(t,e){e.stopPropagation(),Be(Tp,this).dispatch("switchannotationeditorparams",{source:this,type:Be(Rp,this),value:t})}function Lp(t){Je._keyboardManager.exec(this,t)}function Op(t){if(Ue(Mp,this,Up))return void this.hideDropdown();if(Ve(Sp,this,0===t.detail),Be(xp,this)||(Ve(xp,this,new AbortController),window.addEventListener("pointerdown",Fe(Mp,this,Fp).bind(this),{signal:Be(Ip,this).combinedSignal(Be(xp,this))})),Be(Ap,this))return void Be(Ap,this).classList.remove("hidden");const e=Ve(Ap,this,Fe(Mp,this,Np).call(this));Be(bp,this).append(e)}function Fp(t){var e;null!==(e=Be(Ap,this))&&void 0!==e&&e.contains(t.target)||this.hideDropdown()}function Up(t){return Be(Ap,t)&&!Be(Ap,t).classList.contains("hidden")}Je=Pp;var Bp={_:null},Vp=new WeakMap,jp=new WeakMap,Wp=new WeakMap,zp=new WeakMap,Hp=new WeakMap,qp=new WeakMap,Gp=new WeakMap,Kp=new WeakMap,Xp=new WeakMap,Qp=new WeakMap,Yp=new WeakMap,Jp=new WeakMap,$p=new WeakMap,Zp=new WeakMap,tg=new WeakMap,eg=new WeakMap,ng=new WeakMap,ig=new WeakMap,sg=new WeakSet;class rg extends Oa{static get _keyboardManager(){const t=rg.prototype;return qn(this,"_keyboardManager",new gs([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super(l(l({},t),{},{name:"highlightEditor"})),Le(this,sg),Oe(this,Vp,null),Oe(this,jp,0),Oe(this,Wp,void 0),Oe(this,zp,null),Oe(this,Hp,null),Oe(this,qp,null),Oe(this,Gp,null),Oe(this,Kp,0),Oe(this,Xp,null),Oe(this,Qp,null),Oe(this,Yp,null),Oe(this,Jp,!1),Oe(this,$p,null),Oe(this,Zp,void 0),Oe(this,tg,null),Oe(this,eg,""),Oe(this,ng,void 0),Oe(this,ig,""),this.color=t.color||rg._defaultColor,Ve(ng,this,t.thickness||rg._defaultThickness),Ve(Zp,this,t.opacity||rg._defaultOpacity),Ve(Wp,this,t.boxes||null),Ve(ig,this,t.methodOfCreation||""),Ve(eg,this,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(Ve(Jp,this,!0),Fe(sg,this,og).call(this,t),Fe(sg,this,dg).call(this)):Be(Wp,this)&&(Ve(Vp,this,t.anchorNode),Ve(jp,this,t.anchorOffset),Ve(Gp,this,t.focusNode),Ve(Kp,this,t.focusOffset),Fe(sg,this,ag).call(this),Fe(sg,this,dg).call(this),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:Be(Jp,this)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:Be(ng,this),methodOfCreation:Be(ig,this)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,e){var n;Oa.initialize(t,e),rg._defaultColor||(rg._defaultColor=(null===(n=e.highlightColors)||void 0===n?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(t,e){switch(t){case mn.HIGHLIGHT_DEFAULT_COLOR:rg._defaultColor=e;break;case mn.HIGHLIGHT_THICKNESS:rg._defaultThickness=e}}translateInPage(t,e){}get toolbarPosition(){return Be($p,this)}updateParams(t,e){switch(t){case mn.HIGHLIGHT_COLOR:Fe(sg,this,lg).call(this,e);break;case mn.HIGHLIGHT_THICKNESS:Fe(sg,this,cg).call(this,e)}}static get defaultPropertiesToUpdate(){return[[mn.HIGHLIGHT_DEFAULT_COLOR,rg._defaultColor],[mn.HIGHLIGHT_THICKNESS,rg._defaultThickness]]}get propertiesToUpdate(){return[[mn.HIGHLIGHT_COLOR,this.color||rg._defaultColor],[mn.HIGHLIGHT_THICKNESS,Be(ng,this)||rg._defaultThickness],[mn.HIGHLIGHT_FREE,Be(Jp,this)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(Ve(Hp,this,new Pp({editor:this})),t.addColorPicker(Be(Hp,this))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(Fe(sg,this,mg).call(this))}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,Fe(sg,this,mg).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){Fe(sg,this,hg).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(Fe(sg,this,dg).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;if(this.parent&&!t)Fe(sg,this,hg).call(this);else if(t){var n;Fe(sg,this,dg).call(this,t),e=!this.parent&&(null===(n=this.div)||void 0===n?void 0:n.classList.contains("selectedEditor"))}super.setParent(t),this.show(this._isVisible),e&&this.select()}rotate(t){const{drawLayer:e}=this.parent;let n;Be(Jp,this)?(t=(t-this.rotation+360)%360,n=fg.call(rg,Be(Qp,this).box,t)):n=fg.call(rg,[this.x,this.y,this.width,this.height],t),e.updateProperties(Be(Yp,this),{bbox:n,root:{"data-main-rotation":t}}),e.updateProperties(Be(tg,this),{bbox:fg.call(rg,Be(qp,this).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();Be(eg,this)&&(t.setAttribute("aria-label",Be(eg,this)),t.setAttribute("role","mark")),Be(Jp,this)?t.classList.add("free"):this.div.addEventListener("keydown",Fe(sg,this,pg).bind(this),{signal:this._uiManager._signal});const e=Ve(Xp,this,document.createElement("div"));t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=Be(zp,this);const[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),ts(this,Be(Xp,this),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(Be(tg,this),{rootClass:{hovered:!0}}))}pointerleave(){var t;this.isSelected||(null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(Be(tg,this),{rootClass:{hovered:!1}}))}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:Fe(sg,this,gg).call(this,!0);break;case 1:case 3:Fe(sg,this,gg).call(this,!1)}}select(){var t;super.select(),Be(tg,this)&&(null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(Be(tg,this),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),Be(tg,this)&&(null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(Be(tg,this),{rootClass:{selected:!1}}),Be(Jp,this)||Fe(sg,this,gg).call(this,!1))}get _mustFixPosition(){return!Be(Jp,this)}show(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(Be(Yp,this),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(Be(tg,this),{rootClass:{hidden:!t}}))}static startHighlighting(t,e,n){let{target:i,x:s,y:r}=n;const{x:a,y:o,width:l,height:c}=i.getBoundingClientRect(),u=new AbortController,h=t.combinedSignal(u),d=e=>{u.abort(),Fe(rg,this,bg).call(this,t,e)};window.addEventListener("blur",d,{signal:h}),window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("pointerdown",Ei,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",_i,{signal:h}),i.addEventListener("pointermove",Fe(rg,this,wg).bind(this,t),{signal:h}),this._freeHighlight=new yp({x:s,y:r},[a,o,l,c],t.scale,this._defaultThickness/2,e,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0))}static async deserialize(t,e,n){let i=null;if(t instanceof Wd){const{data:{quadPoints:e,rect:n,rotation:s,id:r,color:a,opacity:o,popupRef:l},parent:{page:{pageNumber:c}}}=t;i=t={annotationType:gn.HIGHLIGHT,color:Array.from(a),opacity:o,quadPoints:e,boxes:null,pageIndex:c-1,rect:n.slice(0),rotation:s,id:r,deleted:!1,popupRef:l}}else if(t instanceof Vd){const{data:{inkLists:e,rect:n,rotation:s,id:r,color:a,borderStyle:{rawWidth:o},popupRef:l},parent:{page:{pageNumber:c}}}=t;i=t={annotationType:gn.HIGHLIGHT,color:Array.from(a),thickness:o,inkLists:e,boxes:null,pageIndex:c-1,rect:n.slice(0),rotation:s,id:r,deleted:!1,popupRef:l}}const{color:s,quadPoints:r,inkLists:a,opacity:o}=t,l=await super.deserialize(t,e,n);l.color=ii.makeHexColor(...s),Ve(Zp,l,o||1),a&&Ve(ng,l,t.thickness),l.annotationElementId=t.id||null,l._initialData=i;const[c,u]=l.pageDimensions,[h,d]=l.pageTranslation;if(r){const t=Ve(Wp,l,[]);for(let e=0;e<r.length;e+=8)t.push({x:(r[e]-h)/c,y:1-(r[e+1]-d)/u,width:(r[e+2]-r[e])/c,height:(r[e+1]-r[e+5])/u});Fe(sg,l,ag).call(l),Fe(sg,l,dg).call(l),l.rotate(l.rotation)}else if(a){Ve(Jp,l,!0);const t=a[0],n={x:t[0]-h,y:u-(t[1]-d)},i=new yp(n,[0,0,c,u],1,Be(ng,l)/2,!0,.001);for(let e=0,a=t.length;e<a;e+=2)n.x=t[e]-h,n.y=u-(t[e+1]-d),i.add(n);const{id:s,clipPathId:r}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:l.color,"fill-opacity":l._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:i.toSVGPath()}},!0,!0);Fe(sg,l,og).call(l,{highlightOutlines:i.getOutlines(),highlightId:s,clipPathId:r}),Fe(sg,l,dg).call(l),l.rotate(l.parentRotation)}return l}serialize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getRect(0,0),n=Oa._colorManager.convert(this.color),i={annotationType:gn.HIGHLIGHT,color:n,opacity:Be(Zp,this),thickness:Be(ng,this),quadPoints:Fe(sg,this,vg).call(this),outlines:Fe(sg,this,yg).call(this,e),pageIndex:this.pageIndex,rect:e,rotation:Fe(sg,this,mg).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!Fe(sg,this,_g).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}function ag(){const t=new cp(Be(Wp,this),.001);Ve(Qp,this,t.getOutlines()),[this.x,this.y,this.width,this.height]=Be(Qp,this).box;const e=new cp(Be(Wp,this),.0025,.001,"ltr"===this._uiManager.direction);Ve(qp,this,e.getOutlines());const{lastPoint:n}=Be(qp,this);Ve($p,this,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height])}function og(t){let{highlightOutlines:e,highlightId:n,clipPathId:i}=t;Ve(Qp,this,e);if(Ve(qp,this,e.getNewOutline(Be(ng,this)/2+1.5,.0025)),n>=0)Ve(Yp,this,n),Ve(zp,this,i),this.parent.drawLayer.finalizeDraw(n,{bbox:e.box,path:{d:e.toSVGPath()}}),Ve(tg,this,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:Be(qp,this).box,path:{d:Be(qp,this).toSVGPath()}},!0));else if(this.parent){const t=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(Be(Yp,this),{bbox:fg.call($e,Be(Qp,this).box,(t-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(Be(tg,this),{bbox:fg.call($e,Be(qp,this).box,t),path:{d:Be(qp,this).toSVGPath()}})}const[s,r,a,o]=e.box;switch(this.rotation){case 0:this.x=s,this.y=r,this.width=a,this.height=o;break;case 90:{const[t,e]=this.parentDimensions;this.x=r,this.y=1-s,this.width=a*e/t,this.height=o*t/e;break}case 180:this.x=1-s,this.y=1-r,this.width=a,this.height=o;break;case 270:{const[t,e]=this.parentDimensions;this.x=1-r,this.y=s,this.width=a*e/t,this.height=o*t/e;break}}const{lastPoint:l}=Be(qp,this);Ve($p,this,[(l[0]-s)/a,(l[1]-r)/o])}function lg(t){const e=(t,e)=>{var n,i;this.color=t,Ve(Zp,this,e),null===(n=this.parent)||void 0===n||n.drawLayer.updateProperties(Be(Yp,this),{root:{fill:t,"fill-opacity":e}}),null===(i=Be(Hp,this))||void 0===i||i.updateColor(t)},n=this.color,i=Be(Zp,this);this.addCommands({cmd:e.bind(this,t,$e._defaultOpacity),undo:e.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mn.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}function cg(t){const e=Be(ng,this),n=t=>{Ve(ng,this,t),Fe(sg,this,ug).call(this,t)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mn.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}function ug(t){if(!Be(Jp,this))return;Fe(sg,this,og).call(this,{highlightOutlines:Be(Qp,this).getNewOutline(t/2)}),this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}function hg(){null!==Be(Yp,this)&&this.parent&&(this.parent.drawLayer.remove(Be(Yp,this)),Ve(Yp,this,null),this.parent.drawLayer.remove(Be(tg,this)),Ve(tg,this,null))}function dg(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null===Be(Yp,this)&&(({id:Ne(Ve,[Yp,this])._,clipPathId:Ne(Ve,[zp,this])._}=t.drawLayer.draw({bbox:Be(Qp,this).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":Be(Zp,this)},rootClass:{highlight:!0,free:Be(Jp,this)},path:{d:Be(Qp,this).toSVGPath()}},!1,!0)),Ve(tg,this,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:Be(Jp,this)},bbox:Be(qp,this).box,path:{d:Be(qp,this).toSVGPath()}},Be(Jp,this))),Be(Xp,this)&&(Be(Xp,this).style.clipPath=Be(zp,this)))}function fg(t,e){let[n,i,s,r]=t;switch(e){case 90:return[1-i-r,n,r,s];case 180:return[1-n-s,1-i-r,s,r];case 270:return[i,1-n-s,r,s]}return[n,i,s,r]}function pg(t){$e._keyboardManager.exec(this,t)}function gg(t){if(!Be(Vp,this))return;const e=window.getSelection();t?e.setPosition(Be(Vp,this),Be(jp,this)):e.setPosition(Be(Gp,this),Be(Kp,this))}function mg(){return Be(Jp,this)?this.rotation:0}function vg(){if(Be(Jp,this))return null;const[t,e]=this.pageDimensions,[n,i]=this.pageTranslation,s=Be(Wp,this),r=new Float32Array(8*s.length);let a=0;for(const{x:o,y:l,width:c,height:u}of s){const s=o*t+n,h=(1-l)*e+i;r[a]=r[a+4]=s,r[a+1]=r[a+3]=h,r[a+2]=r[a+6]=s+c*t,r[a+5]=r[a+7]=h-u*e,a+=8}return r}function yg(t){return Be(Qp,this).serialize(t,Fe(sg,this,mg).call(this))}function wg(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}function bg(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}function _g(t){const{color:e}=this._initialData;return t.color.some(((t,n)=>t!==e[n]))}$e=rg,a(rg,"_defaultColor",null),a(rg,"_defaultOpacity",1),a(rg,"_defaultThickness",12),a(rg,"_type","highlight"),a(rg,"_editorType",gn.HIGHLIGHT),a(rg,"_freeHighlightId",-1),a(rg,"_freeHighlight",null),a(rg,"_freeHighlightClipId","");var Eg=new WeakMap;class Ag{constructor(){Oe(this,Eg,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,n)}updateSVGProperty(t,e){Be(Eg,this)[t]=e}toSVGProperties(){const t=Be(Eg,this);return Ve(Eg,this,Object.create(null)),{root:t}}reset(){Ve(Eg,this,Object.create(null))}updateAll(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;this.updateProperties(t)}clone(){jn("Not implemented")}}var Sg=new WeakMap,kg=new WeakMap,Cg=new WeakSet;class Tg extends Oa{constructor(t){super(t),Le(this,Cg),Oe(this,Sg,null),Oe(this,kg,void 0),a(this,"_drawId",null),Ve(kg,this,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(Fe(Cg,this,xg).call(this,t),Fe(Cg,this,Mg).call(this))}static _mergeSVGProperties(t,e){const n=new Set(Object.keys(t));for(const[i,s]of Object.entries(e))n.has(i)?Object.assign(t[i],s):t[i]=s;return t}static getDefaultDrawingOptions(t){jn("Not implemented")}static get typesMap(){jn("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,e),this._currentParent&&(Og._.updateProperty(n,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)t.push([n,e[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[n,i]of this.constructor.typesMap)t.push([n,e[i]]);return t}_updateProperty(t,e,n){const i=this._drawingOptions,s=i[e],r=t=>{var n;i.updateProperty(e,t);const s=Be(Sg,this).updateProperty(e,t);s&&Fe(Cg,this,Dg).call(this,s),null===(n=this.parent)||void 0===n||n.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:r.bind(this,n),undo:r.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(this._drawId,Tg._mergeSVGProperties(Be(Sg,this).getPathResizingSVGProperties(Fe(Cg,this,Ng).call(this)),{bbox:Fe(Cg,this,Lg).call(this)}))}_onResized(){var t;null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(this._drawId,Tg._mergeSVGProperties(Be(Sg,this).getPathResizedSVGProperties(Fe(Cg,this,Ng).call(this)),{bbox:Fe(Cg,this,Lg).call(this)}))}_onTranslating(t,e){var n;null===(n=this.parent)||void 0===n||n.drawLayer.updateProperties(this._drawId,{bbox:Fe(Cg,this,Lg).call(this)})}_onTranslated(){var t;null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(this._drawId,Tg._mergeSVGProperties(Be(Sg,this).getPathTranslatedSVGProperties(Fe(Cg,this,Ng).call(this),this.parentDimensions),{bbox:Fe(Cg,this,Lg).call(this)}))}_onStartDragging(){var t;null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,Be(kg,this)&&(Ve(kg,this,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){Fe(Cg,this,Rg).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(Fe(Cg,this,Mg).call(this),Fe(Cg,this,Dg).call(this,Be(Sg,this).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;if(this.parent&&!t)this._uiManager.removeShouldRescale(this),Fe(Cg,this,Rg).call(this);else if(t){var n;this._uiManager.addShouldRescale(this),Fe(Cg,this,Mg).call(this,t),e=!this.parent&&(null===(n=this.div)||void 0===n?void 0:n.classList.contains("selectedEditor"))}super.setParent(t),e&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Tg._mergeSVGProperties({bbox:Fe(Cg,this,Lg).call(this)},Be(Sg,this).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&Fe(Cg,this,Dg).call(this,Be(Sg,this).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const n=super.render();n.classList.add("draw");const i=document.createElement("div");n.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),n}static createDrawerInstance(t,e,n,i,s){jn("Not implemented")}static startDrawing(t,e,n,i){var s,r;const{target:a,offsetX:o,offsetY:l,pointerId:c,pointerType:u}=i;if(Vg._&&Vg._!==u)return;const{viewport:{rotation:h}}=t,{width:d,height:f}=a.getBoundingClientRect(),p=Fg._=new AbortController,g=t.combinedSignal(p);Bg._||(Bg._=c),null!==(s=Vg._)&&void 0!==s||(Vg._=u),window.addEventListener("pointerup",(t=>{var e;Bg._===t.pointerId?this._endDraw(t):null===(e=jg._)||void 0===e||e.delete(t.pointerId)}),{signal:g}),window.addEventListener("pointercancel",(t=>{var e;Bg._===t.pointerId?this._currentParent.endDrawingSession():null===(e=jg._)||void 0===e||e.delete(t.pointerId)}),{signal:g}),window.addEventListener("pointerdown",(t=>{Vg._===t.pointerType&&((jg._||(jg._=new Set)).add(t.pointerId),Og._.isCancellable()&&(Og._.removeLastElement(),Og._.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))}),{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",_i,{signal:g}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:g}),a.addEventListener("touchmove",(t=>{t.timeStamp===Wg._&&Ei(t)}),{signal:g}),t.toggleDrawing(),null===(r=e._editorUndoBar)||void 0===r||r.hide(),Og._?t.drawLayer.updateProperties(this._currentDrawId,Og._.startNew(o,l,d,f,h)):(e.updateUIForDefaultProperties(this),Og._=this.createDrawerInstance(o,l,d,f,h),Ug._=this.getDefaultDrawingOptions(),this._currentParent=t,({id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Ug._.toSVGProperties(),Og._.defaultSVGProperties),!0,!1)))}static _drawMove(t){var e;if(Wg._=-1,!Og._)return;const{offsetX:n,offsetY:i,pointerId:s}=t;Bg._===s&&((null===(e=jg._)||void 0===e?void 0:e.size)>=1?this._endDraw(t):(this._currentParent.drawLayer.updateProperties(this._currentDrawId,Og._.add(n,i)),Wg._=t.timeStamp,Ei(t)))}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Og._=null,Ug._=null,Vg._=null,Wg._=NaN),Fg._&&(Fg._.abort(),Fg._=null,Bg._=NaN,jg._=null)}static _endDraw(t){const e=this._currentParent;if(e)if(e.toggleDrawing(!0),this._cleanup(!1),(null===t||void 0===t?void 0:t.target)===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Og._.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const t=Og._,n=this._currentDrawId,i=t.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(n,t.setLastElement(i))},undo:()=>{e.drawLayer.updateProperties(n,t.removeLastElement())},mustExec:!1,type:mn.DRAW_STEP})}else this.endDrawing(!1)}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(mn.DRAW_STEP),!Og._.isEmpty()){const{pageDimensions:[n,i],scale:s}=e,r=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Og._.getOutlines(n*s,i*s,s,this._INNER_MARGIN),drawingOptions:Ug._,mustBeCommitted:!t});return this._cleanup(!0),r}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,n,i,s,r){jn("Not implemented")}static async deserialize(t,e,n){const{rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:a}}=e.viewport,o=this.deserializeDraw(r,a,i,s,this._INNER_MARGIN,t),l=await super.deserialize(t,e,n);return l.createDrawingOptions(t),Fe(Cg,l,xg).call(l,{drawOutlines:o}),Fe(Cg,l,Mg).call(l),l.onScaleChanging(),l.rotate(),l}serializeDraw(t){const[e,n]=this.pageTranslation,[i,s]=this.pageDimensions;return Be(Sg,this).serialize([e,n,i,s],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}function xg(t){let{drawOutlines:e,drawId:n,drawingOptions:i}=t;Ve(Sg,this,e),this._drawingOptions||(this._drawingOptions=i),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,e.defaultProperties)):this._drawId=Fe(Cg,this,Ig).call(this,e,this.parent),Fe(Cg,this,Dg).call(this,e.box)}function Ig(t,e){const{id:n}=e.drawLayer.draw(Ze._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n}function Rg(){null!==this._drawId&&this.parent&&(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}function Mg(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null!==this._drawId&&this.parent===t||(null===this._drawId?(this._drawingOptions.updateAll(),this._drawId=Fe(Cg,this,Ig).call(this,Be(Sg,this),t)):this.parent.drawLayer.updateParent(this._drawId,t.drawLayer))}function Pg(t){let[e,n,i,s]=t;const{parentDimensions:[r,a],rotation:o}=this;switch(o){case 90:return[n,1-e,i*(a/r),s*(r/a)];case 180:return[1-e,1-n,i,s];case 270:return[1-n,e,i*(a/r),s*(r/a)];default:return[e,n,i,s]}}function Ng(){const{x:t,y:e,width:n,height:i,parentDimensions:[s,r],rotation:a}=this;switch(a){case 90:return[1-e,t,n*(s/r),i*(r/s)];case 180:return[1-t,1-e,n,i];case 270:return[e,1-t,n*(s/r),i*(r/s)];default:return[t,e,n,i]}}function Dg(t){if([this.x,this.y,this.width,this.height]=Fe(Cg,this,Pg).call(this,t),this.div){this.fixAndSetPosition();const[t,e]=this.parentDimensions;this.setDims(this.width*t,this.height*e)}this._onResized()}function Lg(){const{x:t,y:e,width:n,height:i,rotation:s,parentRotation:r,parentDimensions:[a,o]}=this;switch((4*s+r)/90){case 1:return[1-e-i,t,i,n];case 2:return[1-t-n,1-e-i,n,i];case 3:return[e,1-t-n,i,n];case 4:return[t,e-n*(a/o),i*(o/a),n*(a/o)];case 5:return[1-e,t,n*(a/o),i*(o/a)];case 6:return[1-t-i*(o/a),1-e,i*(o/a),n*(a/o)];case 7:return[e-n*(a/o),1-t-i*(o/a),n*(a/o),i*(o/a)];case 8:return[t-n,e-i,n,i];case 9:return[1-e,t-n,i,n];case 10:return[1-t,1-e,n,i];case 11:return[e-i,1-t,i,n];case 12:return[t-i*(o/a),e,i*(o/a),n*(a/o)];case 13:return[1-e-n*(a/o),t-i*(o/a),n*(a/o),i*(o/a)];case 14:return[1-t,1-e-n*(a/o),i*(o/a),n*(a/o)];case 15:return[e,1-t,n*(a/o),i*(o/a)];default:return[t,e,n,i]}}Ze=Tg,a(Tg,"_currentDrawId",-1),a(Tg,"_currentParent",null);var Og={_:null},Fg={_:null},Ug={_:null},Bg={_:NaN},Vg={_:null},jg={_:null},Wg={_:NaN};a(Tg,"_INNER_MARGIN",3);var zg=new WeakMap,Hg=new WeakMap,qg=new WeakMap,Gg=new WeakMap,Kg=new WeakMap,Xg=new WeakMap,Qg=new WeakMap,Yg=new WeakMap,Jg=new WeakMap,$g=new WeakMap,Zg=new WeakMap,tm=new WeakSet;class em{constructor(t,e,n,i,s,r){Le(this,tm),Oe(this,zg,new Float64Array(6)),Oe(this,Hg,void 0),Oe(this,qg,void 0),Oe(this,Gg,void 0),Oe(this,Kg,void 0),Oe(this,Xg,void 0),Oe(this,Qg,""),Oe(this,Yg,0),Oe(this,Jg,new fm),Oe(this,$g,void 0),Oe(this,Zg,void 0),Ve($g,this,n),Ve(Zg,this,i),Ve(Gg,this,s),Ve(Kg,this,r),[t,e]=Fe(tm,this,nm).call(this,t,e);const a=Ve(Hg,this,[NaN,NaN,NaN,NaN,t,e]);Ve(Xg,this,[t,e]),Ve(qg,this,[{line:a,points:Be(Xg,this)}]),Be(zg,this).set(a,0)}updateProperty(t,e){"stroke-width"===t&&Ve(Kg,this,e)}isEmpty(){return!Be(qg,this)||0===Be(qg,this).length}isCancellable(){return Be(Xg,this).length<=10}add(t,e){[t,e]=Fe(tm,this,nm).call(this,t,e);const[n,i,s,r]=Be(zg,this).subarray(2,6),a=t-s,o=e-r;return Math.hypot(Be($g,this)*a,Be(Zg,this)*o)<=2?null:(Be(Xg,this).push(t,e),isNaN(n)?(Be(zg,this).set([s,r,t,e],2),Be(Hg,this).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(Be(zg,this)[0])&&Be(Hg,this).splice(6,6),Be(zg,this).set([n,i,s,r,t,e],0),Be(Hg,this).push(...Af.createBezierPoints(n,i,s,r,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(2===Be(Xg,this).length?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,i,s){Ve($g,this,n),Ve(Zg,this,i),Ve(Gg,this,s),[t,e]=Fe(tm,this,nm).call(this,t,e);const r=Ve(Hg,this,[NaN,NaN,NaN,NaN,t,e]);Ve(Xg,this,[t,e]);const a=Be(qg,this).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),Be(qg,this).push({line:r,points:Be(Xg,this)}),Be(zg,this).set(r,0),Ve(Yg,this,0),this.toSVGPath(),null}getLastElement(){return Be(qg,this).at(-1)}setLastElement(t){return Be(qg,this)?(Be(qg,this).push(t),Ve(Hg,this,t.line),Ve(Xg,this,t.points),Ve(Yg,this,0),{path:{d:this.toSVGPath()}}):Be(Jg,this).setLastElement(t)}removeLastElement(){if(!Be(qg,this))return Be(Jg,this).removeLastElement();Be(qg,this).pop(),Ve(Qg,this,"");for(let t=0,e=Be(qg,this).length;t<e;t++){const{line:e,points:n}=Be(qg,this)[t];Ve(Hg,this,e),Ve(Xg,this,n),Ve(Yg,this,0),this.toSVGPath()}return{path:{d:Be(Qg,this)}}}toSVGPath(){const t=Af.svgRound(Be(Hg,this)[4]),e=Af.svgRound(Be(Hg,this)[5]);if(2===Be(Xg,this).length)return Ve(Qg,this,"".concat(Be(Qg,this)," M ").concat(t," ").concat(e," Z")),Be(Qg,this);if(Be(Xg,this).length<=6){const n=Be(Qg,this).lastIndexOf("M");Ve(Qg,this,"".concat(Be(Qg,this).slice(0,n)," M ").concat(t," ").concat(e)),Ve(Yg,this,6)}if(4===Be(Xg,this).length){const t=Af.svgRound(Be(Hg,this)[10]),e=Af.svgRound(Be(Hg,this)[11]);return Ve(Qg,this,"".concat(Be(Qg,this)," L ").concat(t," ").concat(e)),Ve(Yg,this,12),Be(Qg,this)}const n=[];0===Be(Yg,this)&&(n.push("M ".concat(t," ").concat(e)),Ve(Yg,this,6));for(let i=Be(Yg,this),s=Be(Hg,this).length;i<s;i+=6){const[t,e,s,r,a,o]=Be(Hg,this).slice(i,i+6).map(Af.svgRound);n.push("C".concat(t," ").concat(e," ").concat(s," ").concat(r," ").concat(a," ").concat(o))}return Ve(Qg,this,Be(Qg,this)+n.join(" ")),Ve(Yg,this,Be(Hg,this).length),Be(Qg,this)}getOutlines(t,e,n,i){const s=Be(qg,this).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),Be(Jg,this).build(Be(qg,this),t,e,n,Be(Gg,this),Be(Kg,this),i),Ve(zg,this,null),Ve(Hg,this,null),Ve(qg,this,null),Ve(Qg,this,null),Be(Jg,this)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}function nm(t,e){return Af._normalizePoint(t,e,Be($g,this),Be(Zg,this),Be(Gg,this))}var im=new WeakMap,sm=new WeakMap,rm=new WeakMap,am=new WeakMap,om=new WeakMap,lm=new WeakMap,cm=new WeakMap,um=new WeakMap,hm=new WeakMap,dm=new WeakSet;class fm extends Af{constructor(){super(...arguments),Le(this,dm),Oe(this,im,void 0),Oe(this,sm,0),Oe(this,rm,void 0),Oe(this,am,void 0),Oe(this,om,void 0),Oe(this,lm,void 0),Oe(this,cm,void 0),Oe(this,um,void 0),Oe(this,hm,void 0)}build(t,e,n,i,s,r,a){Ve(om,this,e),Ve(lm,this,n),Ve(cm,this,i),Ve(um,this,s),Ve(hm,this,r),Ve(rm,this,null!==a&&void 0!==a?a:0),Ve(am,this,t),Fe(dm,this,mm).call(this)}get thickness(){return Be(hm,this)}setLastElement(t){return Be(am,this).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return Be(am,this).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of Be(am,this))if(t.push("M".concat(Af.svgRound(e[4])," ").concat(Af.svgRound(e[5]))),6!==e.length)if(12===e.length&&isNaN(e[6]))t.push("L".concat(Af.svgRound(e[10])," ").concat(Af.svgRound(e[11])));else for(let n=6,i=e.length;n<i;n+=6){const[i,s,r,a,o,l]=e.subarray(n,n+6).map(Af.svgRound);t.push("C".concat(i," ").concat(s," ").concat(r," ").concat(a," ").concat(o," ").concat(l))}else t.push("Z");return t.join("")}serialize(t,e){let[n,i,s,r]=t;const a=[],o=[],[l,c,u,h]=Fe(dm,this,gm).call(this);let d,f,p,g,m,v,y,w,b;switch(Be(um,this)){case 0:b=Af._rescale,d=n,f=i+r,p=s,g=-r,m=n+l*s,v=i+(1-c-h)*r,y=n+(l+u)*s,w=i+(1-c)*r;break;case 90:b=Af._rescaleAndSwap,d=n,f=i,p=s,g=r,m=n+c*s,v=i+l*r,y=n+(c+h)*s,w=i+(l+u)*r;break;case 180:b=Af._rescale,d=n+s,f=i,p=-s,g=r,m=n+(1-l-u)*s,v=i+c*r,y=n+(1-l)*s,w=i+(c+h)*r;break;case 270:b=Af._rescaleAndSwap,d=n+s,f=i+r,p=-s,g=-r,m=n+(1-c-h)*s,v=i+(1-l-u)*r,y=n+(1-c)*s,w=i+(1-l)*r}for(const{line:_,points:E}of Be(am,this))a.push(b(_,d,f,p,g,e?new Array(_.length):null)),o.push(b(E,d,f,p,g,e?new Array(E.length):null));return{lines:a,points:o,rect:[m,v,y,w]}}static deserialize(t,e,n,i,s,r){let{paths:{lines:a,points:o},rotation:l,thickness:c}=r;const u=[];let h,d,f,p,g;switch(l){case 0:g=Af._rescale,h=-t/n,d=e/i+1,f=1/n,p=-1/i;break;case 90:g=Af._rescaleAndSwap,h=-e/i,d=-t/n,f=1/i,p=1/n;break;case 180:g=Af._rescale,h=t/n+1,d=-e/i,f=-1/n,p=1/i;break;case 270:g=Af._rescaleAndSwap,h=e/i+1,d=t/n+1,f=-1/i,p=-1/n}if(!a){a=[];for(const t of o){const e=t.length;if(2===e){a.push(new Float32Array([NaN,NaN,NaN,NaN,t[0],t[1]]));continue}if(4===e){a.push(new Float32Array([NaN,NaN,NaN,NaN,t[0],t[1],NaN,NaN,NaN,NaN,t[2],t[3]]));continue}const n=new Float32Array(3*(e-2));a.push(n);let[i,s,r,o]=t.subarray(0,4);n.set([NaN,NaN,NaN,NaN,i,s],0);for(let a=4;a<e;a+=2){const e=t[a],l=t[a+1];n.set(Af.createBezierPoints(i,s,r,o,e,l),3*(a-2)),[i,s,r,o]=[r,o,e,l]}}}for(let v=0,y=a.length;v<y;v++)u.push({line:g(a[v].map((t=>null!==t&&void 0!==t?t:NaN)),h,d,f,p),points:g(o[v].map((t=>null!==t&&void 0!==t?t:NaN)),h,d,f,p)});const m=new this.prototype.constructor;return m.build(u,n,i,1,l,c,s),m}get box(){return Be(im,this)}updateProperty(t,e){return"stroke-width"===t?Fe(dm,this,vm).call(this,e):null}updateParentDimensions(t,e){let[n,i]=t;const[s,r]=Fe(dm,this,pm).call(this);Ve(om,this,n),Ve(lm,this,i),Ve(cm,this,e);const[a,o]=Fe(dm,this,pm).call(this),l=a-s,c=o-r,u=Be(im,this);return u[0]-=l,u[1]-=c,u[2]+=2*l,u[3]+=2*c,u}updateRotation(t){return Ve(sm,this,t),{path:{transform:this.rotationTransform}}}get viewBox(){return Be(im,this).map(Af.svgRound).join(" ")}get defaultProperties(){const[t,e]=Be(im,this);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(Af.svgRound(t)," ").concat(Af.svgRound(e))}}}get rotationTransform(){const[,,t,e]=Be(im,this);let n=0,i=0,s=0,r=0,a=0,o=0;switch(Be(sm,this)){case 90:i=e/t,s=-t/e,a=t;break;case 180:n=-1,r=-1,a=t,o=e;break;case 270:i=-e/t,s=t/e,o=e;break;default:return""}return"matrix(".concat(n," ").concat(i," ").concat(s," ").concat(r," ").concat(Af.svgRound(a)," ").concat(Af.svgRound(o),")")}getPathResizingSVGProperties(t){let[e,n,i,s]=t;const[r,a]=Fe(dm,this,pm).call(this),[o,l,c,u]=Be(im,this);if(Math.abs(c-r)<=Af.PRECISION||Math.abs(u-a)<=Af.PRECISION){const t=e+i/2-(o+c/2),r=n+s/2-(l+u/2);return{path:{"transform-origin":"".concat(Af.svgRound(e)," ").concat(Af.svgRound(n)),transform:"".concat(this.rotationTransform," translate(").concat(t," ").concat(r,")")}}}const h=(i-2*r)/(c-2*r),d=(s-2*a)/(u-2*a),f=c/i,p=u/s;return{path:{"transform-origin":"".concat(Af.svgRound(o)," ").concat(Af.svgRound(l)),transform:"".concat(this.rotationTransform," scale(").concat(f," ").concat(p,") ")+"translate(".concat(Af.svgRound(r)," ").concat(Af.svgRound(a),") scale(").concat(h," ").concat(d,") ")+"translate(".concat(Af.svgRound(-r)," ").concat(Af.svgRound(-a),")")}}}getPathResizedSVGProperties(t){let[e,n,i,s]=t;const[r,a]=Fe(dm,this,pm).call(this),o=Be(im,this),[l,c,u,h]=o;if(o[0]=e,o[1]=n,o[2]=i,o[3]=s,Math.abs(u-r)<=Af.PRECISION||Math.abs(h-a)<=Af.PRECISION){const t=e+i/2-(l+u/2),r=n+s/2-(c+h/2);for(const{line:e,points:n}of Be(am,this))Af._translate(e,t,r,e),Af._translate(n,t,r,n);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(Af.svgRound(e)," ").concat(Af.svgRound(n)),transform:this.rotationTransform||null,d:this.toSVGPath()}}}const d=(i-2*r)/(u-2*r),f=(s-2*a)/(h-2*a),p=-d*(l+r)+e+r,g=-f*(c+a)+n+a;if(1!==d||1!==f||0!==p||0!==g)for(const{line:m,points:v}of Be(am,this))Af._rescale(m,p,g,d,f,m),Af._rescale(v,p,g,d,f,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(Af.svgRound(e)," ").concat(Af.svgRound(n)),transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties(t,e){let[n,i]=t;const[s,r]=e,a=Be(im,this),o=n-a[0],l=i-a[1];if(Be(om,this)===s&&Be(lm,this)===r)for(const{line:c,points:u}of Be(am,this))Af._translate(c,o,l,c),Af._translate(u,o,l,u);else{const t=Be(om,this)/s,e=Be(lm,this)/r;Ve(om,this,s),Ve(lm,this,r);for(const{line:n,points:i}of Be(am,this))Af._rescale(n,o,l,t,e,n),Af._rescale(i,o,l,t,e,i);a[2]*=t,a[3]*=e}return a[0]=n,a[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":"".concat(Af.svgRound(n)," ").concat(Af.svgRound(i))}}}get defaultSVGProperties(){const t=Be(im,this);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":"".concat(Af.svgRound(t[0])," ").concat(Af.svgRound(t[1])),transform:this.rotationTransform||null},bbox:t}}}function pm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be(hm,this);const e=Be(rm,this)+t/2*Be(cm,this);return Be(um,this)%180===0?[e/Be(om,this),e/Be(lm,this)]:[e/Be(lm,this),e/Be(om,this)]}function gm(){const[t,e,n,i]=Be(im,this),[s,r]=Fe(dm,this,pm).call(this,0);return[t+s,e+r,n-2*s,i-2*r]}function mm(){const t=Ve(im,this,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of Be(am,this)){if(i.length<=12){for(let e=4,n=i.length;e<n;e+=6)ii.pointBoundingBox(i[e],i[e+1],t);continue}let e=i[4],n=i[5];for(let s=6,r=i.length;s<r;s+=6){const[r,a,o,l,c,u]=i.subarray(s,s+6);ii.bezierBoundingBox(e,n,r,a,o,l,c,u,t),e=c,n=u}}const[e,n]=Fe(dm,this,pm).call(this);t[0]=ui(t[0]-e,0,1),t[1]=ui(t[1]-n,0,1),t[2]=ui(t[2]+e,0,1),t[3]=ui(t[3]+n,0,1),t[2]-=t[0],t[3]-=t[1]}function vm(t){const[e,n]=Fe(dm,this,pm).call(this);Ve(hm,this,t);const[i,s]=Fe(dm,this,pm).call(this),[r,a]=[i-e,s-n],o=Be(im,this);return o[0]-=r,o[1]-=a,o[2]+=2*r,o[3]+=2*a,o}class ym extends Ag{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Oa._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){"stroke-width"===t&&(null!==e&&void 0!==e||(e=this["stroke-width"]),e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new ym(this._viewParameters);return t.updateAll(this),t}}var wm=new WeakSet;class bm extends Tg{constructor(t){super(l(l({},t),{},{name:"inkEditor"})),Le(this,wm),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Oa.initialize(t,e),this._defaultDrawingOptions=new ym(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return qn(this,"typesMap",new Map([[mn.INK_THICKNESS,"stroke-width"],[mn.INK_COLOR,"stroke"],[mn.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,n,i,s){return new em(t,e,n,i,s,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,n,i,s,r){return fm.deserialize(t,e,n,i,s,r)}static async deserialize(t,e,n){let i=null;if(t instanceof Vd){const{data:{inkLists:e,rect:n,rotation:s,id:r,color:a,opacity:o,borderStyle:{rawWidth:l},popupRef:c},parent:{page:{pageNumber:u}}}=t;i=t={annotationType:gn.INK,color:Array.from(a),thickness:l,opacity:o,paths:{points:e},boxes:null,pageIndex:u-1,rect:n.slice(0),rotation:s,id:r,deleted:!1,popupRef:c}}const s=await super.deserialize(t,e,n);return s.annotationElementId=t.id||null,s._initialData=i,s}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:n}=this;e.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions(t){let{color:e,thickness:n,opacity:i}=t;this._drawingOptions=bm.getDefaultDrawingOptions({stroke:ii.makeHexColor(...e),"stroke-width":n,"stroke-opacity":i})}serialize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:n,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":r,"stroke-width":a}}=this,o={annotationType:gn.INK,color:Oa._colorManager.convert(s),opacity:r,thickness:a,paths:{lines:e,points:n},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(o.isCopy=!0,o):this.annotationElementId&&!Fe(wm,this,_m).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(t){const{points:e,rect:n}=this.serializeDraw(!1);return t.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:e}),null}}function _m(t){const{color:e,thickness:n,opacity:i,pageIndex:s}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some(((t,n)=>t!==e[n]))||t.thickness!==n||t.opacity!==i||t.pageIndex!==s}a(bm,"_type","ink"),a(bm,"_editorType",gn.INK),a(bm,"_defaultDrawingOptions",null);class Em extends fm{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}class Am{static extractContoursFromText(t,e,n,i,s,r){let{fontFamily:a,fontStyle:o,fontWeight:l}=e,c=new OffscreenCanvas(1,1),u=c.getContext("2d",{alpha:!1});const h=u.font="".concat(o," ").concat(l," ").concat(200,"px ").concat(a),{actualBoundingBoxLeft:d,actualBoundingBoxRight:f,actualBoundingBoxAscent:p,actualBoundingBoxDescent:g,fontBoundingBoxAscent:m,fontBoundingBoxDescent:v,width:y}=u.measureText(t),w=1.5,b=Math.ceil(Math.max(Math.abs(d)+Math.abs(f)||0,y)*w),_=Math.ceil(Math.max(Math.abs(p)+Math.abs(g)||200,Math.abs(m)+Math.abs(v)||200)*w);c=new OffscreenCanvas(b,_),u=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),u.font=h,u.filter="grayscale(1)",u.fillStyle="white",u.fillRect(0,0,b,_),u.fillStyle="black",u.fillText(t,.5*b/2,1.5*_/2);const E=Fe(Am,this,Pm).call(this,u.getImageData(0,0,b,_).data),A=Fe(Am,this,Mm).call(this,E),S=Fe(Am,this,Nm).call(this,A),k=Fe(Am,this,Tm).call(this,E,b,_,S);return this.processDrawnLines({lines:{curves:k,width:b,height:_},pageWidth:n,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:!0,areContours:!0})}static process(t,e,n,i,s){const[r,a,o]=Fe(Am,this,Dm).call(this,t),[l,c]=Fe(Am,this,Rm).call(this,r,a,o,Math.hypot(a,o)*Fe(Am,this,Lm)._.sigmaSFactor,Fe(Am,this,Lm)._.sigmaR,Fe(Am,this,Lm)._.kernelSize),u=Fe(Am,this,Nm).call(this,c),h=Fe(Am,this,Tm).call(this,l,a,o,u);return this.processDrawnLines({lines:{curves:h,width:a,height:o},pageWidth:e,pageHeight:n,rotation:i,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines(t){var e;let{lines:n,pageWidth:i,pageHeight:s,rotation:r,innerMargin:a,mustSmooth:o,areContours:l}=t;r%180!==0&&([i,s]=[s,i]);const{curves:c,width:u,height:h}=n,d=null!==(e=n.thickness)&&void 0!==e?e:0,f=[],p=Math.min(i/u,s/h),g=p/i,m=p/s,v=[];for(const{points:w}of c){const t=o?Fe(Am,this,Im).call(this,w):w;if(!t)continue;v.push(t);const e=t.length,n=new Float32Array(e),i=new Float32Array(3*(2===e?2:e-2));if(f.push({line:i,points:n}),2===e){n[0]=t[0]*g,n[1]=t[1]*m,i.set([NaN,NaN,NaN,NaN,n[0],n[1]],0);continue}let[s,r,a,l]=t;s*=g,r*=m,a*=g,l*=m,n.set([s,r,a,l],0),i.set([NaN,NaN,NaN,NaN,s,r],0);for(let o=4;o<e;o+=2){const e=n[o]=t[o]*g,c=n[o+1]=t[o+1]*m;i.set(Af.createBezierPoints(s,r,a,l,e,c),3*(o-2)),[s,r,a,l]=[a,l,e,c]}}if(0===f.length)return null;const y=l?new Em:new fm;return y.build(f,i,s,1,r,l?0:d,a),{outline:y,newCurves:v,areContours:l,thickness:d,width:u,height:h}}static async compressSignature(t){let e,{outlines:n,areContours:i,thickness:s,width:r,height:a}=t,o=1/0,l=-1/0,c=0;for(const y of n){c+=y.length;for(let t=2,e=y.length;t<e;t++){const e=y[t]-y[t-2];o=Math.min(o,e),l=Math.max(l,e)}}e=o>=-128&&l<=127?Int8Array:o>=-32768&&l<=32767?Int16Array:Int32Array;const u=n.length,h=8+3*u,d=new Uint32Array(h);let f=0;d[f++]=h*Uint32Array.BYTES_PER_ELEMENT+(c-2*u)*e.BYTES_PER_ELEMENT,d[f++]=0,d[f++]=r,d[f++]=a,d[f++]=i?0:1,d[f++]=Math.max(0,Math.floor(null!==s&&void 0!==s?s:0)),d[f++]=u,d[f++]=e.BYTES_PER_ELEMENT;for(const y of n)d[f++]=y.length-2,d[f++]=y[0],d[f++]=y[1];const p=new CompressionStream("deflate-raw"),g=p.writable.getWriter();await g.ready,g.write(d);const m=e.prototype.constructor;for(const y of n){const t=new m(y.length-2);for(let e=2,n=y.length;e<n;e++)t[e-2]=y[e]-y[e-2];g.write(t)}g.close();const v=await new Response(p.readable).arrayBuffer();return hi(new Uint8Array(v))}static async decompressSignature(t){try{const l=(a=t,Uint8Array.fromBase64?Uint8Array.fromBase64(a):ti(atob(a))),{readable:c,writable:u}=new DecompressionStream("deflate-raw"),h=u.getWriter();await h.ready,h.write(l).then((async()=>{await h.ready,await h.close()})).catch((()=>{}));let d=null,f=0;var e,n=!1,i=!1;try{for(var s,r=$t(c);n=!(s=await r.next()).done;n=!1){const t=s.value;d||(d=new Uint8Array(new Uint32Array(t.buffer,0,4)[0])),d.set(t,f),f+=t.length}}catch(o){i=!0,e=o}finally{try{n&&null!=r.return&&await r.return()}finally{if(i)throw e}}const p=new Uint32Array(d.buffer,0,d.length>>2),g=p[1];if(0!==g)throw new Error("Invalid version: ".concat(g));const m=p[2],v=p[3],y=0===p[4],w=p[5],b=p[6],_=p[7],E=[],A=(8+3*b)*Uint32Array.BYTES_PER_ELEMENT;let S;switch(_){case Int8Array.BYTES_PER_ELEMENT:S=new Int8Array(d.buffer,A);break;case Int16Array.BYTES_PER_ELEMENT:S=new Int16Array(d.buffer,A);break;case Int32Array.BYTES_PER_ELEMENT:S=new Int32Array(d.buffer,A)}f=0;for(let t=0;t<b;t++){const e=p[3*t+8],n=new Float32Array(e+2);E.push(n);for(let i=0;i<2;i++)n[i]=p[3*t+8+i+1];for(let t=0;t<e;t++)n[t+2]=n[t]+S[f++]}return{areContours:y,thickness:w,outlines:E,width:m,height:v}}catch(l){return Vn("decompressSignature: ".concat(l)),null}var a}}function Sm(t,e,n,i){return i-=e,0===(n-=t)?i>0?0:4:1===n?i+6:2-i}function km(t,e,n,i,s,r,a){const o=Fe(tn,this,Sm).call(this,n,i,s,r);for(let l=0;l<8;l++){const s=(-l+o-a+16)%8;if(0!==t[(n+Fe(tn,this,Om)._[2*s])*e+(i+Fe(tn,this,Om)._[2*s+1])])return s}return-1}function Cm(t,e,n,i,s,r,a){const o=Fe(tn,this,Sm).call(this,n,i,s,r);for(let l=0;l<8;l++){const s=(l+o+a+16)%8;if(0!==t[(n+Fe(tn,this,Om)._[2*s])*e+(i+Fe(tn,this,Om)._[2*s+1])])return s}return-1}function Tm(t,e,n,i){const s=t.length,r=new Int32Array(s);for(let c=0;c<s;c++)r[c]=t[c]<=i?1:0;for(let c=1;c<n-1;c++)r[c*e]=r[c*e+e-1]=0;for(let c=0;c<e;c++)r[c]=r[e*n-1-c]=0;let a,o=1;const l=[];for(let c=1;c<n-1;c++){a=1;for(let t=1;t<e-1;t++){const n=c*e+t,i=r[n];if(0===i)continue;let s=c,u=t;if(1===i&&0===r[n-1])o+=1,u-=1;else{if(!(i>=1&&0===r[n+1])){1!==i&&(a=Math.abs(i));continue}o+=1,u+=1,i>1&&(a=i)}const h=[t,c],d=u===t+1,f={isHole:d,points:h,id:o,parent:0};let p;l.push(f);for(const t of l)if(t.id===a){p=t;break}p?p.isHole?f.parent=d?p.parent:a:f.parent=d?a:p.parent:f.parent=d?a:0;const g=Fe(tn,this,km).call(this,r,e,c,t,s,u,0);if(-1===g){r[n]=-o,1!==r[n]&&(a=Math.abs(r[n]));continue}let m=Fe(tn,this,Om)._[2*g],v=Fe(tn,this,Om)._[2*g+1];const y=c+m,w=t+v;s=y,u=w;let b=c,_=t;for(;;){const i=Fe(tn,this,Cm).call(this,r,e,b,_,s,u,1);m=Fe(tn,this,Om)._[2*i],v=Fe(tn,this,Om)._[2*i+1];const l=b+m,d=_+v;h.push(d,l);const f=b*e+_;if(0===r[f+1]?r[f]=-o:1===r[f]&&(r[f]=o),l===c&&d===t&&b===y&&_===w){1!==r[n]&&(a=Math.abs(r[n]));break}s=b,u=_,b=l,_=d}}}return l}function xm(t,e,n,i){if(n-e<=4){for(let s=e;s<n-2;s+=2)i.push(t[s],t[s+1]);return}const s=t[e],r=t[e+1],a=t[n-4]-s,o=t[n-3]-r,l=Math.hypot(a,o),c=a/l,u=o/l,h=c*r-u*s,d=o/a,f=1/l,p=Math.atan(d),g=Math.cos(p),m=Math.sin(p),v=f*(Math.abs(g)+Math.abs(m)),y=f*(1-v+v**2),w=Math.max(Math.atan(Math.abs(m+g)*y),Math.atan(Math.abs(m-g)*y));let b=0,_=e;for(let E=e+2;E<n-2;E+=2){const e=Math.abs(h-c*t[E+1]+u*t[E]);e>b&&(_=E,b=e)}b>(l*w)**2?(Fe(tn,this,xm).call(this,t,e,_+2,i),Fe(tn,this,xm).call(this,t,_,n,i)):i.push(s,r)}function Im(t){const e=[],n=t.length;return Fe(tn,this,xm).call(this,t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e}function Rm(t,e,n,i,s,r){const a=new Float32Array(r**2),o=-2*i**2,l=r>>1;for(let p=0;p<r;p++){const t=(p-l)**2;for(let e=0;e<r;e++)a[p*r+e]=Math.exp((t+(e-l)**2)/o)}const c=new Float32Array(256),u=-2*s**2;for(let p=0;p<256;p++)c[p]=Math.exp(p**2/u);const h=t.length,d=new Uint8Array(h),f=new Uint32Array(256);for(let p=0;p<n;p++)for(let i=0;i<e;i++){const s=p*e+i,o=t[s];let u=0,h=0;for(let d=0;d<r;d++){const s=p+d-l;if(!(s<0||s>=n))for(let n=0;n<r;n++){const f=i+n-l;if(f<0||f>=e)continue;const p=t[s*e+f],g=a[d*r+n]*c[Math.abs(p-o)];u+=p*g,h+=g}}f[d[s]=Math.round(u/h)]++}return[d,f]}function Mm(t){const e=new Uint32Array(256);for(const n of t)e[n]++;return e}function Pm(t){const e=t.length,n=new Uint8ClampedArray(e>>2);let i=-1/0,s=1/0;for(let a=0,o=n.length;a<o;a++){if(0===t[3+(a<<2)]){i=n[a]=255;continue}const e=n[a]=t[a<<2];e>i&&(i=e),e<s&&(s=e)}const r=255/(i-s);for(let a=0;a<e;a++)n[a]=(n[a]-s)*r;return n}function Nm(t){let e,n=-1/0,i=-1/0;const s=t.findIndex((t=>0!==t));let r=s,a=s;for(e=s;e<256;e++){const s=t[e];s>n&&(e-r>i&&(i=e-r,a=e-1),n=s,r=e)}for(e=a-1;e>=0&&!(t[e]>t[e+1]);e--);return e}function Dm(t){const e=t,{width:n,height:i}=t,{maxDim:s}=Fe(tn,this,Lm)._;let r=n,a=i;if(n>s||i>s){let o=n,l=i,c=Math.log2(Math.max(n,i)/s);const u=Math.floor(c);c=c===u?u-1:u;for(let n=0;n<c;n++){r=Math.ceil(o/2),a=Math.ceil(l/2);const n=new OffscreenCanvas(r,a);n.getContext("2d").drawImage(t,0,0,o,l,0,0,r,a),o=r,l=a,t!==e&&t.close(),t=n.transferToImageBitmap()}const h=Math.min(s/r,s/a);r=Math.round(r*h),a=Math.round(a*h)}const o=new OffscreenCanvas(r,a).getContext("2d",{willReadFrequently:!0});o.filter="grayscale(1)",o.drawImage(t,0,0,t.width,t.height,0,0,r,a);const l=o.getImageData(0,0,r,a).data;return[Fe(tn,this,Pm).call(this,l),r,a]}tn=Am;var Lm={_:{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}},Om={_:new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1])};class Fm extends Ag{constructor(){super(),super.updateProperties({fill:Oa._defaultLineColor,"stroke-width":0})}clone(){const t=new Fm;return t.updateAll(this),t}}class Um extends ym{constructor(t){super(t),super.updateProperties({stroke:Oa._defaultLineColor,"stroke-width":1})}clone(){const t=new Um(this._viewParameters);return t.updateAll(this),t}}var Bm=new WeakMap,Vm=new WeakMap,jm=new WeakMap,Wm=new WeakMap;class zm extends Tg{constructor(t){super(l(l({},t),{},{mustBeCommitted:!0,name:"signatureEditor"})),Oe(this,Bm,!1),Oe(this,Vm,null),Oe(this,jm,null),Oe(this,Wm,null),this._willKeepAspectRatio=!0,Ve(jm,this,t.signatureData||null),Ve(Vm,this,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Oa.initialize(t,e),this._defaultDrawingOptions=new Fm,this._defaultDrawnSignatureOptions=new Um(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return qn(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!Be(Vm,this)}}static computeTelemetryFinalData(t){var e,n;const i=t.get("hasDescription");return{hasAltText:null!==(e=i.get(!0))&&void 0!==e?e:0,hasNoAltText:null!==(n=i.get(!1))&&void 0!==n?n:0}}get isResizable(){return!0}onScaleChanging(){null!==this._drawId&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),null===this._drawId)if(Be(jm,this)){const{lines:t,mustSmooth:e,areContours:n,description:i,uuid:s,heightInPage:r}=Be(jm,this),{rawDims:{pageWidth:a,pageHeight:o},rotation:l}=this.parent.viewport,c=Am.processDrawnLines({lines:t,pageWidth:a,pageHeight:o,rotation:l,innerMargin:zm._INNER_MARGIN,mustSmooth:e,areContours:n});this.addSignature(c,r,i,s)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return n&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){Ve(Wm,this,t),this.addEditToolbar()}getUuid(){return Be(Wm,this)}get description(){return Be(Vm,this)}set description(t){Ve(Vm,this,t),super.addEditToolbar().then((e=>{null===e||void 0===e||e.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:n,width:i,height:s}=Be(jm,this),r=Math.max(i,s);return{areContours:e,outline:Am.processDrawnLines({lines:{curves:t.map((t=>({points:t}))),thickness:n,width:i,height:s},pageWidth:r,pageHeight:r,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e}).outline}}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.signatureManager&&null!==Be(Vm,this)&&(await t.addEditSignatureButton(this._uiManager.signatureManager,Be(Wm,this),Be(Vm,this)),t.show()),t):null}addSignature(t,e,n,i){const{x:s,y:r}=this,{outline:a}=Ve(jm,this,t);let o;Ve(Bm,this,a instanceof Em),Ve(Vm,this,n),this.div.setAttribute("data-l10n-args",JSON.stringify({description:n})),Be(Bm,this)?o=zm.getDefaultDrawingOptions():(o=zm._defaultDrawnSignatureOptions.clone(),o.updateProperties({"stroke-width":a.thickness})),this._addOutlines({drawOutlines:a,drawingOptions:o});const[l,c]=this.parentDimensions,[,u]=this.pageDimensions;let h=e/u;h=h>=1?.5:h,this.width*=h/this.height,this.width>=1&&(h*=.9/this.width,this.width=.9),this.height=h,this.setDims(l*this.width,c*this.height),this.x=s,this.y=r,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:i}=this.parent.viewport;return Am.process(t,e,n,i,zm._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:n,pageHeight:i},rotation:s}=this.parent.viewport;return Am.extractContoursFromText(t,e,n,i,s,zm._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:i}=this.parent.viewport;return Am.processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:i,innerMargin:zm._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions(t){let{areContours:e,thickness:n}=t;e?this._drawingOptions=zm.getDefaultDrawingOptions():(this._drawingOptions=zm._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;const{lines:e,points:n,rect:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,r={annotationType:gn.SIGNATURE,isSignature:!0,areContours:Be(Bm,this),color:[0,0,0],thickness:Be(Bm,this)?0:s,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(r.paths={lines:e,points:n},r.uuid=Be(Wm,this),r.isCopy=!0):r.lines=e,Be(Vm,this)&&(r.accessibilityData={type:"Figure",alt:Be(Vm,this)}),r}static deserializeDraw(t,e,n,i,s,r){return r.areContours?Em.deserialize(t,e,n,i,s,r):fm.deserialize(t,e,n,i,s,r)}static async deserialize(t,e,n){var i;const s=await super.deserialize(t,e,n);return Ve(Bm,s,t.areContours),Ve(Vm,s,(null===(i=t.accessibilityData)||void 0===i?void 0:i.alt)||""),Ve(Wm,s,t.uuid),s}}a(zm,"_type","signature"),a(zm,"_editorType",gn.SIGNATURE),a(zm,"_defaultDrawingOptions",null);var Hm=new WeakMap,qm=new WeakMap,Gm=new WeakMap,Km=new WeakMap,Xm=new WeakMap,Qm=new WeakMap,Ym=new WeakMap,Jm=new WeakMap,$m=new WeakMap,Zm=new WeakMap,tv=new WeakMap,ev=new WeakSet;class nv extends Oa{constructor(t){super(l(l({},t),{},{name:"stampEditor"})),Le(this,ev),Oe(this,Hm,null),Oe(this,qm,null),Oe(this,Gm,null),Oe(this,Km,null),Oe(this,Xm,null),Oe(this,Qm,""),Oe(this,Ym,null),Oe(this,Jm,!1),Oe(this,$m,null),Oe(this,Zm,!1),Oe(this,tv,!1),Ve(Km,this,t.bitmapUrl),Ve(Xm,this,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Oa.initialize(t,e)}static isHandlingMimeForPasting(t){return Ri.includes(t)}static paste(t,e){e.pasteEditor({mode:gn.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!(null===(t=this.altTextData)||void 0===t||!t.altText)}}static computeTelemetryFinalData(t){var e,n;const i=t.get("hasAltText");return{hasAltText:null!==(e=i.get(!0))&&void 0!==e?e:0,hasNoAltText:null!==(n=i.get(!1))&&void 0!==n?n:0}}async mlGuessAltText(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:s,height:r}=t||this.copyCanvas(null,null,!0).imageData,a=await n.guess({name:"altText",request:{data:i,width:s,height:r,channels:i.length/(s*r)}});if(!a)throw new Error("No response from the AI service.");if(a.error)throw new Error("Error from the AI service.");if(a.cancel)return null;if(!a.output)throw new Error("No valid response from the AI service.");const o=a.output;return await this.setGuessedAltText(o),e&&!this.hasAltTextData()&&(this.altTextData={alt:o,decorative:!1}),o}remove(){var t;Be(qm,this)&&(Ve(Hm,this,null),this._uiManager.imageManager.deleteId(Be(qm,this)),null===(t=Be(Ym,this))||void 0===t||t.remove(),Ve(Ym,this,null),Be($m,this)&&(clearTimeout(Be($m,this)),Ve($m,this,null)));super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(Be(qm,this)&&null===Be(Ym,this)&&Fe(ev,this,rv).call(this),this.isAttachedToDOM||this.parent.add(this))):Be(qm,this)&&Fe(ev,this,rv).call(this)}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(Be(Gm,this)||Be(Hm,this)||Be(Km,this)||Be(Xm,this)||Be(qm,this)||Be(Jm,this))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),Be(Jm,this)||(Be(Hm,this)?Fe(ev,this,av).call(this):Fe(ev,this,rv).call(this)),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:n,bitmap:i}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(Ve(qm,this,n),i&&Ve(Hm,this,i),Ve(Jm,this,!1),Fe(ev,this,av).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;null!==Be($m,this)&&clearTimeout(Be($m,this));Ve($m,this,setTimeout((()=>{Ve($m,this,null),Fe(ev,this,lv).call(this)}),200))}copyCanvas(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t||(t=224);const{width:i,height:s}=Be(Hm,this),r=new Ii;let a=Be(Hm,this),o=i,l=s,c=null;if(e){var u,h;if(i>e||s>e){const t=Math.min(e/i,e/s);o=Math.floor(i*t),l=Math.floor(s*t)}c=document.createElement("canvas");const t=c.width=Math.ceil(o*r.sx),n=c.height=Math.ceil(l*r.sy);Be(Zm,this)||(a=Fe(ev,this,ov).call(this,t,n));const d=c.getContext("2d");d.filter=this._uiManager.hcmFilter;let f="white",p="#cfcfd8";"none"!==this._uiManager.hcmFilter?p="black":null!==(u=(h=window).matchMedia)&&void 0!==u&&u.call(h,"(prefers-color-scheme: dark)").matches&&(f="#8f8f9d",p="#42414d");const g=15,m=g*r.sx,v=g*r.sy,y=new OffscreenCanvas(2*m,2*v),w=y.getContext("2d");w.fillStyle=f,w.fillRect(0,0,2*m,2*v),w.fillStyle=p,w.fillRect(0,0,m,v),w.fillRect(m,v,m,v),d.fillStyle=d.createPattern(y,"repeat"),d.fillRect(0,0,t,n),d.drawImage(a,0,0,a.width,a.height,0,0,t,n)}let d=null;if(n){let e,n;if(r.symmetric&&a.width<t&&a.height<t)e=a.width,n=a.height;else if(a=Be(Hm,this),i>t||s>t){const r=Math.min(t/i,t/s);e=Math.floor(i*r),n=Math.floor(s*r),Be(Zm,this)||(a=Fe(ev,this,ov).call(this,e,n))}const o=new OffscreenCanvas(e,n).getContext("2d",{willReadFrequently:!0});o.drawImage(a,0,0,a.width,a.height,0,0,e,n),d={width:e,height:n,data:o.getImageData(0,0,e,n).data}}return{canvas:c,width:o,height:l,imageData:d}}static async deserialize(t,e,n){let i=null,s=!1;if(t instanceof Gd){var r;const{data:{rect:a,rotation:o,id:l,structParent:c,popupRef:u},container:h,parent:{page:{pageNumber:d}},canvas:f}=t;let p,g;f?(delete t.canvas,({id:p,bitmap:g}=n.imageManager.getFromCanvas(h.id,f)),f.remove()):(s=!0,t._hasNoCanvas=!0);const m=(null===(r=await e._structTree.getAriaAttributes("".concat(ci).concat(l)))||void 0===r?void 0:r.get("aria-label"))||"";i=t={annotationType:gn.STAMP,bitmapId:p,bitmap:g,pageIndex:d-1,rect:a.slice(0),rotation:o,id:l,deleted:!1,accessibilityData:{decorative:!1,altText:m},isSvg:!1,structParent:c,popupRef:u}}const a=await super.deserialize(t,e,n),{rect:o,bitmap:l,bitmapUrl:c,bitmapId:u,isSvg:h,accessibilityData:d}=t;s?(n.addMissingCanvas(t.id,a),Ve(Jm,a,!0)):u&&n.imageManager.isValidId(u)?(Ve(qm,a,u),l&&Ve(Hm,a,l)):Ve(Km,a,c),Ve(Zm,a,h);const[f,p]=a.pageDimensions;return a.width=(o[2]-o[0])/f,a.height=(o[3]-o[1])/p,a.annotationElementId=t.id||null,d&&(a.altTextData=d),a._initialData=i,Ve(tv,a,!!i),a}serialize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:gn.STAMP,bitmapId:Be(qm,this),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:Be(Zm,this),structTreeParentId:this._structTreeParentId};if(t)return n.bitmapUrl=Fe(ev,this,cv).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:i,altText:s}=this.serializeAltText(!1);if(!i&&s&&(n.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const t=Fe(ev,this,uv).call(this,n);if(t.isSame)return null;var r;if(t.isSameAltText)delete n.accessibilityData;else n.accessibilityData.structParent=null!==(r=this._initialData.structParent)&&void 0!==r?r:-1}if(n.id=this.annotationElementId,null===e)return n;e.stamps||(e.stamps=new Map);const a=Be(Zm,this)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(e.stamps.has(Be(qm,this))){if(Be(Zm,this)){const t=e.stamps.get(Be(qm,this));a>t.area&&(t.area=a,t.serialized.bitmap.close(),t.serialized.bitmap=Fe(ev,this,cv).call(this,!1))}}else e.stamps.set(Be(qm,this),{area:a,serialized:n}),n.bitmap=Fe(ev,this,cv).call(this,!1);return n}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}function iv(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?(Ve(Hm,this,t.bitmap),e||(Ve(qm,this,t.id),Ve(Zm,this,t.isSvg)),t.file&&Ve(Qm,this,t.file.name),Fe(ev,this,av).call(this)):this.remove()}function sv(){if(Ve(Gm,this,null),this._uiManager.enableWaiting(!1),Be(Ym,this)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&Be(Hm,this))return this._editToolbar.hide(),void this._uiManager.editAltText(this,!0);if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&Be(Hm,this)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch(t){}}this.div.focus()}}function rv(){if(Be(qm,this))return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(Be(qm,this)).then((t=>Fe(ev,this,iv).call(this,t,!0))).finally((()=>Fe(ev,this,sv).call(this)));if(Be(Km,this)){const t=Be(Km,this);return Ve(Km,this,null),this._uiManager.enableWaiting(!0),void Ve(Gm,this,this._uiManager.imageManager.getFromUrl(t).then((t=>Fe(ev,this,iv).call(this,t))).finally((()=>Fe(ev,this,sv).call(this))))}if(Be(Xm,this)){const t=Be(Xm,this);return Ve(Xm,this,null),this._uiManager.enableWaiting(!0),void Ve(Gm,this,this._uiManager.imageManager.getFromFile(t).then((t=>Fe(ev,this,iv).call(this,t))).finally((()=>Fe(ev,this,sv).call(this))))}const t=document.createElement("input");t.type="file",t.accept=Ri.join(",");const e=this._uiManager._signal;Ve(Gm,this,new Promise((n=>{t.addEventListener("change",(async()=>{if(t.files&&0!==t.files.length){this._uiManager.enableWaiting(!0);const e=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),Fe(ev,this,iv).call(this,e)}else this.remove();n()}),{signal:e}),t.addEventListener("cancel",(()=>{this.remove(),n()}),{signal:e})})).finally((()=>Fe(ev,this,sv).call(this)))),t.click()}function av(){var t;const{div:e}=this;let{width:n,height:i}=Be(Hm,this);const[s,r]=this.pageDimensions,a=.75;if(this.width)n=this.width*s,i=this.height*r;else if(n>a*s||i>a*r){const t=Math.min(a*s/n,a*r/i);n*=t,i*=t}const[o,l]=this.parentDimensions;this.setDims(n*o/s,i*l/r),this._uiManager.enableWaiting(!1);const c=Ve(Ym,this,document.createElement("canvas"));c.setAttribute("role","img"),this.addContainer(c),this.width=n/s,this.height=i/r,null!==(t=this._initialOptions)&&void 0!==t&&t.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(e.hidden=!1),Fe(ev,this,lv).call(this),Be(tv,this)||(this.parent.addUndoableEditor(this),Ve(tv,this,!0)),this._reportTelemetry({action:"inserted_image"}),Be(Qm,this)&&this.div.setAttribute("aria-description",Be(Qm,this))}function ov(t,e){const{width:n,height:i}=Be(Hm,this);let s=n,r=i,a=Be(Hm,this);for(;s>2*t||r>2*e;){const n=s,i=r;s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),r>2*e&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2));const o=new OffscreenCanvas(s,r);o.getContext("2d").drawImage(a,0,0,n,i,0,0,s,r),a=o.transferToImageBitmap()}return a}function lv(){const[t,e]=this.parentDimensions,{width:n,height:i}=this,s=new Ii,r=Math.ceil(n*t*s.sx),a=Math.ceil(i*e*s.sy),o=Be(Ym,this);if(!o||o.width===r&&o.height===a)return;o.width=r,o.height=a;const l=Be(Zm,this)?Be(Hm,this):Fe(ev,this,ov).call(this,r,a),c=o.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(l,0,0,l.width,l.height,0,0,r,a)}function cv(t){if(t){if(Be(Zm,this)){const t=this._uiManager.imageManager.getSvgUrl(Be(qm,this));if(t)return t}const t=document.createElement("canvas");({width:t.width,height:t.height}=Be(Hm,this));return t.getContext("2d").drawImage(Be(Hm,this),0,0),t.toDataURL()}if(Be(Zm,this)){const[t,e]=this.pageDimensions,n=Math.round(this.width*t*fi.PDF_TO_CSS_UNITS),i=Math.round(this.height*e*fi.PDF_TO_CSS_UNITS),s=new OffscreenCanvas(n,i);return s.getContext("2d").drawImage(Be(Hm,this),0,0,Be(Hm,this).width,Be(Hm,this).height,0,0,n,i),s.transferToImageBitmap()}return structuredClone(Be(Hm,this))}function uv(t){var e;const{pageIndex:n,accessibilityData:{altText:i}}=this._initialData,s=t.pageIndex===n,r=((null===(e=t.accessibilityData)||void 0===e?void 0:e.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&s&&r,isSameAltText:r}}a(nv,"_type","stamp"),a(nv,"_editorType",gn.STAMP);var hv=new WeakMap,dv=new WeakMap,fv=new WeakMap,pv=new WeakMap,gv=new WeakMap,mv=new WeakMap,vv=new WeakMap,yv=new WeakMap,wv=new WeakMap,bv=new WeakMap,_v=new WeakMap,Ev=new WeakMap,Av=new WeakMap,Sv=new WeakMap,kv=new WeakSet;class Cv{constructor(t){let{uiManager:e,pageIndex:n,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:u}=t;Le(this,kv),Oe(this,hv,void 0),Oe(this,dv,!1),Oe(this,fv,null),Oe(this,pv,null),Oe(this,gv,null),Oe(this,mv,new Map),Oe(this,vv,!1),Oe(this,yv,!1),Oe(this,wv,!1),Oe(this,bv,null),Oe(this,_v,null),Oe(this,Ev,null),Oe(this,Av,null),Oe(this,Sv,void 0);const h=[...Pv._.values()];if(!Cv._initialized){Cv._initialized=!0;for(const t of h)t.initialize(u,e)}e.registerEditorTypes(h),Ve(Sv,this,e),this.pageIndex=n,this.div=i,Ve(hv,this,r),Ve(fv,this,a),this.viewport=c,Ve(Ev,this,l),this.drawLayer=o,this._structTree=s,Be(Sv,this).addLayer(this)}get isEmpty(){return 0===Be(mv,this).size}get isInvisible(){return this.isEmpty&&Be(Sv,this).getMode()===gn.NONE}updateToolbar(t){Be(Sv,this).updateToolbar(t)}updateMode(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be(Sv,this).getMode();switch(Fe(kv,this,Mv).call(this),t){case gn.NONE:return this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case gn.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case gn.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of Pv._.values())e.toggle("".concat(n._type,"Editing"),t===n._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===(null===(e=Be(Ev,this))||void 0===e?void 0:e.div)}setEditingState(t){Be(Sv,this).setEditingState(t)}addCommands(t){Be(Sv,this).addCommands(t)}cleanUndoStack(t){Be(Sv,this).cleanUndoStack(t)}toggleDrawing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("drawing",!t)}togglePointerEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(t=Be(fv,this))||void 0===t||t.div.classList.toggle("disabled",!e)}async enable(){Ve(wv,this,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const n of Be(mv,this).values())n.enableEditing(),n.show(!0),n.annotationElementId&&(Be(Sv,this).removeChangedExistingAnnotation(n),t.add(n.annotationElementId));if(!Be(fv,this))return void Ve(wv,this,!1);const e=Be(fv,this).getEditableAnnotations();for(const n of e){if(n.hide(),Be(Sv,this).isDeletedAnnotationElement(n.data.id))continue;if(t.has(n.data.id))continue;const e=await this.deserialize(n);e&&(this.addOrRebuild(e),e.enableEditing())}Ve(wv,this,!1)}disable(){Ve(yv,this,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const s of Be(mv,this).values()){var n;s.disableEditing(),s.annotationElementId&&(null===s.serialize()?(e.set(s.annotationElementId,s),null===(n=this.getEditableAnnotation(s.annotationElementId))||void 0===n||n.show(),s.remove()):t.set(s.annotationElementId,s))}if(Be(fv,this)){const n=Be(fv,this).getEditableAnnotations();for(const i of n){const{id:n}=i.data;if(Be(Sv,this).isDeletedAnnotationElement(n))continue;let s=e.get(n);s?(s.resetAnnotationElement(i),s.show(!1),i.show()):(s=t.get(n),s&&(Be(Sv,this).addChangedExistingAnnotation(s),s.renderAnnotationElement(i)&&s.show(!1)),i.show())}}Fe(kv,this,Mv).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of Pv._.values())i.remove("".concat(s._type,"Editing"));this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),Ve(yv,this,!1)}getEditableAnnotation(t){var e;return(null===(e=Be(fv,this))||void 0===e?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){Be(Sv,this).getActive()!==t&&Be(Sv,this).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,null!==(t=Be(Ev,this))&&void 0!==t&&t.div&&!Be(Av,this)){Ve(Av,this,new AbortController);const t=Be(Sv,this).combinedSignal(Be(Av,this));Be(Ev,this).div.addEventListener("pointerdown",Fe(kv,this,Tv).bind(this),{signal:t}),Be(Ev,this).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,null!==(t=Be(Ev,this))&&void 0!==t&&t.div&&Be(Av,this)&&(Be(Av,this).abort(),Ve(Av,this,null),Be(Ev,this).div.classList.remove("highlighting"))}enableClick(){if(Be(pv,this))return;Ve(pv,this,new AbortController);const t=Be(Sv,this).combinedSignal(Be(pv,this));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;null===(t=Be(pv,this))||void 0===t||t.abort(),Ve(pv,this,null)}attach(t){Be(mv,this).set(t.id,t);const{annotationElementId:e}=t;e&&Be(Sv,this).isDeletedAnnotationElement(e)&&Be(Sv,this).removeDeletedAnnotationElement(t)}detach(t){var e;Be(mv,this).delete(t.id),null===(e=Be(hv,this))||void 0===e||e.removePointerInTextLayer(t.contentDiv),!Be(yv,this)&&t.annotationElementId&&Be(Sv,this).addDeletedAnnotationElement(t)}remove(t){this.detach(t),Be(Sv,this).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(Be(Sv,this).addDeletedAnnotationElement(t.annotationElementId),Oa.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),null===(e=t.parent)||void 0===e||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(t.parent!==this||!t.isAttachedToDOM){if(this.changeParent(t),Be(Sv,this).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!Be(wv,this)),Be(Sv,this).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var e;if(!t.isAttachedToDOM)return;const{activeElement:n}=document;t.div.contains(n)&&!Be(gv,this)&&(t._focusEventsAllowed=!1,Ve(gv,this,setTimeout((()=>{Ve(gv,this,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",(()=>{t._focusEventsAllowed=!0}),{once:!0,signal:Be(Sv,this)._signal}),n.focus())}),0))),t._structTreeParentId=null===(e=Be(hv,this))||void 0===e?void 0:e.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){this.addCommands({cmd:()=>t._uiManager.rebuild(t),undo:()=>{t.remove()},mustExec:!1})}getNextId(){return Be(Sv,this).getId()}combinedSignal(t){return Be(Sv,this).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return null===(t=Ue(kv,this,xv))||void 0===t?void 0:t.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await Be(Sv,this).updateMode(t.mode);const{offsetX:n,offsetY:i}=Fe(kv,this,Rv).call(this),s=this.getNextId(),r=Fe(kv,this,Iv).call(this,l({parent:this,id:s,x:n,y:i,uiManager:Be(Sv,this),isCentered:!0},e));r&&this.add(r)}async deserialize(t){var e,n;return await(null===(e=Pv._.get(null!==(n=t.annotationType)&&void 0!==n?n:t.annotationEditorType))||void 0===e?void 0:e.deserialize(t,this,Be(Sv,this)))||null}createAndAddNewEditor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.getNextId(),s=Fe(kv,this,Iv).call(this,l({parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:Be(Sv,this),isCentered:e},n));return s&&this.add(s),s}addNewEditor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.createAndAddNewEditor(Fe(kv,this,Rv).call(this),!0,t)}setSelected(t){Be(Sv,this).setSelected(t)}toggleSelected(t){Be(Sv,this).toggleSelected(t)}unselect(t){Be(Sv,this).unselect(t)}pointerup(t){var e;const{isMac:n}=ei.platform;if(0!==t.button||t.ctrlKey&&n)return;if(t.target!==this.div)return;if(!Be(vv,this))return;if(Ve(vv,this,!1),null!==(e=Ue(kv,this,xv))&&void 0!==e&&e.isDrawer&&Ue(kv,this,xv).supportMultipleDrawings)return;if(!Be(dv,this))return void Ve(dv,this,!0);const i=Be(Sv,this).getMode();i!==gn.STAMP&&i!==gn.SIGNATURE?this.createAndAddNewEditor(t,!1):Be(Sv,this).unselectAll()}pointerdown(t){var e;if(Be(Sv,this).getMode()===gn.HIGHLIGHT&&this.enableTextSelection(),Be(vv,this))return void Ve(vv,this,!1);const{isMac:n}=ei.platform;if(0!==t.button||t.ctrlKey&&n)return;if(t.target!==this.div)return;if(Ve(vv,this,!0),null!==(e=Ue(kv,this,xv))&&void 0!==e&&e.isDrawer)return void this.startDrawingSession(t);const i=Be(Sv,this).getActive();Ve(dv,this,!i||i.isEmpty())}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),Be(bv,this))return void Ue(kv,this,xv).startDrawing(this,Be(Sv,this),!1,t);Be(Sv,this).setCurrentDrawingSession(this),Ve(bv,this,new AbortController);const e=Be(Sv,this).combinedSignal(Be(bv,this));this.div.addEventListener("blur",(t=>{let{relatedTarget:e}=t;e&&!this.div.contains(e)&&(Ve(_v,this,null),this.commitOrRemove())}),{signal:e}),Ue(kv,this,xv).startDrawing(this,Be(Sv,this),!1,t)}pause(t){if(t){const{activeElement:t}=document;this.div.contains(t)&&Ve(_v,this,t)}else Be(_v,this)&&setTimeout((()=>{var t;null===(t=Be(_v,this))||void 0===t||t.focus(),Ve(_v,this,null)}),0)}endDrawingSession(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Be(bv,this)?(Be(Sv,this).setCurrentDrawingSession(null),Be(bv,this).abort(),Ve(bv,this,null),Ve(_v,this,null),Ue(kv,this,xv).endDrawing(t)):null}findNewParent(t,e,n){const i=Be(Sv,this).findParent(e,n);return null!==i&&i!==this&&(i.changeParent(t),!0)}commitOrRemove(){return!!Be(bv,this)&&(this.endDrawingSession(),!0)}onScaleChanging(){Be(bv,this)&&Ue(kv,this,xv).onScaleChangingWhenDrawing(this)}destroy(){var t;this.commitOrRemove(),(null===(t=Be(Sv,this).getActive())||void 0===t?void 0:t.parent)===this&&(Be(Sv,this).commitOrRemove(),Be(Sv,this).setActiveEditor(null)),Be(gv,this)&&(clearTimeout(Be(gv,this)),Ve(gv,this,null));for(const n of Be(mv,this).values()){var e;null===(e=Be(hv,this))||void 0===e||e.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove()}this.div=null,Be(mv,this).clear(),Be(Sv,this).removeLayer(this)}render(t){let{viewport:e}=t;this.viewport=e,xi(this.div,e);for(const n of Be(Sv,this).getEditors(this.pageIndex))this.add(n),n.rebuild();this.updateMode()}update(t){let{viewport:e}=t;Be(Sv,this).commitOrRemove(),Fe(kv,this,Mv).call(this);const n=this.viewport.rotation,i=e.rotation;if(this.viewport=e,xi(this.div,{rotation:i}),n!==i)for(const s of Be(mv,this).values())s.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return Be(Sv,this).viewParameters.realScale}}function Tv(t){Be(Sv,this).unselectAll();const{target:e}=t;if(e===Be(Ev,this).div||("img"===e.getAttribute("role")||e.classList.contains("endOfContent"))&&Be(Ev,this).div.contains(e)){const{isMac:e}=ei.platform;if(0!==t.button||t.ctrlKey&&e)return;Be(Sv,this).showAllEditors("highlight",!0,!0),Be(Ev,this).div.classList.add("free"),this.toggleDrawing(),rg.startHighlighting(this,"ltr"===Be(Sv,this).direction,{target:Be(Ev,this).div,x:t.x,y:t.y}),Be(Ev,this).div.addEventListener("pointerup",(()=>{Be(Ev,this).div.classList.remove("free"),this.toggleDrawing(!0)}),{once:!0,signal:Be(Sv,this)._signal}),t.preventDefault()}}function xv(t){return Pv._.get(Be(Sv,t).getMode())}function Iv(t){const e=Ue(kv,this,xv);return e?new e.prototype.constructor(t):null}function Rv(){const{x:t,y:e,width:n,height:i}=this.div.getBoundingClientRect(),s=Math.max(0,t),r=Math.max(0,e),a=(s+Math.min(window.innerWidth,t+n))/2-t,o=(r+Math.min(window.innerHeight,e+i))/2-e,[l,c]=this.viewport.rotation%180===0?[a,o]:[o,a];return{offsetX:l,offsetY:c}}function Mv(){for(const t of Be(mv,this).values())t.isEmpty()&&t.remove()}a(Cv,"_initialized",!1);var Pv={_:new Map([ff,bm,nv,rg,zm].map((t=>[t._editorType,t])))},Nv=new WeakMap,Dv=new WeakMap,Lv=new WeakMap,Ov=new WeakSet;class Fv{constructor(t){let{pageIndex:e}=t;Le(this,Ov),Oe(this,Nv,null),Oe(this,Dv,new Map),Oe(this,Lv,new Map),this.pageIndex=e}setParent(t){if(Be(Nv,this)){if(Be(Nv,this)!==t){if(Be(Dv,this).size>0)for(const e of Be(Dv,this).values())e.remove(),t.append(e);Ve(Nv,this,t)}}else Ve(Nv,this,t)}static get _svgFactory(){return qn(this,"_svgFactory",new kh)}draw(t){var e,n;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=(Wv._=(e=Wv._,n=e++,e),n),a=Fe(Ov,this,Bv).call(this),o=Fv._svgFactory.createElement("defs");a.append(o);const l=Fv._svgFactory.createElement("path");o.append(l);const c="path_p".concat(this.pageIndex,"_").concat(r);l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),i&&Be(Lv,this).set(r,l);const u=s?Fe(Ov,this,Vv).call(this,o,c):null,h=Fv._svgFactory.createElement("use");return a.append(h),h.setAttribute("href","#".concat(c)),this.updateProperties(a,t),Be(Dv,this).set(r,a),{id:r,clipPathId:"url(#".concat(u,")")}}drawOutline(t,e){var n,i;const s=(Wv._=(n=Wv._,i=n++,n),i),r=Fe(Ov,this,Bv).call(this),a=Fv._svgFactory.createElement("defs");r.append(a);const o=Fv._svgFactory.createElement("path");a.append(o);const l="path_p".concat(this.pageIndex,"_").concat(s);let c;if(o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),e){const t=Fv._svgFactory.createElement("mask");a.append(t),c="mask_p".concat(this.pageIndex,"_").concat(s),t.setAttribute("id",c),t.setAttribute("maskUnits","objectBoundingBox");const e=Fv._svgFactory.createElement("rect");t.append(e),e.setAttribute("width","1"),e.setAttribute("height","1"),e.setAttribute("fill","white");const n=Fv._svgFactory.createElement("use");t.append(n),n.setAttribute("href","#".concat(l)),n.setAttribute("stroke","none"),n.setAttribute("fill","black"),n.setAttribute("fill-rule","nonzero"),n.classList.add("mask")}const u=Fv._svgFactory.createElement("use");r.append(u),u.setAttribute("href","#".concat(l)),c&&u.setAttribute("mask","url(#".concat(c,")"));const h=u.cloneNode();return r.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(r,t),Be(Dv,this).set(s,r),s}finalizeDraw(t,e){Be(Lv,this).delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:n,bbox:i,rootClass:s,path:r}=e,a="number"===typeof t?Be(Dv,this).get(t):t;if(a){if(n&&Fe(Ov,this,jv).call(this,a,n),i&&Uv.call(Fv,a,i),s){const{classList:t}=a;for(const[e,n]of Object.entries(s))t.toggle(e,n)}if(r){const t=a.firstChild.firstChild;Fe(Ov,this,jv).call(this,t,r)}}}updateParent(t,e){if(e===this)return;const n=Be(Dv,this).get(t);n&&(Be(Nv,e).append(n),Be(Dv,this).delete(t),Be(Dv,e).set(t,n))}remove(t){Be(Lv,this).delete(t),null!==Be(Nv,this)&&(Be(Dv,this).get(t).remove(),Be(Dv,this).delete(t))}destroy(){Ve(Nv,this,null);for(const t of Be(Dv,this).values())t.remove();Be(Dv,this).clear(),Be(Lv,this).clear()}}function Uv(t,e){let[n,i,s,r]=e;const{style:a}=t;a.top="".concat(100*i,"%"),a.left="".concat(100*n,"%"),a.width="".concat(100*s,"%"),a.height="".concat(100*r,"%")}function Bv(){const t=en._svgFactory.create(1,1,!0);return Be(Nv,this).append(t),t.setAttribute("aria-hidden",!0),t}function Vv(t,e){const n=en._svgFactory.createElement("clipPath");t.append(n);const i="clip_".concat(e);n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const s=en._svgFactory.createElement("use");return n.append(s),s.setAttribute("href","#".concat(e)),s.classList.add("clip"),i}function jv(t,e){for(const[n,i]of Object.entries(e))null===i?t.removeAttribute(n):t.setAttribute(n,i)}en=Fv;var Wv={_:0};globalThis._pdfjsTestingUtils={HighlightOutliner:cp},globalThis.pdfjsLib={AbortException:$n,AnnotationEditorLayer:Cv,AnnotationEditorParamsType:mn,AnnotationEditorType:gn,AnnotationEditorUIManager:cr,AnnotationLayer:nf,AnnotationMode:pn,AnnotationType:Sn,build:"47ad820d9",ColorPicker:Pp,createValidAbsoluteUrl:zn,DOMSVGFactory:kh,DrawLayer:Fv,FeatureTest:ei,fetchData:pi,getDocument:Du,getFilenameFromUrl:function(t){return[t]=t.split(/[#?]/,1),t.substring(t.lastIndexOf("/")+1)},getPdfFilenameFromUrl:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"document.pdf";if("string"!==typeof t)return e;if(vi(t))return Vn('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(t);let s=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(s&&(s=s[0],s.includes("%")))try{s=n.exec(decodeURIComponent(s))[0]}catch(r){}return s||e},getUuid:li,getXfaPageViewport:function(t,e){let{scale:n=1,rotation:i=0}=e;const{width:s,height:r}=t.attributes.style,a=[0,0,parseInt(s),parseInt(r)];return new gi({viewBox:a,userUnit:1,scale:n,rotation:i})},GlobalWorkerOptions:cc,ImageKind:An,InvalidPDFException:Qn,isDataScheme:vi,isPdfFile:yi,isValidExplicitDest:Eo,MathClamp:ui,noContextMenu:_i,normalizeUnicode:function(t){return ai||(ai=/([\xA0\xB5\u037E\u0EB3\u2000-\u200A\u202F\u2126\uFB00-\uFB04\uFB06\uFB20-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBA1\uFBA4-\uFBA9\uFBAE-\uFBB1\uFBD3-\uFBDC\uFBDE-\uFBE7\uFBEA-\uFBF8\uFBFC\uFBFD\uFC00-\uFC5D\uFC64-\uFCF1\uFCF5-\uFD3D\uFD88\uFDF4\uFDFA\uFDFB\uFE71\uFE77\uFE79\uFE7B\uFE7D]+)|(\uFB05+)/g,oi=new Map([["\ufb05","\u017ft"]])),t.replaceAll(ai,((t,e,n)=>e?e.normalize("NFKC"):oi.get(n)))},OPS:Mn,OutputScale:Ii,PasswordResponses:{NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PDFDataRangeTransport:Wu,PDFDateString:Ai,PDFWorker:Zu,PermissionFlag:{PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},PixelsPerInch:fi,RenderingCancelledException:mi,ResponseException:Yn,setLayerDimensions:xi,shadow:qn,SignatureExtractor:Am,stopEvent:Ei,SupportedImageMimeTypes:Ri,TextLayer:bu,TouchManager:oa,updateUrlHash:Hn,Util:ii,VerbosityLevel:Rn,version:"5.3.31",XfaLayer:Ch};var zv=n(450);const Hv=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let s=t.charCodeAt(i);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296===(64512&s)&&i+1<t.length&&56320===(64512&t.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++i)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},qv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<t.length;s+=3){const e=t[s],r=s+1<t.length,a=r?t[s+1]:0,o=s+2<t.length,l=o?t[s+2]:0,c=e>>2,u=(3&e)<<4|a>>4;let h=(15&a)<<2|l>>6,d=63&l;o||(d=64,r||(h=64)),i.push(n[c],n[u],n[h],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Hv(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const s=t[n++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=t[n++];e[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const r=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(r>>10)),e[i++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],a=t[n++];e[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<t.length;){const e=n[t.charAt(s++)],r=s<t.length?n[t.charAt(s)]:0;++s;const a=s<t.length?n[t.charAt(s)]:64;++s;const o=s<t.length?n[t.charAt(s)]:64;if(++s,null==e||null==r||null==a||null==o)throw new Gv;const l=e<<2|r>>4;if(i.push(l),64!==a){const t=r<<4&240|a>>2;if(i.push(t),64!==o){const t=a<<6&192|o;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Gv extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Kv=function(t){return function(t){const e=Hv(t);return qv.encodeByteArray(e,!0)}(t).replace(/\./g,"")},Xv=function(t){try{return qv.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Qv(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const Yv=()=>{try{return Qv().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://127.0.0.1:8000"}.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"===typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const e=t&&Xv(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(t))}},Jv=t=>{var e,n;return null===(n=null===(e=Yv())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},$v=()=>{var t;return null===(t=Yv())||void 0===t?void 0:t.config},Zv=t=>{var e;return null===(e=Yv())||void 0===e?void 0:e["_".concat(t)]};class ty{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"===typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function ey(t){return t.endsWith(".cloudworkstations.dev")}async function ny(t){return(await fetch(t,{credentials:"include"})).ok}const iy={};let sy=!1;function ry(t,e){if("undefined"===typeof window||"undefined"===typeof document||!ey(window.location.host)||iy[t]===e||iy[t]||sy)return;function n(t){return"__firebase__banner__".concat(t)}iy[t]=e;const i="__firebase__banner",s=function(){const t={prod:[],emulator:[]};for(const e of Object.keys(iy))iy[e]?t.emulator.push(e):t.prod.push(e);return t}().prod.length>0;function r(){const t=document.createElement("span");return t.style.cursor="pointer",t.style.marginLeft="16px",t.style.fontSize="24px",t.innerHTML=" &times;",t.onclick=()=>{sy=!0,function(){const t=document.getElementById(i);t&&t.remove()}()},t}function a(){const t=function(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}(i),e=n("text"),a=document.getElementById(e)||document.createElement("span"),o=n("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(t.created){const e=t.element;!function(t){t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center"}(e),function(t,e){t.setAttribute("id",e),t.innerText="Learn more",t.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",t.setAttribute("target","__blank"),t.style.paddingLeft="5px",t.style.textDecoration="underline"}(l,o);const n=r();!function(t,e){t.setAttribute("width","24"),t.setAttribute("id",e),t.setAttribute("height","24"),t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("fill","none"),t.style.marginLeft="-6px"}(u,c),e.append(u,a,l,n),document.body.appendChild(e)}s?(a.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',a.innerText="Preview backend running in this workspace."),a.setAttribute("id",e)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a()}function ay(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function oy(){var t;const e=null===(t=Yv())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(i){return!1}}function ly(){return!oy()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cy(){try{return"object"===typeof indexedDB}catch(t){return!1}}class uy extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,uy.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hy.prototype.create)}}class hy{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t){const e=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(t),i=this.errors[t],s=i?function(t,e){return t.replace(dy,((t,n)=>{const i=e[n];return null!=i?String(i):"<".concat(n,"?>")}))}(i,e):"Error",r="".concat(this.serviceName,": ").concat(s," (").concat(n,").");return new uy(n,r,e)}}const dy=/\{\$([^}]+)}/g;function fy(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const s of n){if(!i.includes(s))return!1;const n=t[s],r=e[s];if(py(n)&&py(r)){if(!fy(n,r))return!1}else if(n!==r)return!1}for(const s of i)if(!n.includes(s))return!1;return!0}function py(t){return null!==t&&"object"===typeof t}function gy(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function my(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function vy(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class yy{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!==typeof t||null===t)return!1;for(const n of e)if(n in t&&"function"===typeof t[n])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=wy),void 0===i.error&&(i.error=wy),void 0===i.complete&&(i.complete=wy);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),s}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function wy(){}function by(t){return t&&t._delegate?t._delegate:t}class _y{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Ey="[DEFAULT]";class Ay{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new ty;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(n){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null===t||void 0===t?void 0:t.identifier),i=null!==(e=null===t||void 0===t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error("Mismatching Component ".concat(t.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:Ey})}catch(e){}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:i});n.resolve(t)}catch(e){}}}}clearInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ey;this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ey;return this.instances.has(t)}getOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ey;return this.instancesOptions.get(t)||{}}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[s,r]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&r.resolve(i)}return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch(i){}}getOrInitializeService(t){let{instanceIdentifier:e,options:n={}}=t,i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(s=e,s===Ey?void 0:s),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch(r){}var s;return i||null}normalizeInstanceIdentifier(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ey;return this.component?this.component.multipleInstances?t:Ey:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Sy{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component ".concat(t.name," has already been registered with ").concat(this.name));e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Ay(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const ky=[];var Cy;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(Cy||(Cy={}));const Ty={debug:Cy.DEBUG,verbose:Cy.VERBOSE,info:Cy.INFO,warn:Cy.WARN,error:Cy.ERROR,silent:Cy.SILENT},xy=Cy.INFO,Iy={[Cy.DEBUG]:"log",[Cy.VERBOSE]:"log",[Cy.INFO]:"info",[Cy.WARN]:"warn",[Cy.ERROR]:"error"},Ry=function(t,e){if(e<t.logLevel)return;const n=(new Date).toISOString(),i=Iy[e];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(e,")"));for(var s=arguments.length,r=new Array(s>2?s-2:0),a=2;a<s;a++)r[a-2]=arguments[a];console[i]("[".concat(n,"]  ").concat(t.name,":"),...r)};class My{constructor(t){this.name=t,this._logLevel=xy,this._logHandler=Ry,this._userLogHandler=null,ky.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Cy))throw new TypeError('Invalid value "'.concat(t,'" assigned to `logLevel`'));this._logLevel=t}setLogLevel(t){this._logLevel="string"===typeof t?Ty[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Cy.DEBUG,...e),this._logHandler(this,Cy.DEBUG,...e)}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Cy.VERBOSE,...e),this._logHandler(this,Cy.VERBOSE,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Cy.INFO,...e),this._logHandler(this,Cy.INFO,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Cy.WARN,...e),this._logHandler(this,Cy.WARN,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Cy.ERROR,...e),this._logHandler(this,Cy.ERROR,...e)}}let Py,Ny;const Dy=new WeakMap,Ly=new WeakMap,Oy=new WeakMap,Fy=new WeakMap,Uy=new WeakMap;let By={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return Ly.get(t);if("objectStoreNames"===e)return t.objectStoreNames||Oy.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Wy(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function Vy(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Ny||(Ny=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(zy(this),n),Wy(Dy.get(this))}:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Wy(t.apply(zy(this),n))}:function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];const r=t.call(zy(this),e,...i);return Oy.set(r,e.sort?e.sort():[e]),Wy(r)}}function jy(t){return"function"===typeof t?Vy(t):(t instanceof IDBTransaction&&function(t){if(Ly.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{e(),i()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)}));Ly.set(t,e)}(t),e=t,(Py||(Py=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>e instanceof t))?new Proxy(t,By):t);var e}function Wy(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{e(Wy(t.result)),i()},r=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&Dy.set(e,t)})).catch((()=>{})),Uy.set(e,t),e}(t);if(Fy.has(t))return Fy.get(t);const e=jy(t);return e!==t&&(Fy.set(t,e),Uy.set(e,t)),e}const zy=t=>Uy.get(t);const Hy=["get","getKey","getAll","getAllKeys","count"],qy=["put","add","delete","clear"],Gy=new Map;function Ky(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!==typeof e)return;if(Gy.get(e))return Gy.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=qy.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!Hy.includes(n))return;const r=async function(t){const e=this.transaction(t,s?"readwrite":"readonly");let r=e.store;for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return i&&(r=r.index(o.shift())),(await Promise.all([r[n](...o),s&&e.done]))[0]};return Gy.set(e,r),r}By=(t=>l(l({},t),{},{get:(e,n,i)=>Ky(e,n)||t.get(e,n,i),has:(e,n)=>!!Ky(e,n)||t.has(e,n)}))(By);class Xy{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}(t)){const e=t.getImmediate();return"".concat(e.library,"/").concat(e.version)}return null})).filter((t=>t)).join(" ")}}const Qy="@firebase/app",Yy="0.13.1",Jy=new My("@firebase/app"),$y="@firebase/app-compat",Zy="@firebase/analytics-compat",tw="@firebase/analytics",ew="@firebase/app-check-compat",nw="@firebase/app-check",iw="@firebase/auth",sw="@firebase/auth-compat",rw="@firebase/database",aw="@firebase/data-connect",ow="@firebase/database-compat",lw="@firebase/functions",cw="@firebase/functions-compat",uw="@firebase/installations",hw="@firebase/installations-compat",dw="@firebase/messaging",fw="@firebase/messaging-compat",pw="@firebase/performance",gw="@firebase/performance-compat",mw="@firebase/remote-config",vw="@firebase/remote-config-compat",yw="@firebase/storage",ww="@firebase/storage-compat",bw="@firebase/firestore",_w="@firebase/ai",Ew="@firebase/firestore-compat",Aw="firebase",Sw="[DEFAULT]",kw={[Qy]:"fire-core",[$y]:"fire-core-compat",[tw]:"fire-analytics",[Zy]:"fire-analytics-compat",[nw]:"fire-app-check",[ew]:"fire-app-check-compat",[iw]:"fire-auth",[sw]:"fire-auth-compat",[rw]:"fire-rtdb",[aw]:"fire-data-connect",[ow]:"fire-rtdb-compat",[lw]:"fire-fn",[cw]:"fire-fn-compat",[uw]:"fire-iid",[hw]:"fire-iid-compat",[dw]:"fire-fcm",[fw]:"fire-fcm-compat",[pw]:"fire-perf",[gw]:"fire-perf-compat",[mw]:"fire-rc",[vw]:"fire-rc-compat",[yw]:"fire-gcs",[ww]:"fire-gcs-compat",[bw]:"fire-fst",[Ew]:"fire-fst-compat",[_w]:"fire-vertex","fire-js":"fire-js",[Aw]:"fire-js-all"},Cw=new Map,Tw=new Map,xw=new Map;function Iw(t,e){try{t.container.addComponent(e)}catch(n){Jy.debug("Component ".concat(e.name," failed to register with FirebaseApp ").concat(t.name),n)}}function Rw(t){const e=t.name;if(xw.has(e))return Jy.debug("There were multiple attempts to register component ".concat(e,".")),!1;xw.set(e,t);for(const n of Cw.values())Iw(n,t);for(const n of Tw.values())Iw(n,t);return!0}function Mw(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Pw(t){return null!==t&&void 0!==t&&void 0!==t.settings}const Nw=new hy("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Dw{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new _y("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Nw.create("app-deleted",{appName:this._name})}}const Lw="11.9.0";function Ow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t;if("object"!==typeof e){e={name:e}}const i=Object.assign({name:Sw,automaticDataCollectionEnabled:!0},e),s=i.name;if("string"!==typeof s||!s)throw Nw.create("bad-app-name",{appName:String(s)});if(n||(n=$v()),!n)throw Nw.create("no-options");const r=Cw.get(s);if(r){if(fy(n,r.options)&&fy(i,r.config))return r;throw Nw.create("duplicate-app",{appName:s})}const a=new Sy(s);for(const l of xw.values())a.addComponent(l);const o=new Dw(n,i,a);return Cw.set(s,o),o}function Fw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sw;const e=Cw.get(t);if(!e&&t===Sw&&$v())return Ow();if(!e)throw Nw.create("no-app",{appName:t});return e}function Uw(t,e,n){var i;let s=null!==(i=kw[t])&&void 0!==i?i:t;n&&(s+="-".concat(n));const r=s.match(/\s|\//),a=e.match(/\s|\//);if(r||a){const t=['Unable to register library "'.concat(s,'" with version "').concat(e,'":')];return r&&t.push('library name "'.concat(s,'" contains illegal characters (whitespace or "/")')),r&&a&&t.push("and"),a&&t.push('version name "'.concat(e,'" contains illegal characters (whitespace or "/")')),void Jy.warn(t.join(" "))}Rw(new _y("".concat(s,"-version"),(()=>({library:s,version:e})),"VERSION"))}const Bw="firebase-heartbeat-store";let Vw=null;function jw(){return Vw||(Vw=function(t,e){let{blocked:n,upgrade:i,blocking:s,terminated:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(t,e),o=Wy(a);return i&&a.addEventListener("upgradeneeded",(t=>{i(Wy(a.result),t.oldVersion,t.newVersion,Wy(a.transaction),t)})),n&&a.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),o.then((t=>{r&&t.addEventListener("close",(()=>r())),s&&t.addEventListener("versionchange",(t=>s(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),o}("firebase-heartbeat-database",1,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(Bw)}catch(n){console.warn(n)}}}).catch((t=>{throw Nw.create("idb-open",{originalErrorMessage:t.message})}))),Vw}async function Ww(t,e){try{const n=(await jw()).transaction(Bw,"readwrite"),i=n.objectStore(Bw);await i.put(e,zw(t)),await n.done}catch(n){if(n instanceof uy)Jy.warn(n.message);else{const t=Nw.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});Jy.warn(t.message)}}}function zw(t){return"".concat(t.name,"!").concat(t.options.appId)}class Hw{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Gw(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=qw();if(null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some((t=>t.date===i)))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>30){const t=function(t){if(0===t.length)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(t,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Jy.warn(n)}}async getHeartbeatsHeader(){var t;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=qw(),{heartbeatsToSend:n,unsentEntries:i}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let i=t.slice();for(const s of t){const t=n.find((t=>t.agent===s.agent));if(t){if(t.dates.push(s.date),Kw(n)>e){t.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Kw(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),s=Kv(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Jy.warn(e),""}}}function qw(){return(new Date).toISOString().substring(0,10)}class Gw{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!cy()&&new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")}}catch(n){e(n)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await jw()).transaction(Bw),n=await e.objectStore(Bw).get(zw(t));return await e.done,n}catch(e){if(e instanceof uy)Jy.warn(e.message);else{const t=Nw.create("idb-get",{originalErrorMessage:null===e||void 0===e?void 0:e.message});Jy.warn(t.message)}}}(this.app);return(null===t||void 0===t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ww(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ww(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function Kw(t){return Kv(JSON.stringify({version:2,heartbeats:t})).length}var Xw;Xw="",Rw(new _y("platform-logger",(t=>new Xy(t)),"PRIVATE")),Rw(new _y("heartbeat",(t=>new Hw(t)),"PRIVATE")),Uw(Qy,Yy,Xw),Uw(Qy,Yy,"esm2017"),Uw("fire-js","");Uw("firebase","11.9.1","app");function Qw(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Yw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Jw=Yw,$w=new hy("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Zw=new My("@firebase/auth");function tb(t){if(Zw.logLevel<=Cy.ERROR){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];Zw.error("Auth (".concat(Lw,"): ").concat(t),...n)}}function eb(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];throw ab(t,...n)}function nb(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return ab(t,...n)}function ib(t,e,n){const i=Object.assign(Object.assign({},Jw()),{[e]:n});return new hy("auth","Firebase",i).create(e,{appName:t.name})}function sb(t){return ib(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function rb(t,e,n){if(!(e instanceof n))throw n.name!==e.constructor.name&&eb(t,"argument-error"),ib(t,"argument-error","Type of ".concat(e.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function ab(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];if("string"!==typeof t){const e=n[0],i=[...n.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(e,...i)}return $w.create(t,...n)}function ob(t,e){if(!t){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];throw ab(e,...i)}}function lb(t){const e="INTERNAL ASSERTION FAILED: "+t;throw tb(e),new Error(e)}function cb(t,e){t||lb(e)}function ub(){var t;return"undefined"!==typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function hb(){return"http:"===db()||"https:"===db()}function db(){var t;return"undefined"!==typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function fb(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(hb()||function(){const t="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class pb{constructor(t,e){this.shortDelay=t,this.longDelay=e,cb(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ay())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return fb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function gb(t,e){cb(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?"".concat(n).concat(e.startsWith("/")?e.slice(1):e):n}class mb{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void lb("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void lb("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void lb("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const vb={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},yb=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],wb=new pb(3e4,6e4);function bb(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function _b(t,e,n,i){return Eb(t,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let s={},r={};i&&("GET"===e?r=i:s={body:JSON.stringify(i)});const a=gy(Object.assign({key:t.config.apiKey},r)).slice(1),o=await t._getAdditionalHeaders();o["Content-Type"]="application/json",t.languageCode&&(o["X-Firebase-Locale"]=t.languageCode);const l=Object.assign({method:e,headers:o},s);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),t.emulatorConfig&&ey(t.emulatorConfig.host)&&(l.credentials="include"),mb.fetch()(await Sb(t,t.config.apiHost,n,a),l)}))}async function Eb(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},vb),e);try{const e=new Cb(t),s=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const r=await s.json();if("needConfirmation"in r)throw Tb(t,"account-exists-with-different-credential",r);if(s.ok&&!("errorMessage"in r))return r;{const e=s.ok?r.errorMessage:r.error.message,[n,a]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Tb(t,"credential-already-in-use",r);if("EMAIL_EXISTS"===n)throw Tb(t,"email-already-in-use",r);if("USER_DISABLED"===n)throw Tb(t,"user-disabled",r);const o=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw ib(t,o,a);eb(t,o)}}catch(s){if(s instanceof uy)throw s;eb(t,"network-request-failed",{message:String(s)})}}async function Ab(t,e,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const r=await _b(t,e,n,i,s);return"mfaPendingCredential"in r&&eb(t,"multi-factor-auth-required",{_serverResponse:r}),r}async function Sb(t,e,n,i){const s="".concat(e).concat(n,"?").concat(i),r=t,a=r.config.emulator?gb(t.config,s):"".concat(t.config.apiScheme,"://").concat(s);if(yb.includes(n)&&(await r._persistenceManagerAvailable,"COOKIE"===r._getPersistenceType())){return r._getPersistence()._getFinalTarget(a).toString()}return a}function kb(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Cb{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(nb(this.auth,"network-request-failed"))),wb.get())}))}}function Tb(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const s=nb(t,e,i);return s.customData._tokenResponse=n,s}function xb(t){return void 0!==t&&void 0!==t.enterprise}class Ib{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return kb(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Rb(t,e){return _b(t,"GET","/v2/recaptchaConfig",bb(t,e))}async function Mb(t,e){return _b(t,"POST","/v1/accounts:lookup",e)}function Pb(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(e){}}function Nb(t){return 1e3*Number(t)}function Db(t){const[e,n,i]=t.split(".");if(void 0===e||void 0===n||void 0===i)return tb("JWT malformed, contained fewer than 3 sections"),null;try{const t=Xv(n);return t?JSON.parse(t):(tb("Failed to decode base64 JWT payload"),null)}catch(s){return tb("Caught error parsing JWT payload as JSON",null===s||void 0===s?void 0:s.toString()),null}}function Lb(t){const e=Db(t);return ob(e,"internal-error"),ob("undefined"!==typeof e.exp,"internal-error"),ob("undefined"!==typeof e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}async function Ob(t,e){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return e;try{return await e}catch(n){throw n instanceof uy&&function(t){let{code:e}=t;return e==="auth/".concat("user-disabled")||e==="auth/".concat("user-token-expired")}(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}class Fb{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void((null===t||void 0===t?void 0:t.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class Ub{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Pb(this.lastLoginAt),this.creationTime=Pb(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Bb(t){var e;const n=t.auth,i=await t.getIdToken(),s=await Ob(t,Mb(n,{idToken:i}));ob(null===s||void 0===s?void 0:s.users.length,n,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const a=(null===(e=r.providerUserInfo)||void 0===e?void 0:e.length)?Vb(r.providerUserInfo):[],o=(l=t.providerData,c=a,[...l.filter((t=>!c.some((e=>e.providerId===t.providerId)))),...c]);var l,c;const u=t.isAnonymous,h=!(t.email&&r.passwordHash)&&!(null===o||void 0===o?void 0:o.length),d=!!u&&h,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Ub(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(t,f)}function Vb(t){return t.map((t=>{var{providerId:e}=t,n=Qw(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class jb{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){ob(t.idToken,"internal-error"),ob("undefined"!==typeof t.idToken,"internal-error"),ob("undefined"!==typeof t.refreshToken,"internal-error");const e="expiresIn"in t&&"undefined"!==typeof t.expiresIn?Number(t.expiresIn):Lb(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){ob(0!==t.length,"internal-error");const e=Lb(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(ob(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:s}=await async function(t,e){const n=await Eb(t,{},(async()=>{const n=gy({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,r=await Sb(t,i,"/v1/token","key=".concat(s)),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const o={method:"POST",headers:a,body:n};return t.emulatorConfig&&ey(t.emulatorConfig.host)&&(o.credentials="include"),mb.fetch()(r,o)}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:s}=e,r=new jb;return n&&(ob("string"===typeof n,"internal-error",{appName:t}),r.refreshToken=n),i&&(ob("string"===typeof i,"internal-error",{appName:t}),r.accessToken=i),s&&(ob("number"===typeof s,"internal-error",{appName:t}),r.expirationTime=s),r}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new jb,this.toJSON())}_performRefresh(){return lb("not implemented")}}function Wb(t,e){ob("string"===typeof t||"undefined"===typeof t,"internal-error",{appName:e})}class zb{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,s=Qw(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Fb(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ub(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const e=await Ob(this,this.stsTokenManager.getToken(this.auth,t));return ob(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=by(t),i=await n.getIdToken(e),s=Db(i);ob(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const r="object"===typeof s.firebase?s.firebase:void 0,a=null===r||void 0===r?void 0:r.sign_in_provider;return{claims:s,token:i,authTime:Pb(Nb(s.auth_time)),issuedAtTime:Pb(Nb(s.iat)),expirationTime:Pb(Nb(s.exp)),signInProvider:a||null,signInSecondFactor:(null===r||void 0===r?void 0:r.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=by(t);await Bb(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(ob(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new zb(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){ob(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await Bb(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Pw(this.auth.app))return Promise.reject(sb(this.auth));const t=await this.getIdToken();return await Ob(this,async function(t,e){return _b(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,s,r,a,o,l,c;const u=null!==(n=e.displayName)&&void 0!==n?n:void 0,h=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(s=e.phoneNumber)&&void 0!==s?s:void 0,f=null!==(r=e.photoURL)&&void 0!==r?r:void 0,p=null!==(a=e.tenantId)&&void 0!==a?a:void 0,g=null!==(o=e._redirectEventId)&&void 0!==o?o:void 0,m=null!==(l=e.createdAt)&&void 0!==l?l:void 0,v=null!==(c=e.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:w,isAnonymous:b,providerData:_,stsTokenManager:E}=e;ob(y&&E,t,"internal-error");const A=jb.fromJSON(this.name,E);ob("string"===typeof y,t,"internal-error"),Wb(u,t.name),Wb(h,t.name),ob("boolean"===typeof w,t,"internal-error"),ob("boolean"===typeof b,t,"internal-error"),Wb(d,t.name),Wb(f,t.name),Wb(p,t.name),Wb(g,t.name),Wb(m,t.name),Wb(v,t.name);const S=new zb({uid:y,auth:t,email:h,emailVerified:w,displayName:u,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:A,createdAt:m,lastLoginAt:v});return _&&Array.isArray(_)&&(S.providerData=_.map((t=>Object.assign({},t)))),g&&(S._redirectEventId=g),S}static async _fromIdTokenResponse(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=new jb;i.updateFromServerResponse(e);const s=new zb({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await Bb(s),s}static async _fromGetAccountInfoResponse(t,e,n){const i=e.users[0];ob(void 0!==i.localId,"internal-error");const s=void 0!==i.providerUserInfo?Vb(i.providerUserInfo):[],r=!(i.email&&i.passwordHash)&&!(null===s||void 0===s?void 0:s.length),a=new jb;a.updateFromIdToken(n);const o=new zb({uid:i.localId,auth:t,stsTokenManager:a,isAnonymous:r}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ub(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(null===s||void 0===s?void 0:s.length)};return Object.assign(o,l),o}}const Hb=new Map;function qb(t){cb(t instanceof Function,"Expected a class definition");let e=Hb.get(t);return e?(cb(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Hb.set(t,e),e)}class Gb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Gb.type="NONE";const Kb=Gb;function Xb(t,e,n){return"firebase".concat(":",t,":").concat(e,":").concat(n)}class Qb{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Xb(this.userKey,i.apiKey,s),this.fullPersistenceKey=Xb("persistence",i.apiKey,s),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if("string"===typeof t){const e=await Mb(this.auth,{idToken:t}).catch((()=>{}));return e?zb._fromGetAccountInfoResponse(this.auth,e,t):null}return zb._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!e.length)return new Qb(qb(Kb),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let s=i[0]||qb(Kb);const r=Xb(n,t.config.apiKey,t.name);let a=null;for(const c of e)try{const e=await c._get(r);if(e){let n;if("string"===typeof e){const i=await Mb(t,{idToken:e}).catch((()=>{}));if(!i)break;n=await zb._fromGetAccountInfoResponse(t,i,e)}else n=zb._fromJSON(t,e);c!==s&&(a=n),s=c;break}}catch(l){}const o=i.filter((t=>t._shouldAllowMigration));return s._shouldAllowMigration&&o.length?(s=o[0],a&&await s._set(r,a.toJSON()),await Promise.all(e.map((async t=>{if(t!==s)try{await t._remove(r)}catch(l){}}))),new Qb(s,t,n)):new Qb(s,t,n)}}function Yb(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(t_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Jb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(n_(e))return"Blackberry";if(i_(e))return"Webos";if($b(e))return"Safari";if((e.includes("chrome/")||Zb(e))&&!e.includes("edge/"))return"Chrome";if(e_(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Jb(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ay();return/firefox\//i.test(t)}function $b(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ay()).toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Zb(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ay();return/crios\//i.test(t)}function t_(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ay();return/iemobile/i.test(t)}function e_(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ay();return/android/i.test(t)}function n_(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ay();return/blackberry/i.test(t)}function i_(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ay();return/webos/i.test(t)}function s_(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ay();return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function r_(){return function(){const t=ay();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()&&10===document.documentMode}function a_(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ay();return s_(t)||e_(t)||i_(t)||n_(t)||/windows phone/i.test(t)||t_(t)}function o_(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(t){case"Browser":e=Yb(ay());break;case"Worker":e="".concat(Yb(ay()),"-").concat(t);break;default:e=t}const i=n.length?n.join(","):"FirebaseCore-web";return"".concat(e,"/","JsCore","/").concat(Lw,"/").concat(i)}class l_{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(s){i(s)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(n){e.reverse();for(const t of e)try{t()}catch(i){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class c_{constructor(t){var e,n,i,s;const r=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=r.minPasswordLength)&&void 0!==e?e:6,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),void 0!==r.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),void 0!==r.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),void 0!==r.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),void 0!==r.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(s=t.forceUpgradeOnSignin)&&void 0!==s&&s,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,i,s,r,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,o),this.validatePasswordCharacterOptions(t,o),o.isValid&&(o.isValid=null===(e=o.meetsMinPasswordLength)||void 0===e||e),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(i=o.containsLowercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(s=o.containsUppercaseLetter)||void 0===s||s),o.isValid&&(o.isValid=null===(r=o.containsNumericCharacter)||void 0===r||r),o.isValid&&(o.isValid=null===(a=o.containsNonAlphanumericCharacter)||void 0===a||a),o}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}class u_{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new d_(this),this.idTokenSubscription=new d_(this),this.beforeStateQueue=new l_(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$w,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise((t=>this._resolvePersistenceManagerAvailable=t))}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=qb(e)),this._initializationPromise=this.queue((async()=>{var n,i,s;if(!this._deleted&&(this.persistenceManager=await Qb.create(this,t),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(i=this._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(r){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(s=this.currentUser)||void 0===s?void 0:s.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUserFromIdToken(t){try{const e=await Mb(this,{idToken:t}),n=await zb._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var e;if(Pw(this.app)){const t=this.app.settings.authIdToken;return t?new Promise((e=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(t).then(e,e)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,r=null===i||void 0===i?void 0:i._redirectEventId,a=await this.tryRedirectSignIn(t);n&&n!==r||!(null===a||void 0===a?void 0:a.user)||(i=a.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(r){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(r)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ob(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(n){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await Bb(t)}catch(e){if((null===e||void 0===e?void 0:e.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Pw(this.app))return Promise.reject(sb(this));const e=t?by(t):null;return e&&ob(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return t&&ob(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return Pw(this.app)?Promise.reject(sb(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Pw(this.app)?Promise.reject(sb(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(qb(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t){return _b(t,"GET","/v2/passwordPolicy",bb(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),e=new c_(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new hy("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged((()=>{n(),t()}),e)}}))}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return _b(t,"POST","/v2/accounts:revokeToken",bb(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&qb(t)||this._popupRedirectResolver;ob(e,this,"argument-error"),this.redirectPersistenceManager=await Qb.create(this,[qb(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const s="function"===typeof e?e:e.next.bind(e);let r=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ob(a,this,"internal-error"),a.then((()=>{r||s(this.currentUser)})),"function"===typeof e){const s=t.addObserver(e,n,i);return()=>{r=!0,s()}}{const n=t.addObserver(e);return()=>{r=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return ob(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=o_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(Pw(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null===e||void 0===e?void 0:e.error)&&function(t){if(Zw.logLevel<=Cy.WARN){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];Zw.warn("Auth (".concat(Lw,"): ").concat(t),...n)}}("Error while retrieving App Check token: ".concat(e.error)),null===e||void 0===e?void 0:e.token}}function h_(t){return by(t)}class d_{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new yy(t,e);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return ob(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let f_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function p_(t){return f_.loadJS(t)}function g_(t){return"__".concat(t).concat(Math.floor(1e6*Math.random()))}class m_{constructor(){this.enterprise=new v_}ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}class v_{ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}const y_="NO_RECAPTCHA";class w_{constructor(t){this.type="recaptcha-enterprise",this.auth=h_(t)}async verify(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(e,n,i){const s=window.grecaptcha;xb(s)?s.enterprise.ready((()=>{s.enterprise.execute(e,{action:t}).then((t=>{n(t)})).catch((()=>{n(y_)}))})):i(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new m_).execute("siteKey",{action:"verify"})}return new Promise(((t,i)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,n)=>{Rb(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new Ib(i);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{n(t)}))}))})(this.auth).then((s=>{if(!e&&xb(window.grecaptcha))n(s,t,i);else{if("undefined"===typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let e=f_.recaptchaEnterpriseScript;0!==e.length&&(e+=s),p_(e).then((()=>{n(s,t,i)})).catch((t=>{i(t)}))}})).catch((t=>{i(t)}))}))}}async function b_(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const r=new w_(t);let a;if(s)a=y_;else try{a=await r.verify(n)}catch(l){a=await r.verify(n,!0)}const o=Object.assign({},e);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in o){const t=o.phoneEnrollmentInfo.phoneNumber,e=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:t,recaptchaToken:e,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const t=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:t,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return i?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function __(t,e,n,i,s){var r,a;if("EMAIL_PASSWORD_PROVIDER"===s){if(null===(r=t._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await b_(t,e,n,"getOobCode"===n);return i(t,s)}return i(t,e).catch((async s=>{if(s.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const s=await b_(t,e,n,"getOobCode"===n);return i(t,s)}return Promise.reject(s)}))}if("PHONE_PROVIDER"===s){if(null===(a=t._getRecaptchaConfig())||void 0===a?void 0:a.isProviderEnabled("PHONE_PROVIDER")){const s=await b_(t,e,n);return i(t,s).catch((async s=>{var r;if("AUDIT"===(null===(r=t._getRecaptchaConfig())||void 0===r?void 0:r.getProviderEnforcementState("PHONE_PROVIDER"))&&(s.code==="auth/".concat("missing-recaptcha-token")||s.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const s=await b_(t,e,n,!1,!0);return i(t,s)}return Promise.reject(s)}))}{const s=await b_(t,e,n,!1,!0);return i(t,s)}}return Promise.reject(s+" provider is not supported.")}async function E_(t){const e=h_(t),n=await Rb(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),i=new Ib(n);if(null==e.tenantId?e._agentRecaptchaConfig=i:e._tenantRecaptchaConfigs[e.tenantId]=i,i.isAnyProviderEnabled()){new w_(e).verify()}}function A_(t,e,n){const i=h_(t);ob(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!!(null===n||void 0===n?void 0:n.disableWarnings),r=S_(e),{host:a,port:o}=function(t){const e=S_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const t=s[1];return{host:t,port:k_(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:k_(e)}}}(e),l=null===o?"":":".concat(o),c={url:"".concat(r,"//").concat(a).concat(l,"/")},u=Object.freeze({host:a,port:o,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator)return ob(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),void ob(fy(c,i.config.emulator)&&fy(u,i.emulatorConfig),i,"emulator-config-failed");i.config.emulator=c,i.emulatorConfig=u,i.settings.appVerificationDisabledForTesting=!0,ey(a)?(ny("".concat(r,"//").concat(a).concat(l)),ry("Auth",!0)):s||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}function S_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function k_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class C_{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return lb("not implemented")}_getIdTokenResponse(t){return lb("not implemented")}_linkToIdToken(t,e){return lb("not implemented")}_getReauthenticationResolver(t){return lb("not implemented")}}async function T_(t,e){return _b(t,"POST","/v1/accounts:signUp",e)}async function x_(t,e){return Ab(t,"POST","/v1/accounts:signInWithPassword",bb(t,e))}class I_ extends C_{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new I_(t,e,"password")}static _fromEmailAndCode(t,e){return new I_(t,e,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"===typeof t?JSON.parse(t):t;if((null===e||void 0===e?void 0:e.email)&&(null===e||void 0===e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return __(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",x_,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(t,e){return Ab(t,"POST","/v1/accounts:signInWithEmailLink",bb(t,e))}(t,{email:this._email,oobCode:this._password});default:eb(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return __(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",T_,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(t,e){return Ab(t,"POST","/v1/accounts:signInWithEmailLink",bb(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:eb(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function R_(t,e){return Ab(t,"POST","/v1/accounts:signInWithIdp",bb(t,e))}class M_ extends C_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new M_(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):eb("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"===typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,s=Qw(e,["providerId","signInMethod"]);if(!n||!i)return null;const r=new M_(n,i);return r.idToken=s.idToken||void 0,r.accessToken=s.accessToken||void 0,r.secret=s.secret,r.nonce=s.nonce,r.pendingToken=s.pendingToken||null,r}_getIdTokenResponse(t){return R_(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,R_(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,R_(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=gy(e)}return t}}async function P_(t,e){return _b(t,"POST","/v1/accounts:sendVerificationCode",bb(t,e))}const N_={USER_NOT_FOUND:"user-not-found"};class D_ extends C_{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new D_({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new D_({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return Ab(t,"POST","/v1/accounts:signInWithPhoneNumber",bb(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await Ab(t,"POST","/v1/accounts:signInWithPhoneNumber",bb(t,e));if(n.temporaryProof)throw Tb(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return Ab(t,"POST","/v1/accounts:signInWithPhoneNumber",bb(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),N_)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"===typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:s}=t;return n||e||i||s?new D_({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:s}):null}}class L_{constructor(t){var e,n,i,s,r,a;const o=my(vy(t)),l=null!==(e=o.apiKey)&&void 0!==e?e:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,u=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=o.mode)&&void 0!==i?i:null);ob(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(s=o.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(r=o.lang)&&void 0!==r?r:null,this.tenantId=null!==(a=o.tenantId)&&void 0!==a?a:null}static parseLink(t){const e=function(t){const e=my(vy(t)).link,n=e?my(vy(e)).deep_link_id:null,i=my(vy(t)).deep_link_id;return(i?my(vy(i)).link:null)||i||n||e||t}(t);try{return new L_(e)}catch(n){return null}}}class O_{constructor(){this.providerId=O_.PROVIDER_ID}static credential(t,e){return I_._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=L_.parseLink(e);return ob(n,"argument-error"),I_._fromEmailAndCode(t,n.code,n.tenantId)}}O_.PROVIDER_ID="password",O_.EMAIL_PASSWORD_SIGN_IN_METHOD="password",O_.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class F_{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class U_ extends F_{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class B_ extends U_{constructor(){super("facebook.com")}static credential(t){return M_._fromParams({providerId:B_.PROVIDER_ID,signInMethod:B_.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return B_.credentialFromTaggedObject(t)}static credentialFromError(t){return B_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return B_.credential(e.oauthAccessToken)}catch(n){return null}}}B_.FACEBOOK_SIGN_IN_METHOD="facebook.com",B_.PROVIDER_ID="facebook.com";class V_ extends U_{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return M_._fromParams({providerId:V_.PROVIDER_ID,signInMethod:V_.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return V_.credentialFromTaggedObject(t)}static credentialFromError(t){return V_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return V_.credential(n,i)}catch(s){return null}}}V_.GOOGLE_SIGN_IN_METHOD="google.com",V_.PROVIDER_ID="google.com";class j_ extends U_{constructor(){super("github.com")}static credential(t){return M_._fromParams({providerId:j_.PROVIDER_ID,signInMethod:j_.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return j_.credentialFromTaggedObject(t)}static credentialFromError(t){return j_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return j_.credential(e.oauthAccessToken)}catch(n){return null}}}j_.GITHUB_SIGN_IN_METHOD="github.com",j_.PROVIDER_ID="github.com";class W_ extends U_{constructor(){super("twitter.com")}static credential(t,e){return M_._fromParams({providerId:W_.PROVIDER_ID,signInMethod:W_.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return W_.credentialFromTaggedObject(t)}static credentialFromError(t){return W_.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return W_.credential(n,i)}catch(s){return null}}}W_.TWITTER_SIGN_IN_METHOD="twitter.com",W_.PROVIDER_ID="twitter.com";class z_{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=await zb._fromIdTokenResponse(t,n,i),r=H_(n);return new z_({user:s,providerId:r,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=H_(n);return new z_({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function H_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class q_ extends uy{constructor(t,e,n,i){var s;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,q_.prototype),this.customData={appName:t.name,tenantId:null!==(s=t.tenantId)&&void 0!==s?s:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new q_(t,e,n,i)}}function G_(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw q_._fromErrorAndOperation(t,n,e,i);throw n}))}async function K_(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=await Ob(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return z_._forOperation(t,"link",i)}async function X_(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:i}=t;if(Pw(i.app))return Promise.reject(sb(i));const s="reauthenticate";try{const r=await Ob(t,G_(i,s,e,t),n);ob(r.idToken,i,"internal-error");const a=Db(r.idToken);ob(a,i,"internal-error");const{sub:o}=a;return ob(t.uid===o,i,"user-mismatch"),z_._forOperation(t,s,r)}catch(r){throw(null===r||void 0===r?void 0:r.code)==="auth/".concat("user-not-found")&&eb(i,"user-mismatch"),r}}async function Q_(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Pw(t.app))return Promise.reject(sb(t));const i="signIn",s=await G_(t,i,e),r=await z_._fromIdTokenResponse(t,i,s);return n||await t._updateCurrentUser(r.user),r}function Y_(t,e){return _b(t,"POST","/v2/accounts/mfaEnrollment:start",bb(t,e))}new WeakMap;const J_="__sak";class $_{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(J_,"1"),this.storage.removeItem(J_),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class Z_ extends $_{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=a_(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;e?this.detachListener():this.stopPolling();const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},s=this.storage.getItem(n);r_()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,10):i()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Z_.type="LOCAL";const tE=Z_;function eE(t){var e,n;const i=t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),s=RegExp("".concat(i,"=([^;]+)"));return null!==(n=null===(e=document.cookie.match(s))||void 0===e?void 0:e[1])&&void 0!==n?n:null}function nE(t){const e="http:"===window.location.protocol;return"".concat(e?"__dev_":"__HOST-","FIREBASE_").concat(t.split(":")[3])}class iE{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(t){if(void 0===typeof window)return t;const e=new URL("".concat(window.location.origin,"/__cookies__"));return e.searchParams.set("finalTarget",t),e}async _isAvailable(){var t;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(t=navigator.cookieEnabled)||void 0===t||t))}async _set(t,e){}async _get(t){if(!this._isAvailable())return null;const e=nE(t);if(window.cookieStore){const t=await window.cookieStore.get(e);return null===t||void 0===t?void 0:t.value}return eE(e)}async _remove(t){if(!this._isAvailable())return;if(!await this._get(t))return;const e=nE(t);document.cookie="".concat(e,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch((()=>{}))}_addListener(t,e){if(!this._isAvailable())return;const n=nE(t);if(window.cookieStore){const t=t=>{const i=t.changed.find((t=>t.name===n));i&&e(i.value);t.deleted.find((t=>t.name===n))&&e(null)},i=()=>window.cookieStore.removeEventListener("change",t);return this.listenerUnsubscribes.set(e,i),window.cookieStore.addEventListener("change",t)}let i=eE(n);const s=setInterval((()=>{const t=eE(n);t!==i&&(e(t),i=t)}),1e3);this.listenerUnsubscribes.set(e,(()=>clearInterval(s)))}_removeListener(t,e){const n=this.listenerUnsubscribes.get(e);n&&(n(),this.listenerUnsubscribes.delete(e))}}iE.type="COOKIE";class sE extends $_{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}sE.type="SESSION";const rE=sE;class aE{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new aE(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:s}=e.data,r=this.handlersMap[i];if(!(null===r||void 0===r?void 0:r.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const a=Array.from(r).map((async t=>t(e.origin,s))),o=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}})))}(a);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:o})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function oE(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let i=0;i<e;i++)n+=Math.floor(10*Math.random());return t+n}aE.receivers=[];class lE{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const i="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,r;return new Promise(((a,o)=>{const l=oE("",20);i.port1.start();const c=setTimeout((()=>{o(new Error("unsupported_event"))}),n);r={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(c),s=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),a(e.data.response);break;default:clearTimeout(c),clearTimeout(s),o(new Error("invalid_response"))}}},this.handlers.add(r),i.port1.addEventListener("message",r.onMessage),this.target.postMessage({eventType:t,eventId:l,data:e},[i.port2])})).finally((()=>{r&&this.removeMessageHandler(r)}))}}function cE(){return window}function uE(){return"undefined"!==typeof cE().WorkerGlobalScope&&"function"===typeof cE().importScripts}const hE="firebaseLocalStorageDb",dE="firebaseLocalStorage",fE="fbase_key";class pE{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function gE(t,e){return t.transaction([dE],e?"readwrite":"readonly").objectStore(dE)}function mE(){const t=indexedDB.open(hE,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(dE,{keyPath:fE})}catch(i){n(i)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(dE)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(hE);return new pE(t).toPromise()}(),e(await mE()))}))}))}async function vE(t,e,n){const i=gE(t,!0).put({[fE]:e,value:n});return new pE(i).toPromise()}function yE(t,e){const n=gE(t,!0).delete(e);return new pE(n).toPromise()}class wE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await mE()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(n){if(e++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return uE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=aE._getInstance(uE()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new lE(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(this.sender&&this.activeServiceWorker&&function(){var t;return(null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await mE();return await vE(t,J_,"1"),await yE(t,J_),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>vE(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=gE(t,!1).get(e),i=await new pE(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>yE(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=gE(t,!1).getAll();return new pE(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;if(0!==t.length)for(const{fbase_key:i,value:s}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),e.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),e.push(i));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}wE.type="LOCAL";const bE=wE;function _E(t,e){return _b(t,"POST","/v2/accounts/mfaSignIn:start",bb(t,e))}g_("rcb"),new pb(3e4,6e4);const EE="recaptcha";async function AE(t,e,n){var i;if(!t._getRecaptchaConfig())try{await E_(t)}catch(s){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(s="string"===typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){ob("enroll"===e.type,t,"internal-error");const i={idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},r=__(t,i,"mfaSmsEnrollment",(async(t,e)=>{if(e.phoneEnrollmentInfo.captchaResponse===y_){ob((null===n||void 0===n?void 0:n.type)===EE,t,"argument-error");return Y_(t,await SE(t,e,n))}return Y_(t,e)}),"PHONE_PROVIDER");return(await r.catch((t=>Promise.reject(t)))).phoneSessionInfo.sessionInfo}{ob("signin"===e.type,t,"internal-error");const r=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;ob(r,t,"missing-multi-factor-info");const a={mfaPendingCredential:e.credential,mfaEnrollmentId:r,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=__(t,a,"mfaSmsSignIn",(async(t,e)=>{if(e.phoneSignInInfo.captchaResponse===y_){ob((null===n||void 0===n?void 0:n.type)===EE,t,"argument-error");return _E(t,await SE(t,e,n))}return _E(t,e)}),"PHONE_PROVIDER");return(await o.catch((t=>Promise.reject(t)))).phoneResponseInfo.sessionInfo}}{const e={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"},i=__(t,e,"sendVerificationCode",(async(t,e)=>{if(e.captchaResponse===y_){ob((null===n||void 0===n?void 0:n.type)===EE,t,"argument-error");return P_(t,await SE(t,e,n))}return P_(t,e)}),"PHONE_PROVIDER");return(await i.catch((t=>Promise.reject(t)))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function SE(t,e,n){ob(n.type===EE,t,"argument-error");const i=await n.verify();ob("string"===typeof i,t,"argument-error");const s=Object.assign({},e);if("phoneEnrollmentInfo"in s){const t=s.phoneEnrollmentInfo.phoneNumber,e=s.phoneEnrollmentInfo.captchaResponse,n=s.phoneEnrollmentInfo.clientType,r=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:t,recaptchaToken:i,captchaResponse:e,clientType:n,recaptchaVersion:r}}),s}if("phoneSignInInfo"in s){const t=s.phoneSignInInfo.captchaResponse,e=s.phoneSignInInfo.clientType,n=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:i,captchaResponse:t,clientType:e,recaptchaVersion:n}}),s}return Object.assign(s,{recaptchaToken:i}),s}class kE{constructor(t){this.providerId=kE.PROVIDER_ID,this.auth=h_(t)}verifyPhoneNumber(t,e){return AE(this.auth,t,by(e))}static credential(t,e){return D_._fromVerification(t,e)}static credentialFromResult(t){const e=t;return kE.credentialFromTaggedObject(e)}static credentialFromError(t){return kE.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e)return null;const{phoneNumber:n,temporaryProof:i}=e;return n&&i?D_._fromTokenResponse(n,i):null}}function CE(t,e){return e?qb(e):(ob(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}kE.PROVIDER_ID="phone",kE.PHONE_SIGN_IN_METHOD="phone";class TE extends C_{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return R_(t,this._buildIdpRequest())}_linkToIdToken(t,e){return R_(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return R_(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function xE(t){return Q_(t.auth,new TE(t),t.bypassAuthState)}function IE(t){const{auth:e,user:n}=t;return ob(n,e,"internal-error"),X_(n,new TE(t),t.bypassAuthState)}async function RE(t){const{auth:e,user:n}=t;return ob(n,e,"internal-error"),K_(n,new TE(t),t.bypassAuthState)}class ME{constructor(t,e,n,i){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:s,error:r,type:a}=t;if(r)return void this.reject(r);const o={auth:this.auth,requestUri:e,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(l){this.reject(l)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return xE;case"linkViaPopup":case"linkViaRedirect":return RE;case"reauthViaPopup":case"reauthViaRedirect":return IE;default:eb(this.auth,"internal-error")}}resolve(t){cb(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){cb(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const PE=new pb(2e3,1e4);class NE extends ME{constructor(t,e,n,i,s){super(t,e,i,s),this.provider=n,this.authWindow=null,this.pollId=null,NE.currentPopupAction&&NE.currentPopupAction.cancel(),NE.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return ob(t,this.auth,"internal-error"),t}async onExecution(){cb(1===this.filter.length,"Popup operations only handle one event");const t=oE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(nb(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(nb(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,NE.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(nb(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,PE.get())};t()}}NE.currentPopupAction=null;const DE=new Map;class LE extends ME{constructor(t,e){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let t=DE.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=UE(e),i=FE(t);if(!await i._isAvailable())return!1;const s="true"===await i._get(n);return await i._remove(n),s}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}DE.set(this.auth._key(),t)}return this.bypassAuthState||DE.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function OE(t,e){DE.set(t._key(),e)}function FE(t){return qb(t._redirectPersistence)}function UE(t){return Xb("pendingRedirect",t.config.apiKey,t.name)}async function BE(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Pw(t.app))return Promise.reject(sb(t));const i=h_(t),s=CE(i,e),r=new LE(i,s,n),a=await r.execute();return a&&!n&&(delete a.user._redirectEventId,await i._persistUserIfCurrent(a.user),await i._setRedirectUser(null,e)),a}class VE{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WE(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!WE(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(nb(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(jE(t))}saveEventToCache(t){this.cachedEventUids.add(jE(t)),this.lastProcessedEventTime=Date.now()}}function jE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function WE(t){let{type:e,error:n}=t;return"unknown"===e&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const zE=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HE=/^https?/;async function qE(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t){return _b(t,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(t);for(const i of e)try{if(GE(i))return}catch(n){}eb(t,"unauthorized-domain")}function GE(t){const e=ub(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return""===s.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===i}if(!HE.test(n))return!1;if(zE.test(t))return i===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const KE=new pb(3e4,6e4);function XE(){const t=cE().___jsl;if(null===t||void 0===t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}function QE(t){return new Promise(((e,n)=>{var i,s,r;function a(){XE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{XE(),n(nb(t,"network-request-failed"))},timeout:KE.get()})}if(null===(s=null===(i=cE().gapi)||void 0===i?void 0:i.iframes)||void 0===s?void 0:s.Iframe)e(gapi.iframes.getContext());else{if(!(null===(r=cE().gapi)||void 0===r?void 0:r.load)){const e=g_("iframefcb");return cE()[e]=()=>{gapi.load?a():n(nb(t,"network-request-failed"))},p_("".concat(f_.gapiScript,"?onload=").concat(e)).catch((t=>n(t)))}a()}})).catch((t=>{throw YE=null,t}))}let YE=null;const JE=new pb(5e3,15e3),$E={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ZE=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function tA(t){const e=t.config;ob(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?gb(e,"emulator/auth/iframe"):"https://".concat(t.config.authDomain,"/").concat("__/auth/iframe"),i={apiKey:e.apiKey,appName:t.name,v:Lw},s=ZE.get(t.config.apiHost);s&&(i.eid=s);const r=t._getFrameworks();return r.length&&(i.fw=r.join(",")),"".concat(n,"?").concat(gy(i).slice(1))}async function eA(t){const e=await function(t){return YE=YE||QE(t),YE}(t),n=cE().gapi;return ob(n,t,"internal-error"),e.open({where:document.body,url:tA(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$E,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const s=nb(t,"network-request-failed"),r=cE().setTimeout((()=>{i(s)}),JE.get());function a(){cE().clearTimeout(r),n(e)}e.ping(a).then(a,(()=>{i(s)}))}))))}const nA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class iA{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function sA(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const r=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let o="";const l=Object.assign(Object.assign({},nA),{width:i.toString(),height:s.toString(),top:r,left:a}),c=ay().toLowerCase();n&&(o=Zb(c)?"_blank":n),Jb(c)&&(e=e||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((t,e)=>{let[n,i]=e;return"".concat(t).concat(n,"=").concat(i,",")}),"");if(function(){var t;return s_(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ay())&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(c)&&"_self"!==o)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",o),new iA(null);const h=window.open(e||"",o,u);ob(h,t,"popup-blocked");try{h.focus()}catch(d){}return new iA(h)}const rA="__/auth/handler",aA="emulator/auth/handler",oA=encodeURIComponent("fac");async function lA(t,e,n,i,s,r){ob(t.config.authDomain,t,"auth-domain-config-required"),ob(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:Lw,eventId:s};if(e instanceof F_){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(r||{}))a[t]=e}if(e instanceof U_){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(a.scopes=t.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await t._getAppCheckToken(),c=l?"#".concat(oA,"=").concat(encodeURIComponent(l)):"";return"".concat(function(t){let{config:e}=t;if(!e.emulator)return"https://".concat(e.authDomain,"/").concat(rA);return gb(e,aA)}(t),"?").concat(gy(o).slice(1)).concat(c)}const cA="webStorageSupport";const uA=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rE,this._completeRedirectFn=BE,this._overrideRedirectResult=OE}async _openPopup(t,e,n,i){var s;cb(null===(s=this.eventManagers[t._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");return sA(t,await lA(t,e,n,ub(),i),oE())}async _openRedirect(t,e,n,i){await this._originValidation(t);return function(t){cE().location.href=t}(await lA(t,e,n,ub(),i)),new Promise((()=>{}))}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(cb(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await eA(t),n=new VE(t);return e.register("authEvent",(e=>{ob(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event");return{status:n.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(cA,{type:cA},(n=>{var i;const s=null===(i=null===n||void 0===n?void 0:n[0])||void 0===i?void 0:i[cA];void 0!==s&&e(!!s),eb(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=qE(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return a_()||$b()||s_()}};var hA="@firebase/auth",dA="1.10.7";class fA{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(t)}}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null===e||void 0===e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){ob(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const pA=Zv("authIdTokenMaxAge")||300;let gA=null;var mA;f_={loadJS:t=>new Promise(((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=nb("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",function(){var t,e;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},mA="Browser",Rw(new _y("auth",((t,e)=>{let{options:n}=e;const i=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=i.options;ob(a&&!a.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:a,authDomain:o,clientPlatform:mA,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:o_(mA)},c=new u_(i,s,r,l);return function(t,e){const n=(null===e||void 0===e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(qb);(null===e||void 0===e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null===e||void 0===e?void 0:e.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),Rw(new _y("auth-internal",(t=>(t=>new fA(t))(h_(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Uw(hA,dA,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(mA)),Uw(hA,dA,"esm2017");const vA=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fw();const e=Mw(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=Mw(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(fy(n.getOptions(),null!==e&&void 0!==e?e:{}))return t;eb(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:uA,persistence:[bE,tE,rE]}),i=Zv("authTokenSyncURL");if(i&&"boolean"===typeof isSecureContext&&isSecureContext){const t=new URL(i,location.origin);if(location.origin===t.origin){const e=(s=t.toString(),async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>pA)return;const i=null===e||void 0===e?void 0:e.token;gA!==i&&(gA=i,await fetch(s,{method:i?"POST":"DELETE",headers:i?{Authorization:"Bearer ".concat(i)}:{}}))});!function(t,e,n){by(t).beforeAuthStateChanged(e,n)}(n,e,(()=>e(n.currentUser))),function(t,e,n,i){by(t).onIdTokenChanged(e,n,i)}(n,(t=>e(t)))}}var s;const r=Jv("auth");return r&&A_(n,"http://".concat(r)),n}(Ow({apiKey:"AIzaSyAUG3zBqARq3FQ0EmooxgnTFGmlDFkp1Vc",authDomain:"joe-ai-42737.firebaseapp.com",projectId:"joe-ai-42737",storageBucket:"joe-ai-42737.appspot.com",messagingSenderId:"430692671237",appId:"1:430692671237:web:322e5728b7dc090ed4616c",measurementId:"G-JFS55QD5VS"})),yA=new V_;var wA,bA,_A="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},EA={};(function(){var t;function e(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(t,e,n){n||(n=0);var i=Array(16);if("string"===typeof e)for(var s=0;16>s;++s)i[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)i[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var r=t.g[3],a=e+(r^n&(s^r))+i[0]+3614090360&4294967295;a=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=n+(a<<7&4294967295|a>>>25))+((a=r+(s^e&(n^s))+i[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^r&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(e^s&(r^e))+i[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=e+(r^n&(s^r))+i[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=r+(s^e&(n^s))+i[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^r&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(e^s&(r^e))+i[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=e+(r^n&(s^r))+i[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=r+(s^e&(n^s))+i[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^r&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(e^s&(r^e))+i[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=e+(r^n&(s^r))+i[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=r+(s^e&(n^s))+i[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^r&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(e^s&(r^e))+i[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^r&(n^s))+i[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=r+(n^s&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=s+(e^n&(r^e))+i[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(r^e&(s^r))+i[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=e+(s^r&(n^s))+i[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=r+(n^s&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=s+(e^n&(r^e))+i[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(r^e&(s^r))+i[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=e+(s^r&(n^s))+i[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=r+(n^s&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=s+(e^n&(r^e))+i[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(r^e&(s^r))+i[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=e+(s^r&(n^s))+i[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=r+(n^s&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=s+(e^n&(r^e))+i[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(r^e&(s^r))+i[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=e+(n^s^r)+i[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=r+(e^n^s)+i[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=s+(r^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^r^e)+i[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=e+(n^s^r)+i[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=r+(e^n^s)+i[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=s+(r^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^r^e)+i[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=e+(n^s^r)+i[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=r+(e^n^s)+i[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=s+(r^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^r^e)+i[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=e+(n^s^r)+i[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=r+(e^n^s)+i[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=s+(r^e^n)+i[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^r^e)+i[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=e+(s^(n|~r))+i[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=r+(n^(e|~s))+i[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=s+(e^(r|~n))+i[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(r^(s|~e))+i[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=e+(s^(n|~r))+i[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=r+(n^(e|~s))+i[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=s+(e^(r|~n))+i[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(r^(s|~e))+i[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=e+(s^(n|~r))+i[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=r+(n^(e|~s))+i[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=s+(e^(r|~n))+i[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(r^(s|~e))+i[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((r=(e=n+((a=e+(s^(n|~r))+i[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=r+(n^(e|~s))+i[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((s=r+((a=s+(e^(r|~n))+i[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(a<<21&4294967295|a>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+r&4294967295}function i(t,e){this.h=e;for(var n=[],i=!0,s=t.length-1;0<=s;s--){var r=0|t[s];i&&r==e||(n[s]=r,i=!1)}this.g=n}!function(t,e){function n(){}n.prototype=e.prototype,t.D=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.C=function(t,n,i){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return e.prototype[n].apply(t,s)}}(e,(function(){this.blockSize=-1})),e.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},e.prototype.u=function(t,e){void 0===e&&(e=t.length);for(var i=e-this.blockSize,s=this.B,r=this.h,a=0;a<e;){if(0==r)for(;a<=i;)n(this,t,a),a+=this.blockSize;if("string"===typeof t){for(;a<e;)if(s[r++]=t.charCodeAt(a++),r==this.blockSize){n(this,s),r=0;break}}else for(;a<e;)if(s[r++]=t[a++],r==this.blockSize){n(this,s),r=0;break}}this.h=r,this.o+=e},e.prototype.v=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.o;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.u(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var s={};function r(t){return-128<=t&&128>t?function(t,e){var n=s;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(t){return new i([0|t],0>t?-1:0)})):new i([0|t],0>t?-1:0)}function a(t){if(isNaN(t)||!isFinite(t))return o;if(0>t)return d(a(-t));for(var e=[],n=1,s=0;t>=n;s++)e[s]=t/n|0,n*=4294967296;return new i(e,0)}var o=r(0),l=r(1),c=r(16777216);function u(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function h(t){return-1==t.h}function d(t){for(var e=t.g.length,n=[],s=0;s<e;s++)n[s]=~t.g[s];return new i(n,~t.h).add(l)}function f(t,e){return t.add(d(e))}function p(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function g(t,e){this.g=t,this.h=e}function m(t,e){if(u(e))throw Error("division by zero");if(u(t))return new g(o,o);if(h(t))return e=m(d(t),e),new g(d(e.g),d(e.h));if(h(e))return e=m(t,d(e)),new g(d(e.g),e.h);if(30<t.g.length){if(h(t)||h(e))throw Error("slowDivide_ only works with positive integers.");for(var n=l,i=e;0>=i.l(t);)n=v(n),i=v(i);var s=y(n,1),r=y(i,1);for(i=y(i,2),n=y(n,2);!u(i);){var c=r.add(i);0>=c.l(t)&&(s=s.add(n),r=c),i=y(i,1),n=y(n,1)}return e=f(t,s.j(e)),new g(s,e)}for(s=o;0<=t.l(e);){for(n=Math.max(1,Math.floor(t.m()/e.m())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),c=(r=a(n)).j(e);h(c)||0<c.l(t);)c=(r=a(n-=i)).j(e);u(r)&&(r=l),s=s.add(r),t=f(t,c)}return new g(s,t)}function v(t){for(var e=t.g.length+1,n=[],s=0;s<e;s++)n[s]=t.i(s)<<1|t.i(s-1)>>>31;return new i(n,t.h)}function y(t,e){var n=e>>5;e%=32;for(var s=t.g.length-n,r=[],a=0;a<s;a++)r[a]=0<e?t.i(a+n)>>>e|t.i(a+n+1)<<32-e:t.i(a+n);return new i(r,t.h)}(t=i.prototype).m=function(){if(h(this))return-d(this).m();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.i(n);t+=(0<=i?i:4294967296+i)*e,e*=4294967296}return t},t.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(u(this))return"0";if(h(this))return"-"+d(this).toString(t);for(var e=a(Math.pow(t,6)),n=this,i="";;){var s=m(n,e).g,r=((0<(n=f(n,s.j(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(u(n=s))return r+i;for(;6>r.length;)r="0"+r;i=r+i}},t.i=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},t.l=function(t){return h(t=f(this,t))?-1:u(t)?0:1},t.abs=function(){return h(this)?d(this):this},t.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],s=0,r=0;r<=e;r++){var a=s+(65535&this.i(r))+(65535&t.i(r)),o=(a>>>16)+(this.i(r)>>>16)+(t.i(r)>>>16);s=o>>>16,a&=65535,o&=65535,n[r]=o<<16|a}return new i(n,-2147483648&n[n.length-1]?-1:0)},t.j=function(t){if(u(this)||u(t))return o;if(h(this))return h(t)?d(this).j(d(t)):d(d(this).j(t));if(h(t))return d(this.j(d(t)));if(0>this.l(c)&&0>t.l(c))return a(this.m()*t.m());for(var e=this.g.length+t.g.length,n=[],s=0;s<2*e;s++)n[s]=0;for(s=0;s<this.g.length;s++)for(var r=0;r<t.g.length;r++){var l=this.i(s)>>>16,f=65535&this.i(s),g=t.i(r)>>>16,m=65535&t.i(r);n[2*s+2*r]+=f*m,p(n,2*s+2*r),n[2*s+2*r+1]+=l*m,p(n,2*s+2*r+1),n[2*s+2*r+1]+=f*g,p(n,2*s+2*r+1),n[2*s+2*r+2]+=l*g,p(n,2*s+2*r+2)}for(s=0;s<e;s++)n[s]=n[2*s+1]<<16|n[2*s];for(s=e;s<2*e;s++)n[s]=0;return new i(n,0)},t.A=function(t){return m(this,t).h},t.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],s=0;s<e;s++)n[s]=this.i(s)&t.i(s);return new i(n,this.h&t.h)},t.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],s=0;s<e;s++)n[s]=this.i(s)|t.i(s);return new i(n,this.h|t.h)},t.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],s=0;s<e;s++)n[s]=this.i(s)^t.i(s);return new i(n,this.h^t.h)},e.prototype.digest=e.prototype.v,e.prototype.reset=e.prototype.s,e.prototype.update=e.prototype.u,bA=EA.Md5=e,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=a,i.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return d(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=a(Math.pow(n,8)),s=o,r=0;r<e.length;r+=8){var l=Math.min(8,e.length-r),c=parseInt(e.substring(r,r+l),n);8>l?(l=a(Math.pow(n,l)),s=s.j(l).add(a(c))):s=(s=s.j(i)).add(a(c))}return s},wA=EA.Integer=i}).apply("undefined"!==typeof _A?_A:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var AA,SA,kA,CA,TA,xA,IA,RA,MA="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},PA={};(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t};var n=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof MA&&MA];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(t,i){if(i)t:{var s=n;t=t.split(".");for(var r=0;r<t.length-1;r++){var a=t[r];if(!(a in s))break t;s=s[a]}(i=i(r=s[t=t[t.length-1]]))!=r&&null!=i&&e(s,t,{configurable:!0,writable:!0,value:i})}}("Array.prototype.values",(function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var n=0,i=!1,s={next:function(){if(!i&&n<t.length){var s=n++;return{value:e(s,t[s]),done:!1}}return i=!0,{done:!0,value:void 0}}};return s[Symbol.iterator]=function(){return s},s}(this,(function(t,e){return e}))}}));var i=i||{},s=this||self;function r(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function a(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function o(t,e,n){return t.call.apply(t.bind,arguments)}function l(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function c(t,e,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function h(t,e){function n(){}n.prototype=e.prototype,t.aa=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Qb=function(t,n,i){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return e.prototype[n].apply(t,s)}}function d(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function f(t,e){for(let n=1;n<arguments.length;n++){const e=arguments[n];if(r(e)){const n=t.length||0,i=e.length||0;t.length=n+i;for(let s=0;s<i;s++)t[n+s]=e[s]}else t.push(e)}}function p(t){return/^[\s\xa0]*$/.test(t)}function g(){var t=s.navigator;return t&&(t=t.userAgent)?t:""}function m(t){return m[" "](t),t}m[" "]=function(){};var v=-1!=g().indexOf("Gecko")&&!(-1!=g().toLowerCase().indexOf("webkit")&&-1==g().indexOf("Edge"))&&!(-1!=g().indexOf("Trident")||-1!=g().indexOf("MSIE"))&&-1==g().indexOf("Edge");function y(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function w(t){const e={};for(const n in t)e[n]=t[n];return e}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(t,e){let n,i;for(let s=1;s<arguments.length;s++){for(n in i=arguments[s],i)t[n]=i[n];for(let e=0;e<b.length;e++)n=b[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function E(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function A(t){s.setTimeout((()=>{throw t}),0)}function S(){var t=I;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var k=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new C),(t=>t.reset()));class C{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}let T,x=!1,I=new class{constructor(){this.h=this.g=null}add(t,e){const n=k.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},R=()=>{const t=s.Promise.resolve(void 0);T=()=>{t.then(M)}};var M=()=>{for(var t;t=S();){try{t.h.call(t.g)}catch(n){A(n)}var e=k;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}x=!1};function P(){this.s=this.s,this.C=this.C}function N(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}P.prototype.s=!1,P.prototype.ma=function(){this.s||(this.s=!0,this.N())},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},N.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};s.addEventListener("test",t,e),s.removeEventListener("test",t,e)}catch(n){}return t}();function L(t,e){if(N.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(v){t:{try{m(e.nodeName);var s=!0;break t}catch(r){}s=!1}s||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:O[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&L.aa.h.call(this)}}h(L,N);var O={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var F="closure_listenable_"+(1e6*Math.random()|0),U=0;function B(t,e,n,i,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ha=s,this.key=++U,this.da=this.fa=!1}function V(t){t.da=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function j(t){this.src=t,this.g={},this.h=0}function W(t,e){var n=e.type;if(n in t.g){var i,s=t.g[n],r=Array.prototype.indexOf.call(s,e,void 0);(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(V(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function z(t,e,n,i){for(var s=0;s<t.length;++s){var r=t[s];if(!r.da&&r.listener==e&&r.capture==!!n&&r.ha==i)return s}return-1}j.prototype.add=function(t,e,n,i,s){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var a=z(t,e,i,s);return-1<a?(e=t[a],n||(e.fa=!1)):((e=new B(e,this.src,r,!!i,s)).fa=n,t.push(e)),e};var H="closure_lm_"+(1e6*Math.random()|0),q={};function G(t,e,n,i,s){if(i&&i.once)return X(t,e,n,i,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)G(t,e[r],n,i,s);return null}return n=et(n),t&&t[F]?t.K(e,n,a(i)?!!i.capture:!!i,s):K(t,e,n,!1,i,s)}function K(t,e,n,i,s,r){if(!e)throw Error("Invalid event type");var o=a(s)?!!s.capture:!!s,l=Z(t);if(l||(t[H]=l=new j(t)),(n=l.add(e,n,i,o,r)).proxy)return n;if(i=function(){function t(n){return e.call(t.src,t.listener,n)}const e=$;return t}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)D||(s=o),void 0===s&&(s=!1),t.addEventListener(e.toString(),i,s);else if(t.attachEvent)t.attachEvent(J(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function X(t,e,n,i,s){if(Array.isArray(e)){for(var r=0;r<e.length;r++)X(t,e[r],n,i,s);return null}return n=et(n),t&&t[F]?t.L(e,n,a(i)?!!i.capture:!!i,s):K(t,e,n,!0,i,s)}function Q(t,e,n,i,s){if(Array.isArray(e))for(var r=0;r<e.length;r++)Q(t,e[r],n,i,s);else i=a(i)?!!i.capture:!!i,n=et(n),t&&t[F]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=z(r=t.g[e],n,i,s))&&(V(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[e],t.h--)))):t&&(t=Z(t))&&(e=t.g[e.toString()],t=-1,e&&(t=z(e,n,i,s)),(n=-1<t?e[t]:null)&&Y(n))}function Y(t){if("number"!==typeof t&&t&&!t.da){var e=t.src;if(e&&e[F])W(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(J(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Z(e))?(W(n,t),0==n.h&&(n.src=null,e[H]=null)):V(t)}}}function J(t){return t in q?q[t]:q[t]="on"+t}function $(t,e){if(t.da)t=!0;else{e=new L(e,this);var n=t.listener,i=t.ha||t.src;t.fa&&Y(t),t=n.call(i,e)}return t}function Z(t){return(t=t[H])instanceof j?t:null}var tt="__closure_events_fn_"+(1e9*Math.random()>>>0);function et(t){return"function"===typeof t?t:(t[tt]||(t[tt]=function(e){return t.handleEvent(e)}),t[tt])}function nt(){P.call(this),this.i=new j(this),this.M=this,this.F=null}function it(t,e){var n,i=t.F;if(i)for(n=[];i;i=i.F)n.push(i);if(t=t.M,i=e.type||e,"string"===typeof e)e=new N(e,t);else if(e instanceof N)e.target=e.target||t;else{var s=e;_(e=new N(i,t),s)}if(s=!0,n)for(var r=n.length-1;0<=r;r--){var a=e.g=n[r];s=st(a,i,!0,e)&&s}if(s=st(a=e.g=t,i,!0,e)&&s,s=st(a,i,!1,e)&&s,n)for(r=0;r<n.length;r++)s=st(a=e.g=n[r],i,!1,e)&&s}function st(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var a=e[r];if(a&&!a.da&&a.capture==n){var o=a.listener,l=a.ha||a.src;a.fa&&W(t.i,a),s=!1!==o.call(l,i)&&s}}return s&&!i.defaultPrevented}function rt(t,e,n){if("function"===typeof t)n&&(t=c(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=c(t.handleEvent,t)}return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function at(t){t.g=rt((()=>{t.g=null,t.i&&(t.i=!1,at(t))}),t.l);const e=t.h;t.h=null,t.m.apply(null,e)}h(nt,P),nt.prototype[F]=!0,nt.prototype.removeEventListener=function(t,e,n,i){Q(this,t,e,n,i)},nt.prototype.N=function(){if(nt.aa.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)V(n[i]);delete e.g[t],e.h--}}this.F=null},nt.prototype.K=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},nt.prototype.L=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};class ot extends P{constructor(t,e){super(),this.m=t,this.l=e,this.h=null,this.i=!1,this.g=null}j(t){this.h=arguments,this.g?this.i=!0:at(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function lt(t){P.call(this),this.h=t,this.g={}}h(lt,P);var ct=[];function ut(t){y(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Y(t)}),t),t.g={}}lt.prototype.N=function(){lt.aa.N.call(this),ut(this)},lt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ht=s.JSON.stringify,dt=s.JSON.parse,ft=class{stringify(t){return s.JSON.stringify(t,void 0)}parse(t){return s.JSON.parse(t,void 0)}};function pt(){}function gt(t){return t.h||(t.h=t.i())}function mt(){}pt.prototype.h=null;var vt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function yt(){N.call(this,"d")}function wt(){N.call(this,"c")}h(yt,N),h(wt,N);var bt={},_t=null;function Et(){return _t=_t||new nt}function At(t){N.call(this,bt.La,t)}function St(t){const e=Et();it(e,new At(e))}function kt(t,e){N.call(this,bt.STAT_EVENT,t),this.stat=e}function Ct(t){const e=Et();it(e,new kt(e,t))}function Tt(t,e){N.call(this,bt.Ma,t),this.size=e}function xt(t,e){if("function"!==typeof t)throw Error("Fn must not be null and must be a function");return s.setTimeout((function(){t()}),e)}function It(){this.g=!0}function Rt(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var a=1;a<s.length;a++)s[a]=""}}}return ht(n)}catch(o){return e}}(t,n)+(i?" "+i:"")}))}bt.La="serverreachability",h(At,N),bt.STAT_EVENT="statevent",h(kt,N),bt.Ma="timingevent",h(Tt,N),It.prototype.xa=function(){this.g=!1},It.prototype.info=function(){};var Mt,Pt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Nt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Dt(){}function Lt(t,e,n,i){this.j=t,this.i=e,this.l=n,this.R=i||1,this.U=new lt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ot}function Ot(){this.i=null,this.g="",this.h=!1}h(Dt,pt),Dt.prototype.g=function(){return new XMLHttpRequest},Dt.prototype.i=function(){return{}},Mt=new Dt;var Ft={},Ut={};function Bt(t,e,n){t.L=1,t.v=he(ae(e)),t.m=n,t.P=!0,Vt(t,null)}function Vt(t,e){t.F=Date.now(),zt(t),t.A=ae(t.v);var n=t.A,i=t.R;Array.isArray(i)||(i=[String(i)]),ke(n.i,"t",i),t.C=0,n=t.j.J,t.h=new Ot,t.g=fn(t.j,n?e:null,!t.m),0<t.O&&(t.M=new ot(c(t.Y,t,t.g),t.O)),e=t.U,n=t.g,i=t.ca;var s="readystatechange";Array.isArray(s)||(s&&(ct[0]=s.toString()),s=ct);for(var r=0;r<s.length;r++){var a=G(n,s[r],i||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}e=t.H?w(t.H):{},t.m?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.m,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),St(),function(t,e,n,i,s,r){t.info((function(){if(t.g)if(r)for(var a="",o=r.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");a=2<=h.length&&"type"==h[1]?a+(u+"=")+c+"&":a+(u+"=redacted&")}}else a=null;else a=r;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+e+"\n"+n+"\n"+a}))}(t.i,t.u,t.A,t.l,t.R,t.m)}function jt(t){return!!t.g&&("GET"==t.u&&2!=t.L&&t.j.Ca)}function Wt(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?Ut:(n=Number(e.substring(n,i)),isNaN(n)?Ft:(i+=1)+n>e.length?Ut:(e=e.slice(i,i+n),t.C=i+n,e))}function zt(t){t.S=Date.now()+t.I,Ht(t,t.I)}function Ht(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=xt(c(t.ba,t),e)}function qt(t){t.B&&(s.clearTimeout(t.B),t.B=null)}function Gt(t){0==t.j.G||t.J||ln(t.j,t)}function Kt(t){qt(t);var e=t.M;e&&"function"==typeof e.ma&&e.ma(),t.M=null,ut(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.ma())}function Xt(t,e){try{var n=t.j;if(0!=n.G&&(n.g==t||Zt(n.h,t)))if(!t.K&&Zt(n.h,t)&&3==n.G){try{var i=n.Da.g.parse(e)}catch(u){i=null}if(Array.isArray(i)&&3==i.length){var s=i;if(0==s[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;on(n),Ye(n)}sn(n),Ct(18)}}else n.za=s[1],0<n.za-n.T&&37500>s[2]&&n.F&&0==n.v&&!n.C&&(n.C=xt(c(n.Za,n),6e3));if(1>=$t(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else un(n,11)}else if((t.K||n.g==t)&&on(n),!p(e))for(s=n.Da.g.parse(e),e=0;e<s.length;e++){let c=s[e];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const e=c[3];null!=e&&(n.la=e,n.j.info("VER="+n.la));const s=c[4];null!=s&&(n.Aa=s,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(i=1.5*u,n.L=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=i.h;r.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(te(r,r.h),r.h=null))}if(i.D){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.ya=t,ue(i.I,i.D,t))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-t.F,n.j.info("Handshake RTT: "+n.R+"ms"));var a=t;if((i=n).qa=dn(i,i.J?i.ia:null,i.W),a.K){ee(i.h,a);var o=a,l=i.L;l&&(o.I=l),o.B&&(qt(o),zt(o)),i.g=a}else nn(i);0<n.i.length&&$e(n)}else"stop"!=c[0]&&"close"!=c[0]||un(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?un(n,7):Qe(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}St()}catch(u){}}Lt.prototype.ca=function(t){t=t.target;const e=this.M;e&&3==qe(t)?e.j():this.Y(t)},Lt.prototype.Y=function(t){try{if(t==this.g)t:{const d=qe(this.g);var e=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||Ge(this.g)))){this.J||4!=d||7==e||St(),qt(this);var n=this.g.Z();this.X=n;e:if(jt(this)){var i=Ge(this.g);t="";var r=i.length,a=4==qe(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Kt(this),Gt(this);var o="";break e}this.h.i=new s.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:!(a&&e==r-1)});i.length=0,this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(t,e,n,i,s,r,a){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+e+"\n"+n+"\n"+r+" "+a}))}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){e:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break e}}u=null}if(!(n=u)){this.o=!1,this.s=3,Ct(12),Kt(this),Gt(this);break t}Rt(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xt(this,n)}if(this.P){let t;for(n=!0;!this.J&&this.C<o.length;){if(t=Wt(this,o),t==Ut){4==d&&(this.s=4,Ct(14),n=!1),Rt(this.i,this.l,null,"[Incomplete Response]");break}if(t==Ft){this.s=4,Ct(15),Rt(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Rt(this.i,this.l,t,null),Xt(this,t)}if(jt(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=o.length||this.h.h||(this.s=1,Ct(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),rn(h),h.M=!0,Ct(11))}}else Rt(this.i,this.l,o,"[Invalid Chunked Response]"),Kt(this),Gt(this)}else Rt(this.i,this.l,o,null),Xt(this,o);4==d&&Kt(this),this.o&&!this.J&&(4==d?ln(this.j,this):(this.o=!1,zt(this)))}else(function(t){const e={};t=(t.g&&2<=qe(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if(p(t[i]))continue;var n=E(t[i]);const s=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const r=e[s]||[];e[s]=r,r.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Ct(12)):(this.s=0,Ct(13)),Kt(this),Gt(this)}}}catch(d){}},Lt.prototype.cancel=function(){this.J=!0,Kt(this)},Lt.prototype.ba=function(){this.B=null;const t=Date.now();0<=t-this.S?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.i,this.A),2!=this.L&&(St(),Ct(17)),Kt(this),this.s=2,Gt(this)):Ht(this,this.S-t)};var Qt=class{constructor(t,e){this.g=t,this.map=e}};function Yt(t){this.l=t||10,s.PerformanceNavigationTiming?t=0<(t=s.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Jt(t){return!!t.h||!!t.g&&t.g.size>=t.j}function $t(t){return t.h?1:t.g?t.g.size:0}function Zt(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function te(t,e){t.g?t.g.add(e):t.h=e}function ee(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ne(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return d(t.i)}function ie(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(r(t)||"string"===typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.na&&"function"==typeof t.na)return t.na();if(!t.V||"function"!=typeof t.V){if("undefined"!==typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!==typeof Set&&t instanceof Set)){if(r(t)||"string"===typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.V&&"function"==typeof t.V)return t.V();if("undefined"!==typeof Map&&t instanceof Map||"undefined"!==typeof Set&&t instanceof Set)return Array.from(t.values());if("string"===typeof t)return t.split("");if(r(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),s=i.length,a=0;a<s;a++)e.call(void 0,i[a],n&&n[a],t)}Yt.prototype.cancel=function(){if(this.i=ne(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var se=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function re(t){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,t instanceof re){this.h=t.h,oe(this,t.j),this.o=t.o,this.g=t.g,le(this,t.s),this.l=t.l;var e=t.i,n=new _e;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),ce(this,n),this.m=t.m}else t&&(e=String(t).match(se))?(this.h=!1,oe(this,e[1]||"",!0),this.o=de(e[2]||""),this.g=de(e[3]||"",!0),le(this,e[4]),this.l=de(e[5]||"",!0),ce(this,e[6]||"",!0),this.m=de(e[7]||"")):(this.h=!1,this.i=new _e(null,this.h))}function ae(t){return new re(t)}function oe(t,e,n){t.j=n?de(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function le(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.s=e}else t.s=null}function ce(t,e,n){e instanceof _e?(t.i=e,function(t,e){e&&!t.j&&(Ee(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Ae(this,e),ke(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=fe(e,we)),t.i=new _e(e,t.h))}function ue(t,e,n){t.i.set(e,n)}function he(t){return ue(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function de(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function fe(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,pe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function pe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}re.prototype.toString=function(){var t=[],e=this.j;e&&t.push(fe(e,me,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.o)&&t.push(fe(e,me,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(fe(n,"/"==n.charAt(0)?ye:ve,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.m)&&t.push("#",fe(n,be)),t.join("")};var ge,me=/[#\/\?@]/g,ve=/[#\?:]/g,ye=/[#\?]/g,we=/[#\?@]/g,be=/#/g;function _e(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ee(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),s=null;if(0<=i){var r=t[n].substring(0,i);s=t[n].substring(i+1)}else r=t[n];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Ae(t,e){Ee(t),e=Ce(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Se(t,e){return Ee(t),e=Ce(t,e),t.g.has(e)}function ke(t,e,n){Ae(t,e),0<n.length&&(t.i=null,t.g.set(Ce(t,e),d(n)),t.h+=n.length)}function Ce(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Te(t,e,n,i,s){try{s&&(s.onload=null,s.onerror=null,s.onabort=null,s.ontimeout=null),i(n)}catch(r){}}function xe(){this.g=new ft}function Ie(t,e,n){const i=n||"";try{ie(t,(function(t,n){let s=t;a(t)&&(s=ht(t)),e.push(i+n+"="+encodeURIComponent(s))}))}catch(s){throw e.push(i+"type="+encodeURIComponent("_badmap")),s}}function Re(t){this.l=t.Ub||null,this.j=t.eb||!1}function Me(t,e){nt.call(this),this.D=t,this.o=e,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Pe(t){t.j.read().then(t.Pa.bind(t)).catch(t.ga.bind(t))}function Ne(t){t.readyState=4,t.l=null,t.j=null,t.v=null,De(t)}function De(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Le(t){let e="";return y(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Oe(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=Le(n),"string"===typeof t?null!=n&&encodeURIComponent(String(n)):ue(t,e,n))}function Fe(t){nt.call(this),this.headers=new Map,this.o=t||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(t=_e.prototype).add=function(t,e){Ee(this),this.i=null,t=Ce(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},t.forEach=function(t,e){Ee(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},t.na=function(){Ee(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const s=t[i];for(let t=0;t<s.length;t++)n.push(e[i])}return n},t.V=function(t){Ee(this);let e=[];if("string"===typeof t)Se(this,t)&&(e=e.concat(this.g.get(Ce(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},t.set=function(t,e){return Ee(this),this.i=null,Se(this,t=Ce(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const r=encodeURIComponent(String(i)),a=this.V(i);for(i=0;i<a.length;i++){var s=r;""!==a[i]&&(s+="="+encodeURIComponent(String(a[i]))),t.push(s)}}return this.i=t.join("&")},h(Re,pt),Re.prototype.g=function(){return new Me(this.l,this.j)},Re.prototype.i=(ge={},function(){return ge}),h(Me,nt),(t=Me.prototype).open=function(t,e){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=t,this.A=e,this.readyState=1,De(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.u,method:this.B,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||s).fetch(new Request(this.A,e)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ne(this)),this.readyState=0},t.Sa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,De(this)),this.g&&(this.readyState=3,De(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof s.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Pe(this)}else t.text().then(this.Ra.bind(this),this.ga.bind(this))},t.Pa=function(t){if(this.g){if(this.o&&t.value)this.response.push(t.value);else if(!this.o){var e=t.value?t.value:new Uint8Array(0);(e=this.v.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ne(this):De(this),3==this.readyState&&Pe(this)}},t.Ra=function(t){this.g&&(this.response=this.responseText=t,Ne(this))},t.Qa=function(t){this.g&&(this.response=t,Ne(this))},t.ga=function(){this.g&&Ne(this)},t.setRequestHeader=function(t,e){this.u.append(t,e)},t.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Me.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}}),h(Fe,nt);var Ue=/^https?$/i,Be=["POST","PUT"];function Ve(t,e){t.h=!1,t.g&&(t.j=!0,t.g.abort(),t.j=!1),t.l=e,t.m=5,je(t),ze(t)}function je(t){t.A||(t.A=!0,it(t,"complete"),it(t,"error"))}function We(t){if(t.h&&"undefined"!=typeof i&&(!t.v[1]||4!=qe(t)||2!=t.Z()))if(t.u&&4==qe(t))rt(t.Ea,0,t);else if(it(t,"readystatechange"),4==qe(t)){t.h=!1;try{const i=t.Z();t:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var r;if(r=0===i){var a=String(t.D).match(se)[1]||null;!a&&s.self&&s.self.location&&(a=s.self.location.protocol.slice(0,-1)),r=!Ue.test(a?a.toLowerCase():"")}n=r}if(n)it(t,"complete"),it(t,"success");else{t.m=6;try{var o=2<qe(t)?t.g.statusText:""}catch(l){o=""}t.l=o+" ["+t.Z()+"]",je(t)}}finally{ze(t)}}}function ze(t,e){if(t.g){He(t);const i=t.g,s=t.v[0]?()=>{}:null;t.g=null,t.v=null,e||it(t,"ready");try{i.onreadystatechange=s}catch(n){}}}function He(t){t.I&&(s.clearTimeout(t.I),t.I=null)}function qe(t){return t.g?t.g.readyState:0}function Ge(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.H){case"":case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Ke(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xe(t){this.Aa=0,this.i=[],this.j=new It,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ke("failFast",!1,t),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ke("baseRetryDelayMs",5e3,t),this.cb=Ke("retryDelaySeedMs",1e4,t),this.Wa=Ke("forwardChannelMaxRetries",2,t),this.wa=Ke("forwardChannelRequestTimeoutMs",2e4,t),this.pa=t&&t.xmlHttpFactory||void 0,this.Xa=t&&t.Tb||void 0,this.Ca=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.h=new Yt(t&&t.concurrentRequestLimit),this.Da=new xe,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=t&&t.Rb||!1,t&&t.xa&&this.j.xa(),t&&t.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&t&&t.detectBufferingProxy||!1,this.ja=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.ja=t.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qe(t){if(Je(t),3==t.G){var e=t.U++,n=ae(t.I);if(ue(n,"SID",t.K),ue(n,"RID",e),ue(n,"TYPE","terminate"),tn(t,n),(e=new Lt(t,t.j,e)).L=2,e.v=he(ae(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(e.v.toString(),"")}catch(i){}!n&&s.Image&&((new Image).src=e.v,n=!0),n||(e.g=fn(e.j,null),e.g.ea(e.v)),e.F=Date.now(),zt(e)}hn(t)}function Ye(t){t.g&&(rn(t),t.g.cancel(),t.g=null)}function Je(t){Ye(t),t.u&&(s.clearTimeout(t.u),t.u=null),on(t),t.h.cancel(),t.s&&("number"===typeof t.s&&s.clearTimeout(t.s),t.s=null)}function $e(t){if(!Jt(t.h)&&!t.s){t.s=!0;var e=t.Ga;T||R(),x||(T(),x=!0),I.add(e,t),t.B=0}}function Ze(t,e){var n;n=e?e.l:t.U++;const i=ae(t.I);ue(i,"SID",t.K),ue(i,"RID",n),ue(i,"AID",t.T),tn(t,i),t.m&&t.o&&Oe(i,t.m,t.o),n=new Lt(t,t.j,n,t.B+1),null===t.m&&(n.H=t.o),e&&(t.i=e.D.concat(t.i)),e=en(t,n,1e3),n.I=Math.round(.5*t.wa)+Math.round(.5*t.wa*Math.random()),te(t.h,n),Bt(n,i,e)}function tn(t,e){t.H&&y(t.H,(function(t,n){ue(e,n,t)})),t.l&&ie({},(function(t,n){ue(e,n,t)}))}function en(t,e,n){n=Math.min(t.i.length,n);var i=t.l?c(t.l.Na,t.l,t):null;t:{var s=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=s[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let a=!0;for(let o=0;o<n;o++){let n=s[o].g;const l=s[o].map;if(n-=e,0>n)e=Math.max(0,s[o].g-100),a=!1;else try{Ie(l,t,"req"+n+"_")}catch(r){i&&i(l)}}if(a){i=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,i}function nn(t){if(!t.g&&!t.u){t.Y=1;var e=t.Fa;T||R(),x||(T(),x=!0),I.add(e,t),t.v=0}}function sn(t){return!(t.g||t.u||3<=t.v)&&(t.Y++,t.u=xt(c(t.Fa,t),cn(t,t.v)),t.v++,!0)}function rn(t){null!=t.A&&(s.clearTimeout(t.A),t.A=null)}function an(t){t.g=new Lt(t,t.j,"rpc",t.Y),null===t.m&&(t.g.H=t.o),t.g.O=0;var e=ae(t.qa);ue(e,"RID","rpc"),ue(e,"SID",t.K),ue(e,"AID",t.T),ue(e,"CI",t.F?"0":"1"),!t.F&&t.ja&&ue(e,"TO",t.ja),ue(e,"TYPE","xmlhttp"),tn(t,e),t.m&&t.o&&Oe(e,t.m,t.o),t.L&&(t.g.I=t.L);var n=t.g;t=t.ia,n.L=1,n.v=he(ae(e)),n.m=null,n.P=!0,Vt(n,t)}function on(t){null!=t.C&&(s.clearTimeout(t.C),t.C=null)}function ln(t,e){var n=null;if(t.g==e){on(t),rn(t),t.g=null;var i=2}else{if(!Zt(t.h,e))return;n=e.D,ee(t.h,e),i=1}if(0!=t.G)if(e.o)if(1==i){n=e.m?e.m.length:0,e=Date.now()-e.F;var s=t.B;it(i=Et(),new Tt(i,n)),$e(t)}else nn(t);else if(3==(s=e.s)||0==s&&0<e.X||!(1==i&&function(t,e){return!($t(t.h)>=t.h.j-(t.s?1:0))&&(t.s?(t.i=e.D.concat(t.i),!0):!(1==t.G||2==t.G||t.B>=(t.Va?0:t.Wa))&&(t.s=xt(c(t.Ga,t,e),cn(t,t.B)),t.B++,!0))}(t,e)||2==i&&sn(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),s){case 1:un(t,5);break;case 4:un(t,10);break;case 3:un(t,6);break;default:un(t,2)}}function cn(t,e){let n=t.Ta+Math.floor(Math.random()*t.cb);return t.isActive()||(n*=2),n*e}function un(t,e){if(t.j.info("Error code "+e),2==e){var n=c(t.fb,t),i=t.Xa;const e=!i;i=new re(i||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||oe(i,"https"),he(i),e?function(t,e){const n=new It;if(s.Image){const i=new Image;i.onload=u(Te,n,"TestLoadImage: loaded",!0,e,i),i.onerror=u(Te,n,"TestLoadImage: error",!1,e,i),i.onabort=u(Te,n,"TestLoadImage: abort",!1,e,i),i.ontimeout=u(Te,n,"TestLoadImage: timeout",!1,e,i),s.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(i.toString(),n):function(t,e){new It;const n=new AbortController,i=setTimeout((()=>{n.abort(),Te(0,0,!1,e)}),1e4);fetch(t,{signal:n.signal}).then((t=>{clearTimeout(i),t.ok?Te(0,0,!0,e):Te(0,0,!1,e)})).catch((()=>{clearTimeout(i),Te(0,0,!1,e)}))}(i.toString(),n)}else Ct(2);t.G=0,t.l&&t.l.sa(e),hn(t),Je(t)}function hn(t){if(t.G=0,t.ka=[],t.l){const e=ne(t.h);0==e.length&&0==t.i.length||(f(t.ka,e),f(t.ka,t.i),t.h.i.length=0,d(t.i),t.i.length=0),t.l.ra()}}function dn(t,e,n){var i=n instanceof re?ae(n):new re(n);if(""!=i.g)e&&(i.g=e+"."+i.g),le(i,i.s);else{var r=s.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var a=new re(null);i&&oe(a,i),e&&(a.g=e),r&&le(a,r),n&&(a.l=n),i=a}return n=t.D,e=t.ya,n&&e&&ue(i,n,e),ue(i,"VER",t.la),tn(t,i),i}function fn(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ca&&!t.pa?new Fe(new Re({eb:n})):new Fe(t.pa)).Ha(t.J),e}function pn(){}function gn(){}function mn(t,e){nt.call(this),this.g=new Xe(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.o=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.va&&(t?t["X-WebChannel-Client-Profile"]=e.va:t={"X-WebChannel-Client-Profile":e.va}),this.g.S=t,(t=e&&e.Sb)&&!p(t)&&(this.g.m=t),this.v=e&&e.supportsCrossDomainXhr||!1,this.u=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!p(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new wn(this)}function vn(t){yt.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function yn(){wt.call(this),this.status=1}function wn(t){this.g=t}(t=Fe.prototype).Ha=function(t){this.J=t},t.ea=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Mt.g(),this.v=this.o?gt(this.o):gt(Mt),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(e,String(t),!0),this.B=!1}catch(a){return void Ve(this,a)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!==typeof i.keys||"function"!==typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),r=s.FormData&&t instanceof s.FormData,!(0<=Array.prototype.indexOf.call(Be,e,void 0))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{He(this),this.u=!0,this.g.send(t),this.u=!1}catch(a){Ve(this,a)}},t.abort=function(t){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=t||7,it(this,"complete"),it(this,"abort"),ze(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ze(this,!0)),Fe.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?We(this):this.bb())},t.bb=function(){We(this)},t.isActive=function(){return!!this.g},t.Z=function(){try{return 2<qe(this)?this.g.status:-1}catch(ge){return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch(ge){return""}},t.Oa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),dt(e)}},t.Ba=function(){return this.m},t.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(t=Xe.prototype).la=8,t.G=1,t.connect=function(t,e,n,i){Ct(0),this.W=t,this.H=e||{},n&&void 0!==i&&(this.H.OSID=n,this.H.OAID=i),this.F=this.X,this.I=dn(this,null,this.W),$e(this)},t.Ga=function(t){if(this.s)if(this.s=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const s=new Lt(this,this.j,t);let r=this.o;if(this.S&&(r?(r=w(r),_(r,this.S)):r=this.S),null!==this.m||this.O||(s.H=r,r=null),this.P)t:{for(var e=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.map&&"string"===typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=en(this,s,e),ue(n=ae(this.I),"RID",t),ue(n,"CVER",22),this.D&&ue(n,"X-HTTP-Session-Id",this.D),tn(this,n),r&&(this.O?e="headers="+encodeURIComponent(String(Le(r)))+"&"+e:this.m&&Oe(n,this.m,r)),te(this.h,s),this.Ua&&ue(n,"TYPE","init"),this.P?(ue(n,"$req",e),ue(n,"SID","null"),s.T=!0,Bt(s,n,null)):Bt(s,n,e),this.G=2}}else 3==this.G&&(t?Ze(this,t):0==this.i.length||Jt(this.h)||Ze(this))},t.Fa=function(){if(this.u=null,an(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var t=2*this.R;this.j.info("BP detection timer enabled: "+t),this.A=xt(c(this.ab,this),t)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ct(10),Ye(this),an(this))},t.Za=function(){null!=this.C&&(this.C=null,Ye(this),sn(this),Ct(19))},t.fb=function(t){t?(this.j.info("Successfully pinged google.com"),Ct(2)):(this.j.info("Failed to ping google.com"),Ct(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=pn.prototype).ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){},gn.prototype.g=function(t,e){return new mn(t,e)},h(mn,nt),mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mn.prototype.close=function(){Qe(this.g)},mn.prototype.o=function(t){var e=this.g;if("string"===typeof t){var n={};n.__data__=t,t=n}else this.u&&((n={}).__data__=ht(t),t=n);e.i.push(new Qt(e.Ya++,t)),3==e.G&&$e(e)},mn.prototype.N=function(){this.g.l=null,delete this.j,Qe(this.g),delete this.g,mn.aa.N.call(this)},h(vn,yt),h(yn,wt),h(wn,pn),wn.prototype.ua=function(){it(this.g,"a")},wn.prototype.ta=function(t){it(this.g,new vn(t))},wn.prototype.sa=function(t){it(this.g,new yn)},wn.prototype.ra=function(){it(this.g,"b")},gn.prototype.createWebChannel=gn.prototype.g,mn.prototype.send=mn.prototype.o,mn.prototype.open=mn.prototype.m,mn.prototype.close=mn.prototype.close,RA=PA.createWebChannelTransport=function(){return new gn},IA=PA.getStatEventTarget=function(){return Et()},xA=PA.Event=bt,TA=PA.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Pt.NO_ERROR=0,Pt.TIMEOUT=8,Pt.HTTP_ERROR=6,CA=PA.ErrorCode=Pt,Nt.COMPLETE="complete",kA=PA.EventType=Nt,mt.EventType=vt,vt.OPEN="a",vt.CLOSE="b",vt.ERROR="c",vt.MESSAGE="d",nt.prototype.listen=nt.prototype.K,SA=PA.WebChannel=mt,PA.FetchXmlHttpFactory=Re,Fe.prototype.listenOnce=Fe.prototype.L,Fe.prototype.getLastError=Fe.prototype.Ka,Fe.prototype.getLastErrorCode=Fe.prototype.Ba,Fe.prototype.getStatus=Fe.prototype.Z,Fe.prototype.getResponseJson=Fe.prototype.Oa,Fe.prototype.getResponseText=Fe.prototype.oa,Fe.prototype.send=Fe.prototype.ea,Fe.prototype.setWithCredentials=Fe.prototype.Ha,AA=PA.XhrIo=Fe}).apply("undefined"!==typeof MA?MA:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const NA="@firebase/firestore",DA="4.7.17";class LA{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}LA.UNAUTHENTICATED=new LA(null),LA.GOOGLE_CREDENTIALS=new LA("google-credentials-uid"),LA.FIRST_PARTY=new LA("first-party-uid"),LA.MOCK_USER=new LA("mock-user");let OA="11.9.0";const FA=new My("@firebase/firestore");function UA(){return FA.logLevel}function BA(t){if(FA.logLevel<=Cy.DEBUG){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const s=n.map(WA);FA.debug("Firestore (".concat(OA,"): ").concat(t),...s)}}function VA(t){if(FA.logLevel<=Cy.ERROR){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const s=n.map(WA);FA.error("Firestore (".concat(OA,"): ").concat(t),...s)}}function jA(t){if(FA.logLevel<=Cy.WARN){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const s=n.map(WA);FA.warn("Firestore (".concat(OA,"): ").concat(t),...s)}}function WA(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function zA(t,e,n){let i="Unexpected state";"string"==typeof e?i=e:n=e,HA(t,i,n)}function HA(t,e,n){let i="FIRESTORE (".concat(OA,") INTERNAL ASSERTION FAILED: ").concat(e," (ID: ").concat(t.toString(16),")");if(void 0!==n)try{i+=" CONTEXT: "+JSON.stringify(n)}catch(t){i+=" CONTEXT: "+n}throw VA(i),new Error(i)}function qA(t,e,n,i){let s="Unexpected state";"string"==typeof n?s=n:i=n,t||HA(e,s,i)}function GA(t,e){return t}const KA={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class XA extends uy{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class QA{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class YA{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}}class JA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(LA.UNAUTHENTICATED)))}shutdown(){}}class $A{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class ZA{constructor(t){this.t=t,this.currentUser=LA.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){qA(void 0===this.o,42304);let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let s=new QA;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new QA,t.enqueueRetryable((()=>i(this.currentUser)))};const r=()=>{const e=s;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},a=t=>{BA("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.o&&(this.auth.addAuthTokenListener(this.o),r())};this.t.onInit((t=>a(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?a(t):(BA("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new QA)}}),0),r()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(BA("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(qA("string"==typeof e.accessToken,31837,{l:e}),new YA(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return qA(null===t||"string"==typeof t,2055,{h:t}),new LA(t)}}class tS{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=LA.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class eS{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new tS(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(LA.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class nS{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iS{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Pw(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){qA(void 0===this.o,3512);const n=t=>{null!=t.error&&BA("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(t.error.message));const n=t.token!==this.m;return this.m=t.token,BA("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{BA("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.V.getImmediate({optional:!0});t?i(t):BA("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new nS(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(qA("string"==typeof t.token,44558,{tokenResult:t}),this.m=t.token,new nS(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function sS(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}function rS(){return new TextEncoder}class aS{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=sS(40);for(let i=0;i<n.length;++i)e.length<20&&n[i]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return e}}function oS(t,e){return t<e?-1:t>e?1:0}function lS(t,e){let n=0;for(;n<t.length&&n<e.length;){const i=t.codePointAt(n),s=e.codePointAt(n);if(i!==s){if(i<128&&s<128)return oS(i,s);{const r=rS(),a=uS(r.encode(cS(t,n)),r.encode(cS(e,n)));return 0!==a?a:oS(i,s)}}n+=i>65535?2:1}return oS(t.length,e.length)}function cS(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function uS(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return oS(t[n],e[n]);return oS(t.length,e.length)}function hS(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}const dS=-62135596800,fS=1e6;class pS{static now(){return pS.fromMillis(Date.now())}static fromDate(t){return pS.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*fS);return new pS(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new XA(KA.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new XA(KA.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<dS)throw new XA(KA.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new XA(KA.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/fS}_compareTo(t){return this.seconds===t.seconds?oS(this.nanoseconds,t.nanoseconds):oS(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds-dS;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class gS{static fromTimestamp(t){return new gS(t)}static min(){return new gS(new pS(0,0))}static max(){return new gS(new pS(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const mS="__name__";class vS{constructor(t,e,n){void 0===e?e=0:e>t.length&&zA(637,{offset:e,range:t.length}),void 0===n?n=t.length-e:n>t.length-e&&zA(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===vS.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof vS?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=vS.compareSegments(t.get(i),e.get(i));if(0!==n)return n}return oS(t.length,e.length)}static compareSegments(t,e){const n=vS.isNumericId(t),i=vS.isNumericId(e);return n&&!i?-1:!n&&i?1:n&&i?vS.extractNumericId(t).compare(vS.extractNumericId(e)):lS(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return wA.fromString(t.substring(4,t.length-2))}}class yS extends vS{construct(t,e,n){return new yS(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const t=[];for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(const s of n){if(s.indexOf("//")>=0)throw new XA(KA.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));t.push(...s.split("/").filter((t=>t.length>0)))}return new yS(t)}static emptyPath(){return new yS([])}}const wS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bS extends vS{construct(t,e,n){return new bS(t,e,n)}static isValidIdentifier(t){return wS.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bS.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===mS}static keyField(){return new bS([mS])}static fromServerFormat(t){const e=[];let n="",i=0;const s=()=>{if(0===n.length)throw new XA(KA.INVALID_ARGUMENT,"Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));e.push(n),n=""};let r=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new XA(KA.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new XA(KA.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(r=!r,i++):"."!==e||r?(n+=e,i++):(s(),i++)}if(s(),r)throw new XA(KA.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new bS(e)}static emptyPath(){return new bS([])}}class _S{constructor(t){this.path=t}static fromPath(t){return new _S(yS.fromString(t))}static fromName(t){return new _S(yS.fromString(t).popFirst(5))}static empty(){return new _S(yS.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===yS.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return yS.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new _S(new yS(t.slice()))}}const ES=-1;class AS{constructor(t,e,n,i){this.indexId=t,this.collectionGroup=e,this.fields=n,this.indexState=i}}AS.UNKNOWN_ID=-1;function SS(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,s=gS.fromTimestamp(1e9===i?new pS(n+1,0):new pS(n,i));return new CS(s,_S.empty(),e)}function kS(t){return new CS(t.readTime,t.key,ES)}class CS{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new CS(gS.min(),_S.empty(),ES)}static max(){return new CS(gS.max(),_S.empty(),ES)}}function TS(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=_S.comparator(t.documentKey,e.documentKey),0!==n?n:oS(t.largestBatchId,e.largestBatchId))}const xS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class IS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function RS(t){if(t.code!==KA.FAILED_PRECONDITION||t.message!==xS)throw t;BA("LocalStore","Unexpectedly lost primary lease")}class MS{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&zA(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new MS(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof MS?e:MS.resolve(e)}catch(t){return MS.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):MS.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):MS.reject(e)}static resolve(t){return new MS(((e,n)=>{e(t)}))}static reject(t){return new MS(((e,n)=>{n(t)}))}static waitFor(t){return new MS(((e,n)=>{let i=0,s=0,r=!1;t.forEach((t=>{++i,t.next((()=>{++s,r&&s===i&&e()}),(t=>n(t)))})),r=!0,s===i&&e()}))}static or(t){let e=MS.resolve(!1);for(const n of t)e=e.next((t=>t?MS.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new MS(((n,i)=>{const s=t.length,r=new Array(s);let a=0;for(let o=0;o<s;o++){const l=o;e(t[l]).next((t=>{r[l]=t,++a,a===s&&n(r)}),(t=>i(t)))}}))}static doWhile(t,e){return new MS(((n,i)=>{const s=()=>{!0===t()?e().next((()=>{s()}),i):n()};s()}))}}function PS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function NS(t){return"IndexedDbTransactionError"===t.name}class DS{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ue(t),this.ce=t=>e.writeSequenceNumber(t))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ce&&this.ce(t),t}}DS.le=-1;const LS=-1;function OS(t){return null==t}function FS(t){return 0===t&&1/t==-1/0}function US(t){return"number"==typeof t&&Number.isInteger(t)&&!FS(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const BS="\x01";function VS(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=WS(e)),e=jS(t.get(n),e);return WS(e)}function jS(t,e){let n=e;const i=t.length;for(let s=0;s<i;s++){const e=t.charAt(s);switch(e){case"\0":n+="\x01\x10";break;case BS:n+="\x01\x11";break;default:n+=e}}return n}function WS(t){return t+BS+"\x01"}const zS="remoteDocuments",HS="owner",qS="mutationQueues",GS="mutations";const KS="documentMutations",XS="remoteDocumentsV14",QS="remoteDocumentGlobal",YS="targets",JS="targetDocuments",$S="targetGlobal",ZS="collectionParents",tk="clientMetadata",ek="bundles",nk="namedQueries",ik="indexConfiguration",sk="indexState",rk="indexEntries",ak="documentOverlays",ok="globals",lk=[qS,GS,KS,zS,YS,HS,$S,JS,tk,QS,ZS,ek,nk],ck=[qS,GS,KS,XS,YS,HS,$S,JS,tk,QS,ZS,ek,nk,ak],uk=ck,hk=[...uk,ik,sk,rk];function dk(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function fk(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function pk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class gk{constructor(t,e){this.comparator=t,this.root=e||vk.EMPTY}insert(t,e){return new gk(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,vk.BLACK,null,null))}remove(t){return new gk(this.comparator,this.root.remove(t,this.comparator).copy(null,null,vk.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push("".concat(e,":").concat(n)),!1))),"{".concat(t.join(", "),"}")}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new mk(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new mk(this.root,t,this.comparator,!1)}getReverseIterator(){return new mk(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new mk(this.root,t,this.comparator,!0)}}class mk{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?n(t.key,e):1,e&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(0===s){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class vk{constructor(t,e,n,i,s){this.key=t,this.value=e,this.color=null!=n?n:vk.RED,this.left=null!=i?i:vk.EMPTY,this.right=null!=s?s:vk.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,s){return new vk(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===s?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return vk.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return vk.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,vk.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,vk.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw zA(43730,{key:this.key,value:this.value});if(this.right.isRed())throw zA(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw zA(27949);return t+(this.isRed()?0:1)}}vk.EMPTY=null,vk.RED=!0,vk.BLACK=!1,vk.EMPTY=new class{constructor(){this.size=0}get key(){throw zA(57766)}get value(){throw zA(16141)}get color(){throw zA(16727)}get left(){throw zA(29726)}get right(){throw zA(36894)}copy(t,e,n,i,s){return this}insert(t,e,n){return new vk(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class yk{constructor(t){this.comparator=t,this.data=new gk(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new wk(this.data.getIterator())}getIteratorFrom(t){return new wk(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof yk))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new yk(this.comparator);return e.data=t,e}}class wk{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class bk{constructor(t){this.fields=t,t.sort(bS.comparator)}static empty(){return new bk([])}unionWith(t){let e=new yk(bS.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new bk(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return hS(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class _k extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ek{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new _k("Invalid base64 string: "+t):t}}(t);return new Ek(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new Ek(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return oS(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ek.EMPTY_BYTE_STRING=new Ek("");const Ak=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sk(t){if(qA(!!t,39018),"string"==typeof t){let e=0;const n=Ak.exec(t);if(qA(!!n,46558,{timestamp:t}),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:kk(t.seconds),nanos:kk(t.nanos)}}function kk(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ck(t){return"string"==typeof t?Ek.fromBase64String(t):Ek.fromUint8Array(t)}const Tk="server_timestamp",xk="__type__",Ik="__previous_value__",Rk="__local_write_time__";function Mk(t){var e,n;return(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{})[xk])||void 0===n?void 0:n.stringValue)===Tk}function Pk(t){const e=t.mapValue.fields[Ik];return Mk(e)?Pk(e):e}function Nk(t){const e=Sk(t.mapValue.fields[Rk].timestampValue);return new pS(e.seconds,e.nanos)}class Dk{constructor(t,e,n,i,s,r,a,o,l,c){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=r,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const Lk="(default)";class Ok{constructor(t,e){this.projectId=t,this.database=e||Lk}static empty(){return new Ok("","")}get isDefaultDatabase(){return this.database===Lk}isEqual(t){return t instanceof Ok&&t.projectId===this.projectId&&t.database===this.database}}const Fk="__type__",Uk="__max__",Bk={mapValue:{fields:{__type__:{stringValue:Uk}}}},Vk="__vector__",jk="value";function Wk(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Mk(t)?4:rC(t)?9007199254740991:iC(t)?10:11:zA(28295,{value:t})}function zk(t,e){if(t===e)return!0;const n=Wk(t);if(n!==Wk(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Nk(t).isEqual(Nk(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=Sk(t.timestampValue),i=Sk(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Ck(t.bytesValue).isEqual(Ck(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return kk(t.geoPointValue.latitude)===kk(e.geoPointValue.latitude)&&kk(t.geoPointValue.longitude)===kk(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return kk(t.integerValue)===kk(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=kk(t.doubleValue),i=kk(e.doubleValue);return n===i?FS(n)===FS(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return hS(t.arrayValue.values||[],e.arrayValue.values||[],zk);case 10:case 11:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(dk(n)!==dk(i))return!1;for(const s in n)if(n.hasOwnProperty(s)&&(void 0===i[s]||!zk(n[s],i[s])))return!1;return!0}(t,e);default:return zA(52216,{left:t})}}function Hk(t,e){return void 0!==(t.values||[]).find((t=>zk(t,e)))}function qk(t,e){if(t===e)return 0;const n=Wk(t),i=Wk(e);if(n!==i)return oS(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return oS(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=kk(t.integerValue||t.doubleValue),i=kk(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Gk(t.timestampValue,e.timestampValue);case 4:return Gk(Nk(t),Nk(e));case 5:return lS(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Ck(t),i=Ck(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let s=0;s<n.length&&s<i.length;s++){const t=oS(n[s],i[s]);if(0!==t)return t}return oS(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=oS(kk(t.latitude),kk(e.latitude));return 0!==n?n:oS(kk(t.longitude),kk(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Kk(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n,i,s,r;const a=t.fields||{},o=e.fields||{},l=null===(n=a[jk])||void 0===n?void 0:n.arrayValue,c=null===(i=o[jk])||void 0===i?void 0:i.arrayValue,u=oS((null===(s=null==l?void 0:l.values)||void 0===s?void 0:s.length)||0,(null===(r=null==c?void 0:c.values)||void 0===r?void 0:r.length)||0);return 0!==u?u:Kk(l,c)}(t.mapValue,e.mapValue);case 11:return function(t,e){if(t===Bk.mapValue&&e===Bk.mapValue)return 0;if(t===Bk.mapValue)return 1;if(e===Bk.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),s=e.fields||{},r=Object.keys(s);i.sort(),r.sort();for(let a=0;a<i.length&&a<r.length;++a){const t=lS(i[a],r[a]);if(0!==t)return t;const e=qk(n[i[a]],s[r[a]]);if(0!==e)return e}return oS(i.length,r.length)}(t.mapValue,e.mapValue);default:throw zA(23264,{Pe:n})}}function Gk(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return oS(t,e);const n=Sk(t),i=Sk(e),s=oS(n.seconds,i.seconds);return 0!==s?s:oS(n.nanos,i.nanos)}function Kk(t,e){const n=t.values||[],i=e.values||[];for(let s=0;s<n.length&&s<i.length;++s){const t=qk(n[s],i[s]);if(t)return t}return oS(n.length,i.length)}function Xk(t){return Qk(t)}function Qk(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=Sk(t);return"time(".concat(e.seconds,",").concat(e.nanos,")")}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return Ck(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return _S.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return"geo(".concat(t.latitude,",").concat(t.longitude,")")}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=Qk(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const s of e)i?i=!1:n+=",",n+="".concat(s,":").concat(Qk(t.fields[s]));return n+"}"}(t.mapValue):zA(61005,{value:t})}function Yk(t){switch(Wk(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Pk(t);return e?16+Yk(e):16;case 5:return 2*t.stringValue.length;case 6:return Ck(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(t){return(t.values||[]).reduce(((t,e)=>t+Yk(e)),0)}(t.arrayValue);case 10:case 11:return function(t){let e=0;return fk(t.fields,((t,n)=>{e+=t.length+Yk(n)})),e}(t.mapValue);default:throw zA(13486,{value:t})}}function Jk(t,e){return{referenceValue:"projects/".concat(t.projectId,"/databases/").concat(t.database,"/documents/").concat(e.path.canonicalString())}}function $k(t){return!!t&&"integerValue"in t}function Zk(t){return!!t&&"arrayValue"in t}function tC(t){return!!t&&"nullValue"in t}function eC(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function nC(t){return!!t&&"mapValue"in t}function iC(t){var e,n;return(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{})[Fk])||void 0===n?void 0:n.stringValue)===Vk}function sC(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return fk(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=sC(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=sC(t.arrayValue.values[n]);return e}return Object.assign({},t)}function rC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Uk}class aC{constructor(t){this.value=t}static empty(){return new aC({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!nC(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=sC(e)}setAll(t){let e=bS.emptyPath(),n={},i=[];t.forEach(((t,s)=>{if(!e.isImmediateParentOf(s)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=s.popLast()}t?n[s.lastSegment()]=sC(t):i.push(s.lastSegment())}));const s=this.getFieldsMap(e);this.applyChanges(s,n,i)}delete(t){const e=this.field(t.popLast());nC(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return zk(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];nC(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){fk(e,((e,n)=>t[e]=n));for(const i of n)delete t[i]}clone(){return new aC(sC(this.value))}}function oC(t){const e=[];return fk(t.fields,((t,n)=>{const i=new bS([t]);if(nC(n)){const t=oC(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new bk(e)}class lC{constructor(t,e,n,i,s,r,a){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=s,this.data=r,this.documentState=a}static newInvalidDocument(t){return new lC(t,0,gS.min(),gS.min(),gS.min(),aC.empty(),0)}static newFoundDocument(t,e,n,i){return new lC(t,1,e,gS.min(),n,i,0)}static newNoDocument(t,e){return new lC(t,2,e,gS.min(),gS.min(),aC.empty(),0)}static newUnknownDocument(t,e){return new lC(t,3,e,gS.min(),gS.min(),aC.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(gS.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=aC.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=aC.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=gS.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof lC&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new lC(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class cC{constructor(t,e){this.position=t,this.inclusive=e}}function uC(t,e,n){let i=0;for(let s=0;s<t.position.length;s++){const r=e[s],a=t.position[s];if(i=r.field.isKeyField()?_S.comparator(_S.fromName(a.referenceValue),n.key):qk(a,n.data.field(r.field)),"desc"===r.dir&&(i*=-1),0!==i)break}return i}function hC(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!zk(t.position[n],e.position[n]))return!1;return!0}class dC{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=t,this.dir=e}}function fC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class pC{}class gC extends pC{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new AC(t,e,n):"array-contains"===e?new TC(t,n):"in"===e?new xC(t,n):"not-in"===e?new IC(t,n):"array-contains-any"===e?new RC(t,n):new gC(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new SC(t,n):new kC(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&void 0===e.nullValue&&this.matchesComparison(qk(e,this.value)):null!==e&&Wk(this.value)===Wk(e)&&this.matchesComparison(qk(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return zA(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mC extends pC{constructor(t,e){super(),this.filters=t,this.op=e,this.Te=null}static create(t,e){return new mC(t,e)}matches(t){return vC(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.Te||(this.Te=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function vC(t){return"and"===t.op}function yC(t){return wC(t)&&vC(t)}function wC(t){for(const e of t.filters)if(e instanceof mC)return!1;return!0}function bC(t){if(t instanceof gC)return t.field.canonicalString()+t.op.toString()+Xk(t.value);if(yC(t))return t.filters.map((t=>bC(t))).join(",");{const e=t.filters.map((t=>bC(t))).join(",");return"".concat(t.op,"(").concat(e,")")}}function _C(t,e){return t instanceof gC?function(t,e){return e instanceof gC&&t.op===e.op&&t.field.isEqual(e.field)&&zk(t.value,e.value)}(t,e):t instanceof mC?function(t,e){return e instanceof mC&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&_C(n,e.filters[i])),!0)}(t,e):void zA(19439)}function EC(t){return t instanceof gC?function(t){return"".concat(t.field.canonicalString()," ").concat(t.op," ").concat(Xk(t.value))}(t):t instanceof mC?function(t){return t.op.toString()+" {"+t.getFilters().map(EC).join(" ,")+"}"}(t):"Filter"}class AC extends gC{constructor(t,e,n){super(t,e,n),this.key=_S.fromName(n.referenceValue)}matches(t){const e=_S.comparator(t.key,this.key);return this.matchesComparison(e)}}class SC extends gC{constructor(t,e){super(t,"in",e),this.keys=CC("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class kC extends gC{constructor(t,e){super(t,"not-in",e),this.keys=CC("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function CC(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>_S.fromName(t.referenceValue)))}class TC extends gC{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Zk(e)&&Hk(e.arrayValue,this.value)}}class xC extends gC{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Hk(this.value.arrayValue,e)}}class IC extends gC{constructor(t,e){super(t,"not-in",e)}matches(t){if(Hk(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&void 0===e.nullValue&&!Hk(this.value.arrayValue,e)}}class RC extends gC{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Zk(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Hk(this.value.arrayValue,t)))}}class MC{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=r,this.endAt=a,this.Ie=null}}function PC(t){return new MC(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function NC(t){const e=GA(t);if(null===e.Ie){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>bC(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),OS(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Xk(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Xk(t))).join(",")),e.Ie=t}return e.Ie}function DC(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!fC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!_C(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!hC(t.startAt,e.startAt)&&hC(t.endAt,e.endAt)}function LC(t){return _S.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class OC{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=r,this.startAt=a,this.endAt=o,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function FC(t,e,n,i,s,r,a,o){return new OC(t,e,n,i,s,r,a,o)}function UC(t){return new OC(t)}function BC(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function VC(t){return null!==t.collectionGroup}function jC(t){const e=GA(t);if(null===e.Ee){e.Ee=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ee.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",i=function(t){let e=new yk(bS.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);i.forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ee.push(new dC(i,n))})),t.has(bS.keyField().canonicalString())||e.Ee.push(new dC(bS.keyField(),n))}return e.Ee}function WC(t){const e=GA(t);return e.de||(e.de=zC(e,jC(t))),e.de}function zC(t,e){if("F"===t.limitType)return PC(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new dC(t.field,e)}));const n=t.endAt?new cC(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new cC(t.startAt.position,t.startAt.inclusive):null;return PC(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function HC(t,e){const n=t.filters.concat([e]);return new OC(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function qC(t,e,n){return new OC(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function GC(t,e){return DC(WC(t),WC(e))&&t.limitType===e.limitType}function KC(t){return"".concat(NC(WC(t)),"|lt:").concat(t.limitType)}function XC(t){return"Query(target=".concat(function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: [".concat(t.filters.map((t=>EC(t))).join(", "),"]")),OS(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: [".concat(t.orderBy.map((t=>function(t){return"".concat(t.field.canonicalString()," (").concat(t.dir,")")}(t))).join(", "),"]")),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Xk(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Xk(t))).join(",")),"Target(".concat(e,")")}(WC(t)),"; limitType=").concat(t.limitType,")")}function QC(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):_S.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of jC(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=uC(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,jC(t),e))&&!(t.endAt&&!function(t,e,n){const i=uC(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,jC(t),e))}(t,e)}function YC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function JC(t){return(e,n)=>{let i=!1;for(const s of jC(t)){const t=$C(s,e,n);if(0!==t)return t;i=i||s.field.isKeyField()}return 0}}function $C(t,e,n){const i=t.field.isKeyField()?_S.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),s=n.data.field(t);return null!==i&&null!==s?qk(i,s):zA(42886)}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return zA(19790,{direction:t.dir})}}class ZC{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[i,s]of n)if(this.equalsFn(i,t))return s}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){fk(this.inner,((e,n)=>{for(const[i,s]of n)t(i,s)}))}isEmpty(){return pk(this.inner)}size(){return this.innerSize}}const tT=new gk(_S.comparator);function eT(){return tT}const nT=new gk(_S.comparator);function iT(){let t=nT;for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(const s of n)t=t.insert(s.key,s);return t}function sT(t){let e=nT;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function rT(){return oT()}function aT(){return oT()}function oT(){return new ZC((t=>t.toString()),((t,e)=>t.isEqual(e)))}const lT=new gk(_S.comparator),cT=new yk(_S.comparator);function uT(){let t=cT;for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(const s of n)t=t.add(s);return t}const hT=new yk(oS);function dT(){return hT}function fT(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:FS(e)?"-0":e}}function pT(t){return{integerValue:""+t}}function gT(t,e){return US(e)?pT(e):fT(t,e)}class mT{constructor(){this._=void 0}}function vT(t,e,n){return t instanceof bT?function(t,e){const n={fields:{[xk]:{stringValue:Tk},[Rk]:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&Mk(e)&&(e=Pk(e)),e&&(n.fields[Ik]=e),{mapValue:n}}(n,e):t instanceof _T?ET(t,e):t instanceof AT?ST(t,e):function(t,e){const n=wT(t,e),i=CT(n)+CT(t.Re);return $k(n)&&$k(t.Re)?pT(i):fT(t.serializer,i)}(t,e)}function yT(t,e,n){return t instanceof _T?ET(t,e):t instanceof AT?ST(t,e):n}function wT(t,e){return t instanceof kT?function(t){return $k(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class bT extends mT{}class _T extends mT{constructor(t){super(),this.elements=t}}function ET(t,e){const n=TT(e);for(const i of t.elements)n.some((t=>zk(t,i)))||n.push(i);return{arrayValue:{values:n}}}class AT extends mT{constructor(t){super(),this.elements=t}}function ST(t,e){let n=TT(e);for(const i of t.elements)n=n.filter((t=>!zk(t,i)));return{arrayValue:{values:n}}}class kT extends mT{constructor(t,e){super(),this.serializer=t,this.Re=e}}function CT(t){return kk(t.integerValue||t.doubleValue)}function TT(t){return Zk(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class xT{constructor(t,e){this.field=t,this.transform=e}}class IT{constructor(t,e){this.version=t,this.transformResults=e}}class RT{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new RT}static exists(t){return new RT(void 0,t)}static updateTime(t){return new RT(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function MT(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class PT{}function NT(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new zT(t.key,RT.none()):new UT(t.key,t.data,RT.none());{const n=t.data,i=aC.empty();let s=new yk(bS.comparator);for(let t of e.fields)if(!s.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),s=s.add(t)}return new BT(t.key,i,new bk(s.toArray()),RT.none())}}function DT(t,e,n){t instanceof UT?function(t,e,n){const i=t.value.clone(),s=jT(t.fieldTransforms,e,n.transformResults);i.setAll(s),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof BT?function(t,e,n){if(!MT(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=jT(t.fieldTransforms,e,n.transformResults),s=e.data;s.setAll(VT(t)),s.setAll(i),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function LT(t,e,n,i){return t instanceof UT?function(t,e,n,i){if(!MT(t.precondition,e))return n;const s=t.value.clone(),r=WT(t.fieldTransforms,i,e);return s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null}(t,e,n,i):t instanceof BT?function(t,e,n,i){if(!MT(t.precondition,e))return n;const s=WT(t.fieldTransforms,i,e),r=e.data;return r.setAll(VT(t)),r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return MT(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function OT(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),s=wT(i.transform,t||null);null!=s&&(null===n&&(n=aC.empty()),n.set(i.field,s))}return n||null}function FT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&hS(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof _T&&e instanceof _T||t instanceof AT&&e instanceof AT?hS(t.elements,e.elements,zk):t instanceof kT&&e instanceof kT?zk(t.Re,e.Re):t instanceof bT&&e instanceof bT}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class UT extends PT{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class BT extends PT{constructor(t,e,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function VT(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function jT(t,e,n){const i=new Map;qA(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let s=0;s<n.length;s++){const r=t[s],a=r.transform,o=e.data.field(r.field);i.set(r.field,yT(a,o,n[s]))}return i}function WT(t,e,n){const i=new Map;for(const s of t){const t=s.transform,r=n.data.field(s.field);i.set(s.field,vT(t,r,e))}return i}class zT extends PT{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class HT extends PT{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class qT{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const e=this.mutations[i];e.key.isEqual(t.key)&&DT(e,t,n[i])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=LT(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=LT(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=aT();return this.mutations.forEach((i=>{const s=t.get(i.key),r=s.overlayedDocument;let a=this.applyToLocalView(r,s.mutatedFields);a=e.has(i.key)?null:a;const o=NT(r,a);null!==o&&n.set(i.key,o),r.isValidDocument()||r.convertToNoDocument(gS.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),uT())}isEqual(t){return this.batchId===t.batchId&&hS(this.mutations,t.mutations,((t,e)=>FT(t,e)))&&hS(this.baseMutations,t.baseMutations,((t,e)=>FT(t,e)))}}class GT{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){qA(t.mutations.length===n.length,58842,{fe:t.mutations.length,ge:n.length});let i=lT;const s=t.mutations;for(let r=0;r<s.length;r++)i=i.insert(s[r].key,n[r].version);return new GT(t,e,n,i)}}class KT{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class XT{constructor(t,e){this.count=t,this.unchangedNames=e}}var QT,YT;function JT(t){switch(t){case KA.OK:return zA(64938);case KA.CANCELLED:case KA.UNKNOWN:case KA.DEADLINE_EXCEEDED:case KA.RESOURCE_EXHAUSTED:case KA.INTERNAL:case KA.UNAVAILABLE:case KA.UNAUTHENTICATED:return!1;case KA.INVALID_ARGUMENT:case KA.NOT_FOUND:case KA.ALREADY_EXISTS:case KA.PERMISSION_DENIED:case KA.FAILED_PRECONDITION:case KA.ABORTED:case KA.OUT_OF_RANGE:case KA.UNIMPLEMENTED:case KA.DATA_LOSS:return!0;default:return zA(15467,{code:t})}}function $T(t){if(void 0===t)return VA("GRPC error has no .code"),KA.UNKNOWN;switch(t){case QT.OK:return KA.OK;case QT.CANCELLED:return KA.CANCELLED;case QT.UNKNOWN:return KA.UNKNOWN;case QT.DEADLINE_EXCEEDED:return KA.DEADLINE_EXCEEDED;case QT.RESOURCE_EXHAUSTED:return KA.RESOURCE_EXHAUSTED;case QT.INTERNAL:return KA.INTERNAL;case QT.UNAVAILABLE:return KA.UNAVAILABLE;case QT.UNAUTHENTICATED:return KA.UNAUTHENTICATED;case QT.INVALID_ARGUMENT:return KA.INVALID_ARGUMENT;case QT.NOT_FOUND:return KA.NOT_FOUND;case QT.ALREADY_EXISTS:return KA.ALREADY_EXISTS;case QT.PERMISSION_DENIED:return KA.PERMISSION_DENIED;case QT.FAILED_PRECONDITION:return KA.FAILED_PRECONDITION;case QT.ABORTED:return KA.ABORTED;case QT.OUT_OF_RANGE:return KA.OUT_OF_RANGE;case QT.UNIMPLEMENTED:return KA.UNIMPLEMENTED;case QT.DATA_LOSS:return KA.DATA_LOSS;default:return zA(39323,{code:t})}}(YT=QT||(QT={}))[YT.OK=0]="OK",YT[YT.CANCELLED=1]="CANCELLED",YT[YT.UNKNOWN=2]="UNKNOWN",YT[YT.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",YT[YT.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",YT[YT.NOT_FOUND=5]="NOT_FOUND",YT[YT.ALREADY_EXISTS=6]="ALREADY_EXISTS",YT[YT.PERMISSION_DENIED=7]="PERMISSION_DENIED",YT[YT.UNAUTHENTICATED=16]="UNAUTHENTICATED",YT[YT.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",YT[YT.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",YT[YT.ABORTED=10]="ABORTED",YT[YT.OUT_OF_RANGE=11]="OUT_OF_RANGE",YT[YT.UNIMPLEMENTED=12]="UNIMPLEMENTED",YT[YT.INTERNAL=13]="INTERNAL",YT[YT.UNAVAILABLE=14]="UNAVAILABLE",YT[YT.DATA_LOSS=15]="DATA_LOSS";let ZT=null;const tx=new wA([4294967295,4294967295],0);function ex(t){const e=rS().encode(t),n=new bA;return n.update(e),new Uint8Array(n.digest())}function nx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new wA([n,i],0),new wA([s,r],0)]}class ix{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new sx("Invalid padding: ".concat(e));if(n<0)throw new sx("Invalid hash count: ".concat(n));if(t.length>0&&0===this.hashCount)throw new sx("Invalid hash count: ".concat(n));if(0===t.length&&0!==e)throw new sx("Invalid padding when bitmap length is 0: ".concat(e));this.pe=8*t.length-e,this.ye=wA.fromNumber(this.pe)}we(t,e,n){let i=t.add(e.multiply(wA.fromNumber(n)));return 1===i.compare(tx)&&(i=new wA([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.pe)return!1;const e=ex(t),[n,i]=nx(e);for(let s=0;s<this.hashCount;s++){const t=this.we(n,i,s);if(!this.be(t))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),r=new ix(s,i,e);return n.forEach((t=>r.insert(t))),r}insert(t){if(0===this.pe)return;const e=ex(t),[n,i]=nx(e);for(let s=0;s<this.hashCount;s++){const t=this.we(n,i,s);this.Se(t)}}Se(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class sx extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class rx{constructor(t,e,n,i,s){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,ax.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new rx(gS.min(),i,new gk(oS),eT(),uT())}}class ax{constructor(t,e,n,i,s){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new ax(n,e,uT(),uT(),uT())}}class ox{constructor(t,e,n,i){this.De=t,this.removedTargetIds=e,this.key=n,this.ve=i}}class lx{constructor(t,e){this.targetId=t,this.Ce=e}}class cx{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ek.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class ux{constructor(){this.Fe=0,this.Me=fx(),this.xe=Ek.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return 0!==this.Fe}get Le(){return this.Ne}ke(t){t.approximateByteSize()>0&&(this.Ne=!0,this.xe=t)}qe(){let t=uT(),e=uT(),n=uT();return this.Me.forEach(((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:zA(38017,{changeType:s})}})),new ax(this.xe,this.Oe,t,e,n)}Qe(){this.Ne=!1,this.Me=fx()}$e(t,e){this.Ne=!0,this.Me=this.Me.insert(t,e)}Ue(t){this.Ne=!0,this.Me=this.Me.remove(t)}Ke(){this.Fe+=1}We(){this.Fe-=1,qA(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class hx{constructor(t){this.ze=t,this.je=new Map,this.He=eT(),this.Je=dx(),this.Ye=dx(),this.Ze=new gk(oS)}Xe(t){for(const e of t.De)t.ve&&t.ve.isFoundDocument()?this.et(e,t.ve):this.tt(e,t.key,t.ve);for(const e of t.removedTargetIds)this.tt(e,t.key,t.ve)}nt(t){this.forEachTarget(t,(e=>{const n=this.rt(e);switch(t.state){case 0:this.it(e)&&n.ke(t.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(t.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(e);break;case 3:this.it(e)&&(n.Ge(),n.ke(t.resumeToken));break;case 4:this.it(e)&&(this.st(e),n.ke(t.resumeToken));break;default:zA(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.je.forEach(((t,n)=>{this.it(n)&&e(n)}))}ot(t){const e=t.targetId,n=t.Ce.count,i=this._t(e);if(i){const s=i.target;if(LC(s))if(0===n){const t=new _S(s.path);this.tt(e,t,lC.newNoDocument(t,gS.min()))}else qA(1===n,20013,{expectedCount:n});else{const i=this.ut(e);if(i!==n){const n=this.ct(t),s=n?this.lt(n,t,i):1;if(0!==s){this.st(e);const t=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(e,t)}null==ZT||ZT.ht(function(t,e,n,i,s){var r,a,o,l,c,u;const h={localCacheCount:t,existenceFilterCount:e.count,databaseId:n.database,projectId:n.projectId},d=e.unchangedNames;return d&&(h.bloomFilter={applied:0===s,hashCount:null!==(r=null==d?void 0:d.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(l=null===(o=null===(a=null==d?void 0:d.bits)||void 0===a?void 0:a.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==d?void 0:d.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:t=>{var e;return null!==(e=null==i?void 0:i.mightContain(t))&&void 0!==e&&e}}),h}(i,t.Ce,this.ze.Pt(),n,s))}}}}ct(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=e;let r,a;try{r=Ck(n).toUint8Array()}catch(t){if(t instanceof _k)return jA("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{a=new ix(r,i,s)}catch(t){return jA(t instanceof sx?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===a.pe?null:a}lt(t,e,n){return e.Ce.count===n-this.Tt(t,e.targetId)?0:2}Tt(t,e){const n=this.ze.getRemoteKeysForTarget(e);let i=0;return n.forEach((n=>{const s=this.ze.Pt(),r="projects/".concat(s.projectId,"/databases/").concat(s.database,"/documents/").concat(n.path.canonicalString());t.mightContain(r)||(this.tt(e,n,null),i++)})),i}It(t){const e=new Map;this.je.forEach(((n,i)=>{const s=this._t(i);if(s){if(n.current&&LC(s.target)){const e=new _S(s.target.path);this.Et(e).has(i)||this.dt(i,e)||this.tt(i,e,lC.newNoDocument(e,t))}n.Le&&(e.set(i,n.qe()),n.Qe())}}));let n=uT();this.Ye.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this._t(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.He.forEach(((e,n)=>n.setReadTime(t)));const i=new rx(t,e,this.Ze,this.He,n);return this.He=eT(),this.Je=dx(),this.Ye=dx(),this.Ze=new gk(oS),i}et(t,e){if(!this.it(t))return;const n=this.dt(t,e.key)?2:0;this.rt(t).$e(e.key,n),this.He=this.He.insert(e.key,e),this.Je=this.Je.insert(e.key,this.Et(e.key).add(t)),this.Ye=this.Ye.insert(e.key,this.At(e.key).add(t))}tt(t,e,n){if(!this.it(t))return;const i=this.rt(t);this.dt(t,e)?i.$e(e,1):i.Ue(e),this.Ye=this.Ye.insert(e,this.At(e).delete(t)),this.Ye=this.Ye.insert(e,this.At(e).add(t)),n&&(this.He=this.He.insert(e,n))}removeTarget(t){this.je.delete(t)}ut(t){const e=this.rt(t).qe();return this.ze.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ke(t){this.rt(t).Ke()}rt(t){let e=this.je.get(t);return e||(e=new ux,this.je.set(t,e)),e}At(t){let e=this.Ye.get(t);return e||(e=new yk(oS),this.Ye=this.Ye.insert(t,e)),e}Et(t){let e=this.Je.get(t);return e||(e=new yk(oS),this.Je=this.Je.insert(t,e)),e}it(t){const e=null!==this._t(t);return e||BA("WatchChangeAggregator","Detected inactive target",t),e}_t(t){const e=this.je.get(t);return e&&e.Be?null:this.ze.Rt(t)}st(t){this.je.set(t,new ux),this.ze.getRemoteKeysForTarget(t).forEach((e=>{this.tt(t,e,null)}))}dt(t,e){return this.ze.getRemoteKeysForTarget(t).has(e)}}function dx(){return new gk(_S.comparator)}function fx(){return new gk(_S.comparator)}const px={asc:"ASCENDING",desc:"DESCENDING"},gx={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mx={and:"AND",or:"OR"};class vx{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function yx(t,e){return t.useProto3Json||OS(e)?e:{value:e}}function wx(t,e){return t.useProto3Json?"".concat(new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+e.nanoseconds).slice(-9),"Z"):{seconds:""+e.seconds,nanos:e.nanoseconds}}function bx(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function _x(t,e){return wx(t,e.toTimestamp())}function Ex(t){return qA(!!t,49232),gS.fromTimestamp(function(t){const e=Sk(t);return new pS(e.seconds,e.nanos)}(t))}function Ax(t,e){return Sx(t,e).canonicalString()}function Sx(t,e){const n=function(t){return new yS(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function kx(t){const e=yS.fromString(t);return qA(qx(e),10190,{key:e.toString()}),e}function Cx(t,e){return Ax(t.databaseId,e.path)}function Tx(t,e){const n=kx(e);if(n.get(1)!==t.databaseId.projectId)throw new XA(KA.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new XA(KA.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new _S(Mx(n))}function xx(t,e){return Ax(t.databaseId,e)}function Ix(t){const e=kx(t);return 4===e.length?yS.emptyPath():Mx(e)}function Rx(t){return new yS(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Mx(t){return qA(t.length>4&&"documents"===t.get(4),29091,{key:t.toString()}),t.popFirst(5)}function Px(t,e,n){return{name:Cx(t,e),fields:n.value.mapValue.fields}}function Nx(t,e){let n;if(e instanceof UT)n={update:Px(t,e.key,e.value)};else if(e instanceof zT)n={delete:Cx(t,e.key)};else if(e instanceof BT)n={update:Px(t,e.key,e.data),updateMask:Hx(e.fieldMask)};else{if(!(e instanceof HT))return zA(16599,{ft:e.type});n={verify:Cx(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof bT)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof _T)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof AT)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof kT)return{fieldPath:e.field.canonicalString(),increment:n.Re};throw zA(20930,{transform:e.transform})}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:_x(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:zA(27497)}(t,e.precondition)),n}function Dx(t,e){return{documents:[xx(t,e.path)]}}function Lx(t,e){const n={structuredQuery:{}},i=e.path;let s;null!==e.collectionGroup?(s=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=xx(t,s);const r=function(t){if(0!==t.length)return zx(mC.create(t,"and"))}(e.filters);r&&(n.structuredQuery.where=r);const a=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:jx(t.field),direction:Ux(t.dir)}}(t)))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const o=yx(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{gt:n,parent:s}}function Ox(t){let e=Ix(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){qA(1===i,65062);const t=n.from[0];t.allDescendants?s=t.collectionId:e=e.child(t.collectionId)}let r=[];n.where&&(r=function(t){const e=Fx(t);return e instanceof mC&&yC(e)?e.getFilters():[e]}(n.where));let a=[];n.orderBy&&(a=function(t){return t.map((t=>function(t){return new dC(Wx(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let o=null;n.limit&&(o=function(t){let e;return e="object"==typeof t?t.value:t,OS(e)?null:e}(n.limit));let l=null;n.startAt&&(l=function(t){const e=!!t.before,n=t.values||[];return new cC(n,e)}(n.startAt));let c=null;return n.endAt&&(c=function(t){const e=!t.before,n=t.values||[];return new cC(n,e)}(n.endAt)),FC(e,s,a,r,o,"F",l,c)}function Fx(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Wx(t.unaryFilter.field);return gC.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Wx(t.unaryFilter.field);return gC.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Wx(t.unaryFilter.field);return gC.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Wx(t.unaryFilter.field);return gC.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return zA(61313);default:return zA(60726)}}(t):void 0!==t.fieldFilter?function(t){return gC.create(Wx(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return zA(58110);default:return zA(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return mC.create(t.compositeFilter.filters.map((t=>Fx(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return zA(1026)}}(t.compositeFilter.op))}(t):zA(30097,{filter:t})}function Ux(t){return px[t]}function Bx(t){return gx[t]}function Vx(t){return mx[t]}function jx(t){return{fieldPath:t.canonicalString()}}function Wx(t){return bS.fromServerFormat(t.fieldPath)}function zx(t){return t instanceof gC?function(t){if("=="===t.op){if(eC(t.value))return{unaryFilter:{field:jx(t.field),op:"IS_NAN"}};if(tC(t.value))return{unaryFilter:{field:jx(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(eC(t.value))return{unaryFilter:{field:jx(t.field),op:"IS_NOT_NAN"}};if(tC(t.value))return{unaryFilter:{field:jx(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jx(t.field),op:Bx(t.op),value:t.value}}}(t):t instanceof mC?function(t){const e=t.getFilters().map((t=>zx(t)));return 1===e.length?e[0]:{compositeFilter:{op:Vx(t.op),filters:e}}}(t):zA(54877,{filter:t})}function Hx(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function qx(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class Gx{constructor(t,e,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:gS.min(),r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:gS.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ek.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=r,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(t){return new Gx(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Gx(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Gx(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Gx(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class Kx{constructor(t){this.wt=t}}function Xx(t){const e=Ox({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?qC(e,e.limit,"L"):e}class Qx{constructor(){}vt(t,e){this.Ct(t,e),e.Ft()}Ct(t,e){if("nullValue"in t)this.Mt(e,5);else if("booleanValue"in t)this.Mt(e,10),e.xt(t.booleanValue?1:0);else if("integerValue"in t)this.Mt(e,15),e.xt(kk(t.integerValue));else if("doubleValue"in t){const n=kk(t.doubleValue);isNaN(n)?this.Mt(e,13):(this.Mt(e,15),FS(n)?e.xt(0):e.xt(n))}else if("timestampValue"in t){let n=t.timestampValue;this.Mt(e,20),"string"==typeof n&&(n=Sk(n)),e.Ot("".concat(n.seconds||"")),e.xt(n.nanos||0)}else if("stringValue"in t)this.Nt(t.stringValue,e),this.Bt(e);else if("bytesValue"in t)this.Mt(e,30),e.Lt(Ck(t.bytesValue)),this.Bt(e);else if("referenceValue"in t)this.kt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Mt(e,45),e.xt(n.latitude||0),e.xt(n.longitude||0)}else"mapValue"in t?rC(t)?this.Mt(e,Number.MAX_SAFE_INTEGER):iC(t)?this.qt(t.mapValue,e):(this.Qt(t.mapValue,e),this.Bt(e)):"arrayValue"in t?(this.$t(t.arrayValue,e),this.Bt(e)):zA(19022,{Ut:t})}Nt(t,e){this.Mt(e,25),this.Kt(t,e)}Kt(t,e){e.Ot(t)}Qt(t,e){const n=t.fields||{};this.Mt(e,55);for(const i of Object.keys(n))this.Nt(i,e),this.Ct(n[i],e)}qt(t,e){var n,i;const s=t.fields||{};this.Mt(e,53);const r=jk,a=(null===(i=null===(n=s[r].arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.length)||0;this.Mt(e,15),e.xt(kk(a)),this.Nt(r,e),this.Ct(s[r],e)}$t(t,e){const n=t.values||[];this.Mt(e,50);for(const i of n)this.Ct(i,e)}kt(t,e){this.Mt(e,37),_S.fromName(t).path.forEach((t=>{this.Mt(e,60),this.Kt(t,e)}))}Mt(t,e){t.xt(e)}Bt(t){t.xt(2)}}Qx.Wt=new Qx;class Yx{constructor(){this.Cn=new Jx}addToCollectionParentIndex(t,e){return this.Cn.add(e),MS.resolve()}getCollectionParents(t,e){return MS.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return MS.resolve()}deleteFieldIndex(t,e){return MS.resolve()}deleteAllFieldIndexes(t){return MS.resolve()}createTargetIndexes(t,e){return MS.resolve()}getDocumentsMatchingTarget(t,e){return MS.resolve(null)}getIndexType(t,e){return MS.resolve(0)}getFieldIndexes(t,e){return MS.resolve([])}getNextCollectionGroupToUpdate(t){return MS.resolve(null)}getMinOffset(t,e){return MS.resolve(CS.min())}getMinOffsetFromCollectionGroup(t,e){return MS.resolve(CS.min())}updateCollectionGroup(t,e,n){return MS.resolve()}updateIndexEntries(t,e){return MS.resolve()}}class Jx{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new yk(yS.comparator),s=!i.has(n);return this.index[e]=i.add(n),s}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new yk(yS.comparator)).toArray()}}new Uint8Array(0);const $x={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Zx=41943040;class tI{static withCacheSize(t){return new tI(t,tI.DEFAULT_COLLECTION_PERCENTILE,tI.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}tI.DEFAULT_COLLECTION_PERCENTILE=10,tI.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,tI.DEFAULT=new tI(Zx,tI.DEFAULT_COLLECTION_PERCENTILE,tI.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),tI.DISABLED=new tI(-1,0,0);class eI{constructor(t){this.ur=t}next(){return this.ur+=2,this.ur}static cr(){return new eI(0)}static lr(){return new eI(-1)}}const nI="LruGarbageCollector",iI=1048576;function sI(t,e){let[n,i]=t,[s,r]=e;const a=oS(n,s);return 0===a?oS(i,r):a}class rI{constructor(t){this.Er=t,this.buffer=new yk(sI),this.dr=0}Ar(){return++this.dr}Rr(t){const e=[t,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(e);else{const t=this.buffer.last();sI(e,t)<0&&(this.buffer=this.buffer.delete(t).add(e))}}get maxValue(){return this.buffer.last()[0]}}class aI{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Vr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return null!==this.Vr}mr(t){BA(nI,"Garbage collection scheduled in ".concat(t,"ms")),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){NS(t)?BA(nI,"Ignoring IndexedDB error during garbage collection: ",t):await RS(t)}await this.mr(3e5)}))}}class oI{constructor(t,e){this.gr=t,this.params=e}calculateTargetCount(t,e){return this.gr.pr(t).next((t=>Math.floor(e/100*t)))}nthSequenceNumber(t,e){if(0===e)return MS.resolve(DS.le);const n=new rI(e);return this.gr.forEachTarget(t,(t=>n.Rr(t.sequenceNumber))).next((()=>this.gr.yr(t,(t=>n.Rr(t))))).next((()=>n.maxValue))}removeTargets(t,e,n){return this.gr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.gr.removeOrphanedDocuments(t,e)}collect(t,e){return-1===this.params.cacheSizeCollectionThreshold?(BA("LruGarbageCollector","Garbage collection skipped; disabled"),MS.resolve($x)):this.getCacheSize(t).next((n=>n<this.params.cacheSizeCollectionThreshold?(BA("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),$x):this.wr(t,e)))}getCacheSize(t){return this.gr.getCacheSize(t)}wr(t,e){let n,i,s,r,a,o,l;const c=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((e=>(e>this.params.maximumSequenceNumbersToCollect?(BA("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(e)),i=this.params.maximumSequenceNumbersToCollect):i=e,r=Date.now(),this.nthSequenceNumber(t,i)))).next((i=>(n=i,a=Date.now(),this.removeTargets(t,n,e)))).next((e=>(s=e,o=Date.now(),this.removeOrphanedDocuments(t,n)))).next((t=>(l=Date.now(),UA()<=Cy.DEBUG&&BA("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(r-c,"ms\n\tDetermined least recently used ").concat(i," in ")+(a-r)+"ms\n"+"\tRemoved ".concat(s," targets in ")+(o-a)+"ms\n"+"\tRemoved ".concat(t," documents in ")+(l-o)+"ms\n"+"Total Duration: ".concat(l-c,"ms")),MS.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:t}))))}}function lI(t,e){return new oI(t,e)}class cI{constructor(){this.changes=new ZC((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,lC.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?MS.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class uI{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class hI{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&LT(n.mutation,t,bk.empty(),pS.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,uT()).next((()=>e))))}getLocalViewOfDocuments(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:uT();const i=rT();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=iT();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=rT();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,uT())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let s=eT();const r=oT(),a=oT();return e.forEach(((t,e)=>{const a=n.get(e.key);i.has(e.key)&&(void 0===a||a.mutation instanceof BT)?s=s.insert(e.key,e):void 0!==a?(r.set(e.key,a.mutation.getFieldMask()),LT(a.mutation,e,a.mutation.getFieldMask(),pS.now())):r.set(e.key,bk.empty())})),this.recalculateAndSaveOverlays(t,s).next((t=>(t.forEach(((t,e)=>r.set(t,e))),e.forEach(((t,e)=>{var n;return a.set(t,new uI(e,null!==(n=r.get(t))&&void 0!==n?n:null))})),a)))}recalculateAndSaveOverlays(t,e){const n=oT();let i=new gk(((t,e)=>t-e)),s=uT();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const s of t)s.keys().forEach((t=>{const r=e.get(t);if(null===r)return;let a=n.get(t)||bk.empty();a=s.applyToLocalView(r,a),n.set(t,a);const o=(i.get(s.batchId)||uT()).add(t);i=i.insert(s.batchId,o)}))})).next((()=>{const r=[],a=i.getReverseIterator();for(;a.hasNext();){const i=a.getNext(),o=i.key,l=i.value,c=aT();l.forEach((t=>{if(!s.has(t)){const i=NT(e.get(t),n.get(t));null!==i&&c.set(t,i),s=s.add(t)}})),r.push(this.documentOverlayCache.saveOverlays(t,o,c))}return MS.waitFor(r)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,i){return function(t){return _S.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):VC(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((s=>{const r=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-s.size):MS.resolve(rT());let a=ES,o=s;return r.next((e=>MS.forEach(e,((e,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),s.get(e)?MS.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{o=o.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,s))).next((()=>this.computeViews(t,o,e,uT()))).next((t=>({batchId:a,changes:sT(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new _S(e)).next((t=>{let e=iT();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const s=e.collectionGroup;let r=iT();return this.indexManager.getCollectionParents(t,s).next((a=>MS.forEach(a,(a=>{const o=function(t,e){return new OC(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,a.child(s));return this.getDocumentsMatchingCollectionQuery(t,o,n,i).next((t=>{t.forEach(((t,e)=>{r=r.insert(t,e)}))}))})).next((()=>r))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((r=>(s=r,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,s,i)))).next((t=>{s.forEach(((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,lC.newInvalidDocument(i)))}));let n=iT();return t.forEach(((t,i)=>{const r=s.get(t);void 0!==r&&LT(r.mutation,i,bk.empty(),pS.now()),QC(e,i)&&(n=n.insert(t,i))})),n}))}}class dI{constructor(t){this.serializer=t,this.kr=new Map,this.qr=new Map}getBundleMetadata(t,e){return MS.resolve(this.kr.get(e))}saveBundleMetadata(t,e){return this.kr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Ex(t.createTime)}}(e)),MS.resolve()}getNamedQuery(t,e){return MS.resolve(this.qr.get(e))}saveNamedQuery(t,e){return this.qr.set(e.name,function(t){return{name:t.name,query:Xx(t.bundledQuery),readTime:Ex(t.readTime)}}(e)),MS.resolve()}}class fI{constructor(){this.overlays=new gk(_S.comparator),this.Qr=new Map}getOverlay(t,e){return MS.resolve(this.overlays.get(e))}getOverlays(t,e){const n=rT();return MS.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.St(t,e,i)})),MS.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.Qr.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.Qr.delete(n)),MS.resolve()}getOverlaysForCollection(t,e,n){const i=rT(),s=e.length+1,r=new _S(e.child("")),a=this.overlays.getIteratorFrom(r);for(;a.hasNext();){const t=a.getNext().value,r=t.getKey();if(!e.isPrefixOf(r.path))break;r.path.length===s&&t.largestBatchId>n&&i.set(t.getKey(),t)}return MS.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let s=new gk(((t,e)=>t-e));const r=this.overlays.getIterator();for(;r.hasNext();){const t=r.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=s.get(t.largestBatchId);null===e&&(e=rT(),s=s.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const a=rT(),o=s.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((t,e)=>a.set(t,e))),!(a.size()>=i)););return MS.resolve(a)}St(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.Qr.get(i.largestBatchId).delete(n.key);this.Qr.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new KT(e,n));let s=this.Qr.get(e);void 0===s&&(s=uT(),this.Qr.set(e,s)),this.Qr.set(e,s.add(n.key))}}class pI{constructor(){this.sessionToken=Ek.EMPTY_BYTE_STRING}getSessionToken(t){return MS.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,MS.resolve()}}class gI{constructor(){this.$r=new yk(mI.Ur),this.Kr=new yk(mI.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(t,e){const n=new mI(t,e);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.zr(new mI(t,e))}jr(t,e){t.forEach((t=>this.removeReference(t,e)))}Hr(t){const e=new _S(new yS([])),n=new mI(e,t),i=new mI(e,t+1),s=[];return this.Kr.forEachInRange([n,i],(t=>{this.zr(t),s.push(t.key)})),s}Jr(){this.$r.forEach((t=>this.zr(t)))}zr(t){this.$r=this.$r.delete(t),this.Kr=this.Kr.delete(t)}Yr(t){const e=new _S(new yS([])),n=new mI(e,t),i=new mI(e,t+1);let s=uT();return this.Kr.forEachInRange([n,i],(t=>{s=s.add(t.key)})),s}containsKey(t){const e=new mI(t,0),n=this.$r.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class mI{constructor(t,e){this.key=t,this.Zr=e}static Ur(t,e){return _S.comparator(t.key,e.key)||oS(t.Zr,e.Zr)}static Wr(t,e){return oS(t.Zr,e.Zr)||_S.comparator(t.key,e.key)}}class vI{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nr=1,this.Xr=new yk(mI.Ur)}checkEmpty(t){return MS.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const s=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new qT(s,e,n,i);this.mutationQueue.push(r);for(const a of i)this.Xr=this.Xr.add(new mI(a.key,s)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return MS.resolve(r)}lookupMutationBatch(t,e){return MS.resolve(this.ei(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.ti(n),s=i<0?0:i;return MS.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return MS.resolve(0===this.mutationQueue.length?LS:this.nr-1)}getAllMutationBatches(t){return MS.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new mI(e,0),i=new mI(e,Number.POSITIVE_INFINITY),s=[];return this.Xr.forEachInRange([n,i],(t=>{const e=this.ei(t.Zr);s.push(e)})),MS.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new yk(oS);return e.forEach((t=>{const e=new mI(t,0),i=new mI(t,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([e,i],(t=>{n=n.add(t.Zr)}))})),MS.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let s=n;_S.isDocumentKey(s)||(s=s.child(""));const r=new mI(new _S(s),0);let a=new yk(oS);return this.Xr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(a=a.add(t.Zr)),!0)}),r),MS.resolve(this.ni(a))}ni(t){const e=[];return t.forEach((t=>{const n=this.ei(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){qA(0===this.ri(e.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Xr;return MS.forEach(e.mutations,(i=>{const s=new mI(i.key,e.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.Xr=n}))}sr(t){}containsKey(t,e){const n=new mI(e,0),i=this.Xr.firstAfterOrEqual(n);return MS.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,MS.resolve()}ri(t,e){return this.ti(t)}ti(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ei(t){const e=this.ti(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class yI{constructor(t){this.ii=t,this.docs=new gk(_S.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),s=i?i.size:0,r=this.ii(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:r}),this.size+=r-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return MS.resolve(n?n.document.mutableCopy():lC.newInvalidDocument(e))}getEntries(t,e){let n=eT();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():lC.newInvalidDocument(t))})),MS.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let s=eT();const r=e.path,a=new _S(r.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:t,value:{document:a}}=o.getNext();if(!r.isPrefixOf(t.path))break;t.path.length>r.length+1||TS(kS(a),n)<=0||(i.has(a.key)||QC(e,a))&&(s=s.insert(a.key,a.mutableCopy()))}return MS.resolve(s)}getAllFromCollectionGroup(t,e,n,i){zA(9500)}si(t,e){return MS.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new wI(this)}getSize(t){return MS.resolve(this.size)}}class wI extends cI{constructor(t){super(),this.Br=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.Br.addEntry(t,i)):this.Br.removeEntry(n)})),MS.waitFor(e)}getFromCache(t,e){return this.Br.getEntry(t,e)}getAllFromCache(t,e){return this.Br.getEntries(t,e)}}class bI{constructor(t){this.persistence=t,this.oi=new ZC((t=>NC(t)),DC),this.lastRemoteSnapshotVersion=gS.min(),this.highestTargetId=0,this._i=0,this.ai=new gI,this.targetCount=0,this.ui=eI.cr()}forEachTarget(t,e){return this.oi.forEach(((t,n)=>e(n))),MS.resolve()}getLastRemoteSnapshotVersion(t){return MS.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return MS.resolve(this._i)}allocateTargetId(t){return this.highestTargetId=this.ui.next(),MS.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._i&&(this._i=e),MS.resolve()}Tr(t){this.oi.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ui=new eI(e),this.highestTargetId=e),t.sequenceNumber>this._i&&(this._i=t.sequenceNumber)}addTargetData(t,e){return this.Tr(e),this.targetCount+=1,MS.resolve()}updateTargetData(t,e){return this.Tr(e),MS.resolve()}removeTargetData(t,e){return this.oi.delete(e.target),this.ai.Hr(e.targetId),this.targetCount-=1,MS.resolve()}removeTargets(t,e,n){let i=0;const s=[];return this.oi.forEach(((r,a)=>{a.sequenceNumber<=e&&null===n.get(a.targetId)&&(this.oi.delete(r),s.push(this.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),MS.waitFor(s).next((()=>i))}getTargetCount(t){return MS.resolve(this.targetCount)}getTargetData(t,e){const n=this.oi.get(e)||null;return MS.resolve(n)}addMatchingKeys(t,e,n){return this.ai.Gr(e,n),MS.resolve()}removeMatchingKeys(t,e,n){this.ai.jr(e,n);const i=this.persistence.referenceDelegate,s=[];return i&&e.forEach((e=>{s.push(i.markPotentiallyOrphaned(t,e))})),MS.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.ai.Hr(e),MS.resolve()}getMatchingKeysForTargetId(t,e){const n=this.ai.Yr(e);return MS.resolve(n)}containsKey(t,e){return MS.resolve(this.ai.containsKey(e))}}class _I{constructor(t,e){this.ci={},this.overlays={},this.li=new DS(0),this.hi=!1,this.hi=!0,this.Pi=new pI,this.referenceDelegate=t(this),this.Ti=new bI(this),this.indexManager=new Yx,this.remoteDocumentCache=function(t){return new yI(t)}((t=>this.referenceDelegate.Ii(t))),this.serializer=new Kx(e),this.Ei=new dI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new fI,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.ci[t.toKey()];return n||(n=new vI(e,this.referenceDelegate),this.ci[t.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(t,e,n){BA("MemoryPersistence","Starting transaction:",t);const i=new EI(this.li.next());return this.referenceDelegate.di(),n(i).next((t=>this.referenceDelegate.Ai(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Ri(t,e){return MS.or(Object.values(this.ci).map((n=>()=>n.containsKey(t,e))))}}class EI extends IS{constructor(t){super(),this.currentSequenceNumber=t}}class AI{constructor(t){this.persistence=t,this.Vi=new gI,this.mi=null}static fi(t){return new AI(t)}get gi(){if(this.mi)return this.mi;throw zA(60996)}addReference(t,e,n){return this.Vi.addReference(n,e),this.gi.delete(n.toString()),MS.resolve()}removeReference(t,e,n){return this.Vi.removeReference(n,e),this.gi.add(n.toString()),MS.resolve()}markPotentiallyOrphaned(t,e){return this.gi.add(e.toString()),MS.resolve()}removeTarget(t,e){this.Vi.Hr(e.targetId).forEach((t=>this.gi.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.gi.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}di(){this.mi=new Set}Ai(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return MS.forEach(this.gi,(n=>{const i=_S.fromPath(n);return this.pi(t,i).next((t=>{t||e.removeEntry(i,gS.min())}))})).next((()=>(this.mi=null,e.apply(t))))}updateLimboDocument(t,e){return this.pi(t,e).next((t=>{t?this.gi.delete(e.toString()):this.gi.add(e.toString())}))}Ii(t){return 0}pi(t,e){return MS.or([()=>MS.resolve(this.Vi.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ri(t,e)])}}class SI{constructor(t,e){this.persistence=t,this.yi=new ZC((t=>VS(t.path)),((t,e)=>t.isEqual(e))),this.garbageCollector=lI(this,e)}static fi(t,e){return new SI(t,e)}di(){}Ai(t){return MS.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}pr(t){const e=this.br(t);return this.persistence.getTargetCache().getTargetCount(t).next((t=>e.next((e=>t+e))))}br(t){let e=0;return this.yr(t,(t=>{e++})).next((()=>e))}yr(t,e){return MS.forEach(this.yi,((n,i)=>this.Dr(t,n,i).next((t=>t?MS.resolve():e(i)))))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.si(t,(i=>this.Dr(t,i,e).next((t=>{t||(n++,s.removeEntry(i,gS.min()))})))).next((()=>s.apply(t))).next((()=>n))}markPotentiallyOrphaned(t,e){return this.yi.set(e,t.currentSequenceNumber),MS.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.yi.set(n,t.currentSequenceNumber),MS.resolve()}removeReference(t,e,n){return this.yi.set(n,t.currentSequenceNumber),MS.resolve()}updateLimboDocument(t,e){return this.yi.set(e,t.currentSequenceNumber),MS.resolve()}Ii(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Yk(t.data.value)),e}Dr(t,e,n){return MS.or([()=>this.persistence.Ri(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const t=this.yi.get(e);return MS.resolve(void 0!==t&&t>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class kI{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.ds=n,this.As=i}static Rs(t,e){let n=uT(),i=uT();for(const s of e.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new kI(t,e.fromCache,n,i)}}class CI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class TI{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=ly()?8:PS(ay())>0?6:4}initialize(t,e){this.ys=t,this.indexManager=e,this.Vs=!0}getDocumentsMatchingQuery(t,e,n,i){const s={result:null};return this.ws(t,e).next((t=>{s.result=t})).next((()=>{if(!s.result)return this.bs(t,e,i,n).next((t=>{s.result=t}))})).next((()=>{if(s.result)return;const n=new CI;return this.Ss(t,e,n).next((i=>{if(s.result=i,this.fs)return this.Ds(t,e,n,i.size)}))})).next((()=>s.result))}Ds(t,e,n,i){return n.documentReadCount<this.gs?(UA()<=Cy.DEBUG&&BA("QueryEngine","SDK will not create cache indexes for query:",XC(e),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),MS.resolve()):(UA()<=Cy.DEBUG&&BA("QueryEngine","Query:",XC(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ps*i?(UA()<=Cy.DEBUG&&BA("QueryEngine","The SDK decides to create cache indexes for query:",XC(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,WC(e))):MS.resolve())}ws(t,e){if(BC(e))return MS.resolve(null);let n=WC(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=qC(e,null,"F"),n=WC(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const s=uT(...i);return this.ys.getDocuments(t,s).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const r=this.vs(e,i);return this.Cs(e,r,s,n.readTime)?this.ws(t,qC(e,null,"F")):this.Fs(t,r,e,n)}))))})))))}bs(t,e,n,i){return BC(e)||i.isEqual(gS.min())?MS.resolve(null):this.ys.getDocuments(t,n).next((s=>{const r=this.vs(e,s);return this.Cs(e,r,n,i)?MS.resolve(null):(UA()<=Cy.DEBUG&&BA("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),XC(e)),this.Fs(t,r,e,SS(i,ES)).next((t=>t)))}))}vs(t,e){let n=new yk(JC(t));return e.forEach(((e,i)=>{QC(t,i)&&(n=n.add(i))})),n}Cs(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const s="F"===t.limitType?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(t,e,n){return UA()<=Cy.DEBUG&&BA("QueryEngine","Using full collection scan to execute query:",XC(e)),this.ys.getDocumentsMatchingQuery(t,e,CS.min(),n)}Fs(t,e,n,i){return this.ys.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}const xI="LocalStore";class II{constructor(t,e,n,i){this.persistence=t,this.Ms=e,this.serializer=i,this.xs=new gk(oS),this.Os=new ZC((t=>NC(t)),DC),this.Ns=new Map,this.Bs=t.getRemoteDocumentCache(),this.Ti=t.getTargetCache(),this.Ei=t.getBundleCache(),this.Ls(n)}Ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new hI(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.xs)))}}function RI(t,e,n,i){return new II(t,e,n,i)}async function MI(t,e){const n=GA(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((s=>(i=s,n.Ls(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const s=[],r=[];let a=uT();for(const t of i){s.push(t.batchId);for(const e of t.mutations)a=a.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)a=a.add(e.key)}return n.localDocuments.getDocuments(t,a).next((t=>({ks:t,removedBatchIds:s,addedBatchIds:r})))}))}))}function PI(t){const e=GA(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Ti.getLastRemoteSnapshotVersion(t)))}function NI(t,e,n){let i=uT(),s=uT();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=eT();return n.forEach(((n,r)=>{const a=t.get(n);r.isFoundDocument()!==a.isFoundDocument()&&(s=s.add(n)),r.isNoDocument()&&r.version.isEqual(gS.min())?(e.removeEntry(n,r.readTime),i=i.insert(n,r)):!a.isValidDocument()||r.version.compareTo(a.version)>0||0===r.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(r),i=i.insert(n,r)):BA(xI,"Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",r.version)})),{qs:i,Qs:s}}))}function DI(t,e){const n=GA(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=LS),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}function LI(t,e){const n=GA(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.Ti.getTargetData(t,e).next((s=>s?(i=s,MS.resolve(i)):n.Ti.allocateTargetId(t).next((s=>(i=new Gx(e,s,"TargetPurposeListen",t.currentSequenceNumber),n.Ti.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.xs.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.xs=n.xs.insert(t.targetId,t),n.Os.set(e,t.targetId)),t}))}async function OI(t,e,n){const i=GA(t),s=i.xs.get(e),r=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",r,(t=>i.persistence.referenceDelegate.removeTarget(t,s)))}catch(t){if(!NS(t))throw t;BA(xI,"Failed to update sequence numbers for target ".concat(e,": ").concat(t))}i.xs=i.xs.remove(e),i.Os.delete(s.target)}function FI(t,e,n){const i=GA(t);let s=gS.min(),r=uT();return i.persistence.runTransaction("Execute query","readwrite",(t=>function(t,e,n){const i=GA(t),s=i.Os.get(n);return void 0!==s?MS.resolve(i.xs.get(s)):i.Ti.getTargetData(e,n)}(i,t,WC(e)).next((e=>{if(e)return s=e.lastLimboFreeSnapshotVersion,i.Ti.getMatchingKeysForTargetId(t,e.targetId).next((t=>{r=t}))})).next((()=>i.Ms.getDocumentsMatchingQuery(t,e,n?s:gS.min(),n?r:uT()))).next((t=>(UI(i,YC(e),t),{documents:t,$s:r})))))}function UI(t,e,n){let i=t.Ns.get(e)||gS.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.Ns.set(e,i)}class BI{constructor(){this.activeTargetIds=dT()}js(t){this.activeTargetIds=this.activeTargetIds.add(t)}Hs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}zs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class VI{constructor(){this.xo=new BI,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.xo.js(t),this.Oo[t]||"not-current"}updateQueryState(t,e,n){this.Oo[t]=e}removeLocalQueryTarget(t){this.xo.Hs(t)}isLocalQueryTarget(t){return this.xo.activeTargetIds.has(t)}clearQueryState(t){delete this.Oo[t]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(t){return this.xo.activeTargetIds.has(t)}start(){return this.xo=new BI,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class jI{No(t){}shutdown(){}}const WI="ConnectivityMonitor";class zI{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(t){this.Qo.push(t)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){BA(WI,"Network connectivity changed: AVAILABLE");for(const t of this.Qo)t(0)}qo(){BA(WI,"Network connectivity changed: UNAVAILABLE");for(const t of this.Qo)t(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let HI=null;function qI(){return null===HI?HI=268435456+Math.round(2147483648*Math.random()):HI++,"0x"+HI.toString(16)}const GI="RestConnection",KI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class XI{get Uo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Ko=e+"://"+t.host,this.Wo="projects/".concat(n,"/databases/").concat(i),this.Go=this.databaseId.database===Lk?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(i)}zo(t,e,n,i,s){const r=qI(),a=this.jo(t,e.toUriEncodedString());BA(GI,"Sending RPC '".concat(t,"' ").concat(r,":"),a,n);const o={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(o,i,s);const{host:l}=new URL(a),c=ey(l);return this.Jo(t,a,o,n,c).then((e=>(BA(GI,"Received RPC '".concat(t,"' ").concat(r,": "),e),e)),(e=>{throw jA(GI,"RPC '".concat(t,"' ").concat(r," failed with error: "),e,"url: ",a,"request:",n),e}))}Yo(t,e,n,i,s,r){return this.zo(t,e,n,i,s)}Ho(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+OA,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}jo(t,e){const n=KI[t];return"".concat(this.Ko,"/v1/").concat(e,":").concat(n)}terminate(){}}class QI{constructor(t){this.Zo=t.Zo,this.Xo=t.Xo}e_(t){this.t_=t}n_(t){this.r_=t}i_(t){this.s_=t}onMessage(t){this.o_=t}close(){this.Xo()}send(t){this.Zo(t)}__(){this.t_()}a_(){this.r_()}u_(t){this.s_(t)}c_(t){this.o_(t)}}const YI="WebChannelConnection";class JI extends XI{constructor(t){super(t),this.l_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,n,i,s){const r=qI();return new Promise(((s,a)=>{const o=new AA;o.setWithCredentials(!0),o.listenOnce(kA.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case CA.NO_ERROR:const e=o.getResponseJson();BA(YI,"XHR for RPC '".concat(t,"' ").concat(r," received:"),JSON.stringify(e)),s(e);break;case CA.TIMEOUT:BA(YI,"RPC '".concat(t,"' ").concat(r," timed out")),a(new XA(KA.DEADLINE_EXCEEDED,"Request time out"));break;case CA.HTTP_ERROR:const n=o.getStatus();if(BA(YI,"RPC '".concat(t,"' ").concat(r," failed with status:"),n,"response text:",o.getResponseText()),n>0){let t=o.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(KA).indexOf(e)>=0?e:KA.UNKNOWN}(e.status);a(new XA(t,e.message))}else a(new XA(KA.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new XA(KA.UNAVAILABLE,"Connection failed."));break;default:zA(9055,{h_:t,streamId:r,P_:o.getLastErrorCode(),T_:o.getLastError()})}}finally{BA(YI,"RPC '".concat(t,"' ").concat(r," completed."))}}));const l=JSON.stringify(i);BA(YI,"RPC '".concat(t,"' ").concat(r," sending request:"),i),o.send(e,"POST",l,n,15)}))}I_(t,e,n){const i=qI(),s=[this.Ko,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=RA(),a=IA(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Ho(o.initMessageHeaders,e,n),o.encodeInitMessageHeaders=!0;const c=s.join("");BA(YI,"Creating RPC '".concat(t,"' stream ").concat(i,": ").concat(c),o);const u=r.createWebChannel(c,o);this.E_(u);let h=!1,d=!1;const f=new QI({Zo:e=>{d?BA(YI,"Not sending because RPC '".concat(t,"' stream ").concat(i," is closed:"),e):(h||(BA(YI,"Opening RPC '".concat(t,"' stream ").concat(i," transport.")),u.open(),h=!0),BA(YI,"RPC '".concat(t,"' stream ").concat(i," sending:"),e),u.send(e))},Xo:()=>u.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(u,SA.EventType.OPEN,(()=>{d||(BA(YI,"RPC '".concat(t,"' stream ").concat(i," transport opened.")),f.__())})),p(u,SA.EventType.CLOSE,(()=>{d||(d=!0,BA(YI,"RPC '".concat(t,"' stream ").concat(i," transport closed")),f.u_(),this.d_(u))})),p(u,SA.EventType.ERROR,(e=>{d||(d=!0,jA(YI,"RPC '".concat(t,"' stream ").concat(i," transport errored. Name:"),e.name,"Message:",e.message),f.u_(new XA(KA.UNAVAILABLE,"The operation could not be completed")))})),p(u,SA.EventType.MESSAGE,(e=>{var n;if(!d){const s=e.data[0];qA(!!s,16349);const r=s,a=(null==r?void 0:r.error)||(null===(n=r[0])||void 0===n?void 0:n.error);if(a){BA(YI,"RPC '".concat(t,"' stream ").concat(i," received error:"),a);const e=a.status;let n=function(t){const e=QT[t];if(void 0!==e)return $T(e)}(e),s=a.message;void 0===n&&(n=KA.INTERNAL,s="Unknown error status: "+e+" with message "+a.message),d=!0,f.u_(new XA(n,s)),u.close()}else BA(YI,"RPC '".concat(t,"' stream ").concat(i," received:"),s),f.c_(s)}})),p(a,xA.STAT_EVENT,(e=>{e.stat===TA.PROXY?BA(YI,"RPC '".concat(t,"' stream ").concat(i," detected buffering proxy")):e.stat===TA.NOPROXY&&BA(YI,"RPC '".concat(t,"' stream ").concat(i," detected no buffering proxy"))})),setTimeout((()=>{f.a_()}),0),f}terminate(){this.l_.forEach((t=>t.close())),this.l_=[]}E_(t){this.l_.push(t)}d_(t){this.l_=this.l_.filter((e=>e===t))}}function $I(){return"undefined"!=typeof document?document:null}function ZI(t){return new vx(t,!0)}class tR{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.xi=t,this.timerId=e,this.A_=n,this.R_=i,this.V_=s,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(t){this.cancel();const e=Math.floor(this.m_+this.w_()),n=Math.max(0,Date.now()-this.g_),i=Math.max(0,e-n);i>0&&BA("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.m_," ms, delay with jitter: ").concat(e," ms, last attempt: ").concat(n," ms ago)")),this.f_=this.xi.enqueueAfterDelay(this.timerId,i,(()=>(this.g_=Date.now(),t()))),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){null!==this.f_&&(this.f_.skipDelay(),this.f_=null)}cancel(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}const eR="PersistentStream";class nR{constructor(t,e,n,i,s,r,a,o){this.xi=t,this.S_=n,this.D_=i,this.connection=s,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new tR(t,e)}O_(){return 1===this.state||5===this.state||this.N_()}N_(){return 2===this.state||3===this.state}start(){this.M_=0,4!==this.state?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&null===this.C_&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,(()=>this.q_())))}Q_(t){this.U_(),this.stream.send(t)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(t,e){this.U_(),this.K_(),this.x_.cancel(),this.v_++,4!==t?this.x_.reset():e&&e.code===KA.RESOURCE_EXHAUSTED?(VA(e.toString()),VA("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):e&&e.code===KA.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.i_(e)}W_(){}auth(){this.state=1;const t=this.G_(this.v_),e=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((t=>{let[n,i]=t;this.v_===e&&this.z_(n,i)}),(e=>{t((()=>{const t=new XA(KA.UNKNOWN,"Fetching auth token failed: "+e.message);return this.j_(t)}))}))}z_(t,e){const n=this.G_(this.v_);this.stream=this.H_(t,e),this.stream.e_((()=>{n((()=>this.listener.e_()))})),this.stream.n_((()=>{n((()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,(()=>(this.N_()&&(this.state=3),Promise.resolve()))),this.listener.n_())))})),this.stream.i_((t=>{n((()=>this.j_(t)))})),this.stream.onMessage((t=>{n((()=>1==++this.M_?this.J_(t):this.onNext(t)))}))}B_(){this.state=5,this.x_.y_((async()=>{this.state=0,this.start()}))}j_(t){return BA(eR,"close with error: ".concat(t)),this.stream=null,this.close(4,t)}G_(t){return e=>{this.xi.enqueueAndForget((()=>this.v_===t?e():(BA(eR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class iR extends nR{constructor(t,e,n,i,s,r){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,r),this.serializer=s}H_(t,e){return this.connection.I_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.x_.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:zA(39313,{state:t})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],r=function(t,e){return t.useProto3Json?(qA(void 0===e||"string"==typeof e,58123),Ek.fromBase64String(e||"")):(qA(void 0===e||e instanceof Buffer||e instanceof Uint8Array,16193),Ek.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(t){const e=void 0===t.code?KA.UNKNOWN:$T(t.code);return new XA(e,t.message||"")}(a);n=new cx(i,s,r,o||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=Tx(t,i.document.name),r=Ex(i.document.updateTime),a=i.document.createTime?Ex(i.document.createTime):gS.min(),o=new aC({mapValue:{fields:i.document.fields}}),l=lC.newFoundDocument(s,r,a,o),c=i.targetIds||[],u=i.removedTargetIds||[];n=new ox(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=Tx(t,i.document),r=i.readTime?Ex(i.readTime):gS.min(),a=lC.newNoDocument(s,r),o=i.removedTargetIds||[];n=new ox([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=Tx(t,i.document),r=i.removedTargetIds||[];n=new ox([],r,s,null)}else{if(!("filter"in e))return zA(11601,{Vt:e});{e.filter;const t=e.filter;t.targetId;const{count:i=0,unchangedNames:s}=t,r=new XT(i,s),a=t.targetId;n=new lx(a,r)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return gS.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?gS.min():e.readTime?Ex(e.readTime):gS.min()}(t);return this.listener.Y_(e,n)}Z_(t){const e={};e.database=Rx(this.serializer),e.addTarget=function(t,e){let n;const i=e.target;if(n=LC(i)?{documents:Dx(t,i)}:{query:Lx(t,i).gt},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=bx(t,e.resumeToken);const i=yx(t,e.expectedCount);null!==i&&(n.expectedCount=i)}else if(e.snapshotVersion.compareTo(gS.min())>0){n.readTime=wx(t,e.snapshotVersion.toTimestamp());const i=yx(t,e.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return zA(28987,{purpose:t})}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.Q_(e)}X_(t){const e={};e.database=Rx(this.serializer),e.removeTarget=t,this.Q_(e)}}class sR extends nR{constructor(t,e,n,i,s,r){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,r),this.serializer=s}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(t,e){return this.connection.I_("Write",t,e)}J_(t){return qA(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,qA(!t.writeResults||0===t.writeResults.length,55816),this.listener.na()}onNext(t){qA(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.x_.reset();const e=function(t,e){return t&&t.length>0?(qA(void 0!==e,14353),t.map((t=>function(t,e){let n=t.updateTime?Ex(t.updateTime):Ex(e);return n.isEqual(gS.min())&&(n=Ex(e)),new IT(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Ex(t.commitTime);return this.listener.ra(n,e)}ia(){const t={};t.database=Rx(this.serializer),this.Q_(t)}ta(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>Nx(this.serializer,t)))};this.Q_(e)}}class rR{}class aR extends rR{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.sa=!1}oa(){if(this.sa)throw new XA(KA.FAILED_PRECONDITION,"The client has already been terminated.")}zo(t,e,n,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[r,a]=s;return this.connection.zo(t,Sx(e,n),i,r,a)})).catch((t=>{throw"FirebaseError"===t.name?(t.code===KA.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new XA(KA.UNKNOWN,t.toString())}))}Yo(t,e,n,i,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((r=>{let[a,o]=r;return this.connection.Yo(t,Sx(e,n),i,a,o,s)})).catch((t=>{throw"FirebaseError"===t.name?(t.code===KA.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new XA(KA.UNKNOWN,t.toString())}))}terminate(){this.sa=!0,this.connection.terminate()}}class oR{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){0===this._a&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve()))))}Pa(t){"Online"===this.state?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha("Connection failed 1 times. Most recent error: ".concat(t.toString())),this.la("Offline")))}set(t){this.Ta(),this._a=0,"Online"===t&&(this.ua=!1),this.la(t)}la(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ha(t){const e="Could not reach Cloud Firestore backend. ".concat(t,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.ua?(VA(e),this.ua=!1):BA("OnlineStateTracker",e)}Ta(){null!==this.aa&&(this.aa.cancel(),this.aa=null)}}const lR="RemoteStore";class cR{constructor(t,e,n,i,s){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=s,this.Ra.No((t=>{n.enqueueAndForget((async()=>{yR(this)&&(BA(lR,"Restarting streams for network reachability change."),await async function(t){const e=GA(t);e.da.add(4),await hR(e),e.Va.set("Unknown"),e.da.delete(4),await uR(e)}(this))}))})),this.Va=new oR(n,i)}}async function uR(t){if(yR(t))for(const e of t.Aa)await e(!0)}async function hR(t){for(const e of t.Aa)await e(!1)}function dR(t,e){const n=GA(t);n.Ea.has(e.targetId)||(n.Ea.set(e.targetId,e),vR(n)?mR(n):FR(n).N_()&&pR(n,e))}function fR(t,e){const n=GA(t),i=FR(n);n.Ea.delete(e),i.N_()&&gR(n,e),0===n.Ea.size&&(i.N_()?i.k_():yR(n)&&n.Va.set("Unknown"))}function pR(t,e){if(t.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(gS.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}FR(t).Z_(e)}function gR(t,e){t.ma.Ke(e),FR(t).X_(e)}function mR(t){t.ma=new hx({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Ea.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),FR(t).start(),t.Va.ca()}function vR(t){return yR(t)&&!FR(t).O_()&&t.Ea.size>0}function yR(t){return 0===GA(t).da.size}function wR(t){t.ma=void 0}async function bR(t){t.Va.set("Online")}async function _R(t){t.Ea.forEach(((e,n)=>{pR(t,e)}))}async function ER(t,e){wR(t),vR(t)?(t.Va.Pa(e),mR(t)):t.Va.set("Unknown")}async function AR(t,e,n){if(t.Va.set("Online"),e instanceof cx&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.Ea.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.Ea.delete(i),t.ma.removeTarget(i))}(t,e)}catch(n){BA(lR,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await SR(t,n)}else if(e instanceof ox?t.ma.Xe(e):e instanceof lx?t.ma.ot(e):t.ma.nt(e),!n.isEqual(gS.min()))try{const e=await PI(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.ma.It(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const s=t.Ea.get(i);s&&t.Ea.set(i,s.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach(((e,n)=>{const i=t.Ea.get(e);if(!i)return;t.Ea.set(e,i.withResumeToken(Ek.EMPTY_BYTE_STRING,i.snapshotVersion)),gR(t,e);const s=new Gx(i.target,e,n,i.sequenceNumber);pR(t,s)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){BA(lR,"Failed to raise snapshot:",e),await SR(t,e)}}async function SR(t,e,n){if(!NS(e))throw e;t.da.add(1),await hR(t),t.Va.set("Offline"),n||(n=()=>PI(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{BA(lR,"Retrying IndexedDB access"),await n(),t.da.delete(1),await uR(t)}))}function kR(t,e){return e().catch((n=>SR(t,n,e)))}async function CR(t){const e=GA(t),n=UR(e);let i=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:LS;for(;TR(e);)try{const t=await DI(e.localStore,i);if(null===t){0===e.Ia.length&&n.k_();break}i=t.batchId,xR(e,t)}catch(t){await SR(e,t)}IR(e)&&RR(e)}function TR(t){return yR(t)&&t.Ia.length<10}function xR(t,e){t.Ia.push(e);const n=UR(t);n.N_()&&n.ea&&n.ta(e.mutations)}function IR(t){return yR(t)&&!UR(t).O_()&&t.Ia.length>0}function RR(t){UR(t).start()}async function MR(t){UR(t).ia()}async function PR(t){const e=UR(t);for(const n of t.Ia)e.ta(n.mutations)}async function NR(t,e,n){const i=t.Ia.shift(),s=GT.from(i,e,n);await kR(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await CR(t)}async function DR(t,e){e&&UR(t).ea&&await async function(t,e){if(function(t){return JT(t)&&t!==KA.ABORTED}(e.code)){const n=t.Ia.shift();UR(t).L_(),await kR(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await CR(t)}}(t,e),IR(t)&&RR(t)}async function LR(t,e){const n=GA(t);n.asyncQueue.verifyOperationInProgress(),BA(lR,"RemoteStore received new credentials");const i=yR(n);n.da.add(3),await hR(n),i&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.da.delete(3),await uR(n)}async function OR(t,e){const n=GA(t);e?(n.da.delete(2),await uR(n)):e||(n.da.add(2),await hR(n),n.Va.set("Unknown"))}function FR(t){return t.fa||(t.fa=function(t,e,n){const i=GA(t);return i.oa(),new iR(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{e_:bR.bind(null,t),n_:_R.bind(null,t),i_:ER.bind(null,t),Y_:AR.bind(null,t)}),t.Aa.push((async e=>{e?(t.fa.L_(),vR(t)?mR(t):t.Va.set("Unknown")):(await t.fa.stop(),wR(t))}))),t.fa}function UR(t){return t.ga||(t.ga=function(t,e,n){const i=GA(t);return i.oa(),new sR(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:MR.bind(null,t),i_:DR.bind(null,t),na:PR.bind(null,t),ra:NR.bind(null,t)}),t.Aa.push((async e=>{e?(t.ga.L_(),await CR(t)):(await t.ga.stop(),t.Ia.length>0&&(BA(lR,"Stopping write stream with ".concat(t.Ia.length," pending writes")),t.Ia=[]))}))),t.ga}class BR{constructor(t,e,n,i,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new QA,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,s){const r=Date.now()+n,a=new BR(t,e,r,i,s);return a.start(n),a}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new XA(KA.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function VR(t,e){if(VA("AsyncQueue","".concat(e,": ").concat(t)),NS(t))return new XA(KA.UNAVAILABLE,"".concat(e,": ").concat(t));throw t}class jR{static emptySet(t){return new jR(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||_S.comparator(e.key,n.key):(t,e)=>_S.comparator(t.key,e.key),this.keyedMap=iT(),this.sortedSet=new gk(this.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof jR))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new jR;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class WR{constructor(){this.pa=new gk(_S.comparator)}track(t){const e=t.doc.key,n=this.pa.get(e);n?0!==t.type&&3===n.type?this.pa=this.pa.insert(e,t):3===t.type&&1!==n.type?this.pa=this.pa.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.pa=this.pa.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.pa=this.pa.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.pa=this.pa.remove(e):1===t.type&&2===n.type?this.pa=this.pa.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.pa=this.pa.insert(e,{type:2,doc:t.doc}):zA(63341,{Vt:t,ya:n}):this.pa=this.pa.insert(e,t)}wa(){const t=[];return this.pa.inorderTraversal(((e,n)=>{t.push(n)})),t}}class zR{constructor(t,e,n,i,s,r,a,o,l){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=r,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(t,e,n,i,s){const r=[];return e.forEach((t=>{r.push({type:0,doc:t})})),new zR(t,e,jR.emptySet(e),r,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&GC(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0}}class HR{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some((t=>t.va()))}}class qR{constructor(){this.queries=GR(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(t,e){const n=GA(t),i=n.queries;n.queries=GR(),i.forEach(((t,n)=>{for(const i of n.Sa)i.onError(e)}))}(this,new XA(KA.ABORTED,"Firestore shutting down"))}}function GR(){return new ZC((t=>KC(t)),GC)}async function KR(t,e){const n=GA(t);let i=3;const s=e.query;let r=n.queries.get(s);r?!r.Da()&&e.va()&&(i=2):(r=new HR,i=e.va()?0:1);try{switch(i){case 0:r.ba=await n.onListen(s,!0);break;case 1:r.ba=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(t){const n=VR(t,"Initialization of query '".concat(XC(e.query),"' failed"));return void e.onError(n)}n.queries.set(s,r),r.Sa.push(e),e.Fa(n.onlineState),r.ba&&e.Ma(r.ba)&&JR(n)}async function XR(t,e){const n=GA(t),i=e.query;let s=3;const r=n.queries.get(i);if(r){const t=r.Sa.indexOf(e);t>=0&&(r.Sa.splice(t,1),0===r.Sa.length?s=e.va()?0:1:!r.Da()&&e.va()&&(s=2))}switch(s){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function QR(t,e){const n=GA(t);let i=!1;for(const s of e){const t=s.query,e=n.queries.get(t);if(e){for(const t of e.Sa)t.Ma(s)&&(i=!0);e.ba=s}}i&&JR(n)}function YR(t,e,n){const i=GA(t),s=i.queries.get(e);if(s)for(const r of s.Sa)r.onError(n);i.queries.delete(e)}function JR(t){t.Ca.forEach((t=>{t.next()}))}var $R,ZR;(ZR=$R||($R={})).xa="default",ZR.Cache="cache";class tM{constructor(t,e,n){this.query=t,this.Oa=e,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=n||{}}Ma(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new zR(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Na?this.La(t)&&(this.Oa.next(t),e=!0):this.ka(t,this.onlineState)&&(this.qa(t),e=!0),this.Ba=t,e}onError(t){this.Oa.error(t)}Fa(t){this.onlineState=t;let e=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,t)&&(this.qa(this.Ba),e=!0),e}ka(t,e){if(!t.fromCache)return!0;if(!this.va())return!0;const n="Offline"!==e;return(!this.options.Qa||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}La(t){if(t.docChanges.length>0)return!0;const e=this.Ba&&this.Ba.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}qa(t){t=zR.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Na=!0,this.Oa.next(t)}va(){return this.options.source!==$R.Cache}}class eM{constructor(t){this.key=t}}class nM{constructor(t){this.key=t}}class iM{constructor(t,e){this.query=t,this.Ha=e,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=uT(),this.mutatedKeys=uT(),this.Za=JC(t),this.Xa=new jR(this.Za)}get eu(){return this.Ha}tu(t,e){const n=e?e.nu:new WR,i=e?e.Xa:this.Xa;let s=e?e.mutatedKeys:this.mutatedKeys,r=i,a=!1;const o="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const c=i.get(t),u=QC(this.query,e)?e:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.ru(c,u)||(n.track({type:2,doc:u}),f=!0,(o&&this.Za(u,o)>0||l&&this.Za(u,l)<0)&&(a=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(o||l)&&(a=!0)),f&&(u?(r=r.add(u),s=d?s.add(t):s.delete(t)):(r=r.delete(t),s=s.delete(t)))})),null!==this.query.limit)for(;r.size>this.query.limit;){const t="F"===this.query.limitType?r.last():r.first();r=r.delete(t.key),s=s.delete(t.key),n.track({type:1,doc:t})}return{Xa:r,nu:n,Cs:a,mutatedKeys:s}}ru(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const s=this.Xa;this.Xa=t.Xa,this.mutatedKeys=t.mutatedKeys;const r=t.nu.wa();r.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return zA(20277,{Vt:t})}};return n(t)-n(e)}(t.type,e.type)||this.Za(t.doc,e.doc))),this.iu(n),i=null!=i&&i;const a=e&&!i?this.su():[],o=0===this.Ya.size&&this.current&&!i?1:0,l=o!==this.Ja;return this.Ja=o,0!==r.length||l?{snapshot:new zR(this.query,t.Xa,s,r,t.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),ou:a}:{ou:a}}Fa(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new WR,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(t){return!this.Ha.has(t)&&!!this.Xa.has(t)&&!this.Xa.get(t).hasLocalMutations}iu(t){t&&(t.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=t.current)}su(){if(!this.current)return[];const t=this.Ya;this.Ya=uT(),this.Xa.forEach((t=>{this._u(t.key)&&(this.Ya=this.Ya.add(t.key))}));const e=[];return t.forEach((t=>{this.Ya.has(t)||e.push(new nM(t))})),this.Ya.forEach((n=>{t.has(n)||e.push(new eM(n))})),e}au(t){this.Ha=t.$s,this.Ya=uT();const e=this.tu(t.documents);return this.applyChanges(e,!0)}uu(){return zR.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,0===this.Ja,this.hasCachedResults)}}const sM="SyncEngine";class rM{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class aM{constructor(t){this.key=t,this.cu=!1}}class oM{constructor(t,e,n,i,s,r){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=r,this.lu={},this.hu=new ZC((t=>KC(t)),GC),this.Pu=new Map,this.Tu=new Set,this.Iu=new gk(_S.comparator),this.Eu=new Map,this.du=new gI,this.Au={},this.Ru=new Map,this.Vu=eI.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return!0===this.mu}}async function lM(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=IM(t);let s;const r=i.hu.get(e);return r?(i.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.uu()):s=await uM(i,e,n,!0),s}async function cM(t,e){const n=IM(t);await uM(n,e,!0,!1)}async function uM(t,e,n,i){const s=await LI(t.localStore,WC(e)),r=s.targetId,a=t.sharedClientState.addLocalQueryTarget(r,n);let o;return i&&(o=await hM(t,e,r,"current"===a,s.resumeToken)),t.isPrimaryClient&&n&&dR(t.remoteStore,s),o}async function hM(t,e,n,i,s){t.fu=(e,n,i)=>async function(t,e,n,i){let s=e.view.tu(n);s.Cs&&(s=await FI(t.localStore,e.query,!1).then((t=>{let{documents:n}=t;return e.view.tu(n,s)})));const r=i&&i.targetChanges.get(e.targetId),a=i&&null!=i.targetMismatches.get(e.targetId),o=e.view.applyChanges(s,t.isPrimaryClient,r,a);return AM(t,e.targetId,o.ou),o.snapshot}(t,e,n,i);const r=await FI(t.localStore,e,!0),a=new iM(e,r.$s),o=a.tu(r.documents),l=ax.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,s),c=a.applyChanges(o,t.isPrimaryClient,l);AM(t,n,c.ou);const u=new rM(e,n,a);return t.hu.set(e,u),t.Pu.has(n)?t.Pu.get(n).push(e):t.Pu.set(n,[e]),c.snapshot}async function dM(t,e,n){const i=GA(t),s=i.hu.get(e),r=i.Pu.get(s.targetId);if(r.length>1)return i.Pu.set(s.targetId,r.filter((t=>!GC(t,e)))),void i.hu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await OI(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),n&&fR(i.remoteStore,s.targetId),_M(i,s.targetId)})).catch(RS)):(_M(i,s.targetId),await OI(i.localStore,s.targetId,!0))}async function fM(t,e){const n=GA(t),i=n.hu.get(e),s=n.Pu.get(i.targetId);n.isPrimaryClient&&1===s.length&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),fR(n.remoteStore,i.targetId))}async function pM(t,e){const n=GA(t);try{const t=await function(t,e){const n=GA(t),i=e.snapshotVersion;let s=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const r=n.Bs.newChangeBuffer({trackRemovals:!0});s=n.xs;const a=[];e.targetChanges.forEach(((r,o)=>{const l=s.get(o);if(!l)return;a.push(n.Ti.removeMatchingKeys(t,r.removedDocuments,o).next((()=>n.Ti.addMatchingKeys(t,r.addedDocuments,o))));let c=l.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(o)?c=c.withResumeToken(Ek.EMPTY_BYTE_STRING,gS.min()).withLastLimboFreeSnapshotVersion(gS.min()):r.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(r.resumeToken,i)),s=s.insert(o,c),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||(e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,r)&&a.push(n.Ti.updateTargetData(t,c))}));let o=eT(),l=uT();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),a.push(NI(t,r,e.documentUpdates).next((t=>{o=t.qs,l=t.Qs}))),!i.isEqual(gS.min())){const e=n.Ti.getLastRemoteSnapshotVersion(t).next((e=>n.Ti.setTargetsMetadata(t,t.currentSequenceNumber,i)));a.push(e)}return MS.waitFor(a).next((()=>r.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,o,l))).next((()=>o))})).then((t=>(n.xs=s,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.Eu.get(e);i&&(qA(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,22616),t.addedDocuments.size>0?i.cu=!0:t.modifiedDocuments.size>0?qA(i.cu,14607):t.removedDocuments.size>0&&(qA(i.cu,42227),i.cu=!1))})),await CM(n,t,e)}catch(t){await RS(t)}}function gM(t,e,n){const i=GA(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.hu.forEach(((n,i)=>{const s=i.view.Fa(e);s.snapshot&&t.push(s.snapshot)})),function(t,e){const n=GA(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const s of n.Sa)s.Fa(e)&&(i=!0)})),i&&JR(n)}(i.eventManager,e),t.length&&i.lu.Y_(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function mM(t,e,n){const i=GA(t);i.sharedClientState.updateQueryState(e,"rejected",n);const s=i.Eu.get(e),r=s&&s.key;if(r){let t=new gk(_S.comparator);t=t.insert(r,lC.newNoDocument(r,gS.min()));const n=uT().add(r),s=new rx(gS.min(),new Map,new gk(oS),t,n);await pM(i,s),i.Iu=i.Iu.remove(r),i.Eu.delete(e),kM(i)}else await OI(i.localStore,e,!1).then((()=>_M(i,e,n))).catch(RS)}async function vM(t,e){const n=GA(t),i=e.batch.batchId;try{const t=await function(t,e){const n=GA(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),s=n.Bs.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const s=n.batch,r=s.keys();let a=MS.resolve();return r.forEach((t=>{a=a.next((()=>i.getEntry(e,t))).next((e=>{const r=n.docVersions.get(t);qA(null!==r,48541),e.version.compareTo(r)<0&&(s.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),a.next((()=>t.mutationQueue.removeMutationBatch(e,s)))}(n,t,e,s).next((()=>s.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=uT();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);bM(n,i,null),wM(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await CM(n,t)}catch(t){await RS(t)}}async function yM(t,e,n){const i=GA(t);try{const t=await function(t,e){const n=GA(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(qA(null!==e,37113),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);bM(i,e,n),wM(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await CM(i,t)}catch(n){await RS(n)}}function wM(t,e){(t.Ru.get(e)||[]).forEach((t=>{t.resolve()})),t.Ru.delete(e)}function bM(t,e,n){const i=GA(t);let s=i.Au[i.currentUser.toKey()];if(s){const t=s.get(e);t&&(n?t.reject(n):t.resolve(),s=s.remove(e)),i.Au[i.currentUser.toKey()]=s}}function _M(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Pu.get(e))t.hu.delete(i),n&&t.lu.gu(i,n);t.Pu.delete(e),t.isPrimaryClient&&t.du.Hr(e).forEach((e=>{t.du.containsKey(e)||EM(t,e)}))}function EM(t,e){t.Tu.delete(e.path.canonicalString());const n=t.Iu.get(e);null!==n&&(fR(t.remoteStore,n),t.Iu=t.Iu.remove(e),t.Eu.delete(n),kM(t))}function AM(t,e,n){for(const i of n)i instanceof eM?(t.du.addReference(i.key,e),SM(t,i)):i instanceof nM?(BA(sM,"Document no longer in limbo: "+i.key),t.du.removeReference(i.key,e),t.du.containsKey(i.key)||EM(t,i.key)):zA(19791,{pu:i})}function SM(t,e){const n=e.key,i=n.path.canonicalString();t.Iu.get(n)||t.Tu.has(i)||(BA(sM,"New document in limbo: "+n),t.Tu.add(i),kM(t))}function kM(t){for(;t.Tu.size>0&&t.Iu.size<t.maxConcurrentLimboResolutions;){const e=t.Tu.values().next().value;t.Tu.delete(e);const n=new _S(yS.fromString(e)),i=t.Vu.next();t.Eu.set(i,new aM(n)),t.Iu=t.Iu.insert(n,i),dR(t.remoteStore,new Gx(WC(UC(n.path)),i,"TargetPurposeLimboResolution",DS.le))}}async function CM(t,e,n){const i=GA(t),s=[],r=[],a=[];i.hu.isEmpty()||(i.hu.forEach(((t,o)=>{a.push(i.fu(o,e,n).then((t=>{var e;if((t||n)&&i.isPrimaryClient){const s=t?!t.fromCache:null===(e=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===e?void 0:e.current;i.sharedClientState.updateQueryState(o.targetId,s?"current":"not-current")}if(t){s.push(t);const e=kI.Rs(o.targetId,t);r.push(e)}})))})),await Promise.all(a),i.lu.Y_(s),await async function(t,e){const n=GA(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>MS.forEach(e,(e=>MS.forEach(e.ds,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>MS.forEach(e.As,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!NS(t))throw t;BA(xI,"Failed to update sequence numbers: "+t)}for(const i of e){const t=i.targetId;if(!i.fromCache){const e=n.xs.get(t),i=e.snapshotVersion,s=e.withLastLimboFreeSnapshotVersion(i);n.xs=n.xs.insert(t,s)}}}(i.localStore,r))}async function TM(t,e){const n=GA(t);if(!n.currentUser.isEqual(e)){BA(sM,"User change. New user:",e.toKey());const t=await MI(n.localStore,e);n.currentUser=e,function(t,e){t.Ru.forEach((t=>{t.forEach((t=>{t.reject(new XA(KA.CANCELLED,e))}))})),t.Ru.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await CM(n,t.ks)}}function xM(t,e){const n=GA(t),i=n.Eu.get(e);if(i&&i.cu)return uT().add(i.key);{let t=uT();const i=n.Pu.get(e);if(!i)return t;for(const e of i){const i=n.hu.get(e);t=t.unionWith(i.view.eu)}return t}}function IM(t){const e=GA(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=pM.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=xM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=mM.bind(null,e),e.lu.Y_=QR.bind(null,e.eventManager),e.lu.gu=YR.bind(null,e.eventManager),e}function RM(t){const e=GA(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=vM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=yM.bind(null,e),e}class MM{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=ZI(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Su(t),await this.persistence.start(),this.localStore=this.Du(t),this.gcScheduler=this.vu(t,this.localStore),this.indexBackfillerScheduler=this.Cu(t,this.localStore)}vu(t,e){return null}Cu(t,e){return null}Du(t){return RI(this.persistence,new TI,t.initialUser,this.serializer)}Su(t){return new _I(AI.fi,this.serializer)}bu(t){return new VI}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}MM.provider={build:()=>new MM};class PM extends MM{constructor(t){super(),this.cacheSizeBytes=t}vu(t,e){qA(this.persistence.referenceDelegate instanceof SI,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new aI(n,t.asyncQueue,e)}Su(t){const e=void 0!==this.cacheSizeBytes?tI.withCacheSize(this.cacheSizeBytes):tI.DEFAULT;return new _I((t=>SI.fi(t,e)),this.serializer)}}class NM{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>gM(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=TM.bind(null,this.syncEngine),await OR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new qR}createDatastore(t){const e=ZI(t.databaseInfo.databaseId),n=function(t){return new JI(t)}(t.databaseInfo);return function(t,e,n,i){return new aR(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,i,s){return new cR(t,e,n,i,s)}(this.localStore,this.datastore,t.asyncQueue,(t=>gM(this.syncEngine,t,0)),zI.C()?new zI:new jI)}createSyncEngine(t,e){return function(t,e,n,i,s,r,a){const o=new oM(t,e,n,i,s,r);return a&&(o.mu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await async function(t){const e=GA(t);BA(lR,"RemoteStore shutting down."),e.da.add(5),await hR(e),e.Ra.shutdown(),e.Va.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate(),null===(e=this.eventManager)||void 0===e||e.terminate()}}NM.provider={build:()=>new NM};class DM{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Mu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Mu(this.observer.error,t):VA("Uncaught Error in snapshot listener:",t.toString()))}xu(){this.muted=!0}Mu(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}const LM="FirestoreClient";class OM{constructor(t,e,n,i,s){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=LA.UNAUTHENTICATED,this.clientId=aS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,(async t=>{BA(LM,"Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(BA(LM,"Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new QA;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=VR(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function FM(t,e){t.asyncQueue.verifyOperationInProgress(),BA(LM,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await MI(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function UM(t,e){t.asyncQueue.verifyOperationInProgress();const n=await BM(t);BA(LM,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>LR(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>LR(e.remoteStore,n))),t._onlineComponents=e}async function BM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){BA(LM,"Using user provided OfflineComponentProvider");try{await FM(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===KA.FAILED_PRECONDITION||t.code===KA.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;jA("Error using user provided cache. Falling back to memory cache: "+n),await FM(t,new MM)}}else BA(LM,"Using default OfflineComponentProvider"),await FM(t,new PM(void 0));return t._offlineComponents}async function VM(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(BA(LM,"Using user provided OnlineComponentProvider"),await UM(t,t._uninitializedComponentsProvider._online)):(BA(LM,"Using default OnlineComponentProvider"),await UM(t,new NM))),t._onlineComponents}function jM(t){return VM(t).then((t=>t.syncEngine))}async function WM(t){const e=await VM(t),n=e.eventManager;return n.onListen=lM.bind(null,e.syncEngine),n.onUnlisten=dM.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=cM.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=fM.bind(null,e.syncEngine),n}function zM(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const HM=new Map;function qM(t,e,n){if(!n)throw new XA(KA.INVALID_ARGUMENT,"Function ".concat(t,"() cannot be called with an empty ").concat(e,"."))}function GM(t){if(!_S.isDocumentKey(t))throw new XA(KA.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(t," has ").concat(t.length,"."))}function KM(t){if(_S.isDocumentKey(t))throw new XA(KA.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(t," has ").concat(t.length,"."))}function XM(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t="".concat(t.substring(0,20),"...")),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?"a custom ".concat(e," object"):"an object"}}return"function"==typeof t?"a function":zA(12329,{type:typeof t})}function QM(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new XA(KA.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=XM(t);throw new XA(KA.INVALID_ARGUMENT,"Expected type '".concat(e.name,"', but it was: ").concat(n))}}return t}const YM="firestore.googleapis.com",JM=!0;class $M{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new XA(KA.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=YM,this.ssl=JM}else this.host=t.host,this.ssl=null!==(e=t.ssl)&&void 0!==e?e:JM;if(this.isUsingEmulator=void 0!==t.emulatorOptions,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=Zx;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<iI)throw new XA(KA.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new XA(KA.INVALID_ARGUMENT,"".concat(t," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zM(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new XA(KA.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (must not be NaN)"));if(t.timeoutSeconds<5)throw new XA(KA.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (minimum allowed value is 5)"));if(t.timeoutSeconds>30)throw new XA(KA.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ZM{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $M({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new XA(KA.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new XA(KA.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $M(t),this._emulatorOptions=t.emulatorOptions||{},void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new JA;switch(t.type){case"firstParty":return new eS(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new XA(KA.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=HM.get(t);e&&(BA("ComponentProvider","Removing Datastore"),HM.delete(t),e.terminate())}(this),Promise.resolve()}}function tP(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var s;t=QM(t,ZM);const r=ey(e),a=t._getSettings(),o=Object.assign(Object.assign({},a),{emulatorOptions:t._getEmulatorOptions()}),l="".concat(e,":").concat(n);r&&(ny("https://".concat(l)),ry("Firestore",!0)),a.host!==YM&&a.host!==l&&jA("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},a),{host:l,ssl:r,emulatorOptions:i});if(!fy(c,o)&&(t._setSettings(c),i.mockUserToken)){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=LA.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Kv(JSON.stringify({alg:"none",type:"JWT"})),Kv(JSON.stringify(r)),""].join(".")}(i.mockUserToken,null===(s=t._app)||void 0===s?void 0:s.options.projectId);const r=i.mockUserToken.sub||i.mockUserToken.user_id;if(!r)throw new XA(KA.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new LA(r)}t._authCredentials=new $A(new YA(e,n))}}class eP{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new eP(this.firestore,t,this._query)}}class nP{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new iP(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new nP(this.firestore,t,this._key)}}class iP extends eP{constructor(t,e,n){super(t,e,UC(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new nP(this.firestore,null,new _S(t))}withConverter(t){return new iP(this.firestore,t,this._path)}}function sP(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];if(t=by(t),qM("collection","path",e),t instanceof ZM){const n=yS.fromString(e,...i);return KM(n),new iP(t,null,n)}{if(!(t instanceof nP||t instanceof iP))throw new XA(KA.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(yS.fromString(e,...i));return KM(n),new iP(t.firestore,null,n)}}const rP="AsyncQueue";class aP{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new tR(this,"async_queue_retry"),this.rc=()=>{const t=$I();t&&BA(rP,"Visibility state changed to "+t.visibilityState),this.x_.b_()},this.sc=t;const e=$I();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.oc(),this._c(t)}enterRestrictedMode(t){if(!this.Yu){this.Yu=!0,this.tc=t||!1;const e=$I();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.rc)}}enqueue(t){if(this.oc(),this.Yu)return new Promise((()=>{}));const e=new QA;return this._c((()=>this.Yu&&this.tc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Ju.push(t),this.ac())))}async ac(){if(0!==this.Ju.length){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(t){if(!NS(t))throw t;BA(rP,"Operation failed with retryable error: "+t)}this.Ju.length>0&&this.x_.y_((()=>this.ac()))}}_c(t){const e=this.sc.then((()=>(this.ec=!0,t().catch((t=>{throw this.Xu=t,this.ec=!1,VA("INTERNAL UNHANDLED ERROR: ",oP(t)),t})).then((t=>(this.ec=!1,t))))));return this.sc=e,e}enqueueAfterDelay(t,e,n){this.oc(),this.nc.indexOf(t)>-1&&(e=0);const i=BR.createAndSchedule(this,t,e,n,(t=>this.uc(t)));return this.Zu.push(i),i}oc(){this.Xu&&zA(47125,{cc:oP(this.Xu)})}verifyOperationInProgress(){}async lc(){let t;do{t=this.sc,await t}while(t!==this.sc)}hc(t){for(const e of this.Zu)if(e.timerId===t)return!0;return!1}Pc(t){return this.lc().then((()=>{this.Zu.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.Zu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.lc()}))}Tc(t){this.nc.push(t)}uc(t){const e=this.Zu.indexOf(t);this.Zu.splice(e,1)}}function oP(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}function lP(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const i of e)if(i in n&&"function"==typeof n[i])return!0;return!1}(t,["next","error","complete"])}class cP extends ZM{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new aP,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new aP(t),this._firestoreClient=void 0,await t}}}function uP(t){if(t._terminated)throw new XA(KA.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||hP(t),t._firestoreClient}function hP(t){var e,n,i;const s=t._freezeSettings(),r=function(t,e,n,i){return new Dk(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,zM(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||(null===(n=s.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=s.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new OM(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(t){const e=null==t?void 0:t._online.build();return{_offline:null==t?void 0:t._offline.build(e),_online:e}}(t._componentsProvider))}class dP{constructor(t){this._byteString=t}static fromBase64String(t){try{return new dP(Ek.fromBase64String(t))}catch(t){throw new XA(KA.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new dP(Ek.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class fP{constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(let i=0;i<e.length;++i)if(0===e[i].length)throw new XA(KA.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bS(e)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class pP{constructor(t){this._methodName=t}}class gP{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new XA(KA.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new XA(KA.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return oS(this._lat,t._lat)||oS(this._long,t._long)}}class mP{constructor(t){this._values=(t||[]).map((t=>t))}toArray(){return this._values.map((t=>t))}isEqual(t){return function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(this._values,t._values)}}const vP=/^__.*__$/;class yP{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new BT(t,this.data,this.fieldMask,e,this.fieldTransforms):new UT(t,this.data,e,this.fieldTransforms)}}function wP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw zA(40011,{Ic:t})}}class bP{constructor(t,e,n,i,s,r){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===s&&this.Ec(),this.fieldTransforms=s||[],this.fieldMask=r||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(t){return new bP(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.dc({path:n,Rc:!1});return i.Vc(t),i}mc(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.dc({path:n,Rc:!1});return i.Ec(),i}fc(t){return this.dc({path:void 0,Rc:!0})}gc(t){return NP(t,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Ec(){if(this.path)for(let t=0;t<this.path.length;t++)this.Vc(this.path.get(t))}Vc(t){if(0===t.length)throw this.gc("Document fields must not be empty");if(wP(this.Ic)&&vP.test(t))throw this.gc('Document fields cannot begin and end with "__"')}}class _P{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||ZI(t)}bc(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new bP({Ic:t,methodName:e,wc:n,path:bS.emptyPath(),Rc:!1,yc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function EP(t){const e=t._freezeSettings(),n=ZI(t._databaseId);return new _P(t._databaseId,!!e.ignoreUndefinedProperties,n)}function AP(t,e,n,i,s){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=t.bc(r.merge||r.mergeFields?2:0,e,n,s);IP("Data must be an object, but it was:",a,i);const o=TP(i,a);let l,c;if(r.merge)l=new bk(a.fieldMask),c=a.fieldTransforms;else if(r.mergeFields){const t=[];for(const i of r.mergeFields){const s=RP(e,i,n);if(!a.contains(s))throw new XA(KA.INVALID_ARGUMENT,"Field '".concat(s,"' is specified in your field mask but missing from your input data."));DP(t,s)||t.push(s)}l=new bk(t),c=a.fieldTransforms.filter((t=>l.covers(t.field)))}else l=null,c=a.fieldTransforms;return new yP(new aC(o),l,c)}class SP extends pP{_toFieldTransform(t){return new xT(t.path,new bT)}isEqual(t){return t instanceof SP}}function kP(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return CP(n,t.bc(i?4:3,e))}function CP(t,e){if(xP(t=by(t)))return IP("Unsupported field value:",e,t),TP(t,e);if(t instanceof pP)return function(t,e){if(!wP(e.Ic))throw e.gc("".concat(t._methodName,"() can only be used with update() and set()"));if(!e.path)throw e.gc("".concat(t._methodName,"() is not currently supported inside arrays"));const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Rc&&4!==e.Ic)throw e.gc("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const s of t){let t=CP(s,e.fc(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=by(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return gT(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=pS.fromDate(t);return{timestampValue:wx(e.serializer,n)}}if(t instanceof pS){const n=new pS(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:wx(e.serializer,n)}}if(t instanceof gP)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof dP)return{bytesValue:bx(e.serializer,t._byteString)};if(t instanceof nP){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.gc("Document reference is for database ".concat(i.projectId,"/").concat(i.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Ax(t.firestore._databaseId||e.databaseId,t._key.path)}}if(t instanceof mP)return function(t,e){return{mapValue:{fields:{[Fk]:{stringValue:Vk},[jk]:{arrayValue:{values:t.toArray().map((t=>{if("number"!=typeof t)throw e.gc("VectorValues must only contain numeric values.");return fT(e.serializer,t)}))}}}}}}(t,e);throw e.gc("Unsupported field value: ".concat(XM(t)))}(t,e)}function TP(t,e){const n={};return pk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fk(t,((t,i)=>{const s=CP(i,e.Ac(t));null!=s&&(n[t]=s)})),{mapValue:{fields:n}}}function xP(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof pS||t instanceof gP||t instanceof dP||t instanceof nP||t instanceof pP||t instanceof mP)}function IP(t,e,n){if(!xP(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=XM(n);throw"an object"===i?e.gc(t+" a custom object"):e.gc(t+" "+i)}}function RP(t,e,n){if((e=by(e))instanceof fP)return e._internalPath;if("string"==typeof e)return PP(t,e);throw NP("Field path arguments must be of type string or ",t,!1,void 0,n)}const MP=new RegExp("[~\\*/\\[\\]]");function PP(t,e,n){if(e.search(MP)>=0)throw NP("Invalid field path (".concat(e,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,n);try{return new fP(...e.split("."))._internalPath}catch(i){throw NP("Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,n)}}function NP(t,e,n,i,s){const r=i&&!i.isEmpty(),a=void 0!==s;let o="Function ".concat(e,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(r||a)&&(l+=" (found",r&&(l+=" in field ".concat(i)),a&&(l+=" in document ".concat(s)),l+=")"),new XA(KA.INVALID_ARGUMENT,o+t+l)}function DP(t,e){return t.some((t=>t.isEqual(e)))}class LP{constructor(t,e,n,i,s){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new nP(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new OP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(FP("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class OP extends LP{data(){return super.data()}}function FP(t,e){return"string"==typeof e?PP(t,e):e instanceof fP?e._internalPath:e._delegate._internalPath}function UP(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new XA(KA.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class BP{}class VP extends BP{}class jP extends VP{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new jP(t,e,n)}_apply(t){const e=this._parse(t);return GP(t._query,e),new eP(t.firestore,t.converter,HC(t._query,e))}_parse(t){const e=EP(t.firestore),n=function(t,e,n,i,s,r,a){let o;if(s.isKeyField()){if("array-contains"===r||"array-contains-any"===r)throw new XA(KA.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(r,"' queries on documentId()."));if("in"===r||"not-in"===r){qP(a,r);const e=[];for(const n of a)e.push(HP(i,t,n));o={arrayValue:{values:e}}}else o=HP(i,t,a)}else"in"!==r&&"not-in"!==r&&"array-contains-any"!==r||qP(a,r),o=kP(n,e,a,"in"===r||"not-in"===r);return gC.create(s,r,o)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value);return n}}class WP extends BP{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new WP(t,e)}_parse(t){const e=this._queryConstraints.map((e=>e._parse(t))).filter((t=>t.getFilters().length>0));return 1===e.length?e[0]:mC.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(t,e){let n=t;const i=e.getFlattenedFilters();for(const s of i)GP(n,s),n=HC(n,s)}(t._query,e),new eP(t.firestore,t.converter,HC(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class zP extends VP{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new zP(t,e)}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new XA(KA.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new XA(KA.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new dC(e,n)}(t._query,this._field,this._direction);return new eP(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new OC(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}function HP(t,e,n){if("string"==typeof(n=by(n))){if(""===n)throw new XA(KA.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!VC(e)&&-1!==n.indexOf("/"))throw new XA(KA.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const i=e.path.child(yS.fromString(n));if(!_S.isDocumentKey(i))throw new XA(KA.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(i,"' is not because it has an odd number of segments (").concat(i.length,")."));return Jk(t,new _S(i))}if(n instanceof nP)return Jk(t,n._key);throw new XA(KA.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(XM(n),"."))}function qP(t,e){if(!Array.isArray(t)||0===t.length)throw new XA(KA.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(e.toString(),"' filters."))}function GP(t,e){const n=function(t,e){for(const n of t)for(const t of n.getFlattenedFilters())if(e.indexOf(t.op)>=0)return t.op;return null}(t.filters,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw n===e.op?new XA(KA.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(e.op.toString(),"' filter.")):new XA(KA.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(e.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class KP{convertValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Wk(t)){case 0:return null;case 1:return t.booleanValue;case 2:return kk(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Ck(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw zA(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return fk(t,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertVectorValue(t){var e,n,i;const s=null===(i=null===(n=null===(e=t.fields)||void 0===e?void 0:e[jk].arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.map((t=>kk(t.doubleValue)));return new mP(s)}convertGeoPoint(t){return new gP(kk(t.latitude),kk(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Pk(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Nk(t));default:return null}}convertTimestamp(t){const e=Sk(t);return new pS(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=yS.fromString(t);qA(qx(n),9688,{name:t});const i=new Ok(n.get(1),n.get(3)),s=new _S(n.popFirst(5));return i.isEqual(e)||VA("Document ".concat(s," contains a document reference within a different database (").concat(i.projectId,"/").concat(i.database,") which is not supported. It will be treated as a reference in the current database (").concat(e.projectId,"/").concat(e.database,") instead.")),s}}function XP(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class QP{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class YP extends LP{constructor(t,e,n,i,s,r){super(t,e,n,i,r),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const e=new JP(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(FP("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class JP extends YP{data(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(t)}}class $P{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new QP(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new JP(this._firestore,this._userDataWriter,n.key,n,new QP(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const t=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new XA(KA.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const i=new JP(t._firestore,t._userDataWriter,n.doc.key,n.doc,new QP(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new JP(t._firestore,t._userDataWriter,e.doc.key,e.doc,new QP(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let s=-1,r=-1;return 0!==e.type&&(s=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),r=n.indexOf(e.doc.key)),{type:ZP(e.type),doc:i,oldIndex:s,newIndex:r}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function ZP(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return zA(61501,{type:t})}}class tN extends KP{constructor(t){super(),this.firestore=t}convertBytes(t){return new dP(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new nP(this.firestore,null,e)}}function eN(t,e){const n=QM(t.firestore,cP),i=function(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];if(t=by(t),1===arguments.length&&(e=aS.newId()),qM("doc","path",e),t instanceof ZM){const n=yS.fromString(e,...i);return GM(n),new nP(t,null,new _S(n))}{if(!(t instanceof nP||t instanceof iP))throw new XA(KA.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(yS.fromString(e,...i));return GM(n),new nP(t.firestore,t instanceof iP?t.converter:null,new _S(n))}}(t),s=XP(t.converter,e);return nN(n,[AP(EP(t.firestore),"addDoc",i._key,s,null!==t.converter,{}).toMutation(i._key,RT.exists(!1))]).then((()=>i))}function nN(t,e){return function(t,e){const n=new QA;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=RM(t);try{const t=await function(t,e){const n=GA(t),i=pS.now(),s=e.reduce(((t,e)=>t.add(e.key)),uT());let r,a;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let o=eT(),l=uT();return n.Bs.getEntries(t,s).next((t=>{o=t,o.forEach(((t,e)=>{e.isValidDocument()||(l=l.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,o))).next((s=>{r=s;const a=[];for(const t of e){const e=OT(t,r.get(t.key).overlayedDocument);null!=e&&a.push(new BT(t.key,e,oC(e.value.mapValue),RT.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,a,e)})).next((e=>{a=e;const i=e.applyToLocalDocumentSet(r,l);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:a.batchId,changes:sT(r)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Au[t.currentUser.toKey()];i||(i=new gk(oS)),i=i.insert(e,n),t.Au[t.currentUser.toKey()]=i}(i,t.batchId,n),await CM(i,t.changes),await CR(i.remoteStore)}catch(t){const e=VR(t,"Failed to persist write");n.reject(e)}}(await jM(t),e,n))),n.promise}(uP(t),e)}function iN(t,e,n){const i=n.docs.get(e._key),s=new tN(t);return new YP(t,s,e._key,i,new QP(n.hasPendingWrites,n.fromCache),e.converter)}new WeakMap;!function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(t){OA=t}(Lw),Rw(new _y("firestore",((t,n)=>{let{instanceIdentifier:i,options:s}=n;const r=t.getProvider("app").getImmediate(),a=new cP(new ZA(t.getProvider("auth-internal")),new iS(r,t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new XA(KA.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ok(t.options.projectId,e)}(r,i),r);return s=Object.assign({useFetchStreams:e},s),a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),Uw(NA,DA,t),Uw(NA,DA,"esm2017")}();var sN=n(579);const rN=function(t,e){const n="object"==typeof t?t:Fw(),i="string"==typeof t?t:e||Lk,s=Mw(n,"firestore").getImmediate({identifier:i});if(!s._initialized){const t=(t=>{const e=Jv(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error("Invalid host ".concat(e," with no separate hostname and port!"));const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]})("firestore");t&&tP(s,...t)}return s}();function aN(){const[t,n]=(0,e.useState)(null),[i,s]=(0,e.useState)(""),[r,a]=(0,e.useState)(""),[o,c]=(0,e.useState)(""),[u,h]=(0,e.useState)(null),[d,f]=(0,e.useState)(!1),[p,g]=(0,e.useState)(null),[m,v]=(0,e.useState)(!1),[y,w]=(0,e.useState)([]);(0,e.useEffect)((()=>{!function(t,e,n,i){by(t).onAuthStateChanged(e,n,i)}(vA,(t=>{if(n(t),t){const e=function(t,e){let n=[];for(var i=arguments.length,s=new Array(i>2?i-2:0),r=2;r<i;r++)s[r-2]=arguments[r];e instanceof BP&&n.push(e),n=n.concat(s),function(t){const e=t.filter((t=>t instanceof WP)).length,n=t.filter((t=>t instanceof jP)).length;if(e>1||e>0&&n>0)throw new XA(KA.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)t=a._apply(t);return t}(sP(rN,"chats"),function(t,e,n){const i=e,s=FP("where",t);return jP._create(s,i,n)}("uid","==",t.uid),function(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=FP("orderBy",t);return zP._create(n,e)}("timestamp","desc")),n=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var s,r,a;t=by(t);let o={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||lP(n[l])||(o=n[l],l++);const c={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(lP(n[l])){const t=n[l];n[l]=null===(s=t.next)||void 0===s?void 0:s.bind(t),n[l+1]=null===(r=t.error)||void 0===r?void 0:r.bind(t),n[l+2]=null===(a=t.complete)||void 0===a?void 0:a.bind(t)}let u,h,d;if(t instanceof nP)h=QM(t.firestore,cP),d=UC(t._key.path),u={next:e=>{n[l]&&n[l](iN(h,t,e))},error:n[l+1],complete:n[l+2]};else{const e=QM(t,eP);h=QM(e.firestore,cP),d=e._query;const i=new tN(h);u={next:t=>{n[l]&&n[l](new $P(h,i,e,t))},error:n[l+1],complete:n[l+2]},UP(t._query)}return function(t,e,n,i){const s=new DM(i),r=new tM(e,s,n);return t.asyncQueue.enqueueAndForget((async()=>KR(await WM(t),r))),()=>{s.xu(),t.asyncQueue.enqueueAndForget((async()=>XR(await WM(t),r)))}}(uP(h),d,c,u)}(e,(t=>{const e=[];t.forEach((t=>{e.push(l({id:t.id},t.data()))})),w(e)}));return()=>n()}w([])}))}),[]);const b=()=>async function(t,e,n){if(Pw(t.app))return Promise.reject(nb(t,"operation-not-supported-in-this-environment"));const i=h_(t);rb(t,e,F_);const s=CE(i,n);return new NE(i,"signInViaPopup",e,s).executeNotNull()}(vA,yA),_=async e=>{f(!0);try{const n=(await Pe.post("https://joe-ai-backend-production.up.railway.app/ask",{message:e},{headers:{"Content-Type":"application/json"}})).data.response;h(n),await(async(e,n)=>{t&&await eN(sP(rN,"chats"),{uid:t.uid,email:t.email,prompt:e,answer:n,timestamp:new SP("serverTimestamp")})})(e,n)}catch(n){h("Error reaching OpenAI API.")}finally{f(!1)}},E=[{id:1,topic:"AI in Healthcare",articles:[{id:"a1",title:"Transforming diagnostics",snippet:"AI is used to detect diseases faster..."}]},{id:2,topic:"NLP",articles:[{id:"b1",title:"Chatbots 2025",snippet:"Chatbots now understand better thanks to transformers..."}]}].filter((t=>t.topic.toLowerCase().includes(i.toLowerCase())));return t?(0,sN.jsxs)("div",{className:"".concat(m?"bg-gray-900 text-white":"bg-gray-100 text-black"," min-h-screen p-6"),children:[(0,sN.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,sN.jsx)("h1",{className:"text-3xl font-bold",children:"JOE AI \u2013 Your Research Assistant"}),(0,sN.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:(0,sN.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,sN.jsxs)("div",{className:"flex items-center gap-2",children:[(0,sN.jsx)("img",{src:t.photoURL,alt:"avatar",className:"w-8 h-8 rounded-full"}),(0,sN.jsx)("span",{className:"text-sm font-medium truncate max-w-[120px]",children:t.displayName})]}),(0,sN.jsx)("button",{onClick:()=>function(t){return by(t).signOut()}(vA),className:"px-3 py-1 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200",children:"Logout"}),(0,sN.jsxs)("button",{onClick:()=>v(!m),className:"px-3 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300",children:["Toggle ",m?"Light":"Dark"," Mode"]})]})})]}),(0,sN.jsxs)("div",{className:"max-w-xl mx-auto mb-6",children:[(0,sN.jsx)("input",{className:"w-full border px-4 py-2 rounded mb-2",placeholder:"Search or ask something...",value:i,onChange:t=>s(t.target.value)}),(0,sN.jsx)("button",{onClick:()=>_(i),className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700",children:"Ask AI"}),d&&(0,sN.jsx)("p",{className:"text-sm mt-2",children:"Loading..."}),u&&(0,sN.jsxs)("div",{className:"mt-4 p-3 bg-white text-black rounded shadow",children:[(0,sN.jsx)("p",{children:u}),(0,sN.jsx)("button",{onClick:()=>{const t=new Blob([u],{type:"text/plain;charset=utf-8"});(0,zv.saveAs)(t,"response.txt")},className:"mt-2 px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:"Export Answer"})]})]}),(0,sN.jsxs)("div",{className:"max-w-xl mx-auto bg-white p-4 rounded shadow mb-6 text-black",children:[(0,sN.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Upload Document (.txt/.pdf)"}),(0,sN.jsx)("input",{type:"file",accept:".txt,.pdf",onChange:async t=>{const e=t.target.files[0];if(e)if("application/pdf"===e.type){const t=new FileReader;t.onload=async t=>{const e=new Uint8Array(t.target.result),n=await Du({data:e}).promise;let i="";for(let s=1;s<=n.numPages;s++){const t=await n.getPage(s);i+=(await t.getTextContent()).items.map((t=>t.str)).join(" ")+"\n"}c(i)},t.readAsArrayBuffer(e)}else{const t=new FileReader;t.onload=t=>c(t.target.result),t.readAsText(e)}},className:"mb-2"}),(0,sN.jsx)("textarea",{className:"w-full border px-3 py-2 rounded mb-2",placeholder:"Ask something about the document...",rows:3,value:r,onChange:t=>a(t.target.value)}),(0,sN.jsx)("button",{onClick:()=>{o&&r&&_("Based on this document: ".concat(o,"\n\nAnswer: ").concat(r))},className:"bg-green-600 text-white w-full py-2 rounded hover:bg-green-700",children:"Ask About Document"})]}),(0,sN.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,sN.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Knowledge Clusters"}),(0,sN.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:E.map((t=>(0,sN.jsxs)("div",{onClick:()=>g(t),className:"p-4 border rounded-lg cursor-pointer hover:shadow bg-white text-black",children:[(0,sN.jsx)("h3",{className:"text-lg font-semibold",children:t.topic}),(0,sN.jsxs)("p",{className:"text-sm text-gray-600",children:[t.articles.length," articles"]})]},t.id)))}),p&&(0,sN.jsxs)("div",{className:"mt-6",children:[(0,sN.jsxs)("h3",{className:"text-xl font-bold mb-2",children:["Articles on ",p.topic]}),(0,sN.jsx)("div",{className:"space-y-3",children:p.articles.map((t=>(0,sN.jsxs)("div",{className:"p-3 bg-white text-black rounded border",children:[(0,sN.jsx)("h4",{className:"font-semibold",children:t.title}),(0,sN.jsx)("p",{className:"text-gray-700 text-sm",children:t.snippet})]},t.id)))})]})]}),(0,sN.jsxs)("div",{className:"max-w-4xl mx-auto mt-10",children:[(0,sN.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Your Chat History"}),0===y.length&&(0,sN.jsx)("p",{className:"text-gray-500",children:"No chat history available."}),(0,sN.jsx)("div",{className:"space-y-6 max-h-96 overflow-y-auto",children:y.map((t=>(0,sN.jsxs)("div",{className:"p-4 bg-white rounded shadow text-black",children:[(0,sN.jsxs)("p",{children:[(0,sN.jsx)("strong",{className:"text-blue-600",children:"You:"})," ",t.prompt]}),(0,sN.jsxs)("p",{className:"mt-2",children:[(0,sN.jsx)("strong",{className:"text-green-600",children:"JOE AI:"})," ",t.answer]})]},t.id)))})]})]}):(0,sN.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:(0,sN.jsxs)("div",{className:"bg-white p-8 rounded shadow text-center",children:[(0,sN.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Welcome to JOE AI"}),(0,sN.jsx)("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Sign in with Google"})]})})}i.createRoot(document.getElementById("root")).render((0,sN.jsx)(e.StrictMode,{children:(0,sN.jsx)(aN,{})}))})()})();
//# sourceMappingURL=main.79f0b9ec.js.map